import{u as oe,r as g,b as ie,d as le,a as re,e as _e,o as ce,g as d,h as p,j as t,p as f,w as P,l as k,t as l,n as V,k as r,i as n,F as U,x as S,Q as F,K as Q,q as R,_ as B,I as de}from"./index.7OFNPsHl.js";import{_ as ue}from"./EditFormSkeleton.hbjdnq7m.js";import{_ as me}from"./VRadio.JTuzCOQM.js";import{_ as pe}from"./VMultiSelect.XXz7TsgF.js";import{_ as he}from"./VTextInput.VtSvZjuc.js";import{_ as ye}from"./VTooltip.n3SV8A0p.js";import{a as q,F as ve}from"./vee-validate.esm.N3uz7Rsk.js";import{c as ge,a as j,d as L,e as be,h as fe}from"./index.esm.cd1bITNA.js";import{C as ke}from"./ClipLoader.1qNfpKDH.js";/* empty css                                                   */const Ve={class:"row"},qe={class:"col-md-12"},we={class:"row"},Ue={class:"col-md-12"},xe={class:"card"},Se={class:"row mb-5"},Ce={class:"section-title pb-2"},Ie={class:"section-title pb-2 text-muted"},$e={class:"col-12 col-md-4 col-lg-3"},Ae={class:"col-12 col-md-4 col-lg-3"},Ee={class:"col-12 col-md-4 col-lg-3"},Pe={class:"col-auto pt-md-3"},De={class:"form-field pt-3"},Te={class:"form-check form-switch"},Ne={class:"form-check-label",for:"status"},Oe=n("em",null,"*",-1),Me={class:"col-auto pt-md-3"},Fe={class:"form-field pt-3"},Qe={class:"form-check form-switch"},Re={class:"form-check-label",for:"is_stockable"},Be=n("em",null,"*",-1),je={key:0,class:"col-6 col-md-4 col-lg-3"},Le={class:"form-field"},Ge={for:""},ze=n("em",{class:"text-danger"},"*",-1),Je={value:""},Ke=["label"],Ye=["value"],He={key:1,class:"col-6 col-md-4 col-lg-3"},We={class:"form-field"},Xe={for:""},Ze=n("em",{class:"text-danger"},"*",-1),et={value:""},tt=["label"],at=["value"],nt={class:"row"},st={class:"section-title pb-2 text-muted"},ot={class:"col-12 col-md-4 col-lg-3"},it={class:"col-12 col-md-4 col-lg-3"},lt={class:"form-field"},rt={class:"input-group input-file-group"},_t={class:"btn btn-light-primary min-width-0 mb-0",for:"formFile"},ct={class:"col-6 col-md-4 col-lg-2"},dt={class:"col-6 col-md-4 col-lg-2"},ut={class:"col-6 col-md-4 col-lg-2"},mt={class:"col-6 col-md-4 col-lg-3"},pt={class:"col-12 col-md-4 col-lg-3"},ht={class:"col-12 col-md-4 col-lg-3"},yt={class:"form-field"},vt={class:"col-12 col-md-4 col-lg-3"},gt={class:"form-field"},bt={class:"col-md-12"},ft={class:"card"},kt={class:"row"},Vt={class:"section-title pb-2 text-muted"},qt={key:0,class:"col-6 col-md-3 col-lg-3"},wt={class:"col-6 col-md-3 col-lg-2"},Ut={key:1,class:"col-6 col-md-3 col-lg-2"},xt={class:"col-md-auto col-lg-auto"},St={class:"col-auto col-lg-auto"},Ct={class:"form-field",type:"radio"},It={class:"label"},$t={class:"form-check form-switch mt-md-3"},At=["onUpdate:modelValue","checked","onChange"],Et={class:"col-auto col-lg-auto"},Pt={class:"form-field",type:"radio"},Dt={class:"label"},Tt={class:"form-check form-switch mt-md-3"},Nt=["onUpdate:modelValue","checked","onChange"],Ot={class:"text-end"},Mt=["disabled"],Ft={key:1,class:"pt-0"},Qt={key:2,class:"pt-0"},Zt={__name:"AddIngredient",setup(Rt){const G=R(()=>B(()=>import("./AddCategory.PP9YcNT2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),{t:i}=oe(),{isAuthorized:D}=de();localStorage.getItem("language");const z=g([{name:i("Everywhere"),value:""},{name:"POS",value:"POS"},{name:"INVOICE",value:"INVOICE"}]),m=g({name:i("Ingredient Name"),sale_price:i("Sale Price"),name_ar:i("Ingredient Name (Arabic)"),short_description:i("Short Description"),short_description_ar:i("Short Description (Arabic)"),description:i("Description"),description_ar:i("Description (Arabic)"),select_categories:i("Select Categories"),purchase_price:i("Purchase Price"),alert_quantity:i("Alert Quantity"),upc:i("UPC (Barcode)"),master_ingredient_tooltip:i("This master ingredient will be visible on all branches."),branch_ingredient_tooltip:i("Stock only for this branch."),sales_price_inc_tax:i("Sale Price (Incl. Tax)"),sales_price_exc_tax:i("Sale Price (Excl. Tax)"),quantity:i("Quantity"),sku:i("SKU"),show_in:i("Show In"),unit:i("Unit")}),J=R(()=>B(()=>import("./ServerMessage.I5ol-gtz.js"),__vite__mapDeps([1,2,3]))),T=ie(),x=le(()=>T.user.currency.symbol),v=re().params.slack,y=_e({type:"",messages:""});function K(){O()}const e=g({is_submitting:!1,slack:"",name:"",sale_price:"",stock_measurement_unit_id:"",sale_measurement_unit_id:"",categories:[],is_stockable:!0,status:!0,image:"",name_ar:"",short_description:"",short_description_ar:"",description:"",description_ar:"",upc:"",purchase_price:"",alert_quantity:"",inventory_slack:"",inventory_quantity:0,inventory_sku:"",inventory_alert_quantity:"",inventory_show_in:"",inventory_is_favorite:!1,inventory_status:!0,is_quantity_readonly:!1,stock_measurement_unit_name:"Units"}),Y=ge({name:j().required(i("name is required",{name:i("Ingredient Name")})).min(3,i("name must be at least n characters",{name:i("Ingredient Name"),number:3})).max(20,i("Must be less than 20 characters",{name:i("Ingredient Name"),number:20})),sale_price:L().typeError(i("must be a number",{name:i("Sale Price")})).required(i("name is required",{name:i("Sale Price")})).positive(i("must be a positive number",{name:i("Sale Price")})),status:be().label("status"),categories:fe().min(1,i("select at least n options",{number:1})),inventory_quantity:L().typeError(i("must be a number",{name:i("Quantity")})).when({is:()=>e.value.is_stockable,then:a=>a.required(i("name is required",{name:i("Quantity")})).moreThan(0,"Quantity cannot be negative"),otherwise:a=>a.nullable()}),inventory_alert_quantity:j().matches(/^([.0-9]{0,9999999999999})$/,i("Alert Quantity must be a positive number or 0"))});async function H(a){e.value.image=a.target.files[0]}async function W(a){e.value.stock_measurement_unit_name=a.target.options[a.target.options.selectedIndex].text}ce(()=>{_.isUndefined(v)||ae(),O(),X()});const N=g({write:!1,delete:!1});function X(){N.value={write:D("A_WRITE_CATEGORY"),delete:D("A_DELETE_CATEGORY")}}const C=g([]),I=g([]),Z=g([]);async function O(){await axios.get("/api/ingredient/add").then(a=>{I.value=a.data.data.categories,Z.value=a.data.data.taxes,C.value=a.data.data.measurements}).catch(a=>{y.type="error",y.messages=a,e.value.is_submitting=!1,console.log(a)})}async function ee(a){e.is_submitting=!0;var o=new FormData;o.append("name",a.name),o.append("sale_price",a.sale_price),o.append("categories",JSON.stringify(a.categories)),o.append("is_stockable",a.is_stockable),o.append("status",a.status),o.append("image",e.value.image),o.append("name_ar",a.name_ar),o.append("short_description",a.short_description),o.append("short_description_ar",a.short_description_ar),o.append("description",a.description),o.append("description_ar",a.description_ar),o.append("upc",a.upc),o.append("purchase_price",a.purchase_price),o.append("alert_quantity",a.alert_quantity),o.append("ingredient_slack",v),o.append("inventory_slack",a.inventory_slack),o.append("inventory_sale_price",a.inventory_sale_price),o.append("inventory_quantity",a.inventory_quantity!=null?a.inventory_quantity:0),o.append("inventory_sku",a.inventory_sku!=null?a.inventory_sku:""),o.append("inventory_alert_quantity",a.inventory_alert_quantity),o.append("inventory_show_in",a.inventory_show_in!=null?a.inventory_show_in:""),o.append("inventory_is_favorite",a.inventory_is_favorite=="1"),o.append("inventory_status",a.inventory_status=="1"),a.is_stockable&&(a.stock_measurement_unit_id!=""&&o.append("stock_measurement_unit_id",a.stock_measurement_unit_id?a.stock_measurement_unit_id:""),a.sale_measurement_unit_id!=""&&o.append("sale_measurement_unit_id",a.sale_measurement_unit_id?a.sale_measurement_unit_id:""));var b=v!=""&&v!=null?"/api/ingredient/update":"/api/ingredient/save";await axios.post(b,o,{headers:{"Content-Type":"multipart/form-data"}}).then(u=>{if(u.data.status_code==200)toast.success(u.data.msg),e.value.is_submitting=!1,te(),router.push("/ingredients");else{try{y.type="error",y.messages=JSON.parse(u.data.msg)}catch{y.type="error",y.messages=u.data.msg}e.value.is_submitting=!1}}).catch(u=>{y.type="error",y.messages=u,e.value.is_submitting=!1,console.log(u)})}function te(){Object.assign(e,e)}const M=g(!1);async function ae(){let a=await axios.get("/api/ingredient",{params:{slack:v}});e.value=a.data.data.ingredient,M.value=!0,e.value.image="",e.value.categories=[],Object.keys(e.value.product_categories).forEach(o=>{e.value.categories.push(e.value.product_categories[o].category.slack)}),e.value.this_branch_inventory!=null?(e.value.inventory_slack=e.value.this_branch_inventory.slack,e.value.sale_price=e.value.this_branch_inventory.sale_price,e.value.inventory_quantity=e.value.this_branch_inventory.quantity,e.value.inventory_sku=e.value.this_branch_inventory.sku,e.value.inventory_alert_quantity=e.value.this_branch_inventory.alert_quantity,e.value.inventory_show_in=e.value.this_branch_inventory.show_in,e.value.inventory_is_favorite=e.value.this_branch_inventory.is_favorite==1,e.value.inventory_status=e.value.this_branch_inventory.status==1,e.value.is_quantity_readonly=!0):(e.value.inventory_show_in="",e.value.inventory_is_favorite=!1,e.value.inventory_status=!0,e.value.is_quantity_readonly=!1),e.value.is_stockable==!0&&e.value.stock_measurement_unit_id>0?e.value.stock_measurement_unit_name=e.value.stock_measurement_unit.unit_name+" "+e.value.stock_measurement_unit.unit_name_ar:e.value.stock_measurement_unit_name="Units"}return(a,o)=>{const b=ye,u=he,$=pe,ne=me,se=ue;return d(),p(U,null,[t(v)==""||t(v)==null||t(v)!=""&&t(M)?(d(),f(t(ve),{key:0,"validation-schema":t(Y),onSubmit:ee,enctype:"multipart/form-data","initial-values":t(e)},{default:P(({values:c,setFieldValue:w})=>[n("div",Ve,[n("div",qe,[t(y).messages!=""?(d(),f(t(J),{key:0,class:"py-3",server_messages:t(y)},null,8,["server_messages"])):k("",!0),n("div",we,[n("div",Ue,[n("div",xe,[n("div",Se,[n("h4",Ce,[V(l(a.$t("Master Ingredient Details"))+":",1),r(b,{message:t(m).master_ingredient_tooltip},null,8,["message"])]),n("h5",Ie,l(a.$t("Basic Details"))+":",1),n("div",$e,[r(u,{type:"text",name:"name",label:t(m).name,required:!0,modelValue:t(e).name,"onUpdate:modelValue":o[0]||(o[0]=s=>t(e).name=s)},null,8,["label","modelValue"])]),n("div",Ae,[t(N).write?(d(),f($,{key:0,name:"categories",label:t(m).select_categories,text:"name",value:"slack",options:t(I),required:"",selected:t(e).categories,addModalShow:!0,addModalId:"#addCategoryModal"},null,8,["label","options","selected"])):(d(),f($,{key:1,name:"categories",label:t(m).select_categories,text:"name",value:"slack",options:t(I),required:"",selected:t(e).categories},null,8,["label","options","selected"]))]),n("div",Ee,[r(u,{type:"text",name:"sale_price",label:t(m).sale_price,required:!0,input_group_text:c.is_stockable&&c.sale_measurement_unit?t(x)+"/ Per "+t(e).sale_measurement_unit.abbreviation:t(x)+"/ Per Unit",modelValue:t(e).sale_price,"onUpdate:modelValue":o[1]||(o[1]=s=>t(e).sale_price=s)},null,8,["label","input_group_text","modelValue"])]),n("div",Pe,[n("div",De,[n("div",Te,[r(t(q),{class:"form-check-input me-2",type:"checkbox",role:"switch",name:"status",id:"status","unchecked-value":!1,value:c.status,onChange:s=>w("status",s.target.checked)},null,8,["value","onChange"]),n("label",Ne,[V(l(a.$t("Active"))+" ",1),Oe])])])]),n("div",Me,[n("div",Fe,[n("div",Qe,[r(t(q),{class:"form-check-input me-2",type:"checkbox",role:"switch",name:"is_stockable",id:"is_stockable","unchecked-value":!1,value:c.is_stockable,onChange:s=>w("is_stockable",s.target.checked)},null,8,["value","onChange"]),n("label",Re,[V(l(a.$t("Is Stockable"))+" ",1),Be])])])]),c.is_stockable?(d(),p("div",je,[n("div",Le,[n("label",Ge,[V(l(a.$t("Stock Unit"))+" ",1),ze,r(b,{message:"Stock unit is your storage unit, i.e sugar can be stored in kilograms "})]),r(t(q),{as:"select",name:"stock_measurement_unit_id",class:"form-control form-control-solid",modelValue:t(e).stock_measurement_unit_id,"onUpdate:modelValue":o[2]||(o[2]=s=>t(e).stock_measurement_unit_id=s),onChange:o[3]||(o[3]=s=>W(s)),disabled:t(e).is_quantity_readonly},{default:P(()=>[n("option",Je,l(a.$t("Units")),1),(d(!0),p(U,null,S(t(C),(s,A)=>(d(),p("optgroup",{key:A,label:s.name+" "+(s.name_ar!=""&&s.name_ar!=null&&s.name_ar!="null"?s.name_ar:"")},[(d(!0),p(U,null,S(s.units,(h,E)=>(d(),p("option",{key:E,value:h.id},l(h.unit_name)+" "+l(h.unit_name_ar!=""&&h.unit_name_ar!=null&&h.unit_name_ar!="null"?h.unit_name_ar:""),9,Ye))),128))],8,Ke))),128))]),_:1},8,["modelValue","disabled"])])])):k("",!0),c.is_stockable?(d(),p("div",He,[n("div",We,[n("label",Xe,[V(l(a.$t("Sales Unit"))+" ",1),Ze,r(b,{message:"Sales unit is your selling unit i.e sugar can be sold in grams  "})]),r(t(q),{as:"select",name:"sale_measurement_unit_id",id:"sale_measurement_unit_id",class:"form-control form-control-solid",modelValue:t(e).sale_measurement_unit_id,"onUpdate:modelValue":o[4]||(o[4]=s=>t(e).sale_measurement_unit_id=s)},{default:P(()=>[n("option",et,l(a.$t("Units")),1),(d(!0),p(U,null,S(t(C),(s,A)=>(d(),p("optgroup",{key:A,label:s.name+" "+(s.name_ar!=""&&s.name_ar!=null&&s.name_ar!="null"?s.name_ar:"")},[(d(!0),p(U,null,S(s.units,(h,E)=>(d(),p("option",{key:E,value:h.id},l(h.unit_name)+" "+l(h.unit_name_ar!=""&&h.unit_name_ar!=null&&h.unit_name_ar!="null"?h.unit_name_ar:""),9,at))),128))],8,tt))),128))]),_:1},8,["modelValue"])])])):k("",!0)]),n("div",nt,[n("h5",st,l(a.$t("Optional Details"))+": ",1),n("div",ot,[r(u,{type:"text",name:"name_ar",label:t(m).name_ar,modelValue:t(e).name_ar,"onUpdate:modelValue":o[5]||(o[5]=s=>t(e).name_ar=s)},null,8,["label","modelValue"])]),n("div",it,[n("div",lt,[n("label",null,l(a.$t("Ingredient Image")),1),n("div",rt,[n("input",{class:"form-control form-control-solid",name:"image",type:"file",id:"formFile",accept:"image/jpg, image/jpeg, image/png",onChange:H},null,32),n("label",_t,l(a.$t("Upload")),1)])])]),n("div",ct,[r(u,{type:"number",name:"purchase_price",label:t(m).purchase_price,input_group_text:c.sale_measurement_unit?t(x)+"/ Per "+c.sale_measurement_unit.abbreviation:t(x)+"/ Per Unit",modelValue:t(e).purchase_price,"onUpdate:modelValue":o[6]||(o[6]=s=>t(e).purchase_price=s)},null,8,["label","input_group_text","modelValue"])]),n("div",dt,[r(u,{type:"number",name:"alert_quantity",label:t(m).alert_quantity,modelValue:t(e).alert_quantity,"onUpdate:modelValue":o[7]||(o[7]=s=>t(e).alert_quantity=s)},null,8,["label","modelValue"])]),n("div",ut,[r(u,{type:"text",name:"upc",label:t(m).upc,modelValue:t(e).upc,"onUpdate:modelValue":o[8]||(o[8]=s=>t(e).upc=s)},null,8,["label","modelValue"])]),n("div",mt,[r(u,{type:"text",name:"short_description",label:t(m).short_description,modelValue:t(e).short_description,"onUpdate:modelValue":o[9]||(o[9]=s=>t(e).short_description=s)},null,8,["label","modelValue"])]),n("div",pt,[r(u,{type:"text",name:"short_description_ar",label:t(m).short_description_ar,modelValue:t(e).short_description_ar,"onUpdate:modelValue":o[10]||(o[10]=s=>t(e).short_description_ar=s)},null,8,["label","modelValue"])]),n("div",ht,[n("div",yt,[n("label",null,l(a.$t("Description")),1),r(t(q),{as:"textarea",class:"form-control form-control-solid text-area",name:"description",label:t(m).description,cols:"50",rows:"4",modelValue:t(e).description,"onUpdate:modelValue":o[11]||(o[11]=s=>t(e).description=s)},null,8,["label","modelValue"])])]),n("div",vt,[n("div",gt,[n("label",null,l(a.$t("Description (Arabic)")),1),r(t(q),{as:"textarea",class:"form-control form-control-solid text-area",name:"description_ar",label:t(m).description_ar,cols:"3",modelValue:t(e).description_ar,"onUpdate:modelValue":o[12]||(o[12]=s=>t(e).description_ar=s)},null,8,["label","modelValue"])])])])])]),n("div",bt,[n("div",ft,[n("div",kt,[n("h5",Vt,[V(l(t(T).user.login_branch.name)+"'s "+l(a.$t("In Hand Inventory Details"))+":",1),r(b,{message:t(m).branch_ingredient_tooltip},null,8,["message"])]),c.is_stockable==!0?(d(),p("div",qt,[r(u,{type:"number",name:"inventory_quantity",label:t(m).quantity,modelValue:c.inventory_quantity,"onUpdate:modelValue":s=>c.inventory_quantity=s,input_group_text:t(e).stock_measurement_unit_name,required:"",readonly:t(e).is_quantity_readonly},null,8,["label","modelValue","onUpdate:modelValue","input_group_text","readonly"])])):k("",!0),n("div",wt,[r(u,{type:"text",name:"inventory_sku",label:t(m).sku,modelValue:c.inventory_sku,"onUpdate:modelValue":s=>c.inventory_sku=s},null,8,["label","modelValue","onUpdate:modelValue"])]),c.is_stockable==!0?(d(),p("div",Ut,[r(u,{type:"number",name:"inventory_alert_quantity",label:t(m).alert_quantity,modelValue:c.inventory_alert_quantity,"onUpdate:modelValue":s=>c.inventory_alert_quantity=s},null,8,["label","modelValue","onUpdate:modelValue"])])):k("",!0),n("div",xt,[r(ne,{type:"radio",name:"inventory_show_in",modelValue:c.inventory_show_in,"onUpdate:modelValue":s=>c.inventory_show_in=s,label:t(m).show_in,options:t(z),onChange:s=>w("inventory_show_in",s.target.value)},null,8,["modelValue","onUpdate:modelValue","label","options","onChange"])]),n("div",St,[n("div",Ct,[n("label",It,l(a.$t("Is Favorite")),1),n("div",$t,[Q(n("input",{class:"form-check-input",name:"inventory_is_favorite",type:"checkbox",role:"switch",id:"inventory_is_favorite","onUpdate:modelValue":s=>c.inventory_is_favorite=s,checked:t(e).inventory_is_favorite,onChange:s=>w("inventory_is_favorite",s.target.checked)},null,40,At),[[F,c.inventory_is_favorite]])])])]),n("div",Et,[n("div",Pt,[n("label",Dt,l(a.$t("Status")),1),n("div",Tt,[Q(n("input",{class:"form-check-input",name:"inventory_status",type:"checkbox",role:"switch",id:"inventory_status","onUpdate:modelValue":s=>c.inventory_status=s,checked:t(e).inventory_status,onChange:s=>w("inventory_status",s.target.checked)},null,40,Nt),[[F,c.inventory_status]])])])])])])])])])]),n("div",Ot,[n("button",{type:"submit",class:"btn btn-primary",disabled:t(e).is_submitting},[t(e).is_submitting?(d(),f(ke,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):k("",!0),t(e).is_submitting?(d(),p("span",Ft,l(a.$t("Saving...")),1)):(d(),p("span",Qt,l(a.$t("Save")),1))],8,Mt)])]),_:1},8,["validation-schema","initial-values"])):(d(),f(se,{key:1})),r(t(G),{onCloseAddCategoryModal:K})],64)}}};export{Zt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/AddCategory.PP9YcNT2.js","assets/ServerMessage.I5ol-gtz.js","assets/index.7OFNPsHl.js","assets/index.1t-AB2n6.css","assets/VSelectInput.LiAW_8HB.js","assets/VTooltip.n3SV8A0p.js","assets/vee-validate.esm.N3uz7Rsk.js","assets/index.esm.cd1bITNA.js","assets/VTextInput.VtSvZjuc.js","assets/ClipLoader.1qNfpKDH.js","assets/ClipLoader.7xz7y6gZ.css","assets/BeatLoader.5j6ku4bW.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
