import{_ as q}from"./PaginateLimit.H-orl6zP.js";import{_ as B}from"./ListingSkeleton.upY030ro.js";import{u as I,b as L,d as V,r as u,e as y,o as A,v as F,f as T,g as n,h as o,i as t,t as s,p as b,l as c,F as H,x as K,n as M,k as v,j as R,O as z}from"./index.GdMxdeuf.js";/* empty css                                                   */const J={class:"page-heading"},G={class:"row align-items-center justify-content-between"},Q={class:"col-auto"},U={class:"mb-0"},W={class:"col-auto"},X=["disabled"],Y={key:1,class:"pt-0"},Z={key:2,class:"pt-0"},ee={key:1,class:"table-responsive"},te={class:"table table-list-data table-hover"},se={class:"bg-light"},ae={scope:"col",width:"10%"},ne={scope:"col",width:"10%"},oe={scope:"col",width:"10%"},ie={scope:"col",width:"10%"},re={scope:"col",width:"10%"},ce={scope:"col",width:"10%"},le=["onClick"],_e={key:0},de={key:1,class:"text-muted"},ue={key:0},pe={key:1},ge={key:0,class:"badge badge-primary"},he={key:1,class:"badge badge-success"},me={key:2,class:"badge badge-warning"},ye={key:3,class:"badge badge-danger"},be={key:4,class:"badge badge-danger"},ve={key:5,class:"badge badge-info"},fe={key:6,class:"badge badge-secondary"},ke={key:7,class:"badge badge-danger"},we=t("s",null,"Cancelled",-1),$e=[we],Oe={key:1},Ce={class:"text-center py-3",colspan:"6"},xe={class:"data-footer"},Ne={class:"row align-items-center justify-content-between"},Se={class:"col-auto"},Ee={class:"col-auto"},Ie={__name:"CustomerOrderList",props:["customer_slack"],setup(f){const{t:k}=I(),w=L(),h=V(()=>w.user.currency.symbol),$={server_messages:{type:"",messages:""},is_listing:!1,search_query:u("")};k("search orders by order no., amount");const r=y({...$}),O=f;A(()=>{d()}),F(()=>r.search_query,_.debounce(()=>{d()},500));function C(e){const i=router.resolve("/order/"+e);window.open(i.href,"_blank")}const x={customer_slack:O.customer_slack,is_exporting:!1},l=y({...x}),p=u([]),g=u([]);async function d(e=1){r.is_listing=!0,await axios.get("/api/orders",{params:{page:e,paginate_limit:m.value,search_query:r.search_query,filters:l}}).then(i=>{p.value=i.data.data.orders,g.value=i.data.pagination,r.is_listing=!1}).catch(i=>{r.server_messages.type="error",r.server_messages.messages=i,r.is_listing=!1,console.log(i)})}const m=u();async function N(e){m.value=e,await d()}async function S(){l.is_exporting=!0,await axios.get("/api/customer/orders_export_excel",{params:{filter:l}}).then(e=>{if(e.data.status_code==200){l.is_exporting=!1;const i=document.createElement("a");i.target="_blank",i.href=e.data.data.file,document.body.appendChild(i),i.click()}else{try{r.server_messages.type="error",r.server_messages.messages=JSON.parse(e.data.msg)}catch{r.server_messages.type="error",r.server_messages.messages=e.data.msg}filter.is_exporting=!1}}).catch(e=>{r.server_messages.type="error",r.server_messages.messages=e,r.is_exporting=!1,console.log(e)})}return(e,i)=>{const E=T("clip-loader"),P=B,D=q;return n(),o("div",null,[t("div",J,[t("div",G,[t("div",Q,[t("h5",U,s(e.$t("Orders")),1)]),t("div",W,[t("button",{type:"button",class:"btn btn-sm btn-success",onClick:i[0]||(i[0]=a=>S()),disabled:l.is_exporting},[l.is_exporting?(n(),b(E,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):c("",!0),l.is_exporting?(n(),o("span",Y,s(e.$t("Exporting...")),1)):(n(),o("span",Z,s(e.$t("Export Excel")),1))],8,X)])])]),r.is_listing?(n(),b(P,{key:0})):(n(),o("div",ee,[t("table",te,[t("thead",se,[t("tr",null,[t("th",ae,s(e.$t("Order No.")),1),t("th",ne,s(e.$t("Order Date")),1),t("th",oe,s(e.$t("Amount")),1),t("th",ie,s(e.$t("Payment Method")),1),t("th",re,s(e.$t("Order Type")),1),t("th",ce,s(e.$t("Status")),1)])]),t("tbody",null,[p.value!=""?(n(!0),o(H,{key:0},K(p.value,(a,j)=>(n(),o("tr",{key:j},[t("td",null,[t("a",{onClick:Pe=>C(a.slack),href:"javascript:;"},"# "+s(a.order_number),9,le)]),t("td",null,s(a.business_date_label),1),t("td",null,[a.returned_status==0?(n(),o("span",_e,s(a.grand_amount_after_returned)+" "+s(h.value),1)):c("",!0),M(),a.grand_amount_after_returned!=a.grand_product_amount?(n(),o("s",de,s(a.grand_product_amount)+" "+s(h.value),1)):c("",!0)]),t("td",null,s(a.payment_method_name),1),t("td",null,[a.order_type==1?(n(),o("span",ue,s(e.$t("Take Away")),1)):c("",!0),a.order_type==2?(n(),o("span",pe,s(e.$t("Dine In")),1)):c("",!0)]),t("td",null,[a.order_status==0?(n(),o("span",ge,s(e.$t("Open")),1)):c("",!0),a.order_status==1?(n(),o("span",he,s(e.$t("Closed")),1)):c("",!0),a.order_status==2?(n(),o("span",me,s(e.$t("In Kitchen")),1)):c("",!0),a.order_status==3?(n(),o("span",ye,s(e.$t("On Hold")),1)):c("",!0),a.order_status==4?(n(),o("span",be,s(e.$t("Hold & In Kitchen")),1)):c("",!0),a.order_status==5&&a.returned_status==0?(n(),o("span",ve,"Partial Returned")):c("",!0),a.order_status==5&&a.returned_status==1?(n(),o("span",fe,"Returned")):c("",!0),a.order_status==6?(n(),o("span",ke,$e)):c("",!0)])]))),128)):(n(),o("tr",Oe,[t("td",Ce,s(e.$t("No Data Found")),1)]))])])])),t("div",xe,[t("div",Ne,[t("div",Se,[v(D,{onPaginate_limit_update:N,pagination:g.value},null,8,["pagination"])]),t("div",Ee,[v(R(z),{data:g.value,limit:5,onPaginationChangePage:d},null,8,["data"])])])])])}}};export{Ie as default};
