import{_ as A}from"./EditFormSmallSkeleton.1yUQOV41.js";import B from"./ServerMessage.qNo4NwTp.js";import{u as E,a as T,r as v,e as U,o as I,g as n,p as g,w as f,f as w,i as s,k as c,n as M,t as m,j as r,h as u,l as S,K as j,Q as z}from"./index.ri7Y_V5F.js";import{_ as J}from"./DefaultLayout.EMHfdzn0.js";import{F as K}from"./vee-validate.esm.0La7AMjT.js";import{c as L,a as C}from"./index.esm.wERziE-M.js";import{_ as D}from"./VTextInput.o2P1IcEE.js";import{C as O}from"./ClipLoader.4-rIzqtH.js";import{_ as Q}from"./VSelect.ijXeZp1F.js";import"./VTooltip.a7qKl6DY.js";/* empty css                                                   *//* empty css                                                                */const R={class:"header-nav-wrap"},G={class:"row align-items-center"},H={class:"col-auto"},P={class:"header-back-link"},W={class:"col-auto"},X={key:0,class:"fw-bold"},Y={key:1,class:"fw-bold"},Z={key:0,class:"content"},ee={class:"row card-strash"},ae={key:0,class:"py-3"},se={class:"col-md-12"},te={class:"row"},oe={class:"col-md-12 mb-4"},ie={class:"card"},le={class:"row"},ne={class:"col-md-3"},de={class:"col-md-3"},ce={class:"col-md-3"},re={class:"col-md-3 pt-md-2"},me={class:"form-field pt-md-2"},_e={class:"form-check form-switch pt-md-4"},ue={class:"form-check-label",for:"status"},pe={class:"text-end"},ve=["disabled"],fe={key:1,class:"pt-0"},he={key:2,class:"pt-0"},Be={__name:"add_customer_display",setup(ye){const{t:l}=E(),t=T().params.slack,h=v({name:l("CDS Name"),activation_code:l("Activation Code"),terminal:l("Select Terminal")}),e=U({...{server_messages:{type:"",messages:""},is_submitting:!1,name:"",activation_code:"",terminal:"",status:!0,cds_slack:""}}),V=L({name:C().required(l("name is required",{name:l("CDS Name")})).min(3,l("name must be at least n characters",{name:l("CDS Name"),number:3})),terminal:C().required(l("name is required",{name:l("Terminal")}))}),$=v([]),k=v([]);I(()=>{t!=""&&t!=null&&q(),x()});const b=v(!1);async function x(){var a=new FormData;a.append("slack",t!=null&&t!=""?t:"");let o=await axios.post("api/customer_display/add",a);(t==""||t==null)&&(e.activation_code=o.data.data.activation_code);let i=o.data.data.terminals;_.forEach(i,p=>{let y={key:p.slack,value:p.terminal_name};k.value.push(y)}),b.value=!0}async function N(){e.is_submitting=!0;var a=new FormData;a.append("name",e.name),a.append("activation_code",e.activation_code),a.append("status",e.status),a.append("terminal",e.terminal),a.append("cds_slack",e.cds_slack);var o=e.cds_slack!=""&&e.cds_slack!=null?"/api/customer_display/update":"/api/customer_display/save";await axios.post(o,a).then(i=>{if(i.data.status_code==200)toast.success(i.data.msg),e.is_submitting=!1,router.push("/customer_displays");else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(i.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=i.data.msg}e.is_submitting=!1}}).catch(i=>{e.server_messages.type="error",e.server_messages.messages=i,e.is_submitting=!1,console.log(i)})}async function q(){await axios.get("/api/customer_display",{params:{slack:t}}).then(a=>{$.value=a.data.data.customer_display,a.data.data.customer_display&&(e.cds_slack=a.data.data.customer_display.slack,e.name=a.data.data.customer_display.name,e.terminal=a.data.data.customer_display.terminal?a.data.data.customer_display.terminal.slack:"",e.status=a.data.data.customer_display.status==1,e.activation_code=a.data.data.customer_display.activation_code)}).catch(a=>{e.server_messages.type="error",e.server_messages.messages=a,console.log(a)})}return(a,o)=>{const i=w("Icon"),p=w("router-link"),y=B,F=A;return n(),g(J,null,{subheader:f(()=>[s("div",R,[s("div",G,[s("div",H,[s("div",P,[c(p,{class:"text-primary",to:"/customer_displays"},{default:f(()=>[c(i,{icon:"fa6-solid:chevron-left"}),M(" "+m(a.$t("CDSs")),1)]),_:1})])]),s("div",W,[r(t)==""||r(t)==null?(n(),u("h5",X,m(a.$t("Add CDS")),1)):(n(),u("h5",Y,m(a.$t("Edit CDS")),1))])])])]),default:f(()=>[r(t)==""||r(t)==null||r(t)!=""&&b.value?(n(),u("div",Z,[c(r(K),{"validation-schema":r(V),onSubmit:N,enctype:"multipart/form-data","initial-values":e},{default:f(()=>[s("div",ee,[e.server_messages.messages!=""?(n(),u("div",ae,[c(y,{server_messages:e.server_messages},null,8,["server_messages"])])):S("",!0),s("div",se,[s("div",te,[s("div",oe,[s("div",ie,[s("div",le,[s("div",ne,[c(D,{type:"text",name:"name",modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.name=d),label:h.value.name,required:!0},null,8,["modelValue","label"])]),s("div",de,[c(D,{type:"text",name:"activation_code",modelValue:e.activation_code,"onUpdate:modelValue":o[1]||(o[1]=d=>e.activation_code=d),label:h.value.activation_code,required:!0,"aria-disabled":!0,readonly:!0},null,8,["modelValue","label"])]),s("div",ce,[c(Q,{modelValue:e.terminal,"onUpdate:modelValue":o[2]||(o[2]=d=>e.terminal=d),name:"terminal",label:h.value.terminal,options:k.value,required:"",placeholder:"Select Terminal"},null,8,["modelValue","label","options"])]),s("div",re,[s("div",me,[s("div",_e,[j(s("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"status",checked:"","onUpdate:modelValue":o[3]||(o[3]=d=>e.status=d)},null,512),[[z,e.status]]),s("label",ue,m(a.$t("Active")),1)])])])])])])])])]),s("div",pe,[s("button",{type:"submit",class:"btn btn-primary",disabled:e.is_submitting},[e.is_submitting?(n(),g(O,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):S("",!0),e.is_submitting?(n(),u("span",fe,m(a.$t("Saving...")),1)):(n(),u("span",he,m(a.$t("Save")),1))],8,ve)])]),_:1},8,["validation-schema","initial-values"])])):(n(),g(F,{key:1}))]),_:1})}}};export{Be as default};
