import{_ as X}from"./DefaultLayout.qd3nRBiq.js";import{_ as Z}from"./PaginateLimit.H-orl6zP.js";import{_ as x}from"./ActionButtonGroup.qGH_Fqs8.js";import{_ as ee}from"./ListingSkeleton.upY030ro.js";import{_ as te}from"./ManageMenu.t-1m2T_G.js";import{u as se,r,e as $,b as oe,o as ae,v as ie,g as i,p as ne,w as C,I as le,f as T,J as ce,k as m,i as e,t as o,K as N,L as de,N as _e,j as v,h as n,n as S,y as re,l as h,F as ue,x as he,O as me}from"./index.GdMxdeuf.js";import"./vue-datepicker.iEAbZR0K.js";import"./ClipLoader.UcGuNCxH.js";/* empty css                                                   */const pe={class:"content"},ge={class:"page-heading"},ve={class:"page-heading position-relative"},fe={class:"row align-items-center justify-content-between mb-3"},ke={class:"col-auto"},ye={class:"mb-0"},we={class:"col col-md-auto"},be={class:"row align-items-center justify-content-between"},$e={class:"col col-md-auto"},Ce={class:"form-field mb-0"},Ne={value:""},Se={value:"1"},Ae={value:"0"},Be={class:"col col-md-auto d-none d-md-block"},Ve={class:"form-field page-heading-search-field mb-0"},De={class:"field-icon"},Ee=["placeholder"],Te={class:"icon"},Ie={key:0,class:"col-auto"},Le={key:0,class:"attention_msg_box"},Oe=["href"],Pe={key:0},qe={key:1,class:"table-responsive"},Re={class:"table table-list-data table-hover"},Fe={class:"bg-light"},Me={scope:"col",width:"10%"},je={scope:"col",width:"20%"},ze={scope:"col",width:"15%"},He={scope:"col",width:"10%"},Je={scope:"col",width:"10%"},Ge={scope:"col",width:"10%"},Ue={scope:"col",width:"10%"},Ke={scope:"col",width:"10%"},We={scope:"col",width:"10%"},Ye={key:0,scope:"col",class:"text-end",width:"5%"},Qe=["onClick"],Xe={alt:"",class:"listing-image img img-thumbnail rounded-circle"},Ze=["onClick"],xe={class:"fw-bold highlighted-list-item"},et=e("br",null,null,-1),tt={class:"text-muted"},st=["onClick"],ot=["onClick"],at=["onClick"],it={key:0},nt={key:1},lt=["onClick"],ct=["onClick"],dt={key:0,class:"badge badge-success fs-11"},_t={key:1,class:"badge badge-warning fs-11"},rt=["onClick"],ut={class:"form-feild"},ht={class:"form-check form-switch form-switch-2"},mt=["onChange","checked"],pt=["onChange","checked"],gt=["onChange","checked"],vt={key:0,class:"text-end"},ft={key:1},kt={class:"text-center py-3",colspan:"11"},yt={class:"data-footer"},wt={class:"row align-items-center justify-content-between"},bt={class:"col-auto"},$t={class:"col-auto"},Lt={__name:"branches",setup(Ct){const{isAuthorized:A}=le(),{t:I}=se(),L={server_messages:{type:"",messages:""},is_listing:!1,search_query:r("")},O=I("Search by name, email, code.."),a=$({...L}),B=oe();ae(()=>{j(),g(),H()}),ie(()=>a.search_query,_.debounce(()=>{g()},500));const k=r([]),y=r([]);async function g(s=1){a.is_listing=!0,await axios.get("/api/branches",{params:{page:s,paginate_limit:V.value,search_query:a.search_query,filter:f}}).then(l=>{k.value=l.data.data,y.value=l.data.pagination,a.is_listing=!1}).catch(l=>{a.server_messages.type="error",a.server_messages.messages=l,a.is_listing=!1,console.log(l)})}const V=r();async function P(s){V.value=s,await g()}async function w(s){var l=new FormData;l.append("slack",s),await axios.post("/api/branch/update_status",l).then(d=>{if(d.data.status_code==200)toast.success(d.data.msg);else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(d.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=d.data.msg}}).catch(d=>{a.server_messages.type="error",a.server_messages.messages=d,console.log(d)})}function u(s){router.push("/branch/"+s)}function q(s){router.push("/branch/edit/"+s)}const R=r(!1),D=$({status:r("")}),f=$({...D}),F=r(!1);async function M(){JSON.stringify(f)!=JSON.stringify(D)&&(F.value=!0),R.value=!1,await g()}const p=r({write:!1,delete:!1});function j(){p.value={write:A("A_WRITE_BRANCH"),delete:A("A_DELETE_BRANCH")}}const z="",b=r(!1);async function H(){await axios.get("/api/branch/check_addon_limit").then(s=>{b.value=s.data.data.disable_branch_add}).catch(s=>{a.server_messages.type="error",a.server_messages.messages=s})}return(s,l)=>{const d=te,E=T("Icon"),J=T("router-link"),G=ee,U=x,K=Z,W=X,Y=ce("lazy");return i(),ne(W,null,{subheader:C(()=>[m(d)]),default:C(()=>[e("div",pe,[e("div",ge,[e("div",ve,[e("div",fe,[e("div",ke,[e("h2",ye,o(s.$t("Branches")),1)]),e("div",we,[e("div",be,[e("div",$e,[e("div",Ce,[N(e("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":l[0]||(l[0]=t=>f.status=t),onChange:M},[e("option",Ne,o(s.$t("Status")),1),e("option",Se,o(s.$t("Active")),1),e("option",Ae,o(s.$t("Inactive")),1)],544),[[de,f.status]])])]),e("div",Be,[e("div",Ve,[e("div",De,[N(e("input",{type:"search",class:"form-control form-control-sm form-control-solid",placeholder:v(O),"onUpdate:modelValue":l[1]||(l[1]=t=>a.search_query=t)},null,8,Ee),[[_e,a.search_query]]),e("div",Te,[m(E,{icon:"fa6-solid:magnifying-glass"})])])])]),p.value.write?(i(),n("div",Ie,[m(J,{class:re(["btn btn-sm btn-light-primary2",{disabled:b.value}]),to:"/branch/add"},{default:C(()=>[S("+ "+o(s.$t("New Branch")),1)]),_:1},8,["class"])])):h("",!0)])])]),b.value?(i(),n("div",Le,[S(o(s.$t("Upgrade your subscription to add more branches,"))+" ",1),e("a",{href:v(z),target:"_blank"},[e("u",null,o(s.$t("click here")),1)],8,Oe),S(" "+o(s.$t("to see the plans.")),1)])):h("",!0)])]),a.is_listing?(i(),n("div",Pe,[m(G)])):(i(),n("div",qe,[e("table",Re,[e("thead",Fe,[e("tr",null,[e("th",Me,o(s.$t("Logo")),1),e("th",je,o(s.$t("Branch Name")),1),e("th",ze,o(s.$t("Email")),1),e("th",He,o(s.$t("Phone")),1),e("th",Je,o(s.$t("VAT")),1),e("th",Ge,o(s.$t("GST Number")),1),e("th",Ue,o(s.$t("Default View")),1),e("th",Ke,o(s.$t("Created At")),1),e("th",We,o(s.$t("Active")),1),p.value.write?(i(),n("th",Ye,o(s.$t("Action")),1)):h("",!0)])]),e("tbody",null,[k.value!=""?(i(!0),n(ue,{key:0},he(k.value,(t,Q)=>(i(),n("tr",{key:Q},[e("td",{onClick:c=>u(t.slack),role:"button"},[N(e("img",Xe,null,512),[[Y,t.logo]])],8,Qe),e("td",{onClick:c=>u(t.slack),role:"button"},[e("div",null,[e("span",xe,o(t.name),1),et,e("small",tt,o(s.$t("Code"))+": "+o(t.code),1)])],8,Ze),e("td",{onClick:c=>u(t.slack),role:"button"},o(t.email),9,st),e("td",{onClick:c=>u(t.slack),role:"button"},o(t.phone),9,ot),e("td",{onClick:c=>u(t.slack),role:"button"},[t.tax_registration_name!=null?(i(),n("span",it,o(s.$t("Vat Name"))+": "+o(t.tax_registration_name),1)):h("",!0),t.tax_registration_number!=null?(i(),n("span",nt,o(s.$t("VAT Number"))+": "+o(t.tax_registration_number),1)):h("",!0)],8,at),e("td",{onClick:c=>u(t.slack),role:"button"},o(t.gst_number),9,lt),e("td",{onClick:c=>u(t.slack),role:"button"},[t.default_view=="POS"||t.default_view=="INVENTORY"||t.default_view=="DASHBOARD"?(i(),n("span",dt,o(t.default_view),1)):h("",!0),t.default_view=="KITCHEN"||t.default_view=="WAITER"?(i(),n("span",_t,o(t.default_view),1)):h("",!0)],8,ct),e("td",{onClick:c=>u(t.slack),role:"button"},o(t.created_at_label),9,rt),e("td",null,[e("div",ut,[e("div",ht,[v(B).user.login_branch!=null&&t.slack==v(B).user.login_branch.slack?(i(),n("input",{key:0,class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:c=>w(t.slack),checked:t.status==1,disabled:""},null,40,mt)):p.value.write?(i(),n("input",{key:2,class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:c=>w(t.slack),checked:t.status==1},null,40,gt)):(i(),n("input",{key:1,class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:c=>w(t.slack),checked:t.status==1,disabled:""},null,40,pt))])])]),p.value.write?(i(),n("td",vt,[m(U,{permissions:p.value,onEdit:q,slack:t.slack},null,8,["permissions","slack"])])):h("",!0)]))),128)):(i(),n("tr",ft,[e("td",kt,o(s.$t("No Data Found")),1)]))])])])),e("div",yt,[e("div",wt,[e("div",bt,[m(K,{onPaginate_limit_update:P,pagination:y.value},null,8,["pagination"])]),e("div",$t,[m(v(me),{data:y.value,limit:5,onPaginationChangePage:g},null,8,["data"])])])])])]),_:1})}}};export{Lt as default};
