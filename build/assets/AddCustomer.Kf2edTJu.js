import{_ as R}from"./EditFormSkeleton.Ez20ofO9.js";import B from"./ServerMessage.EFQMOwoZ.js";import{u as L,a as O,r as g,e as T,o as E,j as p,g as _,p as b,w as J,l as d,h as u,m as y,i as a,t as r,F as z,x as I,L as P,K as v,R as x,k as C,Q as Z}from"./index.sP6fhsqN.js";import{F as G}from"./vee-validate.esm.2kXgdFia.js";import{c as K,a as U}from"./index.esm.DHYHwGJ4.js";import{_ as n}from"./VTextInput.EPCajChY.js";import{C as Q}from"./ClipLoader._89zL49D.js";const W={class:"row card-strash"},H={key:0,class:"py-3"},X={class:"col-md-12"},Y={class:"row"},ee={class:"col-md-12 mb-4"},te={class:"card"},ae={class:"row"},se={class:"col-6 col-md-4 col-lg-3"},oe={class:"col-6 col-md-4 col-lg-3"},le={class:"col-6 col-md-4 col-lg-3"},de={class:"form-field"},ie={class:"form-label"},ne={value:""},re=["value"],me={class:"col-6 col-md-4 col-lg-3"},_e={key:0,class:"col-6 col-md-4 col-lg-3"},ce={class:"form-field"},ue={class:"d-flex align-items-center"},pe={class:"me-3 mt-3"},ge=["checked"],ve={class:"mt-3"},be=["checked"],ye={class:"col-6 col-md-4 col-lg-3"},fe={class:"col-6 col-md-4 col-lg-3"},he={class:"col-6 col-md-4 col-lg-3"},Ve={class:"col-6 col-md-4 col-lg-3"},ke={class:"col-6 col-md-4 col-lg-3"},xe={class:"col-6 col-md-4 col-lg-3"},Ce={class:"col-6 col-md-4 col-lg-3"},Ue={class:"form-field pt-2"},Ne={class:"form-check form-switch pt-4"},Se={class:"form-check-label",for:"status"},$e={class:"col-md-12 mb-4"},qe={class:"card"},we={class:"pb-3"},je={class:"row"},Me={class:"col-6 col-md-4 col-lg-3"},Ae={class:"col-6 col-md-4 col-lg-3"},Fe={class:"col-6 col-md-4 col-lg-3"},De={class:"col-6 col-md-4 col-lg-3"},Re={class:"col-6 col-md-4 col-lg-3"},Be={class:"text-end"},Le=["disabled"],Oe={key:1,class:"pt-0"},Te={key:2,class:"pt-0"},Qe={__name:"AddCustomer",props:{redirection:{type:String,required:!1,default:""}},emits:["closeAddCustomerModal"],setup(N,{emit:S}){const{t:l}=L(),f=O(),c=f.params.slack,i=g({name:l("Customer Name"),email:l("Customer Email"),phone:l("Customer Phone"),tax_registration_number:l("Tax Registration Number"),tax_registration_name:l("Tax Registration Name"),gst_number:l("GST Number"),date_of_birth:l("Date Of Birth"),date_of_anniversary:l("Date Of Anniversary"),joining_date:l("Date Of Joining"),first_address_line:l("Address Line 1"),second_address_line:l("Address Line 2"),city:l("City"),pincode:l("Pincode/Zipcode"),state:l("State")}),e=T({...{server_messages:{type:"",messages:""},is_submitting:!1,name:"",email:"",phone:"",customer_type:"",tax_registration_number:"",tax_registration_name:"",gst_number:"",date_of_birth:"",date_of_anniversary:"",joining_date:"",status:!0,first_address_line:"",second_address_line:"",city:"",pincode:"",state:"",country:"",customer_slack:"",redirection:"",invoice_path:!1,quotation_path:!1}}),$=N;e.redirection=$.redirection;const q=K({name:U().required(l("name is required",{name:l("Customer Name")})).min(3,l("name must be at least n characters",{name:l("Customer Name"),number:3})).matches(/^[a-zA-Z\u0600-\u06FF\s]+$/,l("Name must be in alphabets")),phone:U().matches(/^[0-9]{9,10}$/,l("Mobile number must be 9 or 10 digits")).typeError(l("must be a number",{name:l("Mobile Number")})).required(l("name is required",{name:l("Mobile Number")}))}),h=g([]),w=g([]);E(()=>{j(),c!=""&&c!=null&&M();let t=f.path;e.invoice_path=t.includes("invoice"),e.quotation_path=t.includes("quotation"),(e.invoice_path==!0||e.quotation_path==!0)&&(e.customer_type=1)});async function j(){await axios.get("/api/v2/countries/all").then(t=>{if(t.data.status_code==200)h.value=t.data.data;else try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(t.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=t.data.msg}}).catch(t=>{e.server_messages.type="error",e.server_messages.messages=t,console.log(t)})}const V=g(!1);async function M(){await axios.get("/api/customer",{params:{slack:c}}).then(t=>{w.value=t.data.data,t.data.data&&(e.customer_slack=t.data.data.slack,e.name=t.data.data.name,e.email=t.data.data.email,e.city=t.data.data.city,e.state=t.data.data.state,e.gst_number=t.data.data.gst_number,e.tax_registration_number=t.data.data.tax_registration_number,e.tax_registration_name=t.data.data.tax_registration_name,e.phone=t.data.data.phone,e.first_address_line=t.data.data.first_address_line,e.second_address_line=t.data.data.second_address_line,e.pincode=t.data.data.postal_code,e.country=t.data.data.country?t.data.data.country.slack:"",e.date_of_anniversary=t.data.data.date_of_anniversary,e.date_of_birth=t.data.data.date_of_birth,e.joining_date=t.data.data.joining_date,e.customer_type=t.data.data.type,e.status=t.data.data.status==1,V.value=!0)}).catch(t=>{e.server_messages.type="error",e.server_messages.messages=t,console.log(t)})}async function A(){e.is_submitting=!0;var t=new FormData;t.append("name",e.name),t.append("email",e.email!=""?e.email:""),t.append("phone",e.phone),t.append("customer_type",e.invoice_path==!0||e.quotation_path==!0?1:e.customer_type),t.append("tax_registration_number",e.tax_registration_number),t.append("tax_registration_name",e.tax_registration_name),t.append("gst_number",e.gst_number),t.append("date_of_birth",e.date_of_birth),t.append("date_of_anniversary",e.date_of_anniversary),t.append("joining_date",e.joining_date),t.append("status",e.status),t.append("first_address_line",e.first_address_line),t.append("second_address_line",e.second_address_line),t.append("city",e.city),t.append("pincode",e.pincode),t.append("state",e.state),t.append("country",e.country),t.append("customer_slack",e.customer_slack);var s=e.customer_slack!=""&&e.customer_slack!=null?"/api/customer/update":"/api/customer/save";await axios.post(s,t).then(m=>{if(m.data.status_code==200)e.redirection!=""&&router.push(e.redirection),toast.success(m.data.msg),e.is_submitting=!1,(e.invoice_path==!0||e.quotation_path==!0)&&(e.customer_type=1),F("closeAddCustomerModal");else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(m.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=m.data.msg}e.is_submitting=!1}}).catch(m=>{e.server_messages.type="error",e.server_messages.messages=m,e.is_submitting=!1,console.log(m)})}const F=S;return(t,s)=>{const m=B,k=R;return p(c)==""||p(c)==null||p(c)!=""&&V.value?(_(),b(p(G),{key:0,"validation-schema":p(q),"initial-values":e,onSubmit:A,enctype:"multipart/form-data",id:"add_customer_form"},{default:J(()=>[a("div",W,[e.server_messages.messages!=""?(_(),u("div",H,[d(m,{server_messages:e.server_messages},null,8,["server_messages"])])):y("",!0),a("div",X,[a("div",Y,[a("div",ee,[a("div",te,[a("div",ae,[a("div",se,[d(n,{type:"text",name:"name",modelValue:e.name,"onUpdate:modelValue":s[0]||(s[0]=o=>e.name=o),label:i.value.name,required:!0},null,8,["modelValue","label"])]),a("div",oe,[d(n,{type:"text",name:"phone",modelValue:e.phone,"onUpdate:modelValue":s[1]||(s[1]=o=>e.phone=o),label:i.value.phone,required:""},null,8,["modelValue","label"])]),a("div",le,[a("div",de,[a("label",ie,r(t.$t("Country")),1),v(a("select",{class:"form-control form-control-solid","onUpdate:modelValue":s[2]||(s[2]=o=>e.country=o)},[a("option",ne,r(t.$t("Select Country")),1),(_(!0),u(z,null,I(h.value,(o,D)=>(_(),u("option",{value:o.slack,key:D},r(o.name),9,re))),128))],512),[[P,e.country]])])]),a("div",me,[d(n,{type:"email",name:"email",modelValue:e.email,"onUpdate:modelValue":s[3]||(s[3]=o=>e.email=o),label:i.value.email},null,8,["modelValue","label"])]),e.invoice_path==!1&&e.quotation_path==!1?(_(),u("div",_e,[a("div",ce,[a("label",null,r(t.$t("Customer Type")),1),a("div",ue,[a("label",pe,[v(a("input",{class:"form-check-input me-1",type:"radio",name:"customer_type","onUpdate:modelValue":s[4]||(s[4]=o=>e.customer_type=o),value:2,checked:e.customer_type==2||e.customer_type==""||e.customer_type==null},null,8,ge),[[x,e.customer_type]]),C(r(t.$t("Walk-In")),1)]),a("label",ve,[v(a("input",{class:"form-check-input me-1",type:"radio",name:"customer_type","onUpdate:modelValue":s[5]||(s[5]=o=>e.customer_type=o),value:1,checked:e.customer_type==1},null,8,be),[[x,e.customer_type]]),C(r(t.$t("Regular")),1)])])])])):y("",!0),a("div",ye,[d(n,{type:"text",name:"tax_registration_name",modelValue:e.tax_registration_name,"onUpdate:modelValue":s[6]||(s[6]=o=>e.tax_registration_name=o),label:i.value.tax_registration_name},null,8,["modelValue","label"])]),a("div",fe,[d(n,{type:"text",name:"tax_registration_number",modelValue:e.tax_registration_number,"onUpdate:modelValue":s[7]||(s[7]=o=>e.tax_registration_number=o),label:i.value.tax_registration_number},null,8,["modelValue","label"])]),a("div",he,[d(n,{type:"text",name:"gst_number",modelValue:e.gst_number,"onUpdate:modelValue":s[8]||(s[8]=o=>e.gst_number=o),label:i.value.gst_number},null,8,["modelValue","label"])]),a("div",Ve,[d(n,{type:"date",name:"date_of_birth",modelValue:e.date_of_birth,"onUpdate:modelValue":s[9]||(s[9]=o=>e.date_of_birth=o),label:i.value.date_of_birth},null,8,["modelValue","label"])]),a("div",ke,[d(n,{type:"date",name:"date_of_anniversary",modelValue:e.date_of_anniversary,"onUpdate:modelValue":s[10]||(s[10]=o=>e.date_of_anniversary=o),label:i.value.date_of_anniversary},null,8,["modelValue","label"])]),a("div",xe,[d(n,{type:"date",name:"joining_date",modelValue:e.joining_date,"onUpdate:modelValue":s[11]||(s[11]=o=>e.joining_date=o),label:i.value.joining_date},null,8,["modelValue","label"])]),a("div",Ce,[a("div",Ue,[a("div",Ne,[v(a("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"status",checked:"","onUpdate:modelValue":s[12]||(s[12]=o=>e.status=o)},null,512),[[Z,e.status]]),a("label",Se,r(t.$t("Active")),1)])])])])])]),a("div",$e,[a("div",qe,[a("h5",we,r(t.$t("Address")),1),a("div",je,[a("div",Me,[d(n,{type:"text",name:"first_address_line",modelValue:e.first_address_line,"onUpdate:modelValue":s[13]||(s[13]=o=>e.first_address_line=o),label:i.value.first_address_line},null,8,["modelValue","label"])]),a("div",Ae,[d(n,{type:"text",name:"second_address_line",modelValue:e.second_address_line,"onUpdate:modelValue":s[14]||(s[14]=o=>e.second_address_line=o),label:i.value.second_address_line},null,8,["modelValue","label"])]),a("div",Fe,[d(n,{type:"text",name:"city",modelValue:e.city,"onUpdate:modelValue":s[15]||(s[15]=o=>e.city=o),label:i.value.city},null,8,["modelValue","label"])]),a("div",De,[d(n,{type:"text",name:"pincode",modelValue:e.pincode,"onUpdate:modelValue":s[16]||(s[16]=o=>e.pincode=o),label:i.value.pincode},null,8,["modelValue","label"])]),a("div",Re,[d(n,{type:"text",name:"state",modelValue:e.state,"onUpdate:modelValue":s[17]||(s[17]=o=>e.state=o),label:i.value.state},null,8,["modelValue","label"])])])])])])])]),a("div",Be,[a("button",{type:"submit",class:"btn btn-primary",disabled:e.is_submitting},[e.is_submitting?(_(),b(Q,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):y("",!0),e.is_submitting?(_(),u("span",Oe,r(t.$t("Saving...")),1)):(_(),u("span",Te,r(t.$t("Save")),1))],8,Le)])]),_:1},8,["validation-schema","initial-values"])):(_(),b(k,{key:1}))}}};export{Qe as _};
