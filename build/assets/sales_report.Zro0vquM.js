import{u as me,b as ue,d as O,e as E,r as u,v as pe,o as he,g as d,p as N,w as V,f as I,i as e,k as h,n as P,t as o,j as t,l as c,A as x,B as M,h as r,F as ge,x as ye,O as be,I as fe,bV as y,q as ve,_ as ke}from"./index.7OFNPsHl.js";import{_ as $e}from"./DefaultLayout.nvkZ4UhM.js";import{_ as De}from"./PaginateLimit.Xv-qfeqj.js";import{_ as Ye}from"./ListingSkeleton.iExoV4hO.js";import{_ as we}from"./VMultiSelect.XXz7TsgF.js";import{u as Ve}from"./global.wK1y07-b.js";import{s as R,a as xe,e as Me,j as K}from"./vue-datepicker.sD5zgpde.js";import{s as U,e as L}from"./index.PeC7PMAQ.js";import"./ClipLoader.1qNfpKDH.js";/* empty css                                                   */import"./vee-validate.esm.N3uz7Rsk.js";const Se={class:"header-nav-wrap"},Te={class:"row align-items-center"},Ae={class:"col-auto"},Ce={class:"header-back-link"},Oe={class:"col-auto"},Ne={class:"fw-bold"},Pe={class:"content"},He={class:"card"},Fe={class:"row field-m-0 align-items-end g-3"},Be={class:"col-md-4 col-lg-3"},Ee={class:"form-field"},Ie={for:"",class:"form-label"},Re=e("span",{class:"text-danger"},"*",-1),Ke=["onClick","onKeyup"],Ue={class:"col-md-4 col-lg-3"},Le={class:"form-field"},je={for:"",class:"form-label"},Je=e("span",{class:"text-danger"},"*",-1),Ge=["onClick","onKeyup"],qe={class:"col-md-4 col-lg-3"},ze={key:0,class:"col-md-4 col-lg-3"},Qe={class:"col-md-3 col-lg-3"},We={class:"col-md-3 col-lg-3"},Xe={class:"col-md-3 col-lg-3"},Ze={class:"row mt-4"},et={class:"col-12 text-end"},tt=["disabled"],st=["disabled"],at={class:"card"},ot={class:""},nt={key:0},lt={key:1,class:"table-responsive"},dt={class:"table table-list-data table-hover"},rt={class:"bg-light"},ct={scope:"col"},it={scope:"col"},_t={scope:"col"},mt={scope:"col"},ut={scope:"col"},pt={scope:"col"},ht={scope:"col"},gt={scope:"col"},yt={scope:"col"},bt={scope:"col"},ft={scope:"col",class:"text-end"},vt={scope:"col",class:"text-end"},kt={scope:"col",class:"text-end"},$t={key:0},Dt={class:"text-end"},Yt={class:"text-end"},wt={class:"text-end"},Vt={class:"text-end"},xt={class:"text-end"},Mt={class:"text-end"},St={key:0},Tt={key:1},At={key:0,class:"badge badge-primary"},Ct={key:1,class:"badge badge-success"},Ot={key:2,class:"badge badge-warning"},Nt={key:3,class:"badge badge-danger"},Pt={key:4,class:"badge badge-danger"},Ht={key:5,class:"badge badge-info"},Ft={key:6,class:"badge badge-secondary"},Bt={class:"text-end"},Et={class:"text-end"},It={class:"text-end"},Rt={key:1},Kt={class:"text-center py-3",colspan:"13"},Ut={key:0},Lt=e("th",{colspan:"10"},null,-1),jt={class:"text-end"},Jt={class:"text-end"},Gt={class:"text-end"},qt={class:"data-footer"},zt={class:"row align-items-center justify-content-between"},Qt={class:"col-auto"},Wt={class:"col-auto"},_s={__name:"sales_report",setup(Xt){const{t:p}=me(),{isAuthorized:Zt,getRoundedValue:$}=fe(),{order_types:j,sale_types:J}=Ve(),H=ue(),D=O(()=>H.user.currency.symbol),i=E({server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,dates:u([new Date,new Date]),created_dates:u([new Date,new Date]),selected_branch:u(),selected_terminals:u([]),payment_method:u(),selected_order_type:u(),selected_sale_type:u(),is_exporting:!1}),s=E({...i}),G=p("Select Branch"),q=p("All Branches");p("All Products");const z=p("All Terminals"),Q=p("Select Terminals"),W=p("Select Order Type"),X=p("All Order Type"),Z=p("Select Sale Type"),ee=p("All Sale Type"),te=p("Select Payment Type"),se=p("All Payment Type"),F=u([{label:"Today",value:[new Date,new Date]},{label:"This month",value:[U(new Date),L(new Date)]},{label:"Last month",value:[U(R(new Date,1)),L(R(new Date,1))]},{label:"This year",value:[xe(new Date),Me(new Date)]}]);pe(()=>s.selected_branch,a=>{a>0?oe(a):s.selected_terminals=[]}),he(()=>{ne()});const ae=O(()=>H.user.branches),S=u([]);async function oe(a){a!=null&&a!=""&&await axios.post("/api/branch/terminals",{id:a}).then(n=>{if(n.data.status_code==200){S.value=[];let m=n.data.data;_.forEach(m,f=>{let v={id:f.id,name:f.code+" - "+f.terminal_name};S.value.push(v)})}else try{i.server_messages.type="error",i.server_messages.messages=JSON.parse(n.data.msg)}catch{i.server_messages.type="error",i.server_messages.messages=n.data.msg}}).catch(n=>{i.server_messages.type="error",i.server_messages.messages=n,console.log(n)})}const T=u([]);async function ne(){await axios.get("/api/payment_methods/all").then(a=>{if(a.data.status_code==200){T.value=[];let n=a.data.data;_.forEach(n,m=>{let f={id:m.id,name:m.name};T.value.push(f)})}else try{i.server_messages.type="error",i.server_messages.messages=JSON.parse(a.data.msg)}catch{i.server_messages.type="error",i.server_messages.messages=a.data.msg}}).catch(a=>{i.server_messages.type="error",i.server_messages.messages=a,console.log(a)})}const B=u();async function le(a){B.value=a,await C()}const b=u([]),A=u([]);async function C(a=1){s.is_listing=!0,s.dates!=null&&(s.dates[0]=y(s.dates[0]).format("YYYY-MM-DD"),s.dates[1]=y(s.dates[1]).format("YYYY-MM-DD")),s.created_dates!=null&&(s.created_dates[0]=y(s.created_dates[0]).format("YYYY-MM-DD HH:mm"),s.created_dates[1]=y(s.created_dates[1]).format("YYYY-MM-DD HH:mm")),await axios.get("/api/sales_report",{params:{page:a,paginate_limit:B.value,filter:s}}).then(n=>{b.value=n.data.data.data,A.value=n.data.pagination,s.is_listing=!1}).catch(n=>{s.server_messages.type="error",s.server_messages.messages=n,s.is_listing=!1,console.log(n)})}const Y=O(()=>b.value.length?{order_discount:b.value.reduce(function(n,m){return n+parseFloat(m.order_discount)},0).toFixed(2),grand_product_tax:b.value.reduce(function(n,m){return n+parseFloat(m.tax)},0).toFixed(2),grand_product_amount:b.value.reduce(function(n,m){return n+parseFloat(m.total)},0).toFixed(2)}:null);async function de(){s.is_exporting=!0,s.dates!=null&&(s.dates[0]=y(s.dates[0]).format("YYYY-MM-DD"),s.dates[1]=y(s.dates[1]).format("YYYY-MM-DD")),s.created_dates!=null&&(s.created_dates[0]=y(s.created_dates[0]).format("YYYY-MM-DD HH:mm"),s.created_dates[1]=y(s.created_dates[1]).format("YYYY-MM-DD HH:mm")),await axios.get("/api/sales_report/export_excel",{params:{filter:s}}).then(a=>{if(a.data.status_code==200){s.is_exporting=!1;const n=document.createElement("a");n.target="_blank",n.href=a.data.data.file,document.body.appendChild(n),n.click()}else{try{s.server_messages.type="error",s.server_messages.messages=JSON.parse(a.data.msg)}catch{s.server_messages.type="error",s.server_messages.messages=a.data.msg}s.is_exporting=!1}}).catch(a=>{s.server_messages.type="error",s.server_messages.messages=a,s.is_exporting=!1,console.log(a)})}const re=ve(()=>ke(()=>import("./ServerMessage.I5ol-gtz.js"),__vite__mapDeps([0,1,2])));return(a,n)=>{const m=I("Icon"),f=I("router-link"),v=we,ce=Ye,ie=De,_e=$e;return d(),N(_e,null,{subheader:V(()=>[e("div",Se,[e("div",Te,[e("div",Ae,[e("div",Ce,[h(f,{class:"text-primary",to:"/reports"},{default:V(()=>[h(m,{icon:"fa6-solid:chevron-left"}),P(" "+o(a.$t("Reports")),1)]),_:1})])]),e("div",Oe,[e("h5",Ne,o(a.$t("Sales Report")),1)])])])]),default:V(()=>[e("div",Pe,[t(s).server_messages.messages!=""?(d(),N(t(re),{key:0,class:"py-3",server_messages:t(s).server_messages},null,8,["server_messages"])):c("",!0),e("div",He,[e("div",Fe,[e("div",Be,[e("div",Ee,[e("label",Ie,[P(o(a.$t("Business Dates"))+" ",1),Re]),h(t(K),{range:"","preset-dates":t(F),modelValue:t(s).dates,"onUpdate:modelValue":n[0]||(n[0]=l=>t(s).dates=l),format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":V(({label:l,value:g,presetDate:k})=>[e("span",{role:"button",tabindex:0,onClick:w=>k(g),onKeyup:[x(M(w=>k(g),["prevent"]),["enter"]),x(M(w=>k(g),["prevent"]),["space"])]},o(l),41,Ke)]),_:1},8,["preset-dates","modelValue"])])]),e("div",Ue,[e("div",Le,[e("label",je,[P(o(a.$t("Created At Dates"))+" ",1),Je]),h(t(K),{range:"","preset-dates":t(F),modelValue:t(s).created_dates,"onUpdate:modelValue":n[1]||(n[1]=l=>t(s).created_dates=l),format:"dd-MM-yyyy HH:mm","enable-time-picker":!0,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":V(({label:l,value:g,presetDate:k})=>[e("span",{role:"button",tabindex:0,onClick:w=>k(g),onKeyup:[x(M(w=>k(g),["prevent"]),["enter"]),x(M(w=>k(g),["prevent"]),["space"])]},o(l),41,Ge)]),_:1},8,["preset-dates","modelValue"])])]),e("div",qe,[h(v,{name:"branches",label:t(G),placeholder:t(q),text:"name",value:"id",options:t(ae),modelValue:t(s).selected_branch,"onUpdate:modelValue":n[2]||(n[2]=l=>t(s).selected_branch=l),mode:"single"},null,8,["label","placeholder","options","modelValue"])]),t(s).selected_branch!=null&&t(s).selected_branch>0?(d(),r("div",ze,[t(s).selected_branch!=null&&t(s).selected_branch>0?(d(),N(v,{key:0,name:"terminals",label:t(z),placeholder:t(Q),text:"name",value:"id",options:t(S),modelValue:t(s).selected_terminals,"onUpdate:modelValue":n[3]||(n[3]=l=>t(s).selected_terminals=l)},null,8,["label","placeholder","options","modelValue"])):c("",!0)])):c("",!0),e("div",Qe,[h(v,{name:"payment_methods",label:t(te),placeholder:t(se),text:"name",value:"id",options:t(T),modelValue:t(s).payment_method,"onUpdate:modelValue":n[4]||(n[4]=l=>t(s).payment_method=l),mode:"single"},null,8,["label","placeholder","options","modelValue"])]),e("div",We,[h(v,{name:"order_types",label:t(W),placeholder:t(X),text:"value",value:"key",options:t(j),modelValue:t(s).selected_order_type,"onUpdate:modelValue":n[5]||(n[5]=l=>t(s).selected_order_type=l),mode:"single"},null,8,["label","placeholder","options","modelValue"])]),e("div",Xe,[h(v,{name:"sale_types",label:t(Z),placeholder:t(ee),text:"value",value:"key",options:t(J),modelValue:t(s).selected_sale_type,"onUpdate:modelValue":n[6]||(n[6]=l=>t(s).selected_sale_type=l),mode:"single"},null,8,["label","placeholder","options","modelValue"])])]),e("div",Ze,[e("div",et,[e("button",{class:"btn btn-primary",onClick:C,disabled:t(s).dates==null&&t(s).created_dates==null},o(a.$t("View")),9,tt),e("button",{class:"btn btn-success ms-3",onClick:n[7]||(n[7]=l=>de()),disabled:t(s).dates==null&&t(s).created_dates==null},o(a.$t("Export Excel")),9,st)])])]),e("div",at,[e("div",ot,[t(s).is_listing?(d(),r("div",nt,[h(ce)])):(d(),r("div",lt,[e("table",dt,[e("thead",rt,[e("tr",null,[e("th",ct,o(a.$t("Branch Name")),1),e("th",it,o(a.$t("Terminal")),1),e("th",_t,o(a.$t("Order No.")),1),e("th",mt,o(a.$t("Reference No.")),1),e("th",ut,o(a.$t("Sale Date")),1),e("th",pt,o(a.$t("Customer Name")),1),e("th",ht,o(a.$t("Customer Phone")),1),e("th",gt,o(a.$t("Payment Type")),1),e("th",yt,o(a.$t("Order Type")),1),e("th",bt,o(a.$t("Sale Type")),1),e("th",ft,o(a.$t("Discount Amount")),1),e("th",vt,o(a.$t("Tax Amount")),1),e("th",kt,o(a.$t("Net Sales Amount")),1)])]),e("tbody",null,[t(b)!=""?(d(!0),r(ge,{key:0},ye(t(b),(l,g)=>(d(),r("tr",{key:g},[e("td",null,o(l.branch.name),1),e("td",null,[l.terminal?(d(),r("span",$t,o(l.terminal.terminal_name),1)):c("",!0)]),e("td",Dt,o(l.order_number),1),e("td",Yt,o(l.reference_number),1),e("td",wt,o(l.business_date),1),e("td",Vt,o(l.customer_name),1),e("td",xt,o(l.customer_phone),1),e("td",Mt,o(l.payment_method_name),1),e("td",null,[l.order_type==1?(d(),r("span",St,o(a.$t("Take Away")),1)):c("",!0),l.order_type==2?(d(),r("span",Tt,o(a.$t("Dine In")),1)):c("",!0)]),e("td",null,[l.order_status==0?(d(),r("span",At,o(a.$t("Open")),1)):c("",!0),l.order_status==1?(d(),r("span",Ct,o(a.$t("Closed")),1)):c("",!0),l.order_status==2?(d(),r("span",Ot,o(a.$t("In Kitchen")),1)):c("",!0),l.order_status==3?(d(),r("span",Nt,o(a.$t("On Hold")),1)):c("",!0),l.order_status==4?(d(),r("span",Pt,o(a.$t("Hold & In Kitchen")),1)):c("",!0),l.order_status==5&&l.returned_status==0?(d(),r("span",Ht,"Partial Returned")):c("",!0),l.order_status==5&&l.returned_status==1?(d(),r("span",Ft,"Returned")):c("",!0)]),e("td",Bt,o(t($)(l.order_discount))+" "+o(t(D)),1),e("td",Et,o(t($)(l.tax))+" "+o(t(D)),1),e("td",It,o(t($)(l.total))+" "+o(t(D)),1)]))),128)):(d(),r("tr",Rt,[e("td",Kt,o(a.$t("No Data Found")),1)]))]),t(Y)!=""&&t(Y)!=null?(d(),r("tfoot",Ut,[e("tr",null,[Lt,e("th",jt,o(t($)(t(Y).order_discount))+" "+o(t(D)),1),e("th",Jt,o(t($)(t(Y).grand_product_tax)),1),e("th",Gt,o(t($)(t(Y).grand_product_amount))+" "+o(t(D)),1)])])):c("",!0)])])),e("div",qt,[e("div",zt,[e("div",Qt,[h(ie,{onPaginate_limit_update:le,pagination:t(A)},null,8,["pagination"])]),e("div",Wt,[h(t(be),{data:t(A),limit:5,onPaginationChangePage:C},null,8,["data"])])])])])])])]),_:1})}}};export{_s as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.I5ol-gtz.js","assets/index.7OFNPsHl.js","assets/index.1t-AB2n6.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
