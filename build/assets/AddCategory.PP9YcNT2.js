import O from"./ServerMessage.I5ol-gtz.js";import{_ as T}from"./VSelectInput.LiAW_8HB.js";import{u as q,r as v,e as E,b as z,P as J,o as P,v as K,d as Q,g as n,h as m,i as t,t as c,k as g,w as R,j as p,Q as h,K as y,N as G,l as w,p as H}from"./index.7OFNPsHl.js";import{F as W}from"./vee-validate.esm.N3uz7Rsk.js";import{c as X,a as Y,e as x}from"./index.esm.cd1bITNA.js";import{_ as V}from"./VTextInput.VtSvZjuc.js";/* empty css                                                   */import{C as Z}from"./ClipLoader.1qNfpKDH.js";import"./VTooltip.n3SV8A0p.js";/* empty css                                                   */const ee={class:"modal hide",id:"addCategoryModal",tabindex:"-1","aria-labelledby":"Add Category","aria-modal":"true",role:"dialog","data-bs-backdrop":"static","data-bs-keyboard":"false"},ae={class:"modal-dialog modal-lg modal-dialog-centered"},te={class:"modal-content"},se={class:"modal-header"},oe={key:0,class:"modal-title"},re={key:1,class:"modal-title"},ie={class:"modal-body"},le={class:""},ce={class:"row"},ne={class:"col-md-6"},de={class:"col-md-6"},me={class:"col-md-6"},_e={class:"col-md-6"},ue={class:"form-field"},ge={class:"input-group input-file-group"},pe={class:"btn btn-light-primary min-width-0 mb-0",for:"category_image"},fe={class:"col-4"},ye={class:"form-field"},ve={class:"form-check form-switch"},he={class:"form-check-label",for:"status"},be={class:"col-4"},ke={class:"form-field"},Ce={class:"form-check form-switch"},we={class:"form-check-label",for:"is_favorite"},xe={class:"col-4"},Ve={class:"form-field"},$e={class:"form-check form-switch"},Ne={class:"form-check-label",for:"status"},Se={key:0,class:"py-3"},Ue={class:"mt-2 text-end"},Ae=["disabled"],Me={key:1,class:"pt-0"},Be={key:2,class:"pt-0"},Je={__name:"AddCategory",props:{edit_data:{type:[Array,Object]}},emits:["closeAddCategoryModal"],setup(N,{emit:S}){const{t:i}=q(),f=v(!1),b={server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,category_slack:"",search_category:"",category_name:"",parent_category:"",category_name_ar:"",is_favorite:!1,status:!0,image:"",is_tobacco_tax:!1},e=E({...b});z();const U=X({category_name:Y().required(i("name is required",{name:i("Category Name")})).min(3,i("name must be at least n characters",{name:i("Category Name"),number:3})).max(20,i("Must be less than 20 characters",{name:i("Category Name"),number:20})),is_favorite:x().label("is favorite"),status:x().label("status")}),A=S,u=N,d=J(u,"edit_data"),M=i("Select Parent"),B=i("Category Name"),j=i("Category Name (Arabic)");function k(){document.getElementById("add_category_form").reset(),L(),A("closeAddCategoryModal"),document.getElementById("close_btn").click()}P(()=>{D()}),K(()=>u.edit_data,a=>{a&&(e.category_name=a.name,e.category_name_ar=a.name_ar!=null?a.name_ar:"",e.status=a.status==1,e.is_favorite=a.is_favorite==1,e.is_tobacco_tax=a.is_tobacco_tax==1,e.parent_category=a.parent_id!=null?a.parent_id:"",e.category_slack=a.slack,e.is_tobacco_tax=a.is_tobacco_tax==1)});const r=v([]);async function D(){await axios.post("/api/category/add").then(a=>{if(f.value=!1,a.data.status_code==200)r.value=a.data.data.categories,r.value=[{id:"",name:"None",name_ar:i("None")}].concat(r.value),u.edit_data&&u.edit_data.parent_id==null&&(r.value=r.value.filter(s=>u.edit_data.id!=s.id)),f.value=!0;else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(a.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=a.data.msg}f.value=!1}}).catch(a=>{e.server_messages.type="error",e.server_messages.messages=a,f.value=!1,console.log(a)})}Q(()=>e.search_category!=""?d.value?_.filter(r.value,function(a){return a.name.toLowerCase().includes(e.search_category.toLowerCase())&&a.id!=d.value.id}):_.filter(r.value,function(a){return a.name.toLowerCase().includes(e.search_category.toLowerCase())}):d.value?($("input[name='category']").value==d.value.id&&$("input[name='category']").attr("checked",!0),r.value.filter(a=>a.id!=d.value.id),_.filter(r.value,function(a){return a.id!=d.value.id})):r.value);async function F(a){e.image=a.target.files[0]}v(null);async function I(){e.is_submitting=!0;var a=new FormData;a.append("parent_category",e.parent_category),a.append("category_name",e.category_name),a.append("category_name_ar",e.category_name_ar),a.append("is_favorite",e.is_favorite),a.append("status",e.status),a.append("is_tobacco_tax",e.is_tobacco_tax),a.append("image",e.image),a.append("category_slack",e.category_slack);var s=e.category_slack!=""?"/api/category/update":"/api/category/save";await axios.post(s,a,{headers:{"Content-Type":"multipart/form-data"}}).then(l=>{if(l.data.status_code==200)toast.success(l.data.msg),e.is_submitting=!1,k();else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(l.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=l.data.msg}e.is_submitting=!1}}).catch(l=>{e.server_messages.type="error",e.server_messages.messages=l,e.is_submitting=!1,console.log(l)})}function L(){Object.assign(e,b)}return(a,s)=>{const l=T,C=O;return n(),m("div",ee,[t("div",ae,[t("div",te,[t("div",se,[e.category_slack==""?(n(),m("h5",oe,c(a.$t("Add Category")),1)):(n(),m("h5",re,c(a.$t("Update Category")),1)),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:k,id:"close_btn"})]),t("div",ie,[g(p(W),{"validation-schema":p(U),onSubmit:I,enctype:"multipart/form-data","initial-values":e,id:"add_category_form"},{default:R(()=>[t("div",le,[t("div",ce,[t("div",ne,[g(l,{name:"parent_category",label:p(M),options:r.value,modelValue:e.parent_category,"onUpdate:modelValue":s[0]||(s[0]=o=>e.parent_category=o),size:"normal"},null,8,["label","options","modelValue"])]),t("div",de,[g(V,{type:"text",name:"category_name",modelValue:e.category_name,"onUpdate:modelValue":s[1]||(s[1]=o=>e.category_name=o),label:p(B),required:!0},null,8,["modelValue","label"])]),t("div",me,[g(V,{type:"text",name:"category_name_ar",modelValue:e.category_name_ar,"onUpdate:modelValue":s[2]||(s[2]=o=>e.category_name_ar=o),label:p(j)},null,8,["modelValue","label"])]),t("div",_e,[t("div",ue,[t("label",null,c(a.$t("Upload")),1),t("div",ge,[t("input",{class:"form-control form-control-solid",name:"category_image",type:"file",id:"category_image",accept:"image/jpg, image/jpeg, image/png",onChange:F},null,32),t("label",pe,c(a.$t("Upload")),1)])])]),t("div",fe,[t("div",ye,[t("div",ve,[y(t("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"status",checked:"","onUpdate:modelValue":s[3]||(s[3]=o=>e.status=o)},null,512),[[h,e.status]]),t("label",he,c(a.$t("Active")),1)])])]),t("div",be,[t("div",ke,[t("div",Ce,[y(t("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"is_favorite","onUpdate:modelValue":s[4]||(s[4]=o=>e.is_favorite=o)},null,512),[[h,e.is_favorite]]),t("label",we,c(a.$t("Is Favorite")),1)])])]),t("div",xe,[t("div",Ve,[t("div",$e,[y(t("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"status","onUpdate:modelValue":s[5]||(s[5]=o=>e.is_tobacco_tax=o)},null,512),[[h,e.is_tobacco_tax]]),t("label",Ne,c(a.$t("Tobacco Tax")),1)])])])]),y(t("input",{type:"hidden","onUpdate:modelValue":s[6]||(s[6]=o=>e.category_slack=o)},null,512),[[G,e.category_slack]])]),e.server_messages.messages!=""?(n(),m("div",Se,[g(C,{server_messages:e.server_messages},null,8,["server_messages"])])):w("",!0),t("div",Ue,[t("button",{type:"submit",class:"btn btn-primary",disabled:e.is_submitting},[e.is_submitting?(n(),H(Z,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):w("",!0),e.is_submitting?(n(),m("span",Me,c(a.$t("Saving...")),1)):(n(),m("span",Be,c(a.$t("Save")),1))],8,Ae)])]),_:1},8,["validation-schema","initial-values"])])])])])}}};export{Je as default};
