import{_ as B}from"./EditFormSkeleton.rDEkHHXB.js";import{_ as I}from"./VTextArea.S7BcQM-W.js";import T from"./ServerMessage.Re9KOdbP.js";import{a as M,E as j,F as z}from"./vee-validate.esm.reM-LHjC.js";import{D as L}from"./DefaultLayout.saUWsTkY.js";import{c as O,a as v}from"./index.esm.e6McCFlz.js";import{_ as V}from"./VTextInput.pcaNaUkX.js";import{E as P}from"./Editor.DsaIAbtI.js";import{u as H,a as J,r as f,e as G,o as K,g as n,p as b,w as p,f as k,i as a,l as o,k as w,t as m,j as r,h as u,m as q,T as Q}from"./index.li3fCRRM.js";import{C as W}from"./ClipLoader.gDBpDd3b.js";/* empty css                                                                */import"./VTooltip.pHzwBjkF.js";/* empty css                                                   */const X={class:"header-nav-wrap"},Y={class:"row align-items-center"},Z={class:"col-auto"},ee={class:"header-back-link"},se={class:"col-auto"},ae={key:0,class:"fw-bold"},te={key:1,class:"fw-bold"},ie={key:0,class:"content"},oe={class:"row card-strash"},re={key:0,class:"py-3"},de={class:"col-md-12"},le={class:"row"},ne={class:"col-md-12 mb-4"},ce={class:"card"},me={class:"row"},_e={class:"col-md-3"},ue={class:"col-md-3"},pe={class:"col-md-6"},he={class:"col-md-12 mb-4"},ve={class:"card"},ge={class:"row"},fe={class:"form-field"},be={class:"label"},ye=a("span",{class:"text-danger"},"*",-1),Ve={class:"text-end"},ke=["disabled"],we={key:1,class:"pt-0"},qe={key:2,class:"pt-0"},ze={__name:"add_version_release",setup(xe){const{t}=H(),x=J(),h=f({version:t("Version"),description:t("Description"),released_at:t("Released At"),highlights:t("Highlights")}),S={server_messages:{type:"",messages:""},is_submitting:!1,version:"",description:"",released_at:new Date().toISOString().slice(0,19),highlights:""},e=G({...S});let $=O({version:v().required(t("name is required",{name:t("Version")})),description:v().required(t("name is required",{name:t("Description")})),highlights:v().required(t("name is required",{name:t("Password")})),released_at:v().required(t("name is required",{name:t("Release Date")}))});const D=f([]),c=x.params.id;K(()=>{_.isUndefined(c)&&R(),_.isUndefined(c)||E()});const g=f(!1);async function R(){let s=await axios.get("api/version_releases/add");e.version=s.data.data.version,g.value=!0}async function E(){await axios.get("/api/version_release/"+c).then(s=>{D.value=s.data.data,s.data.data&&(e.id=s.data.data.id,e.version=s.data.data.version,e.description=s.data.data.description,e.highlights=s.data.data.highlights,e.released_at=s.data.data.released_at),g.value=!0}).catch(s=>{e.server_messages.type="error",e.server_messages.messages=s,console.log(s)})}async function U(){e.is_submitting=!0;var s=new FormData;s.append("version",e.version),s.append("description",e.description),s.append("highlights",e.highlights),s.append("released_at",e.released_at),s.append("id",e.id);var i=e.id!=""&&e.id!=null?"/api/version_release/update":"/api/version_release/save";await axios.post(i,s,{headers:{"Content-Type":"multipart/form-data"}}).then(d=>{if(d.data.status_code==200)toast.success(d.data.msg),e.is_submitting=!1,router.push("/releases");else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(d.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=d.data.msg}e.is_submitting=!1}}).catch(d=>{e.server_messages.type="error",e.server_messages.messages=d,e.is_submitting=!1,console.log(d)})}return(s,i)=>{const d=k("Icon"),y=k("router-link"),C=T,F=I,N=B;return n(),b(L,null,{subheader:p(()=>[a("div",X,[a("div",Y,[a("div",Z,[a("div",ee,[o(y,{class:"text-primary",to:"/releases"},{default:p(()=>[o(d,{icon:"fa6-solid:chevron-left"}),w(" "+m(s.$t("Version Releases")),1)]),_:1})])]),a("div",se,[r(c)==""||r(c)==null?(n(),u("h5",ae,m(s.$t("Add Version Release")),1)):(n(),u("h5",te,m(s.$t("Edit Version Release")),1))])])])]),default:p(()=>[r(c)==""||r(c)==null||r(c)!=""&&g.value?(n(),u("div",ie,[o(r(z),{"validation-schema":r($),"initial-values":e,onSubmit:U,enctype:"multipart/form-data"},{default:p(()=>[a("div",oe,[e.server_messages.messages!=""?(n(),u("div",re,[o(C,{server_messages:e.server_messages},null,8,["server_messages"])])):q("",!0),a("div",de,[a("div",le,[a("div",ne,[a("div",ce,[a("div",me,[a("div",_e,[o(V,{type:"text",name:"version",modelValue:e.version,"onUpdate:modelValue":i[0]||(i[0]=l=>e.version=l),label:h.value.version,required:!0},null,8,["modelValue","label"])]),a("div",ue,[o(V,{type:"datetime-local",name:"released_at",modelValue:e.released_at,"onUpdate:modelValue":i[1]||(i[1]=l=>e.released_at=l),label:h.value.released_at,required:!0},null,8,["modelValue","label"])]),a("div",pe,[o(F,{name:"highlights",label:h.value.highlights,modelValue:e.highlights,"onUpdate:modelValue":i[2]||(i[2]=l=>e.highlights=l),required:""},null,8,["label","modelValue"])])])])]),a("div",he,[a("div",ve,[a("div",ge,[o(r(M),{name:"description",label:"label",modelValue:e.description,"onUpdate:modelValue":i[4]||(i[4]=l=>e.description=l)},{default:p(({field:l,meta:Se,errors:$e})=>[a("div",fe,[a("label",be,[w(m(h.value.description)+" ",1),ye]),o(r(P),Q({"api-key":"xm7yrkmhbefzhqie9ehn7yickrbrgkjs1bwfamuoxmm0m4dt",init:{plugins:"lists table code help wordcount codesample advcode "},modelValue:e.description,"onUpdate:modelValue":i[3]||(i[3]=A=>e.description=A)},l),null,16,["modelValue"])])]),_:1},8,["modelValue"]),o(r(j),{name:"description",as:"div",class:"error"})])])])])])]),a("div",Ve,[a("button",{type:"submit",class:"btn btn-primary",disabled:e.is_submitting},[e.is_submitting?(n(),b(W,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):q("",!0),e.is_submitting?(n(),u("span",we,m(s.$t("Saving...")),1)):(n(),u("span",qe,m(s.$t("Save")),1))],8,ke)])]),_:1},8,["validation-schema","initial-values"])])):(n(),b(N,{key:1}))]),_:1})}}};export{ze as default};
