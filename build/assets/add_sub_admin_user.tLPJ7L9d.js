import{_ as O}from"./EditFormSkeleton.rDEkHHXB.js";import{_ as G}from"./VCodeGenerateTextInput.JEj-6DcF.js";import J from"./ServerMessage.Re9KOdbP.js";import{u as T,a as z,r as b,e as H,o as K,v as Q,g as d,p as h,w as y,f as j,i as t,l as i,k as W,t as c,j as m,h as p,m as C,K as X,L as Y,F as Z,x as ee}from"./index.li3fCRRM.js";import{D as ae}from"./DefaultLayout.saUWsTkY.js";import{F as se}from"./vee-validate.esm.reM-LHjC.js";import{c as $,a as g}from"./index.esm.e6McCFlz.js";import{_ as v}from"./VTextInput.pcaNaUkX.js";import{C as te}from"./ClipLoader.gDBpDd3b.js";import{_ as N}from"./VSelect.xfZK6hek.js";import"./VTooltip.pHzwBjkF.js";/* empty css                                                   *//* empty css                                                                */const oe={class:"header-nav-wrap"},le={class:"row align-items-center"},ne={class:"col-auto"},de={class:"header-back-link"},ie={class:"col-auto"},re={key:0,class:"fw-bold"},me={key:1,class:"fw-bold"},ue={key:0,class:"content"},_e={class:"row card-strash"},ce={key:0,class:"py-3"},pe={class:"col-md-12"},ve={class:"row"},ge={class:"col-md-12 mb-4"},fe={class:"card"},be={class:"row"},he={class:"col-md-3"},ye={class:"col-md-3"},we={class:"form-field"},ke={class:"form-label"},Ve=["value"],Se={class:"col-md-3"},qe={class:"col-md-3"},Ue={class:"col-md-3"},je={class:"col-md-3"},Ce={class:"col-md-12 mb-4"},$e={class:"card"},Ne={class:"row"},Ee={class:"col-md-3"},Fe={class:"col-md-3"},Pe={class:"col-md-3"},xe={class:"col-md-3"},De={class:"col-md-3"},Le={class:"col-md-3"},Ae={class:"label"},Re={class:"input-group input-file-group"},Be={class:"btn btn-light-primary min-width-0 mb-0",for:"formFile"},Ie={class:"text-end"},Me=["disabled"],Oe={key:1,class:"pt-0"},Ge={key:2,class:"pt-0"},na={__name:"add_sub_admin_user",setup(Je){const{t:s}=T(),u=z().params.slack,r=b({name:s("Name"),email:s("Email"),password:s("Password"),phone:s("Phone"),status:s("Status"),select_status:s("Select Status"),date_of_birth:s("Date Of Birth"),date_of_anniversary:s("Date Of Anniversary"),joining_date:s("Date Of Joining"),login_code:s("Login Code"),role:s("Role"),select_role:s("Select Role")}),e=H({...{server_messages:{type:"",messages:""},is_submitting:!1,name:"",email:"",password:"",status:"",login_code:"",phone:"",date_of_birth:"",date_of_anniversary:"",joining_date:"",image:"",user_slack:"",password_dummy:"123456789",country:"",role:""}});let w=$({name:g().required(s("name is required",{name:s("Name")})).min(3,s("name must be at least n characters",{name:s("Name"),number:3})),email:g().required(s("name is required",{name:s("Email")})).email(s("must be a valid email",{name:s("Email")})),password:g().required(s("name is required",{name:s("Password")})).min(8,s("name must be at least n characters",{name:s("Password"),number:8}))});const k=b([]),E=[{key:"0",value:s("Inactive")},{key:"1",value:s("Active")},{key:"2",value:s("Hold")},{key:"3",value:s("Left")}],V=b([]),S=b([]);K(()=>{P(),F(),_.isUndefined(u)||x()}),Q(()=>{V.value&&(w=$({name:g().required(s("name is required",{name:s("Name")})).min(3,s("name must be at least n characters",{name:s("Name"),number:3})),email:g().required(s("name is required",{name:s("Email")})).email(s("must be a valid email",{name:s("Email")})),role:g().required(s("name is required",{name:s("Role")}))}))});async function F(){let a=await axios.get("api/admin/roles/all");a=a.data.data,_.forEach(a,o=>{let n={key:o.slack,value:o.name};k.value.push(n)})}async function P(){await axios.get("/api/countries/all").then(a=>{if(a.data.status_code==200)S.value=a.data.data;else try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(a.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=a.data.msg}}).catch(a=>{e.server_messages.type="error",e.server_messages.messages=a,console.log(a)})}const q=b(!1);async function x(){let a=await axios.get("/api/sub_admin",{params:{slack:u}});V.value=a.data.data,a.data.data&&(e.user_slack=a.data.data.slack,e.name=a.data.data.name,e.email=a.data.data.email,e.role=a.data.data.role?a.data.data.role.slack:"",e.status=a.data.data.status,e.login_code=a.data.data.login_code,e.date_of_anniversary=a.data.data.date_of_anniversary,e.date_of_birth=a.data.data.date_of_birth,e.phone=a.data.data.phone,e.joining_date=a.data.data.joining_date,e.password_dummy="123456789",e.country=a.data.data.country_slack),q.value=!0}function D(){let a="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$*",n=o.length;for(let f=0;f<10;f++)a+=o.charAt(Math.floor(Math.random()*n));e.password=a}async function L(){let a=await axios.post("api/user/generate_login_code");e.login_code=a.data.data.login_code}async function A(a){e.image=a.target.files[0]}async function R(){e.is_submitting=!0;var a=new FormData;a.append("name",e.name),a.append("email",e.email),a.append("password",e.password),a.append("country",e.country),a.append("role",e.role),a.append("status",e.status),a.append("login_code",e.login_code),a.append("phone",e.phone),a.append("date_of_birth",e.date_of_birth),a.append("date_of_anniversary",e.date_of_anniversary),a.append("joining_date",e.joining_date),a.append("image",e.image),a.append("user_slack",e.user_slack);var o=e.user_slack!=""&&e.user_slack!=null?"/api/sub_admin/update":"/api/sub_admin/save";await axios.post(o,a,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{if(n.data.status_code==200)toast.success(n.data.msg),e.is_submitting=!1,router.push("/admin/users");else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(n.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=n.data.msg}e.is_submitting=!1}}).catch(n=>{e.server_messages.type="error",e.server_messages.messages=n,e.is_submitting=!1,console.log(n)})}return(a,o)=>{const n=j("Icon"),f=j("router-link"),B=J,U=G,I=O;return d(),h(ae,null,{subheader:y(()=>[t("div",oe,[t("div",le,[t("div",ne,[t("div",de,[i(f,{class:"text-primary",to:"/admin/users"},{default:y(()=>[i(n,{icon:"fa6-solid:chevron-left"}),W(" "+c(a.$t("Sub Admins")),1)]),_:1})])]),t("div",ie,[m(u)==""||m(u)==null?(d(),p("h5",re,c(a.$t("Add Sub Admin")),1)):(d(),p("h5",me,c(a.$t("Edit Sub Admin")),1))])])])]),default:y(()=>[m(u)==""||m(u)==null||m(u)!=""&&q.value?(d(),p("div",ue,[i(m(se),{"validation-schema":m(w),"initial-values":e,onSubmit:R,enctype:"multipart/form-data"},{default:y(()=>[t("div",_e,[e.server_messages.messages!=""?(d(),p("div",ce,[i(B,{server_messages:e.server_messages},null,8,["server_messages"])])):C("",!0),t("div",pe,[t("div",ve,[t("div",ge,[t("div",fe,[t("div",be,[t("div",he,[i(v,{type:"text",name:"name",modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=l=>e.name=l),label:r.value.name,required:!0},null,8,["modelValue","label"])]),t("div",ye,[t("div",we,[t("label",ke,c(a.$t("Country")),1),X(t("select",{class:"form-control form-control-sm form-control-solid",name:"country","onUpdate:modelValue":o[1]||(o[1]=l=>e.country=l)},[(d(!0),p(Z,null,ee(S.value,(l,M)=>(d(),p("option",{value:l.slack,key:M},c(l.name),9,Ve))),128))],512),[[Y,e.country]])])]),t("div",Se,[i(v,{type:"email",name:"email",modelValue:e.email,"onUpdate:modelValue":o[2]||(o[2]=l=>e.email=l),label:r.value.email,required:!0},null,8,["modelValue","label"])]),t("div",qe,[m(u)==null||m(u)==""?(d(),h(U,{key:0,type:"password",name:"password",modelValue:e.password,"onUpdate:modelValue":o[3]||(o[3]=l=>e.password=l),label:r.value.password,required:!0,onGenerate_code:D},null,8,["modelValue","label"])):(d(),h(v,{key:1,type:"password",name:"password_dummy",modelValue:e.password_dummy,"onUpdate:modelValue":o[4]||(o[4]=l=>e.password_dummy=l),label:m(s)("Password")+" ("+m(s)("Can be updated from Reset Password")+")",readonly:!0,disabled:""},null,8,["modelValue","label"]))]),t("div",Ue,[i(N,{name:"status",label:r.value.status,modelValue:e.status,"onUpdate:modelValue":o[5]||(o[5]=l=>e.status=l),placeholder:r.value.select_status,options:E,required:""},null,8,["label","modelValue","placeholder"])]),t("div",je,[i(N,{name:"role",label:r.value.role,modelValue:e.role,"onUpdate:modelValue":o[6]||(o[6]=l=>e.role=l),placeholder:r.value.select_role,options:k.value,required:""},null,8,["label","modelValue","placeholder","options"])])])])]),t("div",Ce,[t("div",$e,[t("div",Ne,[t("div",Ee,[i(U,{type:"text",name:"login_code",modelValue:e.login_code,"onUpdate:modelValue":o[7]||(o[7]=l=>e.login_code=l),label:r.value.login_code,onGenerate_code:L,readonly:!0},null,8,["modelValue","label"])]),t("div",Fe,[i(v,{type:"number",name:"phone",modelValue:e.phone,"onUpdate:modelValue":o[8]||(o[8]=l=>e.phone=l),label:r.value.phone},null,8,["modelValue","label"])]),t("div",Pe,[i(v,{type:"date",name:"date_of_birth",modelValue:e.date_of_birth,"onUpdate:modelValue":o[9]||(o[9]=l=>e.date_of_birth=l),label:r.value.date_of_birth},null,8,["modelValue","label"])]),t("div",xe,[i(v,{type:"date",name:"date_of_anniversary",modelValue:e.date_of_anniversary,"onUpdate:modelValue":o[10]||(o[10]=l=>e.date_of_anniversary=l),label:r.value.date_of_anniversary},null,8,["modelValue","label"])]),t("div",De,[i(v,{type:"date",name:"joining_date",modelValue:e.joining_date,"onUpdate:modelValue":o[11]||(o[11]=l=>e.joining_date=l),label:r.value.joining_date},null,8,["modelValue","label"])]),t("div",Le,[t("label",Ae,c(a.$t("Upload Profile Pic")),1),t("div",Re,[t("input",{class:"form-control form-control-solid",name:"image",type:"file",id:"formFile",accept:"image/jpg, image/jpeg, image/png",onChange:A},null,32),t("label",Be,c(a.$t("Upload")),1)])])])])])])])]),t("div",Ie,[t("button",{type:"submit",class:"btn btn-primary",disabled:e.is_submitting},[e.is_submitting?(d(),h(te,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):C("",!0),e.is_submitting?(d(),p("span",Oe,c(a.$t("Saving...")),1)):(d(),p("span",Ge,c(a.$t("Save")),1))],8,Me)])]),_:1},8,["validation-schema","initial-values"])])):(d(),h(I,{key:1}))]),_:1})}}};export{na as default};
