import{_ as P}from"./ActionButtonGroup.ogbCWQxi.js";import{_ as L}from"./ListingSkeleton.iExoV4hO.js";import{_ as M}from"./InventoryMenu.y7XvlyAV.js";import{u as U,b as z,r as m,e as G,o as J,v as R,g as i,p as K,w,I as Q,f as $,k as d,i as e,t as o,K as W,N as Y,j as D,h as c,n as B,l as p,F as H,x as X,y as S,O as Z}from"./index.7OFNPsHl.js";import{_ as ee}from"./DefaultLayout.nvkZ4UhM.js";import{_ as se}from"./PaginateLimit.Xv-qfeqj.js";import"./vue-datepicker.sD5zgpde.js";import"./ClipLoader.1qNfpKDH.js";/* empty css                                                   */const te={class:"content"},oe={class:"page-heading"},ae={class:"row align-items-center justify-content-between mb-3"},ne={class:"col-auto"},ie={class:"mb-0"},ce={class:"col-auto col-md-auto"},le={class:"row align-items-center justify-content-between"},re={class:"col col-md-auto"},_e={class:"form-field page-heading-search-field mb-0"},de={class:"field-icon"},he=["placeholder"],ue={class:"icon"},me={key:0,class:"col-auto"},pe={key:0},ge={key:1,class:"table-responsive"},ve={class:"table table-list-data table-hover"},fe={class:"bg-light"},ye={scope:"col",width:"10%"},ke={scope:"col",width:"10%"},we={scope:"col",width:"10%"},be={scope:"col",width:"10%"},Ce={scope:"col",width:"10%"},$e={scope:"col",width:"10%"},De={scope:"col",width:"10%"},Be={key:0,scope:"col",class:"text-end",width:"5%"},Se=["onClick"],Ne={class:"fw-bold highlighted-list-item"},Ae={key:0},Te=e("br",null,null,-1),Ie={class:"text-muted"},qe=["onClick"],xe=["onClick"],Ee={key:0,class:"text-success"},Oe={key:1,href:"#"},Ve={key:0},Fe={key:1},je=["onClick"],Pe={key:0,class:"text-warning"},Le={key:1,class:"text-success"},Me=["onClick"],Ue=["onClick"],ze={class:"form-feild"},Ge={class:"form-check form-switch form-switch-2"},Je=["onChange","checked"],Re={key:0,class:"text-end"},Ke={key:1},Qe={class:"text-center py-3",colspan:"11"},We={class:"data-footer"},Ye={class:"row align-items-center justify-content-between"},He={class:"col-auto"},Xe={class:"col-auto"},rs={__name:"discounts",setup(Ze){const{isAuthorized:b}=Q(),{t:v}=U();z(),m(!1);const N={server_messages:{type:"",messages:""},is_listing:!1,search_query:m("")},A=v("Search by name or value"),a=G({...N});J(()=>{E(),g()}),R(()=>a.search_query,_.debounce(()=>{g()},500));const f=m([]),y=m([]);async function g(s=1){a.is_listing=!0,await axios.get("/api/v2/discounts",{params:{page:s,paginate_limit:C.value,search_query:a.search_query}}).then(l=>{f.value=l.data.data,y.value=l.data.pagination,a.is_listing=!1}).catch(l=>{a.server_messages.type="error",a.server_messages.messages=l,a.is_listing=!1,console.log(l)})}const C=m();async function T(s){C.value=s,await g()}async function I(s){var l=new FormData;l.append("slack",s),await axios.post("/api/discount/update_status",l).then(n=>{if(n.data.status_code==200)toast.success(n.data.msg);else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(n.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=n.data.msg}}).catch(n=>{a.server_messages.type="error",a.server_messages.messages=n,console.log(n)})}function h(s){router.push("/discount/"+s)}function q(s){router.push("/discount/edit/"+s)}async function x(s){var l=!1;await Swal.fire({title:v("Do you want to delete this item?"),showCancelButton:!0,confirmButtonText:v("Yes, Delete"),confirmButtonColor:"#d33",cancelButtonText:v("Cancel")}).then(n=>{n.isConfirmed&&(l=!0)}),l&&await axios.post("/api/discount/delete",{slack:s}).then(n=>{if(n.data.status_code==200)toast.success(n.data.msg),g();else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(n.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=n.data.msg}}).catch(n=>{a.server_messages.type="error",a.server_messages.messages=n,console.log(n)})}const r=m({write:!1,delete:!1});function E(){r.value={write:b("A_WRITE_DISCOUNT"),delete:b("A_DELETE_DISCOUNT")}}return(s,l)=>{const n=M,k=$("Icon"),O=$("router-link"),V=L,F=P;return i(),K(ee,null,{subheader:w(()=>[d(n)]),default:w(()=>[e("div",te,[e("div",oe,[e("div",ae,[e("div",ne,[e("h2",ie,o(s.$t("Discounts")),1)]),e("div",ce,[e("div",le,[e("div",re,[e("div",_e,[e("div",de,[W(e("input",{type:"search",class:"form-control form-control-sm form-control-solid",placeholder:D(A),"onUpdate:modelValue":l[0]||(l[0]=t=>a.search_query=t)},null,8,he),[[Y,a.search_query]]),e("div",ue,[d(k,{icon:"fa6-solid:magnifying-glass"})])])])]),r.value.write?(i(),c("div",me,[d(O,{class:"btn btn-sm btn-light-primary2",to:"/discount/add"},{default:w(()=>[B("+ "+o(s.$t("New Discount")),1)]),_:1})])):p("",!0)])])])]),a.is_listing?(i(),c("div",pe,[d(V)])):(i(),c("div",ge,[e("table",ve,[e("thead",fe,[e("tr",null,[e("th",ye,o(s.$t("Discount")),1),e("th",ke,o(s.$t("Value")),1),e("th",we,o(s.$t("Branches")),1),e("th",be,o(s.$t("Applies To")),1),e("th",Ce,o(s.$t("Remaining Qty."))+".",1),e("th",$e,o(s.$t("Created At")),1),e("th",De,o(s.$t("Active")),1),r.value.write||r.value.delete?(i(),c("th",Be,o(s.$t("Action")),1)):p("",!0)])]),e("tbody",null,[f.value!=""?(i(!0),c(H,{key:0},X(f.value,(t,j)=>(i(),c("tr",{key:j},[e("td",{onClick:u=>h(t.slack),role:"button",class:S({"border-start border-5 border-success":t.is_running})},[e("div",{class:S({"text-success":t.is_running})},[e("span",Ne,o(t.name),1),t.name_ar!=""?(i(),c("span",Ae,[Te,e("small",Ie,o(t.name_ar),1)])):p("",!0)],2)],10,Se),e("td",{onClick:u=>h(t.slack),role:"button"},o(t.value)+" "+o(t.type_text),9,qe),e("td",{onClick:u=>h(t.slack),role:"button"},[t.branches_count==0?(i(),c("span",Ee,o(s.$t("All Branches")),1)):(i(),c("span",Oe,[B(o(t.branches_count)+" ",1),t.branches_count>1?(i(),c("span",Ve,o(s.$t("Branches")),1)):(i(),c("span",Fe,o(s.$t("Branch")),1))]))],8,xe),e("td",{onClick:u=>h(t.slack),role:"button"},[t.applies_to==1?(i(),c("span",Pe,o(t.inventory_type_text),1)):p("",!0),t.applies_to==2?(i(),c("span",Le,o(s.$t("Order")),1)):p("",!0)],8,je),e("td",{onClick:u=>h(t.slack),role:"button"},o(t.remaining_discount_quantity),9,Me),e("td",{onClick:u=>h(t.slack),role:"button"},o(t.created_at_label),9,Ue),e("td",null,[e("div",ze,[e("div",Ge,[e("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:u=>I(t.slack),checked:t.status==1},null,40,Je)])])]),r.value.write||r.value.delete?(i(),c("td",Re,[d(F,{permissions:r.value,onEdit:q,onDelete:x,slack:t.slack},null,8,["permissions","slack"])])):p("",!0)]))),128)):(i(),c("tr",Ke,[e("td",Qe,o(s.$t("No Data Found")),1)]))])])])),e("div",We,[e("div",Ye,[e("div",He,[d(se,{onPaginate_limit_update:T,pagination:y.value},null,8,["pagination"])]),e("div",Xe,[d(D(Z),{data:y.value,limit:5,onPaginationChangePage:g},null,8,["data"])])])])])]),_:1})}}};export{rs as default};
