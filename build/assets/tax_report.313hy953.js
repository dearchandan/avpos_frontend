import{u as Z,b as ee,d as S,e as T,r as n,v as se,o as te,g,p as y,w as h,f as C,i as l,k as i,n as E,t as p,j as t,l as x,A as Y,B as A,h as ae,bV as $,q as le,_ as oe}from"./index.ri7Y_V5F.js";import{_ as ne}from"./DefaultLayout.EMHfdzn0.js";import{_ as re}from"./VSelect.ijXeZp1F.js";import{_ as ce}from"./VMultiSelect.3zUL7lik.js";import{u as de}from"./global.f8Ro4KP-.js";import{s as B,a as ie,e as _e,j as me}from"./vue-datepicker.gRWbN_6J.js";import{s as O,e as N}from"./index.DsgwUBM9.js";import"./ClipLoader.4-rIzqtH.js";/* empty css                                                   */import"./vee-validate.esm.0La7AMjT.js";/* empty css                                                                */const pe={class:"header-nav-wrap"},ue={class:"row align-items-center"},ge={class:"col-auto"},he={class:"header-back-link"},ve={class:"col-auto"},fe={class:"fw-bold"},be={class:"content"},ye={class:"card"},xe={class:"row field-m-0 align-items-end g-3"},ke={class:"col-md-4 col-lg-3"},we={class:"form-field"},Ve={for:"",class:"form-label"},De=l("span",{class:"text-danger"},"*",-1),Me=["onClick","onKeyup"],Se={class:"col-md-4 col-lg-3"},Te={key:0,class:"col-md-4 col-lg-3"},Ce={class:"col-md-4 col-lg-3"},Ee={class:"col-md-4 col-lg-3"},Ye={class:"row mt-3"},Ae={class:"col-12 text-end"},$e=["disabled"],Ge={__name:"tax_report",setup(Be){const{t:r}=Z();de();const k=ee();S(()=>k.user.currency.symbol);const d=T({server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,dates:n([new Date,new Date]),selected_branch:n(),selected_terminals:n([]),selected_category:n([]),selected_tax:n([]),is_exporting:!1}),e=T({...d}),U=r("Select Branch"),I=r("All Branches"),j=r("All Terminals"),K=r("Select Terminals"),L=r("Select Category"),R=r("All Categories"),J=r("Select Tax"),P=r("All Taxes"),q=n([{label:"Today",value:[new Date,new Date]},{label:"This month",value:[O(new Date),N(new Date)]},{label:"Last month",value:[O(B(new Date,1)),N(B(new Date,1))]},{label:"This year",value:[ie(new Date),_e(new Date)]}]);se(()=>e.selected_branch,a=>{a>0?z(a):e.selected_terminals=[]}),te(()=>{F(),H()});const G=S(()=>k.user.branches),v=n([]);async function z(a){a!=null&&a!=""&&await axios.post("/api/branch/terminals",{id:a}).then(s=>{if(s.data.status_code==200){v.value=[];let c=s.data.data;_.forEach(c,m=>{let u={id:m.id,name:m.code+" - "+m.terminal_name};v.value.push(u)})}else try{d.server_messages.type="error",d.server_messages.messages=JSON.parse(s.data.msg)}catch{d.server_messages.type="error",d.server_messages.messages=s.data.msg}}).catch(s=>{d.server_messages.type="error",d.server_messages.messages=s,console.log(s)})}const w=n([]);async function F(){let a=await axios.get("api/v2/categories/all");a=a.data.data,_.forEach(a,s=>{let c={key:s.slack,value:s.name,id:s.slack};w.value.push(c)})}const V=n([]);async function H(){let a=await axios.get("api/v2/taxes/all");a=a.data.data,_.forEach(a,s=>{let c={key:s.slack,value:s.name,id:s.slack};V.value.push(c)})}async function Q(){e.is_exporting=!0,e.dates[0]=$(e.dates[0]).format("YYYY-MM-DD"),e.dates[1]=$(e.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/tax_report/export_excel",{params:{filter:e}}).then(a=>{if(a.data.status_code==200){e.is_exporting=!1;const s=document.createElement("a");s.target="_blank",s.href=a.data.data.file,document.body.appendChild(s),s.click()}else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(a.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=a.data.msg}e.is_exporting=!1}}).catch(a=>{e.server_messages.type="error",e.server_messages.messages=a,e.is_exporting=!1,console.log(a)})}const W=le(()=>oe(()=>import("./ServerMessage.qNo4NwTp.js"),__vite__mapDeps([0,1,2])));return(a,s)=>{const c=C("Icon"),m=C("router-link"),u=ce,D=re,X=ne;return g(),y(X,null,{subheader:h(()=>[l("div",pe,[l("div",ue,[l("div",ge,[l("div",he,[i(m,{class:"text-primary",to:"/reports"},{default:h(()=>[i(c,{icon:"fa6-solid:chevron-left"}),E(" "+p(a.$t("Reports")),1)]),_:1})])]),l("div",ve,[l("h5",fe,p(a.$t("Tax Report")),1)])])])]),default:h(()=>[l("div",be,[t(e).server_messages.messages!=""?(g(),y(t(W),{key:0,class:"py-3",server_messages:t(e).server_messages},null,8,["server_messages"])):x("",!0),l("div",ye,[l("div",xe,[l("div",ke,[l("div",we,[l("label",Ve,[E(p(a.$t("Select Dates"))+" ",1),De]),i(t(me),{range:"","preset-dates":t(q),modelValue:t(e).dates,"onUpdate:modelValue":s[0]||(s[0]=o=>t(e).dates=o),format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":h(({label:o,value:f,presetDate:b})=>[l("span",{role:"button",tabindex:0,onClick:M=>b(f),onKeyup:[Y(A(M=>b(f),["prevent"]),["enter"]),Y(A(M=>b(f),["prevent"]),["space"])]},p(o),41,Me)]),_:1},8,["preset-dates","modelValue"])])]),l("div",Se,[i(u,{name:"branches",label:t(U),placeholder:t(I),text:"name",value:"id",options:t(G),modelValue:t(e).selected_branch,"onUpdate:modelValue":s[1]||(s[1]=o=>t(e).selected_branch=o),mode:"single"},null,8,["label","placeholder","options","modelValue"])]),t(e).selected_branch!=null&&t(e).selected_branch>0?(g(),ae("div",Te,[t(e).selected_branch!=null&&t(e).selected_branch>0?(g(),y(u,{key:0,name:"terminals",label:t(j),placeholder:t(K),text:"name",value:"id",options:t(v),modelValue:t(e).selected_terminals,"onUpdate:modelValue":s[2]||(s[2]=o=>t(e).selected_terminals=o)},null,8,["label","placeholder","options","modelValue"])):x("",!0)])):x("",!0),l("div",Ce,[i(D,{name:"categories",label:t(L),placeholder:t(R),text:"name",value:"id",options:t(w),modelValue:t(e).selected_category,"onUpdate:modelValue":s[3]||(s[3]=o=>t(e).selected_category=o)},null,8,["label","placeholder","options","modelValue"])]),l("div",Ee,[i(D,{name:"taxes",label:t(J),placeholder:t(P),text:"name",value:"id",options:t(V),modelValue:t(e).selected_tax,"onUpdate:modelValue":s[4]||(s[4]=o=>t(e).selected_tax=o)},null,8,["label","placeholder","options","modelValue"])])]),l("div",Ye,[l("div",Ae,[l("button",{class:"btn btn-success ms-3",onClick:s[5]||(s[5]=o=>Q()),disabled:t(e).dates==null},p(a.$t("Export Excel")),9,$e)])])])])]),_:1})}}};export{Ge as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.qNo4NwTp.js","assets/index.ri7Y_V5F.js","assets/index.1t-AB2n6.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
