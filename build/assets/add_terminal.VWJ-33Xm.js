import{D as F}from"./DefaultLayout.K5Bh9Jz_.js";import{_ as U}from"./EditFormSmallSkeleton.5z1v6Gtx.js";import{_ as E}from"./VTextInput.EPCajChY.js";import{_ as j}from"./VCodeGenerateTextInput.SsiqSQ9X.js";import A from"./ServerMessage.EFQMOwoZ.js";import{F as G}from"./vee-validate.esm.2kXgdFia.js";import{c as M,a as w}from"./index.esm.DHYHwGJ4.js";import{b as O,u as z,a as J,r as g,e as R,o as H,g as o,p as v,w as u,f as V,i as a,l as r,k as K,t as m,j as i,h as c,m as $}from"./index.sP6fhsqN.js";import{C as P}from"./ClipLoader._89zL49D.js";import"./VTooltip.kcvohVRA.js";/* empty css                                                   */const Q={class:"header-nav-wrap"},W={class:"row align-items-center"},X={class:"col-auto"},Y={class:"header-back-link"},Z={class:"col-auto"},ee={key:0,class:"fw-bold"},se={key:1,class:"fw-bold"},ae={key:0,class:"content"},te={class:"row card-strash"},oe={key:0,class:"py-3"},ne={class:"col-md-12"},ie={class:"row"},le={class:"col-md-12 mb-4"},re={class:"card"},ce={class:"row"},de={class:"col-md-3"},me={class:"col-md-3"},_e={class:"text-end"},ue=["disabled"],pe={key:1,class:"pt-0"},ge={key:2,class:"pt-0"},Ne={__name:"add_terminal",setup(ve){O();const{t:d}=z(),n=J().params.slack,f=g({login_code:d("Login Code"),name:d("Name")}),h={server_messages:{type:"",messages:""},is_submitting:!1,login_code:"",name:"",terminal_slack:""},e=R({...h}),C=M({login_code:w().matches(/^([0-9]{0,999999999999999999})$/,d("Login Code only accept numbers")).required().label("Login Code"),name:w().required(d("name is required",{name:d("Name")}))}),S=g([]);H(()=>{_.isUndefined(n)&&b(),_.isUndefined(n)||x()});async function b(){let s=await axios.post("api/terminal/generate_login_code");e.login_code=s.data.data.login_code}const y=g(!1);async function x(){await axios.get("/api/terminal",{params:{slack:n}}).then(s=>{S.value=s.data.data,e.name=s.data.data.terminal_name,e.terminal_slack=s.data.data.slack,e.login_code=s.data.data.terminal_login_code,y.value=!0}).catch(s=>{e.server_messages.type="error",e.server_messages.messages=s,console.log(s)})}async function T(){e.is_submitting=!0;var s=new FormData;s.append("login_code",e.login_code),s.append("name",e.name),s.append("terminal_slack",e.terminal_slack);var l=e.terminal_slack!=""&&e.terminal_slack!=null?"/api/terminal/update":"/api/terminal/save";await axios.post(l,s).then(t=>{if(t.data.status_code==200)toast.success(t.data.msg),e.is_submitting=!1,N(),router.push("/terminals");else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(t.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=t.data.msg}e.is_submitting=!1}}).catch(t=>{e.server_messages.type="error",e.server_messages.messages=t,e.is_submitting=!1,console.log(t)})}function N(){Object.assign(e,h)}return(s,l)=>{const t=V("Icon"),k=V("router-link"),D=A,L=j,I=E,q=U,B=F;return o(),v(B,null,{subheader:u(()=>[a("div",Q,[a("div",W,[a("div",X,[a("div",Y,[r(k,{class:"text-primary",to:"/terminals"},{default:u(()=>[r(t,{icon:"fa6-solid:chevron-left"}),K(" "+m(s.$t("Terminals")),1)]),_:1})])]),a("div",Z,[i(n)==""||i(n)==null?(o(),c("h5",ee,m(s.$t("Add Terminal")),1)):(o(),c("h5",se,m(s.$t("Edit Terminal")),1))])])])]),default:u(()=>[i(n)==""||i(n)==null||i(n)!=""&&y.value?(o(),c("div",ae,[r(i(G),{"validation-schema":i(C),onSubmit:T,"initial-values":e,enctype:"multipart/form-data"},{default:u(()=>[a("div",te,[e.server_messages.messages!=""?(o(),c("div",oe,[r(D,{server_messages:e.server_messages},null,8,["server_messages"])])):$("",!0),a("div",ne,[a("div",ie,[a("div",le,[a("div",re,[a("div",ce,[a("div",de,[r(L,{type:"text",name:"login_code",modelValue:e.login_code,"onUpdate:modelValue":l[0]||(l[0]=p=>e.login_code=p),label:f.value.login_code,onGenerate_code:b},null,8,["modelValue","label"])]),a("div",me,[r(I,{type:"text",name:"name",modelValue:e.name,"onUpdate:modelValue":l[1]||(l[1]=p=>e.name=p),label:f.value.name,required:!0},null,8,["modelValue","label"])])])])])])])]),a("div",_e,[a("button",{type:"submit",class:"btn btn-primary",disabled:e.is_submitting},[e.is_submitting?(o(),v(P,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):$("",!0),e.is_submitting?(o(),c("span",pe,m(s.$t("Saving...")),1)):(o(),c("span",ge,m(s.$t("Save")),1))],8,ue)])]),_:1},8,["validation-schema","initial-values"])])):(o(),v(q,{key:1}))]),_:1})}}};export{Ne as default};
