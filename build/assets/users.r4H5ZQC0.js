import{_ as le}from"./ActionButtonGroup.IGw_8hrL.js";import{_ as ne}from"./ListingSkeleton.6NzqF9S5.js";import{_ as ie}from"./VSelect.xfZK6hek.js";import{u as ce,b as re,r as c,e as U,o as de,v as B,g as i,p as k,w as A,I as _e,f as F,l as f,i as e,t as o,h as d,k as V,y as ue,m as y,j as b,K as I,L as j,N as me,F as M,x as q,O as he}from"./index.li3fCRRM.js";import{D as pe}from"./DefaultLayout.saUWsTkY.js";import{_ as ve}from"./PaginateLimit.SmYeFgfo.js";import{j as fe}from"./vue-datepicker.a6BsTEHj.js";import{_ as ge}from"./ManageMenu.CWQNPUWJ.js";import"./vee-validate.esm.reM-LHjC.js";/* empty css                                                                */import"./ClipLoader.gDBpDd3b.js";/* empty css                                                   */var ye={VITE_API_BASE_URL:"https://api.avinyadev.com",VITE_DEFAULT_LOCALE:"en",VITE_FALLBACK_LOCALE:"ar",VITE_RECAPTCHA_SITE_KEY:"6LcFHaYpAAAAAOHc3ISL-cu1Ldyg4MHCKbMKYA40",VITE_PUSHER_APP_KEY:"any-key",VITE_PUSHER_APP_CLUSTER:"mt1",VITE_PUSHER_WS_HOST:"api.avinyadev.com",VITE_PUSHER_WS_PORT:"6001",VITE_PUSHER_WSS_PORT:"6001",VITE_PUSHER_FORCE_TLS:"true",VITE_PUSHER_ENCRYPTED:"true",VITE_PUSHER_AUTH_ENDPOINT:"https://api.avinyadev.com/broadcasting/auth",VITE_USER_NODE_ENV:"production",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const ke={class:"content"},be={class:"page-heading position-relative"},Ee={class:"row align-items-center justify-content-between mb-3"},we={class:"col-auto"},Se={class:"mb-0"},Ce={key:0,class:"col-auto"},$e={key:0,class:"attention_msg_box"},Te=["href"],Ue={class:"row align-items-end justify-content-between mb-3"},Ae={class:"col-md-auto"},Ve={class:"row align-items-end justify-content-between g-3"},Ie={class:"col-12 col-md-auto"},Re={class:"form-field"},Pe={class:"col-auto"},Le={class:"form-field"},De={value:""},Ne={value:"0"},Oe={value:"1"},He={value:"2"},Be={value:"3"},Fe={class:"col-auto"},je={class:"col-auto col-md-auto"},Me={class:"col-auto"},qe={class:"form-field page-heading-search-field mb-0"},Ke={class:"field-icon"},Ye=["placeholder"],Je={class:"icon"},We={key:1,class:"table-responsive"},Ge={class:"table table-list-data table-hover"},ze={class:"bg-light"},Qe={scope:"col",width:"20%"},Xe={scope:"col",width:"15%"},Ze={scope:"col",width:"15%"},xe={scope:"col",width:"10%"},et={scope:"col",width:"10%"},tt={scope:"col",width:"10%"},st={scope:"col",width:"10%"},ot={scope:"col",width:"10%"},at={key:0,scope:"col",class:"text-end",width:"5%"},lt=["onClick"],nt={class:"fw-bold highlighted-list-item"},it=e("br",null,null,-1),ct={class:"text-muted"},rt=["onClick"],dt=["onClick"],_t={key:0},ut=["onClick"],mt=["onClick"],ht=["onClick"],pt=["onClick"],vt={class:"text-center"},ft={class:"form-field mb-0"},gt=["onUpdate:modelValue","id","onChange","disabled"],yt=["value"],kt={key:0,class:"text-end"},bt={key:1},Et={class:"text-center py-3",colspan:"11"},wt={class:"data-footer"},St={class:"row align-items-center justify-content-between"},Ct={class:"col-auto"},$t={class:"col-auto"},Ft={__name:"users",setup(Tt){const{t:g}=ce(),{isAuthorized:R}=_e();re();const P=c({role:g("Role"),select_role:g("Select Role")});c(!1);const K={server_messages:{type:"",messages:""},is_listing:!1,search_query:c("")},Y=g("Search by name, email, phone.."),a=U({...K});de(()=>{x(),p(),G(),te()}),B(()=>a.search_query,_.debounce(()=>{p()},500));const E=c([]),w=c([]),J=c([{key:"0",value:"Inactive"},{key:"1",value:"Active"},{key:"2",value:"Hold"},{key:"3",value:"Left"}]);async function p(t=1){a.is_listing=!0,await axios.get("/api/v2/users",{params:{page:t,paginate_limit:L.value,search_query:a.search_query,filter:u}}).then(l=>{E.value=l.data.data,w.value=l.data.pagination,a.is_listing=!1}).catch(l=>{a.server_messages.type="error",a.server_messages.messages=l,a.is_listing=!1,console.log(l)})}const L=c();async function W(t){L.value=t,await p()}const D=c([]);async function G(){let t=await axios.get("api/v2/roles/all");t=t.data.data,_.forEach(t,l=>{let n={key:l.slack,value:l.name};D.value.push(n)})}async function z(t,l){var n=new FormData;n.append("slack",l),n.append("status",t.target.value),await axios.post("/api/user/update_status",n).then(m=>{if(m.data.status_code==200)toast.success(m.data.msg);else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(m.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=m.data.msg}}).catch(m=>{a.server_messages.type="error",a.server_messages.messages=m,console.log(m)})}function v(t){router.push("/user/"+t)}function N(t){router.push("/user/edit/"+t)}async function Q(t){var l=!1;await Swal.fire({title:g("Do you want to delete this User?"),showCancelButton:!0,confirmButtonText:g("Yes, Delete"),confirmButtonColor:"#d33",cancelButtonText:g("Cancel")}).then(n=>{n.isConfirmed&&(l=!0)}),l&&await axios.post("/api/user/delete",{slack:t}).then(n=>{if(n.data.status_code==200)Swal.fire(n.data.msg),p();else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(n.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=n.data.msg}}).catch(n=>{a.server_messages.type="error",a.server_messages.messages=n,console.log(n)})}const X=c(!1),S=U({created_date:c(""),status:c(""),role:c("")}),u=U({...S}),C=c(!1);B(()=>u.role,t=>{$()});async function $(){JSON.stringify(u)!=JSON.stringify(S)&&(C.value=!0),X.value=!1,await p()}function Z(){Object.assign(u,S),C.value=!1,p()}const h=c({write:!1,delete:!1});function x(){h.value={write:R("A_WRITE_USER"),delete:R("A_DELETE_USER")}}const ee=ye.VITE_WEBSITE_SUBSCRIPTION_PAGE_URL,T=c(!1);async function te(){await axios.get("/api/user/check_addon_limit").then(t=>{T.value=t.data.data.disable_user_add}).catch(t=>{a.server_messages.type="error",a.server_messages.messages=t})}return(t,l)=>{const n=F("router-link"),m=ie,O=F("Icon"),se=ne,H=le;return i(),k(pe,null,{subheader:A(()=>[f(ge)]),default:A(()=>[e("div",ke,[e("div",be,[e("div",Ee,[e("div",we,[e("h2",Se,o(t.$t("Users")),1)]),h.value.write?(i(),d("div",Ce,[f(n,{class:ue(["btn btn-sm btn-light-primary2",{disabled:T.value}]),to:"/user/add"},{default:A(()=>[V("+ "+o(t.$t("New User")),1)]),_:1},8,["class"])])):y("",!0)]),T.value?(i(),d("div",$e,[V(o(t.$t("Upgrade your subscription to add more users,"))+" ",1),e("a",{href:b(ee),target:"_blank"},[e("u",null,o(t.$t("click here")),1)],8,Te),V(" "+o(t.$t("to see the plans.")),1)])):y("",!0),e("div",Ue,[e("div",Ae,[e("div",Ve,[e("div",Ie,[e("div",Re,[e("label",null,o(t.$t("Created Date")),1),f(b(fe),{range:"",modelValue:u.created_date,"onUpdate:modelValue":[l[0]||(l[0]=s=>u.created_date=s),l[1]||(l[1]=s=>$())],format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid form-control-sm"},null,8,["modelValue"])])]),e("div",Pe,[e("div",Le,[e("label",null,o(t.$t("Status")),1),I(e("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":l[2]||(l[2]=s=>u.status=s),onChange:$},[e("option",De,o(t.$t("All")),1),e("option",Ne,o(t.$t("Inactive")),1),e("option",Oe,o(t.$t("Active")),1),e("option",He,o(t.$t("Hold")),1),e("option",Be,o(t.$t("Left")),1)],544),[[j,u.status]])])]),e("div",Fe,[f(m,{name:"role",label:P.value.role,modelValue:u.role,"onUpdate:modelValue":l[3]||(l[3]=s=>u.role=s),placeholder:P.value.select_role,options:D.value,height_sm:!0},null,8,["label","modelValue","placeholder","options"])]),e("div",je,[C.value?(i(),d("button",{key:0,class:"btn btn-sm btn-light-danger",onClick:Z},o(t.$t("Clear")),1)):y("",!0)])])]),e("div",Me,[e("div",qe,[e("div",Ke,[I(e("input",{type:"search",class:"form-control form-control-sm form-control-solid",placeholder:b(Y),"onUpdate:modelValue":l[4]||(l[4]=s=>a.search_query=s)},null,8,Ye),[[me,a.search_query]]),e("div",Je,[f(O,{icon:"fa6-solid:magnifying-glass"})])])])])])]),a.is_listing?(i(),k(se,{key:0})):(i(),d("div",We,[e("table",Ge,[e("thead",ze,[e("tr",null,[e("th",Qe,o(t.$t("User Name")),1),e("th",Xe,o(t.$t("Email")),1),e("th",Ze,o(t.$t("Role")),1),e("th",xe,o(t.$t("Phone")),1),e("th",et,o(t.$t("Login Code")),1),e("th",tt,o(t.$t("Joining Date")),1),e("th",st,o(t.$t("Created At")),1),e("th",ot,o(t.$t("Status")),1),h.value.write||h.value.delete?(i(),d("th",at,o(t.$t("Action")),1)):y("",!0)])]),e("tbody",null,[E.value!=""?(i(!0),d(M,{key:0},q(E.value,(s,oe)=>(i(),d("tr",{key:oe},[e("td",{onClick:r=>v(s.slack),role:"button"},[e("div",null,[e("span",nt,o(s.name),1),it,e("small",ct,o(t.$t("Code"))+": "+o(s.code),1)])],8,lt),e("td",{onClick:r=>v(s.slack),role:"button"},o(s.email),9,rt),e("td",{onClick:r=>v(s.slack),role:"button"},[s.role?(i(),d("span",_t,o(s.role.name),1)):y("",!0)],8,dt),e("td",{onClick:r=>v(s.slack),role:"button"},o(s.phone),9,ut),e("td",{onClick:r=>v(s.slack),role:"button"},o(s.login_code),9,mt),e("td",{onClick:r=>v(s.slack),role:"button"},o(s.joining_date),9,ht),e("td",{onClick:r=>v(s.slack),role:"button"},o(s.created_at_label),9,pt),e("td",vt,[e("div",ft,[I(e("select",{class:"form-control form-control-solid form-control-sm","onUpdate:modelValue":r=>s.status=r,name:"approval_status",id:s.slack,onChange:r=>z(r,s.slack),disabled:s.user_type==2},[(i(!0),d(M,null,q(J.value,(r,ae)=>(i(),d("option",{value:r.key,key:ae},o(r.value),9,yt))),128))],40,gt),[[j,s.status]])])]),h.value.write||h.value.delete?(i(),d("td",kt,[s.user_type==2?(i(),k(H,{key:0,permissions:h.value,onEdit:N,slack:s.slack},null,8,["permissions","slack"])):(i(),k(H,{key:1,permissions:h.value,onEdit:N,onDelete:Q,slack:s.slack},null,8,["permissions","slack"]))])):y("",!0)]))),128)):(i(),d("tr",bt,[e("td",Et,o(t.$t("No Data Found")),1)]))])])])),e("div",wt,[e("div",St,[e("div",Ct,[f(ve,{onPaginate_limit_update:W,pagination:w.value},null,8,["pagination"])]),e("div",$t,[f(b(he),{data:w.value,limit:5,onPaginationChangePage:p},null,8,["data"])])])])])]),_:1})}}};export{Ft as default};
