import{_ as le}from"./ActionButtonGroup.ogbCWQxi.js";import{_ as ne}from"./ListingSkeleton.iExoV4hO.js";import{_ as ie}from"./VSelect.UFegTIpk.js";import{u as ce,b as re,r as c,e as N,o as de,v as O,g as i,p as k,w as A,I as _e,f as T,k as g,i as e,t as o,h as d,n as E,y as ue,l as y,j as b,K as D,L as J,N as me,F as M,x as P,O as he}from"./index.7OFNPsHl.js";import{_ as pe}from"./DefaultLayout.nvkZ4UhM.js";import{_ as ve}from"./PaginateLimit.Xv-qfeqj.js";import{j as ge}from"./vue-datepicker.sD5zgpde.js";import{_ as fe}from"./ManageMenu.599_JVk3.js";import"./vee-validate.esm.N3uz7Rsk.js";/* empty css                                                                */import"./ClipLoader.1qNfpKDH.js";/* empty css                                                   */const ye={class:"content"},ke={class:"page-heading position-relative"},be={class:"row align-items-center justify-content-between mb-3"},we={class:"col-auto"},$e={class:"mb-0"},Ce={key:0,class:"col-auto"},Se={key:0,class:"attention_msg_box"},Ue=["href"],Ve={class:"row align-items-end justify-content-between mb-3"},Ne={class:"col-md-auto"},Ae={class:"row align-items-end justify-content-between g-3"},Ee={class:"col-12 col-md-auto"},De={class:"form-field"},je={class:"col-auto"},Be={class:"form-field"},Le={value:""},Ie={value:"0"},Re={value:"1"},qe={value:"2"},Fe={value:"3"},Oe={class:"col-auto"},Te={class:"col-auto col-md-auto"},Je={class:"col-auto"},Me={class:"form-field page-heading-search-field mb-0"},Pe={class:"field-icon"},ze=["placeholder"],Ge={class:"icon"},He={key:1,class:"table-responsive"},Ke={class:"table table-list-data table-hover"},We={class:"bg-light"},Ye={scope:"col",width:"20%"},Qe={scope:"col",width:"15%"},Xe={scope:"col",width:"15%"},Ze={scope:"col",width:"10%"},xe={scope:"col",width:"10%"},et={scope:"col",width:"10%"},tt={scope:"col",width:"10%"},st={scope:"col",width:"10%"},ot={key:0,scope:"col",class:"text-end",width:"5%"},at=["onClick"],lt={class:"fw-bold highlighted-list-item"},nt=e("br",null,null,-1),it={class:"text-muted"},ct=["onClick"],rt=["onClick"],dt={key:0},_t=["onClick"],ut=["onClick"],mt=["onClick"],ht=["onClick"],pt={class:"text-center"},vt={class:"form-field mb-0"},gt=["onUpdate:modelValue","id","onChange","disabled"],ft=["value"],yt={key:0,class:"text-end"},kt={key:1},bt={class:"text-center py-3",colspan:"11"},wt={class:"data-footer"},$t={class:"row align-items-center justify-content-between"},Ct={class:"col-auto"},St={class:"col-auto"},Ot={__name:"users",setup(Ut){const{t:f}=ce(),{isAuthorized:j}=_e();re();const B=c({role:f("Role"),select_role:f("Select Role")});c(!1);const z={server_messages:{type:"",messages:""},is_listing:!1,search_query:c("")},G=f("Search by name, email, phone.."),a=N({...z});de(()=>{x(),p(),W(),te()}),O(()=>a.search_query,_.debounce(()=>{p()},500));const w=c([]),$=c([]),H=c([{key:"0",value:"Inactive"},{key:"1",value:"Active"},{key:"2",value:"Hold"},{key:"3",value:"Left"}]);async function p(t=1){a.is_listing=!0,await axios.get("/api/v2/users",{params:{page:t,paginate_limit:L.value,search_query:a.search_query,filter:u}}).then(l=>{w.value=l.data.data,$.value=l.data.pagination,a.is_listing=!1}).catch(l=>{a.server_messages.type="error",a.server_messages.messages=l,a.is_listing=!1,console.log(l)})}const L=c();async function K(t){L.value=t,await p()}const I=c([]);async function W(){let t=await axios.get("api/v2/roles/all");t=t.data.data,_.forEach(t,l=>{let n={key:l.slack,value:l.name};I.value.push(n)})}async function Y(t,l){var n=new FormData;n.append("slack",l),n.append("status",t.target.value),await axios.post("/api/user/update_status",n).then(m=>{if(m.data.status_code==200)toast.success(m.data.msg);else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(m.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=m.data.msg}}).catch(m=>{a.server_messages.type="error",a.server_messages.messages=m,console.log(m)})}function v(t){router.push("/user/"+t)}function R(t){router.push("/user/edit/"+t)}async function Q(t){var l=!1;await Swal.fire({title:f("Do you want to delete this User?"),showCancelButton:!0,confirmButtonText:f("Yes, Delete"),confirmButtonColor:"#d33",cancelButtonText:f("Cancel")}).then(n=>{n.isConfirmed&&(l=!0)}),l&&await axios.post("/api/user/delete",{slack:t}).then(n=>{if(n.data.status_code==200)Swal.fire(n.data.msg),p();else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(n.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=n.data.msg}}).catch(n=>{a.server_messages.type="error",a.server_messages.messages=n,console.log(n)})}const X=c(!1),C=N({created_date:c(""),status:c(""),role:c("")}),u=N({...C}),S=c(!1);O(()=>u.role,t=>{U()});async function U(){JSON.stringify(u)!=JSON.stringify(C)&&(S.value=!0),X.value=!1,await p()}function Z(){Object.assign(u,C),S.value=!1,p()}const h=c({write:!1,delete:!1});function x(){h.value={write:j("A_WRITE_USER"),delete:j("A_DELETE_USER")}}const ee="",V=c(!1);async function te(){await axios.get("/api/user/check_addon_limit").then(t=>{V.value=t.data.data.disable_user_add}).catch(t=>{a.server_messages.type="error",a.server_messages.messages=t})}return(t,l)=>{const n=T("router-link"),m=ie,q=T("Icon"),se=ne,F=le;return i(),k(pe,null,{subheader:A(()=>[g(fe)]),default:A(()=>[e("div",ye,[e("div",ke,[e("div",be,[e("div",we,[e("h2",$e,o(t.$t("Users")),1)]),h.value.write?(i(),d("div",Ce,[g(n,{class:ue(["btn btn-sm btn-light-primary2",{disabled:V.value}]),to:"/user/add"},{default:A(()=>[E("+ "+o(t.$t("New User")),1)]),_:1},8,["class"])])):y("",!0)]),V.value?(i(),d("div",Se,[E(o(t.$t("Upgrade your subscription to add more users,"))+" ",1),e("a",{href:b(ee),target:"_blank"},[e("u",null,o(t.$t("click here")),1)],8,Ue),E(" "+o(t.$t("to see the plans.")),1)])):y("",!0),e("div",Ve,[e("div",Ne,[e("div",Ae,[e("div",Ee,[e("div",De,[e("label",null,o(t.$t("Created Date")),1),g(b(ge),{range:"",modelValue:u.created_date,"onUpdate:modelValue":[l[0]||(l[0]=s=>u.created_date=s),l[1]||(l[1]=s=>U())],format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid form-control-sm"},null,8,["modelValue"])])]),e("div",je,[e("div",Be,[e("label",null,o(t.$t("Status")),1),D(e("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":l[2]||(l[2]=s=>u.status=s),onChange:U},[e("option",Le,o(t.$t("All")),1),e("option",Ie,o(t.$t("Inactive")),1),e("option",Re,o(t.$t("Active")),1),e("option",qe,o(t.$t("Hold")),1),e("option",Fe,o(t.$t("Left")),1)],544),[[J,u.status]])])]),e("div",Oe,[g(m,{name:"role",label:B.value.role,modelValue:u.role,"onUpdate:modelValue":l[3]||(l[3]=s=>u.role=s),placeholder:B.value.select_role,options:I.value,height_sm:!0},null,8,["label","modelValue","placeholder","options"])]),e("div",Te,[S.value?(i(),d("button",{key:0,class:"btn btn-sm btn-light-danger",onClick:Z},o(t.$t("Clear")),1)):y("",!0)])])]),e("div",Je,[e("div",Me,[e("div",Pe,[D(e("input",{type:"search",class:"form-control form-control-sm form-control-solid",placeholder:b(G),"onUpdate:modelValue":l[4]||(l[4]=s=>a.search_query=s)},null,8,ze),[[me,a.search_query]]),e("div",Ge,[g(q,{icon:"fa6-solid:magnifying-glass"})])])])])])]),a.is_listing?(i(),k(se,{key:0})):(i(),d("div",He,[e("table",Ke,[e("thead",We,[e("tr",null,[e("th",Ye,o(t.$t("User Name")),1),e("th",Qe,o(t.$t("Email")),1),e("th",Xe,o(t.$t("Role")),1),e("th",Ze,o(t.$t("Phone")),1),e("th",xe,o(t.$t("Login Code")),1),e("th",et,o(t.$t("Joining Date")),1),e("th",tt,o(t.$t("Created At")),1),e("th",st,o(t.$t("Status")),1),h.value.write||h.value.delete?(i(),d("th",ot,o(t.$t("Action")),1)):y("",!0)])]),e("tbody",null,[w.value!=""?(i(!0),d(M,{key:0},P(w.value,(s,oe)=>(i(),d("tr",{key:oe},[e("td",{onClick:r=>v(s.slack),role:"button"},[e("div",null,[e("span",lt,o(s.name),1),nt,e("small",it,o(t.$t("Code"))+": "+o(s.code),1)])],8,at),e("td",{onClick:r=>v(s.slack),role:"button"},o(s.email),9,ct),e("td",{onClick:r=>v(s.slack),role:"button"},[s.role?(i(),d("span",dt,o(s.role.name),1)):y("",!0)],8,rt),e("td",{onClick:r=>v(s.slack),role:"button"},o(s.phone),9,_t),e("td",{onClick:r=>v(s.slack),role:"button"},o(s.login_code),9,ut),e("td",{onClick:r=>v(s.slack),role:"button"},o(s.joining_date),9,mt),e("td",{onClick:r=>v(s.slack),role:"button"},o(s.created_at_label),9,ht),e("td",pt,[e("div",vt,[D(e("select",{class:"form-control form-control-solid form-control-sm","onUpdate:modelValue":r=>s.status=r,name:"approval_status",id:s.slack,onChange:r=>Y(r,s.slack),disabled:s.user_type==2},[(i(!0),d(M,null,P(H.value,(r,ae)=>(i(),d("option",{value:r.key,key:ae},o(r.value),9,ft))),128))],40,gt),[[J,s.status]])])]),h.value.write||h.value.delete?(i(),d("td",yt,[s.user_type==2?(i(),k(F,{key:0,permissions:h.value,onEdit:R,slack:s.slack},null,8,["permissions","slack"])):(i(),k(F,{key:1,permissions:h.value,onEdit:R,onDelete:Q,slack:s.slack},null,8,["permissions","slack"]))])):y("",!0)]))),128)):(i(),d("tr",kt,[e("td",bt,o(t.$t("No Data Found")),1)]))])])])),e("div",wt,[e("div",$t,[e("div",Ct,[g(ve,{onPaginate_limit_update:K,pagination:$.value},null,8,["pagination"])]),e("div",St,[g(b(he),{data:$.value,limit:5,onPaginationChangePage:p},null,8,["data"])])])])])]),_:1})}}};export{Ot as default};
