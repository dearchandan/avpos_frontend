import S from"./ServerMessage.EFQMOwoZ.js";import{u as O,r as B,e as E,b as F,P as I,v as D,f as j,g as r,h as m,i as a,t as i,l as c,w as q,Q as J,K as u,F as K,N as b,m as p,x as L,p as z,j as k}from"./index.sP6fhsqN.js";import{F as P}from"./vee-validate.esm.2kXgdFia.js";import{c as Q,a as R,e as T}from"./index.esm.DHYHwGJ4.js";import{_ as M}from"./VTextInput.EPCajChY.js";import{C as G}from"./ClipLoader._89zL49D.js";import"./VTooltip.kcvohVRA.js";/* empty css                                                   */const H={class:"modal modal-lg hide",id:"addMeasurementModal",tabindex:"-1","aria-labelledby":"Add Measurement","aria-modal":"true",role:"dialog","data-bs-backdrop":"static","data-bs-keyboard":"false"},W={class:"modal-dialog modal-dialog-centered"},X={class:"modal-content"},Y={class:"modal-header"},Z={key:0,class:"modal-title"},ee={key:1,class:"modal-title"},ae={class:"modal-body"},te={class:"row"},se={class:"col-6"},ne={class:"col-6"},oe={class:"col-md-6"},ie={class:"form-field"},le={class:"form-check form-switch"},re={class:"form-check-label",for:"status"},me={class:"row pt-3"},de={class:"table table-bordered"},ce={width:"25%"},ue={width:"25%"},_e={width:""},be={width:""},pe=a("th",null,null,-1),he=a("th",null,null,-1),ve=["onUpdate:modelValue"],fe=["onUpdate:modelValue"],ge=["onUpdate:modelValue"],ye=["onUpdate:modelValue"],ke=["onClick","disabled"],Me={key:0,class:"py-3"},Ve={class:"mt-2 text-end"},$e=["disabled"],we={key:1,class:"pt-0"},Ue={key:2,class:"pt-0"},Fe={__name:"AddMeasurement",props:{show_add_measurement_modal:Boolean,edit_data:{type:[Array,Object]}},emits:["closeAddMeasurementModal"],setup(V,{emit:$}){const{t:_}=O(),h={server_messages:{type:"",messages:""},is_saving:!1,is_listing:!1,slack:"",measurement_name:"",measurement_name_ar:"",status:!0},l=B([{id:"",unit_name:"",unit_name_ar:"",abbreviation:"",abbreviation_ar:""}]),e=E({...h});F();const w=Q({measurement_name:R().required(_("name is required",{name:_("Measurement Name")})).min(3,_("name must be at least n characters",{name:_("Measurement Name"),number:3})),status:T().label("status")}),U=$,v=V;I(v,"edit_data");function f(){document.getElementById("frmMeasurement").reset(),x(),document.getElementById("close_btn").click(),U("closeAddMeasurementModal")}D(()=>v.edit_data,t=>{if(t&&(e.slack=t.slack,e.measurement_name=t.name,e.measurement_name_ar=t.name_ar,e.status=t.status==1,t.units)){l.value=[];for(var s=0;s<t.units.length;s++){let o={id:t.units[s].id,unit_name:t.units[s].unit_name,unit_name_ar:t.units[s].unit_name_ar,abbreviation:t.units[s].abbreviation,abbreviation_ar:t.units[s].abbreviation_ar};l.value.push(o)}}});async function A(){e.is_saving=!0;var t=new FormData;t.append("measurement_name",e.measurement_name),t.append("measurement_name_ar",JSON.stringify(e.measurement_name_ar)),t.append("status",e.status),t.append("measurement_units",JSON.stringify(l.value)),t.append("slack",e.slack);var s=e.slack!=""&&e.slack!=null?"/api/measurement/update":"/api/measurement/save";await axios.post(s,t).then(o=>{if(o.data.status_code==200)toast.success(o.data.msg),e.server_messages.type="",e.server_messages.messages="",e.is_saving=!1,f();else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(o.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=o.data.msg}e.is_saving=!1}}).catch(o=>{e.server_messages.type="error",e.server_messages.messages=o,e.is_saving=!1,console.log(o)})}function x(){Object.assign(e,h),l.value=[{id:"",unit_name:"",unit_name_ar:"",abbreviation:"",abbreviation_ar:""}]}function C(){let t={id:"",unit_name:"",unit_name_ar:"",abbreviation:"",abbreviation_ar:""};l.value.push(t)}function N(t){l.value.splice(l.value.indexOf(t),1)}return(t,s)=>{const o=j("Icon"),g=S;return r(),m("div",H,[a("div",W,[a("div",X,[a("div",Y,[e.slack==""||e.slack==null?(r(),m("h5",Z,i(t.$t("Add Measurement")),1)):(r(),m("h5",ee,i(t.$t("Update Measurement")),1)),a("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:f,id:"close_btn"})]),a("div",ae,[c(k(P),{"validation-schema":k(w),onSubmit:A,enctype:"multipart/form-data","initial-values":e,id:"frmMeasurement"},{default:q(()=>[a("div",te,[a("div",se,[c(M,{type:"text",name:"measurement_name",modelValue:e.measurement_name,"onUpdate:modelValue":s[0]||(s[0]=n=>e.measurement_name=n),label:"Measurement Name",required:!0},null,8,["modelValue"])]),a("div",ne,[c(M,{type:"text",name:"measurement_name_ar",modelValue:e.measurement_name_ar,"onUpdate:modelValue":s[1]||(s[1]=n=>e.measurement_name_ar=n),label:"Measurement Name (Arabic)"},null,8,["modelValue"])]),a("div",oe,[a("div",ie,[a("div",le,[u(a("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"status",checked:"","onUpdate:modelValue":s[2]||(s[2]=n=>e.status=n)},null,512),[[J,e.status]]),a("label",re,i(t.$t("Active")),1)])])])]),a("div",me,[a("table",de,[a("thead",null,[a("tr",null,[a("th",ce,i(t.$t("Measurement Unit")),1),a("th",ue,i(t.$t("Measurement Unit"))+" ("+i(t.$t("Arabic"))+")",1),a("th",_e,i(t.$t("Abbreviation")),1),a("th",be,i(t.$t("Abbreviation"))+" ("+i(t.$t("Arabic"))+")",1),pe,he])]),a("tbody",null,[(r(!0),m(K,null,L(l.value,(n,y)=>(r(),m("tr",{key:y},[a("td",null,[u(a("input",{type:"text",name:"unit_name","onUpdate:modelValue":d=>n.unit_name=d,placeholder:"Ex. Kilogram",class:"form-control form-control-solid"},null,8,ve),[[b,n.unit_name]])]),a("td",null,[u(a("input",{type:"text",name:"unit_name_ar","onUpdate:modelValue":d=>n.unit_name_ar=d,placeholder:"Ex. كيلوغرام",class:"form-control form-control-solid"},null,8,fe),[[b,n.unit_name_ar]])]),a("td",null,[u(a("input",{type:"text",name:"abbreviation","onUpdate:modelValue":d=>n.abbreviation=d,placeholder:"Ex. kg",class:"form-control form-control-solid"},null,8,ge),[[b,n.abbreviation]])]),a("td",null,[u(a("input",{type:"text",name:"abbreviation_ar","onUpdate:modelValue":d=>n.abbreviation_ar=d,placeholder:"Ex. kg",class:"form-control form-control-solid"},null,8,ye),[[b,n.abbreviation_ar]])]),a("td",null,[a("button",{class:"btn btn-icon btn-light btn-sm",onClick:d=>N(n),disabled:!(l.value.length>1)},[c(o,{icon:"material-symbols:cancel-outline-rounded",class:"text-danger"})],8,ke)]),a("td",null,[y==l.value.length-1?(r(),m("a",{key:0,href:"#",class:"btn btn-icon btn-light btn-sm",onClick:C},[c(o,{icon:"fa6-solid:plus",class:"text-primary"})])):p("",!0)])]))),128))])])]),e.server_messages.messages!=""?(r(),m("div",Me,[c(g,{server_messages:e.server_messages},null,8,["server_messages"])])):p("",!0),a("div",Ve,[a("button",{type:"submit",class:"btn btn-primary",disabled:e.is_saving},[e.is_saving?(r(),z(G,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):p("",!0),e.is_saving?(r(),m("span",we,i(t.$t("Saving...")),1)):(r(),m("span",Ue,i(t.$t("Save")),1))],8,$e)])]),_:1},8,["validation-schema","initial-values"])])])])])}}};export{Fe as default};
