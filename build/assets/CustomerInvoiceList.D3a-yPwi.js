import{_ as q}from"./PaginateLimit.Qyl6CO-f.js";import{_ as B}from"./ListingSkeleton.PW5leU6x.js";import{u as L,b as F,d as R,r as u,e as m,o as V,v as A,f as O,g as o,h as r,i as t,t as s,p as v,l,F as z,x as J,k as y,j as M,O as G}from"./index.ri7Y_V5F.js";/* empty css                                                   */const H={class:"page-heading"},K={class:"row align-items-center justify-content-between"},Q={class:"col-auto"},T={class:"mb-0"},U={class:"col-auto"},W=["disabled"],X={key:1,class:"pt-0"},Y={key:2,class:"pt-0"},Z={key:1,class:"table-responsive"},ee={class:"table table-list-data table-hover"},te={class:"bg-light"},se={scope:"col",width:"10%"},ae={scope:"col",width:"10%"},oe={scope:"col",width:"10%"},ne={scope:"col",width:"10%"},ie={scope:"col",width:"10%"},re=["onClick"],ce={key:0,class:"badge badge-primary"},le={key:1,class:"badge badge-success"},_e={key:2,class:"badge badge-warning"},de={key:3},ue={key:0,class:"badge badge-secondary"},pe={key:1,class:"badge badge-secondary"},ge={key:1},me={class:"text-center py-3",colspan:"5"},he={class:"data-footer"},ve={class:"row align-items-center justify-content-between"},ye={class:"col-auto"},be={class:"col-auto"},Ce={__name:"CustomerInvoiceList",props:["customer_slack"],setup(b){const{t:f}=L(),k=F(),w=R(()=>k.user.currency.symbol),$={server_messages:{type:"",messages:""},is_listing:!1,search_query:u("")};f("search Invoices by invoice no., reference no., amount");const n=m({...$}),x=b;V(()=>{d()}),A(()=>n.search_query,_.debounce(()=>{d()},500));function C(e){const a=router.resolve("/invoice/"+e);window.open(a.href,"_blank")}const I=m({customer:x.customer_slack,is_exporting:!1}),c=m({...I}),p=u([]),g=u([]);async function d(e=1){n.is_listing=!0,await axios.get("/api/invoices",{params:{page:e,paginate_limit:h.value,search_query:n.search_query,filter:c}}).then(a=>{p.value=a.data.data,g.value=a.data.pagination,n.is_listing=!1}).catch(a=>{n.server_messages.type="error",n.server_messages.messages=a,n.is_listing=!1,console.log(a)})}const h=u();async function P(e){h.value=e,await d()}async function N(){c.is_exporting=!0,await axios.get("/api/customer/invoices_export_excel",{params:{filter:c}}).then(e=>{if(e.data.status_code==200){c.is_exporting=!1;const a=document.createElement("a");a.target="_blank",a.href=e.data.data.file,document.body.appendChild(a),a.click()}else{try{n.server_messages.type="error",n.server_messages.messages=JSON.parse(e.data.msg)}catch{n.server_messages.type="error",n.server_messages.messages=e.data.msg}c.is_exporting=!1}}).catch(e=>{n.server_messages.type="error",n.server_messages.messages=e,c.is_exporting=!1,console.log(e)})}return(e,a)=>{const S=O("clip-loader"),E=B,D=q;return o(),r("div",null,[t("div",H,[t("div",K,[t("div",Q,[t("h5",T,s(e.$t("Invoices")),1)]),t("div",U,[t("button",{type:"button",class:"btn btn-sm btn-success",onClick:a[0]||(a[0]=i=>N()),disabled:c.is_exporting},[c.is_exporting?(o(),v(S,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):l("",!0),c.is_exporting?(o(),r("span",X,s(e.$t("Exporting...")),1)):(o(),r("span",Y,s(e.$t("Export Excel")),1))],8,W)])])]),n.is_listing?(o(),v(E,{key:0})):(o(),r("div",Z,[t("table",ee,[t("thead",te,[t("tr",null,[t("th",se,s(e.$t("Invoice No.")),1),t("th",ae,s(e.$t("Ref. Number")),1),t("th",oe,s(e.$t("Invoice Date")),1),t("th",ne,s(e.$t("Amount")),1),t("th",ie,s(e.$t("Status")),1)])]),t("tbody",null,[p.value!=""?(o(!0),r(z,{key:0},J(p.value,(i,j)=>(o(),r("tr",{key:j},[t("td",null,[t("a",{onClick:fe=>C(i.slack),href:"javascript:;"},"# "+s(i.invoice_number),9,re)]),t("td",null,s(i.reference_no>0?i.reference_no:"--"),1),t("td",null,s(i.invoice_date_label),1),t("td",null,s(i.grand_product_amount)+" "+s(w.value),1),t("td",null,[i.status==0?(o(),r("span",ce,s(e.$t("Draft")),1)):l("",!0),i.status==1?(o(),r("span",le,s(e.$t("Paid")),1)):l("",!0),i.status==2?(o(),r("span",_e,s(e.$t("Partial Paid")),1)):l("",!0),i.status==3?(o(),r("div",de,[i.returned_status==0?(o(),r("span",ue,s(e.$t("Partial Returned")),1)):l("",!0),i.returned_status==1?(o(),r("span",pe,s(e.$t("Returned")),1)):l("",!0)])):l("",!0)])]))),128)):(o(),r("tr",ge,[t("td",me,s(e.$t("No Data Found")),1)]))])])])),t("div",he,[t("div",ve,[t("div",ye,[y(D,{onPaginate_limit_update:P,pagination:g.value},null,8,["pagination"])]),t("div",be,[y(M(G),{data:g.value,limit:5,onPaginationChangePage:d},null,8,["data"])])])])])}}};export{Ce as default};
