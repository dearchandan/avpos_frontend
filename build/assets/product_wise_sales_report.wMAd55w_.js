import{u as se,b as ae,d as S,e as q,r as m,o as oe,g as h,p as C,w as y,f as A,i as e,l as p,k as B,t as s,j as t,m as E,A as N,B as P,h as g,F as ne,x as le,O as ce,I as de,bW as x,q as ie,_ as re}from"./index.li3fCRRM.js";import{D as _e}from"./DefaultLayout.saUWsTkY.js";import{_ as ue}from"./PaginateLimit.SmYeFgfo.js";import{_ as me}from"./ListingSkeleton.6NzqF9S5.js";import{_ as he}from"./VSelect.xfZK6hek.js";import{s as R,a as pe,e as ge,j as fe}from"./vue-datepicker.a6BsTEHj.js";import{s as L,e as O}from"./index.dFkrF4C6.js";import"./ClipLoader.gDBpDd3b.js";/* empty css                                                   */import"./vee-validate.esm.reM-LHjC.js";/* empty css                                                                */const ve={class:"header-nav-wrap"},ye={class:"row align-items-center"},xe={class:"col-auto"},be={class:"header-back-link"},ke={class:"col-auto"},we={class:"fw-bold"},De={class:"content"},Fe={class:"card"},$e={class:"row field-m-0 align-items-end g-3"},Ye={class:"col-md-4 col-lg-3"},Ve={class:"form-field"},Me={for:"",class:"form-label"},Se=e("span",{class:"text-danger"},"*",-1),qe=["onClick","onKeyup"],Ce={class:"col-md-4 col-lg-3"},Ae={class:"col-md-4 col-lg-3"},Be={class:"col-auto text-end"},Ee={class:"row align-items-center"},Ne={class:"col-auto"},Pe=["disabled"],Re={class:"col-auto"},Le=["disabled"],Oe={class:"card"},Te={class:""},Ie={key:0},je={key:1,class:"table-responsive"},Ke={class:"table table-list-data table-hover"},Qe={class:"bg-light"},Ue={scope:"col"},We={scope:"col"},Ge={scope:"col",class:"text-end"},Je={scope:"col",class:"text-end"},ze={scope:"col",class:"text-end"},He={scope:"col",class:"text-end"},Xe={scope:"col",class:"text-end"},Ze={scope:"col",class:"text-end"},et={scope:"col",class:"text-end"},tt={scope:"col",class:"text-end"},st={scope:"col",class:"text-end"},at={scope:"col",class:"text-end"},ot={class:"text-end"},nt={class:"text-end"},lt={class:"text-end"},ct={class:"text-end"},dt={class:"text-end"},it={class:"text-end"},rt={class:"text-end"},_t={class:"text-end"},ut={class:"text-end"},mt={class:"text-end"},ht={key:1},pt={class:"text-center py-3",colspan:"12"},gt={key:0},ft=e("th",{colspan:"2"},null,-1),vt={class:"text-end"},yt={class:"text-end"},xt={class:"text-end"},bt={class:"text-end"},kt={class:"text-end"},wt={class:"text-end"},Dt={class:"text-end"},Ft={class:"text-end"},$t={class:"text-end"},Yt={class:"text-end"},Vt={class:"data-footer"},Mt={class:"row align-items-center justify-content-between"},St={class:"col-auto"},qt={class:"col-auto"},Kt={__name:"product_wise_sales_report",setup(Ct){const{getRoundedValue:d}=de(),{t:f}=se(),D=ae(),i=S(()=>D.user.currency.symbol),T=q({server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,dates:m([new Date,new Date]),selected_branch:m(),selected_category:m(),is_exporting:!1}),n=q({...T}),I=f("Select Branch"),j=f("All Branches");f("All Products");const K=f("Select Category"),Q=f("All Categories"),U=m([{label:"Today",value:[new Date,new Date]},{label:"This month",value:[L(new Date),O(new Date)]},{label:"Last month",value:[L(R(new Date,1)),O(R(new Date,1))]},{label:"This year",value:[pe(new Date),ge(new Date)]}]);oe(()=>{W(),G()});const F=m([]);async function W(){_.forEach(D.user.branches,o=>{let a={key:o.slack,value:o.name,id:o.slack};F.value.push(a)})}const $=m([]);async function G(){let o=await axios.get("api/categories/all");o=o.data.data,_.forEach(o,a=>{let l={key:a.slack,value:a.name,id:a.slack};$.value.push(l)})}const Y=m();async function J(o){Y.value=o,await k()}const r=m([]),b=m([]);async function k(o=1){n.is_listing=!0,n.dates[0]=x(n.dates[0]).format("YYYY-MM-DD"),n.dates[1]=x(n.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/product_wise_sales_report",{params:{page:o,paginate_limit:Y.value,filter:n}}).then(a=>{r.value=a.data.data.data,b.value=a.data.pagination,n.is_listing=!1}).catch(a=>{n.server_messages.type="error",n.server_messages.messages=a,n.is_listing=!1,console.log(a)})}const u=S(()=>r.value.length?{sale_qty:r.value.reduce(function(a,l){return a+parseFloat(l.sale_qty)},0).toFixed(),sale_amount:r.value.reduce(function(a,l){return a+parseFloat(l.sale_amount)},0).toFixed(2),returned_qty:r.value.reduce(function(a,l){return a+parseFloat(l.returned_qty)},0).toFixed(),returned_amount:r.value.reduce(function(a,l){return a+parseFloat(l.returned_amount)},0).toFixed(2),discount_amount:r.value.reduce(function(a,l){return a+parseFloat(l.discount_amount)},0).toFixed(2),returned_discount_amount:r.value.reduce(function(a,l){return a+parseFloat(l.returned_discount_amount)},0).toFixed(2),tax_amount:r.value.reduce(function(a,l){return a+parseFloat(l.tax_amount)},0).toFixed(2),returned_tax_amount:r.value.reduce(function(a,l){return a+parseFloat(l.returned_tax_amount)},0).toFixed(2),net_sale_qty:r.value.reduce(function(a,l){return a+parseFloat(l.net_sale_qty)},0).toFixed(2),net_sale_amount:r.value.reduce(function(a,l){return a+parseFloat(l.net_sale_amount)},0).toFixed(2)}:null);async function z(){n.is_exporting=!0,n.dates[0]=x(n.dates[0]).format("YYYY-MM-DD"),n.dates[1]=x(n.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/product_wise_sales_report/export_excel",{params:{filter:n}}).then(o=>{if(o.data.status_code==200){n.is_exporting=!1;const a=document.createElement("a");a.target="_blank",a.href=o.data.data.file,document.body.appendChild(a),a.click()}else{try{n.server_messages.type="error",n.server_messages.messages=JSON.parse(o.data.msg)}catch{n.server_messages.type="error",n.server_messages.messages=o.data.msg}n.is_exporting=!1}}).catch(o=>{n.server_messages.type="error",n.server_messages.messages=o,n.is_exporting=!1,console.log(o)})}const H=ie(()=>re(()=>import("./ServerMessage.Re9KOdbP.js"),__vite__mapDeps([0,1,2])));return(o,a)=>{const l=A("Icon"),X=A("router-link"),V=he,Z=me,ee=ue,te=_e;return h(),C(te,null,{subheader:y(()=>[e("div",ve,[e("div",ye,[e("div",xe,[e("div",be,[p(X,{class:"text-primary",to:"/reports"},{default:y(()=>[p(l,{icon:"fa6-solid:chevron-left"}),B(" "+s(o.$t("Reports")),1)]),_:1})])]),e("div",ke,[e("h5",we,s(o.$t("Product Wise Sales Report")),1)])])])]),default:y(()=>[e("div",De,[t(n).server_messages.messages!=""?(h(),C(t(H),{key:0,class:"py-3",server_messages:t(n).server_messages},null,8,["server_messages"])):E("",!0),e("div",Fe,[e("div",$e,[e("div",Ye,[e("div",Ve,[e("label",Me,[B(s(o.$t("Select Dates"))+" ",1),Se]),p(t(fe),{range:"","preset-dates":t(U),modelValue:t(n).dates,"onUpdate:modelValue":a[0]||(a[0]=c=>t(n).dates=c),format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":y(({label:c,value:v,presetDate:w})=>[e("span",{role:"button",tabindex:0,onClick:M=>w(v),onKeyup:[N(P(M=>w(v),["prevent"]),["enter"]),N(P(M=>w(v),["prevent"]),["space"])]},s(c),41,qe)]),_:1},8,["preset-dates","modelValue"])])]),e("div",Ce,[p(V,{name:"branches",label:t(I),placeholder:t(j),text:"name",value:"id",options:t(F),modelValue:t(n).selected_branch,"onUpdate:modelValue":a[1]||(a[1]=c=>t(n).selected_branch=c)},null,8,["label","placeholder","options","modelValue"])]),e("div",Ae,[p(V,{name:"categories",label:t(K),placeholder:t(Q),text:"name",value:"id",options:t($),modelValue:t(n).selected_category,"onUpdate:modelValue":a[2]||(a[2]=c=>t(n).selected_category=c)},null,8,["label","placeholder","options","modelValue"])]),e("div",Be,[e("div",Ee,[e("div",Ne,[e("button",{class:"btn btn-primary",onClick:k,disabled:t(n).dates==null},s(o.$t("View")),9,Pe)]),e("div",Re,[e("button",{class:"btn btn-success ms-3",onClick:a[3]||(a[3]=c=>z()),disabled:t(n).dates==null},s(o.$t("Export Excel")),9,Le)])])])])]),e("div",Oe,[e("div",Te,[t(n).is_listing?(h(),g("div",Ie,[p(Z)])):(h(),g("div",je,[e("table",Ke,[e("thead",Qe,[e("tr",null,[e("th",Ue,s(o.$t("Branch")),1),e("th",We,s(o.$t("Product Name")),1),e("th",Ge,s(o.$t("Sold Qty.")),1),e("th",Je,s(o.$t("Sales Amount")),1),e("th",ze,s(o.$t("Returned Qty.")),1),e("th",He,s(o.$t("Returned Amount")),1),e("th",Xe,s(o.$t("Discount")),1),e("th",Ze,s(o.$t("Returned Discount")),1),e("th",et,s(o.$t("Tax")),1),e("th",tt,s(o.$t("Returned Tax")),1),e("th",st,s(o.$t("Net Sales Qty.")),1),e("th",at,s(o.$t("Net Sales Amount")),1)])]),e("tbody",null,[t(r)!=""?(h(!0),g(ne,{key:0},le(t(r),(c,v)=>(h(),g("tr",{key:v},[e("td",null,s(c.branch_name),1),e("td",null,s(c.product_name),1),e("td",ot,s(c.sale_qty),1),e("td",nt,s(t(d)(c.sale_amount))+" "+s(t(i)),1),e("td",lt,s(c.returned_qty),1),e("td",ct,s(t(d)(c.returned_amount))+" "+s(t(i)),1),e("td",dt,s(t(d)(c.discount_amount))+" "+s(t(i)),1),e("td",it,s(t(d)(c.returned_discount_amount))+" "+s(t(i)),1),e("td",rt,s(t(d)(c.tax_amount))+" "+s(t(i)),1),e("td",_t,s(t(d)(c.returned_tax_amount))+" "+s(t(i)),1),e("td",ut,s(c.net_sale_qty),1),e("td",mt,s(t(d)(c.net_sale_amount))+" "+s(t(i)),1)]))),128)):(h(),g("tr",ht,[e("td",pt,s(o.$t("No Data Found")),1)]))]),t(u)!=""&&t(u)!=null?(h(),g("tfoot",gt,[e("tr",null,[ft,e("th",vt,s(t(u).sale_qty),1),e("th",yt,s(t(d)(t(u).sale_amount))+" "+s(t(i)),1),e("th",xt,s(t(u).returned_qty),1),e("th",bt,s(t(d)(t(u).returned_amount))+" "+s(t(i)),1),e("th",kt,s(t(d)(t(u).discount_amount))+" "+s(t(i)),1),e("th",wt,s(t(d)(t(u).returned_discount_amount))+" "+s(t(i)),1),e("th",Dt,s(t(d)(t(u).tax_amount))+" "+s(t(i)),1),e("th",Ft,s(t(d)(t(u).returned_tax_amount))+" "+s(t(i)),1),e("th",$t,s(t(u).net_sale_qty),1),e("th",Yt,s(t(d)(t(u).net_sale_amount))+" "+s(t(i)),1)])])):E("",!0)])])),e("div",Vt,[e("div",Mt,[e("div",St,[p(ee,{onPaginate_limit_update:J,pagination:t(b)},null,8,["pagination"])]),e("div",qt,[p(t(ce),{data:t(b),limit:5,onPaginationChangePage:k},null,8,["data"])])])])])])])]),_:1})}}};export{Kt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.Re9KOdbP.js","assets/index.li3fCRRM.js","assets/index.KTHCd6a8.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
