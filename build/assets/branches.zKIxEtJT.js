import{D as X}from"./DefaultLayout.saUWsTkY.js";import{_ as Z}from"./PaginateLimit.SmYeFgfo.js";import{_ as x}from"./ActionButtonGroup.IGw_8hrL.js";import{_ as ee}from"./ListingSkeleton.6NzqF9S5.js";import{_ as te}from"./ManageMenu.CWQNPUWJ.js";import{u as se,r,e as C,b as oe,o as ae,v as ie,g as i,p as ne,w as S,I as ce,f as V,J as le,l as m,i as e,t as o,K as b,L as _e,N as de,j as v,h as n,k as A,y as re,m as h,F as ue,x as he,O as me}from"./index.li3fCRRM.js";import"./vue-datepicker.a6BsTEHj.js";import"./ClipLoader.gDBpDd3b.js";/* empty css                                                   */var pe={VITE_API_BASE_URL:"https://api.avinyadev.com",VITE_DEFAULT_LOCALE:"en",VITE_FALLBACK_LOCALE:"ar",VITE_RECAPTCHA_SITE_KEY:"6LcFHaYpAAAAAOHc3ISL-cu1Ldyg4MHCKbMKYA40",VITE_PUSHER_APP_KEY:"any-key",VITE_PUSHER_APP_CLUSTER:"mt1",VITE_PUSHER_WS_HOST:"api.avinyadev.com",VITE_PUSHER_WS_PORT:"6001",VITE_PUSHER_WSS_PORT:"6001",VITE_PUSHER_FORCE_TLS:"true",VITE_PUSHER_ENCRYPTED:"true",VITE_PUSHER_AUTH_ENDPOINT:"https://api.avinyadev.com/broadcasting/auth",VITE_USER_NODE_ENV:"production",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const ge={class:"content"},ve={class:"page-heading"},fe={class:"page-heading position-relative"},ke={class:"row align-items-center justify-content-between mb-3"},ye={class:"col-auto"},Ee={class:"mb-0"},we={class:"col col-md-auto"},Ce={class:"row align-items-center justify-content-between"},Se={class:"col col-md-auto"},be={class:"form-field mb-0"},Ae={value:""},Te={value:"1"},$e={value:"0"},Ie={class:"col col-md-auto d-none d-md-block"},Pe={class:"form-field page-heading-search-field mb-0"},Re={class:"field-icon"},Ve=["placeholder"],Le={class:"icon"},Ne={key:0,class:"col-auto"},Be={key:0,class:"attention_msg_box"},De=["href"],Oe={key:0},Ue={key:1,class:"table-responsive"},He={class:"table table-list-data table-hover"},Fe={class:"bg-light"},Me={scope:"col",width:"10%"},Ke={scope:"col",width:"20%"},qe={scope:"col",width:"15%"},We={scope:"col",width:"10%"},Ye={scope:"col",width:"10%"},je={scope:"col",width:"10%"},ze={scope:"col",width:"10%"},Ge={scope:"col",width:"10%"},Je={scope:"col",width:"10%"},Qe={key:0,scope:"col",class:"text-end",width:"5%"},Xe=["onClick"],Ze={alt:"",class:"listing-image img img-thumbnail rounded-circle"},xe=["onClick"],et={class:"fw-bold highlighted-list-item"},tt=e("br",null,null,-1),st={class:"text-muted"},ot=["onClick"],at=["onClick"],it=["onClick"],nt={key:0},ct={key:1},lt=["onClick"],_t=["onClick"],dt={key:0,class:"badge badge-success fs-11"},rt={key:1,class:"badge badge-warning fs-11"},ut=["onClick"],ht={class:"form-feild"},mt={class:"form-check form-switch form-switch-2"},pt=["onChange","checked"],gt=["onChange","checked"],vt=["onChange","checked"],ft={key:0,class:"text-end"},kt={key:1},yt={class:"text-center py-3",colspan:"11"},Et={class:"data-footer"},wt={class:"row align-items-center justify-content-between"},Ct={class:"col-auto"},St={class:"col-auto"},Bt={__name:"branches",setup(bt){const{isAuthorized:T}=ce(),{t:L}=se(),N={server_messages:{type:"",messages:""},is_listing:!1,search_query:r("")},B=L("Search by name, email, code.."),a=C({...N}),$=oe();ae(()=>{M(),g(),q()}),ie(()=>a.search_query,_.debounce(()=>{g()},500));const k=r([]),y=r([]);async function g(s=1){a.is_listing=!0,await axios.get("/api/branches",{params:{page:s,paginate_limit:I.value,search_query:a.search_query,filter:f}}).then(c=>{k.value=c.data.data,y.value=c.data.pagination,a.is_listing=!1}).catch(c=>{a.server_messages.type="error",a.server_messages.messages=c,a.is_listing=!1,console.log(c)})}const I=r();async function D(s){I.value=s,await g()}async function E(s){var c=new FormData;c.append("slack",s),await axios.post("/api/branch/update_status",c).then(d=>{if(d.data.status_code==200)toast.success(d.data.msg);else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(d.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=d.data.msg}}).catch(d=>{a.server_messages.type="error",a.server_messages.messages=d,console.log(d)})}function u(s){router.push("/branch/"+s)}function O(s){router.push("/branch/edit/"+s)}const U=r(!1),P=C({status:r("")}),f=C({...P}),H=r(!1);async function F(){JSON.stringify(f)!=JSON.stringify(P)&&(H.value=!0),U.value=!1,await g()}const p=r({write:!1,delete:!1});function M(){p.value={write:T("A_WRITE_BRANCH"),delete:T("A_DELETE_BRANCH")}}const K=pe.VITE_WEBSITE_SUBSCRIPTION_PAGE_URL,w=r(!1);async function q(){await axios.get("/api/branch/check_addon_limit").then(s=>{w.value=s.data.data.disable_branch_add}).catch(s=>{a.server_messages.type="error",a.server_messages.messages=s})}return(s,c)=>{const d=te,R=V("Icon"),W=V("router-link"),Y=ee,j=x,z=Z,G=X,J=le("lazy");return i(),ne(G,null,{subheader:S(()=>[m(d)]),default:S(()=>[e("div",ge,[e("div",ve,[e("div",fe,[e("div",ke,[e("div",ye,[e("h2",Ee,o(s.$t("Branches")),1)]),e("div",we,[e("div",Ce,[e("div",Se,[e("div",be,[b(e("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":c[0]||(c[0]=t=>f.status=t),onChange:F},[e("option",Ae,o(s.$t("Status")),1),e("option",Te,o(s.$t("Active")),1),e("option",$e,o(s.$t("Inactive")),1)],544),[[_e,f.status]])])]),e("div",Ie,[e("div",Pe,[e("div",Re,[b(e("input",{type:"search",class:"form-control form-control-sm form-control-solid",placeholder:v(B),"onUpdate:modelValue":c[1]||(c[1]=t=>a.search_query=t)},null,8,Ve),[[de,a.search_query]]),e("div",Le,[m(R,{icon:"fa6-solid:magnifying-glass"})])])])]),p.value.write?(i(),n("div",Ne,[m(W,{class:re(["btn btn-sm btn-light-primary2",{disabled:w.value}]),to:"/branch/add"},{default:S(()=>[A("+ "+o(s.$t("New Branch")),1)]),_:1},8,["class"])])):h("",!0)])])]),w.value?(i(),n("div",Be,[A(o(s.$t("Upgrade your subscription to add more branches,"))+" ",1),e("a",{href:v(K),target:"_blank"},[e("u",null,o(s.$t("click here")),1)],8,De),A(" "+o(s.$t("to see the plans.")),1)])):h("",!0)])]),a.is_listing?(i(),n("div",Oe,[m(Y)])):(i(),n("div",Ue,[e("table",He,[e("thead",Fe,[e("tr",null,[e("th",Me,o(s.$t("Logo")),1),e("th",Ke,o(s.$t("Branch Name")),1),e("th",qe,o(s.$t("Email")),1),e("th",We,o(s.$t("Phone")),1),e("th",Ye,o(s.$t("VAT")),1),e("th",je,o(s.$t("GST Number")),1),e("th",ze,o(s.$t("Default View")),1),e("th",Ge,o(s.$t("Created At")),1),e("th",Je,o(s.$t("Active")),1),p.value.write?(i(),n("th",Qe,o(s.$t("Action")),1)):h("",!0)])]),e("tbody",null,[k.value!=""?(i(!0),n(ue,{key:0},he(k.value,(t,Q)=>(i(),n("tr",{key:Q},[e("td",{onClick:l=>u(t.slack),role:"button"},[b(e("img",Ze,null,512),[[J,t.logo]])],8,Xe),e("td",{onClick:l=>u(t.slack),role:"button"},[e("div",null,[e("span",et,o(t.name),1),tt,e("small",st,o(s.$t("Code"))+": "+o(t.code),1)])],8,xe),e("td",{onClick:l=>u(t.slack),role:"button"},o(t.email),9,ot),e("td",{onClick:l=>u(t.slack),role:"button"},o(t.phone),9,at),e("td",{onClick:l=>u(t.slack),role:"button"},[t.tax_registration_name!=null?(i(),n("span",nt,o(s.$t("Vat Name"))+": "+o(t.tax_registration_name),1)):h("",!0),t.tax_registration_number!=null?(i(),n("span",ct,o(s.$t("VAT Number"))+": "+o(t.tax_registration_number),1)):h("",!0)],8,it),e("td",{onClick:l=>u(t.slack),role:"button"},o(t.gst_number),9,lt),e("td",{onClick:l=>u(t.slack),role:"button"},[t.default_view=="POS"||t.default_view=="INVENTORY"||t.default_view=="DASHBOARD"?(i(),n("span",dt,o(t.default_view),1)):h("",!0),t.default_view=="KITCHEN"||t.default_view=="WAITER"?(i(),n("span",rt,o(t.default_view),1)):h("",!0)],8,_t),e("td",{onClick:l=>u(t.slack),role:"button"},o(t.created_at_label),9,ut),e("td",null,[e("div",ht,[e("div",mt,[v($).user.login_branch!=null&&t.slack==v($).user.login_branch.slack?(i(),n("input",{key:0,class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:l=>E(t.slack),checked:t.status==1,disabled:""},null,40,pt)):p.value.write?(i(),n("input",{key:2,class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:l=>E(t.slack),checked:t.status==1},null,40,vt)):(i(),n("input",{key:1,class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:l=>E(t.slack),checked:t.status==1,disabled:""},null,40,gt))])])]),p.value.write?(i(),n("td",ft,[m(j,{permissions:p.value,onEdit:O,slack:t.slack},null,8,["permissions","slack"])])):h("",!0)]))),128)):(i(),n("tr",kt,[e("td",yt,o(s.$t("No Data Found")),1)]))])])])),e("div",Et,[e("div",wt,[e("div",Ct,[m(z,{onPaginate_limit_update:D,pagination:y.value},null,8,["pagination"])]),e("div",St,[m(v(me),{data:y.value,limit:5,onPaginationChangePage:g},null,8,["data"])])])])])]),_:1})}}};export{Bt as default};
