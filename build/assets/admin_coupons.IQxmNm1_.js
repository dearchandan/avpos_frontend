import{_ as P}from"./ActionButtonGroup.UoCDvTnh.js";import{_ as T}from"./CouponStage.PN3pbJ0Z.js";import{_ as V}from"./ListingSkeleton.PW5leU6x.js";import{u as F,b as M,r as h,e as j,o as L,v as U,g as l,p as k,w as f,I as G,f as C,i as e,t as a,h as c,k as d,n as z,l as p,K as J,N as K,j as N,F as Q,x as R,O as W}from"./index.ri7Y_V5F.js";import{_ as Y}from"./DefaultLayout.EMHfdzn0.js";import{_ as H}from"./PaginateLimit.Qyl6CO-f.js";import"./vue-datepicker.gRWbN_6J.js";import"./ClipLoader.4-rIzqtH.js";/* empty css                                                   */const X={class:"header-nav-wrap"},Z={class:"row align-items-center"},ee={class:"col-auto"},te={class:"fw-bold"},se={class:"content"},ae={class:"page-heading"},oe={class:"row align-items-center justify-content-between"},ne={class:"col-auto"},ie={class:"row align-items-center"},le={key:0,class:"col-auto"},ce={class:"col-auto"},re={class:"row align-items-center"},_e={class:"col-auto"},de={class:"form-field page-heading-search-field mb-0"},ue={class:"field-icon"},he=["placeholder"],me={class:"icon"},pe={key:1,class:"table-responsive"},ge={class:"table table-list-data table-hover"},ve={class:"bg-light"},fe={scope:"col",width:"40%"},ye={scope:"col",width:"12%"},we={scope:"col",width:"10%"},be={scope:"col",width:"10%"},ke={key:0,scope:"col",class:"text-center",width:"10%"},Ce={scope:"col",width:"10%"},Ne={class:"fw-bold highlighted-list-item"},$e={key:0},De=e("br",null,null,-1),Ae={class:"text-muted"},Be={key:0,class:"text-end"},Se={key:1},qe={class:"text-center py-3",colspan:"11"},Ie={class:"data-footer"},xe={class:"row align-items-center justify-content-between"},Ee={class:"col-auto"},Oe={class:"col-auto"},Je={__name:"admin_coupons",setup(Pe){const{t:m}=F(),{isAuthorized:y}=G();M();const $={server_messages:{type:"",messages:""},is_listing:!1,search_query:h("")},D=m("Search by name, arabic name, price.."),s=j({...$});L(()=>{q(),u()}),U(()=>s.search_query,_.debounce(()=>{u()},500));const g=h([]),v=h([]);async function u(t=1){s.is_listing=!0,await axios.get("/api/admin/coupons",{params:{page:t,paginate_limit:w.value,search_query:s.search_query}}).then(n=>{g.value=n.data.data,v.value=n.data.pagination,s.is_listing=!1}).catch(n=>{s.server_messages.type="error",s.server_messages.messages=n,s.is_listing=!1,console.log(n)})}const w=h();async function A(t){w.value=t,await u()}function B(t){router.push("/admin/coupon/edit/"+t)}async function S(t){var n=!1;await Swal.fire({title:m("Do you want to delete this item?"),showCancelButton:!0,confirmButtonText:m("Yes, Delete"),confirmButtonColor:"#d33",cancelButtonText:m("Cancel")}).then(i=>{i.isConfirmed&&(n=!0)}),n&&await axios.post("/api/admin/coupon/delete",{slack:t}).then(i=>{if(i.data.status_code==200)toast.success(i.data.msg),u();else try{s.server_messages.type="error",s.server_messages.messages=JSON.parse(i.data.msg)}catch{s.server_messages.type="error",s.server_messages.messages=i.data.msg}}).catch(i=>{s.server_messages.type="error",s.server_messages.messages=i,console.log(i)})}const r=h({write:!1,delete:!1});function q(){r.value={write:y("A_WRITE_ADMIN_COUPON"),delete:y("A_DELETE_ADMIN_COUPON")}}return(t,n)=>{const i=C("router-link"),b=C("Icon"),I=V,x=T,E=P;return l(),k(Y,null,{subheader:f(()=>[e("div",X,[e("div",Z,[e("div",ee,[e("h5",te,a(t.$t("Coupons")),1)])])])]),default:f(()=>[e("div",se,[e("div",ae,[e("div",oe,[e("div",ne,[e("div",ie,[r.value.write?(l(),c("div",le,[d(i,{class:"btn btn-sm btn-light-primary",to:"/admin/coupon/add"},{default:f(()=>[z("+ "+a(t.$t("New Coupon")),1)]),_:1})])):p("",!0)])]),e("div",ce,[e("div",re,[e("div",_e,[e("div",de,[e("div",ue,[J(e("input",{type:"search",class:"form-control form-control-sm form-control-shadow",placeholder:N(D),"onUpdate:modelValue":n[0]||(n[0]=o=>s.search_query=o)},null,8,he),[[K,s.search_query]]),e("div",me,[d(b,{icon:"fa6-solid:magnifying-glass"})])])])])])])])]),s.is_listing?(l(),k(I,{key:0})):(l(),c("div",pe,[e("table",ge,[e("thead",ve,[e("tr",null,[e("th",fe,a(t.$t("Coupon Name")),1),e("th",ye,a(t.$t("Discount")),1),e("th",we,a(t.$t("Quantity")),1),e("th",be,a(t.$t("Active Dates")),1),r.value.write&&r.value.delete?(l(),c("th",ke,a(t.$t("Status")),1)):p("",!0),e("th",Ce,a(t.$t("Action")),1)])]),e("tbody",null,[g.value!=""?(l(!0),c(Q,{key:0},R(g.value,(o,O)=>(l(),c("tr",{key:O},[e("td",null,[e("span",Ne,a(o.name),1),o.name_ar!=""&&o.name_ar!="null"?(l(),c("span",$e,[De,e("small",Ae,a(o.name_ar),1)])):p("",!0)]),e("td",null,a(o.value)+" "+a(o.type_text),1),e("td",null,a(o.quantity),1),e("td",null,a(o.start_datetime_label)+" - "+a(o.end_datetime_label),1),e("td",null,[d(x,{stage:o.stage},null,8,["stage"])]),r.value.write||r.value.delete?(l(),c("td",Be,[d(E,{permissions:r.value,onEdit:B,onDelete:S,slack:o.slack},null,8,["permissions","slack"])])):p("",!0)]))),128)):(l(),c("tr",Se,[e("td",qe,a(t.$t("No Data Found")),1)]))])])])),e("div",Ie,[e("div",xe,[e("div",Ee,[d(H,{onPaginate_limit_update:A,pagination:v.value},null,8,["pagination"])]),e("div",Oe,[d(N(W),{data:v.value,onPaginationChangePage:u},null,8,["data"])])])])])]),_:1})}}};export{Je as default};
