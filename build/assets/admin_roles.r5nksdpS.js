import{u as Y,b as H,r as i,e as w,o as Q,v as X,g as l,p as Z,w as S,I as ee,f as se,i as e,t as c,K as b,N as te,j as k,l as m,h as d,m as C,F as E,x as M,k as ae,M as B,O as oe,q as ne,_ as ie}from"./index.li3fCRRM.js";import{D as le}from"./DefaultLayout.saUWsTkY.js";import{_ as ce}from"./PaginateLimit.SmYeFgfo.js";import{_ as de}from"./ActionButtonGroup.IGw_8hrL.js";import{_ as re}from"./ListingSkeleton.6NzqF9S5.js";import"./vue-datepicker.a6BsTEHj.js";import"./ClipLoader.gDBpDd3b.js";/* empty css                                                   */const _e={class:"header-nav-wrap"},ue={class:"row align-items-center"},me={class:"col-auto"},he={class:"fw-bold"},ge={class:"content"},ve={class:"page-heading"},pe={class:"row align-items-center justify-content-between"},fe={class:"col-auto"},ye={class:"row align-items-center"},we={class:"col-auto"},be={class:"col-auto"},ke={class:"row align-items-center"},Ce={class:"col-auto"},Re={class:"form-field page-heading-search-field mb-0"},Ae={class:"field-icon"},$e=["placeholder"],De={class:"icon"},Se={class:"row py-3"},Ee={class:"col-12 text-end"},Me={key:0},Be={key:1,class:"table-responsive"},Le={class:"table table-list-data table-hover"},Ne={class:"bg-light"},xe={scope:"col",width:"60%"},Fe={scope:"col",width:"10%"},Pe={key:0,scope:"col",class:"text-end",width:"10%"},qe=["onClick"],Ie={class:"text-muted"},Te={class:"form-feild"},Oe={class:"form-check form-switch form-switch-2"},Ve=["onChange","checked"],je={key:0,class:"text-end"},Ge={key:1},Je={class:"text-center py-3",colspan:"8"},ze={class:"data-footer"},Ke={class:"row align-items-center justify-content-between"},Ue={class:"col-auto"},We={class:"col-auto"},os={__name:"admin_roles",setup(Ye){const{t:h}=Y(),{isAuthorized:R}=ee(),L=ne(()=>ie(()=>import("./AddAdminRole.AFY_NQJ9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])));H();const g=i(!1),A=i([]);function $(t=""){A.value=t,g.value=!0}function N(){g.value=!1,r()}const x={server_messages:{type:"",messages:""},is_listing:!1,search_query:i("")},F=h("Search by name..."),s=w({...x});Q(()=>{G(),r()}),X(()=>s.search_query,_.debounce(()=>{r()},500));const v=i([]),p=i([]);i(!1);async function r(t=1){s.is_listing=!0,await axios.get("/api/admin/roles",{params:{page:t,paginate_limit:D.value,search_query:s.search_query,filter:T}}).then(a=>{v.value=a.data.data,console.log("data =",a.data.data[0].role_menus_count.menu_count),p.value=a.data.pagination,s.is_listing=!1}).catch(a=>{s.server_messages.type="error",s.server_messages.messages=a,s.is_listing=!1,console.log(a)})}const D=i();async function P(t){D.value=t,await r()}async function q(t){var a=new FormData;a.append("slack",t),await axios.post("/api/admin/role/update_status",a).then(o=>{if(o.data.status_code==200)toast.success(o.data.msg);else try{s.server_messages.type="error",s.server_messages.messages=JSON.parse(o.data.msg)}catch{s.server_messages.type="error",s.server_messages.messages=o.data.msg}}).catch(o=>{s.server_messages.type="error",s.server_messages.messages=o,console.log(o)})}const I=w({dates:i(),status:i(""),created_by:i("")}),T=w({...I}),O=i(!1);function V(t){router.push("/admin/role/"+t)}async function j(t){var a=!1;await Swal.fire({title:h("Do you want to delete this role, It withdraw the permission from all users with this role?"),showCancelButton:!0,confirmButtonText:h("Yes, Delete"),confirmButtonColor:"#d33",cancelButtonText:h("Cancel")}).then(o=>{o.isConfirmed&&(a=!0)}),a&&await axios.post("/api/admin/role/delete",{slack:t}).then(o=>{if(o.data.status_code==200)toast.success(o.data.msg),r();else try{s.server_messages.type="error",s.server_messages.messages=JSON.parse(o.data.msg)}catch{s.server_messages.type="error",s.server_messages.messages=o.data.msg}}).catch(o=>{s.server_messages.type="error",s.server_messages.messages=o,console.log(o)})}const u=i({write:!1,delete:!1});function G(){u.value={write:R("A_WRITE_ROLE"),delete:R("A_DELETE_ROLE")}}return(t,a)=>{const o=se("Icon"),f=re,J=de,z=ce,K=le;return l(),Z(K,null,{subheader:S(()=>[e("div",_e,[e("div",ue,[e("div",me,[e("h5",he,c(t.$t("Roles")),1)])])])]),default:S(()=>[e("div",ge,[e("div",ve,[e("div",pe,[e("div",fe,[e("div",ye,[e("div",we,[e("a",{class:"btn btn-sm btn-light-primary","data-bs-toggle":"modal",onClick:a[0]||(a[0]=n=>$()),"data-bs-target":"#addRoleModal"},"+ "+c(t.$t("New Role")),1)])])]),e("div",be,[e("div",ke,[e("div",Ce,[e("div",Re,[e("div",Ae,[b(e("input",{type:"search",class:"form-control form-control-sm form-control-shadow",placeholder:k(F),"onUpdate:modelValue":a[1]||(a[1]=n=>s.search_query=n)},null,8,$e),[[te,s.search_query]]),e("div",De,[m(o,{icon:"fa6-solid:magnifying-glass"})])])])])])])]),e("div",Se,[e("div",Ee,[O.value?(l(),d("button",{key:0,class:"badge badge-danger btn-sm",onClick:a[2]||(a[2]=(...n)=>t.clearFilter&&t.clearFilter(...n))},c(t.$t("Clear Filters")),1)):C("",!0)])])]),s.is_listing?(l(),d("div",Me,[m(f)])):(l(),d("div",Be,[e("table",Le,[e("thead",Ne,[e("tr",null,[e("th",xe,c(t.$t("Role")),1),e("th",Fe,c(t.$t("Active")),1),u.value.write&&u.value.delete?(l(),d("th",Pe,c(t.$t("Action")),1)):C("",!0)])]),e("tbody",null,[v.value!=""?(l(!0),d(E,{key:0},M(v.value,(n,U)=>(l(),d("tr",{key:U},[e("td",{role:"button","data-bs-toggle":"modal","data-bs-target":"#viewRoleModal",onClick:y=>V(n.slack)},[e("h6",null,[ae(c(n.name)+" ",1),b(e("label",{class:"text-muted small"}," ("+c(n.role_menus_count.menu_count)+" "+c(t.$t("Permissions"))+")",513),[[B,n.role_menus_count!=""]])]),b(e("span",Ie,[(l(!0),d(E,null,M(n.main_menu_access,(y,W)=>(l(),d("label",{key:W,class:"me-2"},c(y.name)+", ",1))),128))],512),[[B,n.main_menu_access!=""]])],8,qe),e("td",null,[e("div",Te,[e("div",Oe,[e("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:y=>q(n.slack),checked:n.status==1},null,40,Ve)])])]),u.value.write&&u.value.delete?(l(),d("td",je,[m(J,{permissions:u.value,onDelete:j,slack:n.slack,onEditModal:$,edit_modal_data:n,edit_modal_target:"#addRoleModal"},null,8,["permissions","slack","edit_modal_data"])])):C("",!0)]))),128)):(l(),d("tr",Ge,[e("td",Je,c(t.$t("No Data Found")),1)]))])])])),e("div",ze,[e("div",Ke,[e("div",Ue,[m(z,{onPaginate_limit_update:P,pagination:p.value},null,8,["pagination"])]),e("div",We,[m(k(oe),{data:p.value,limit:5,onPaginationChangePage:r},null,8,["data"])])])])]),m(k(L),{show_add_role_modal:g.value,onCloseAddRoleModal:N,edit_data:A.value},null,8,["show_add_role_modal","edit_data"])]),_:1})}}};export{os as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/AddAdminRole.AFY_NQJ9.js","assets/ServerMessage.Re9KOdbP.js","assets/index.li3fCRRM.js","assets/index.KTHCd6a8.css","assets/vee-validate.esm.reM-LHjC.js","assets/index.esm.e6McCFlz.js","assets/VTextInput.pcaNaUkX.js","assets/VTooltip.pHzwBjkF.js","assets/ClipLoader.gDBpDd3b.js","assets/ClipLoader.7xz7y6gZ.css","assets/global.NAtoPKoY.js","assets/BeatLoader.5j6ku4bW.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
