import{u as ne,a as ie,r as b,b as re,d as F,e as ue,s as ce,o as de,g as c,p as w,w as A,f as M,i as l,l as i,k as U,t as u,j as d,h as m,m as V,K as y,M as g,F as _e,x as pe,Q as me,q as ve,_ as be}from"./index.sP6fhsqN.js";import{D as ye}from"./DefaultLayout.K5Bh9Jz_.js";import{_ as he}from"./EditFormSkeleton.Ez20ofO9.js";import{_ as fe}from"./VSelectInput.rvOuFTIX.js";import{_ as ge}from"./VTextInput.EPCajChY.js";import{a as P,F as Ve}from"./vee-validate.esm.2kXgdFia.js";import{c as xe,a as S,e as ke}from"./index.esm.DHYHwGJ4.js";import{C as Se}from"./ClipLoader._89zL49D.js";import{u as we}from"./global.AEIEVpKW.js";import"./VTooltip.kcvohVRA.js";/* empty css                                                   */const Ae={class:"header-nav-wrap"},Ue={class:"row align-items-center"},Te={class:"col-auto"},Ne={class:"header-back-link"},qe={class:"col-auto"},De={key:0,class:"fw-bold"},Pe={key:1,class:"fw-bold"},Ce={key:0,class:"content"},$e={class:"row card-strash"},Ee={class:"col-md-12"},Ie={class:"row"},Oe={class:"col-md-12 mb-4"},Fe={class:"card"},Me={class:"row"},Ye={class:"section-title pb-3 text-muted"},Le={class:"col-6"},Be={class:"col-6"},We={class:"col-3"},Ge={class:"col-3"},Re={class:"col-3"},je={class:"col-3"},Je={class:"col-12"},ze={class:"row"},He={class:"col-3"},Ke={key:0,class:"col-3"},Qe={class:"col-3"},Xe={class:"col-3"},Ze={class:"col-3"},ea={class:"col-2"},aa={class:"col-2"},ta={class:"col-2"},sa={class:"col-2"},la={class:"col-2"},oa={class:"col-2"},na={class:"col-3"},ia={class:"form-field mt-2"},ra={class:"form-check form-switch"},ua={class:"form-check-label",for:"status"},ca=l("em",null,"*",-1),da={class:"col-md-12 mb-4"},_a={class:"card"},pa={class:"row"},ma={class:"section-title pb-3 text-muted"},va={key:0,class:"card p-5 form-check"},ba={class:"form-check-label mb-0 mt-3"},ya=["onUpdate:modelValue","checked","value","id"],ha={class:"text-primary text-uppercase"},fa={class:"text-muted"},ga={key:0},Va={key:1},xa={key:1,class:"card p-5 my-2"},ka={class:"form-check-label mb-0 mt-3"},Sa={class:"text-primary text-uppercase"},wa={class:"text-muted mb-0"},Aa={class:"mt-3"},Ua={key:0},Ta={key:1},Na={class:"col-md-12 mb-4"},qa={class:"card"},Da={class:"row"},Pa={class:"section-title pb-3 text-muted"},Ca={class:"col-md-6"},$a={class:"col-md-6"},Ea=l("input",{type:"hidden",name:"slack"},null,-1),Ia={class:"text-end"},Oa=["disabled"],Fa={key:1,class:"pt-0"},Ma={key:2,class:"pt-0"},Za={__name:"add_master_subscription",props:["action"],setup(Y){const{t:o}=ne(),h=ie().params.slack;b([]);const r=b({name:o("Subscription Name"),name_ar:o("Subscription Name (Arabic)"),subscription_category:o("Subscription Category"),device_type:o("Device Type"),subscription_for:o("Subscription For"),select_country:o("Select Country"),is_trial:o("Is Trial Subscription"),trial_days:o("Trial Days"),price_type:o("Price Type"),price:o("Price"),tax_name:o("Tax Name"),tax_percentage:o("Tax(%)"),discount_name:o("Discount Name"),discount_type:o("Discount Type"),discount_value:o("Discount Amount"),payable_amount:o("Payable Amount"),description:o("Description"),description_ar:o("Description (Arabic)"),subscription_tenure:o("Subscription Tenure"),tax_amount:o("Tax Amount"),offer_name:o("Offer Name"),strike_through_price:o("Strike Through Price")}),L=ve(()=>be(()=>import("./ServerMessage.EFQMOwoZ.js"),__vite__mapDeps([0,1,2]))),B=re(),C=F(()=>B.user.currency.symbol),f=ue({type:"",messages:""}),t=b({is_submitting:!1,name:"",name_ar:"",subscription_category:1,device_type:1,subscription_for:1,country_id:"",is_trial:0,trial_days:7,price_type:1,price:"",tax_name:"VAT",tax_percentage:"15",tax_amount:"",discount_name:"",discount_type:"",discount_value:"",payable_amount:0,status:!0,description:"",description_ar:"",subscription_tenure:"",offer_name:"",strike_through_price:"",slack:""}),x=b([]),{device_types:W,subscription_fors:G,price_types:R,discount_types:La,subscription_categories:j}=we(),J=b([{id:0,name:"No"},{id:1,name:"Yes"}]);ce(Multiselect);const z=xe({name:S().required(o("name is required",{name:o("Subscription Name")})).min(3,o("name must be at least n characters",{name:o("Subscription Name"),number:3})),name_ar:S().required(o("name is required",{name:o("Subscription Name Ar")})).min(3,o("name must be at least n characters",{name:o("Subscription Name Ar"),number:3})),country_id:S().required(o("name is required",{name:o("Country")})),payable_amount:S().nullable().when("is_trial",{is:a=>a==!1,then:a=>a.required(o("Payable Amount is required",{name:o("Payable Amount")})),otherwise:a=>a.nullable()}),tax_name:S().nullable().when("price_type",{is:a=>a==2,then:a=>a.required(o("Tax Name is required",{name:o("Tax Name")})),otherwise:a=>a.nullable()}),tax_percentage:S().nullable().when("price_type",{is:a=>a==2,then:a=>a.required(o("Tax Percentage is required",{name:o("Tax Percentage")})),otherwise:a=>a.nullable()}),status:ke().label("status")});de(()=>{K(),X(),_.isUndefined(h)||H()});const $=b(!1);async function H(){let a=await axios.get("/api/subscription_detail/"+h);t.value=a.data.data,t.value.country_id=a.data.data.country.slack,t.value.description=a.data.data.description!=null?a.data.data.description:"",t.value.description_ar=a.data.data.description_ar!=null?a.data.data.description_ar:"",a.data.data.addons!=null&&(x.value=[],_.forEach(I.value,e=>{var v="";_.forEach(a.data.data.addons,n=>{n.addon_master_id==e.id&&(v=e.value_type==1?n.limit_value:!0)});let p={id:e.id,constant_name:e.constant_name,name:e.name,name_ar:e.name_ar,description:e.description,type:e.type,value_type:e.value_type,price:e.price,status:e.status,value:v};x.value.push(p),E()})),$.value=!0}const T=b(!1),N=b(!1);function E(){const a=x.value,e=a.find(n=>n.constant_name==="POS"&&n.value===!0),v=a.find(n=>n.constant_name==="INVOICING"&&n.value===!0),p=a.find(n=>n.constant_name==="WOSUL_EASY"&&n.value===!0);e||v?T.value=!0:T.value=!1,p?N.value=!0:N.value=!1}b([]);const I=b([]);async function K(){await axios.get("/api/subscription_addons").then(a=>{I.value=a.data,_.forEach(a.data,e=>{let v={id:e.id,constant_name:e.constant_name,name:e.name,name_ar:e.name_ar,description:e.description,type:e.type,value_type:e.value_type,price:e.price,status:e.status,value:""};x.value.push(v)})})}const Q=Y;F(()=>!_.isUndefined(Q.action));const O=b([]);async function X(){await axios.get("/api/countries").then(a=>{_.forEach(a.data.data,e=>{O.value.push({id:e.slack,name:e.name})})}).catch(a=>{f.type="error",f.messages=a,t.value.is_submitting=!1})}async function Z(a){t.value.is_submitting=!0;var e=new FormData;e.append("name",a.name),e.append("name_ar",a.name_ar),e.append("subscription_category",a.subscription_category),e.append("device_type",a.device_type),e.append("subscription_for",a.subscription_for),e.append("country_id",a.country_id),e.append("is_trial",a.is_trial),e.append("trial_days",a.trial_days),e.append("price_type",a.price_type),e.append("price",a.price),e.append("tax_name",a.tax_name),e.append("subscription_tenure",a.subscription_tenure),e.append("offer_name",a.offer_name!=null&&a.offer_name!="undefined"?a.offer_name:""),e.append("strike_through_price",a.strike_through_price!=null&&a.strike_through_price!="undefined"?a.strike_through_price:""),e.append("tax_percentage",a.tax_percentage!=null&&a.tax_percentage!="undefined"?a.tax_percentage:0),e.append("discount_name",a.discount_name!=null&&a.discount_name!="undefined"?a.discount_name:""),e.append("discount_type",a.discount_type!=null&&a.discount_type!="undefined"?a.discount_type:0),e.append("discount_value",a.discount_value),e.append("payable_amount",a.payable_amount),e.append("status",a.status),e.append("description",a.description),e.append("description_ar",a.description_ar),e.append("addons",JSON.stringify(x.value)),e.append("slack",h);var v=h!=""&&h!=null?"/api/subscription/update":"/api/subscription/save";await axios.post(v,e,{headers:{"Content-Type":"multipart/form-data"}}).then(p=>{if(p.data.status_code==200)toast.success(p.data.msg),t.value.is_submitting=!1,ee(),router.push("/master_subscriptions");else{try{f.type="error",f.messages=JSON.parse(p.data.msg)}catch{f.type="error",f.messages=p.data.msg}t.value.is_submitting=!1}}).catch(p=>{f.type="error",f.messages=p,t.value.is_submitting=!1})}function ee(){Object.assign(t,t)}function q(){var a=t.value.payable_amount,e=t.value.tax_percentage,v=a/(e/100+1),p=a-parseFloat(v);t.value.tax_amount=p.toFixed(2),t.value.price=v.toFixed(2)}return(a,e)=>{const v=M("Icon"),p=M("router-link"),n=ge,k=fe,ae=he,te=ye;return c(),w(te,null,{subheader:A(()=>[l("div",Ae,[l("div",Ue,[l("div",Te,[l("div",Ne,[i(p,{class:"text-primary",to:"/master_subscriptions"},{default:A(()=>[i(v,{icon:"fa6-solid:chevron-left"}),U(" "+u(a.$t("Subscriptions")),1)]),_:1})])]),l("div",qe,[d(h)==""||d(h)==null?(c(),m("h5",De,u(a.$t("Add Subscription")),1)):(c(),m("h5",Pe,u(a.$t("Edit Subscription")),1))])])])]),default:A(()=>[d(h)==""||d(h)==null||d(h)!=""&&$.value?(c(),m("div",Ce,[i(d(Ve),{"validation-schema":d(z),onSubmit:Z,enctype:"multipart/form-data","initial-values":t.value},{default:A(({setFieldValue:se,values:le})=>[l("div",$e,[f.messages!=""?(c(),w(d(L),{key:0,class:"py-3",server_messages:f},null,8,["server_messages"])):V("",!0),l("div",Ee,[l("div",Ie,[l("div",Oe,[l("div",Fe,[l("div",Me,[l("h5",Ye,u(a.$t("Basic Details"))+": ",1),l("div",Le,[i(n,{type:"text",name:"name",label:r.value.name,required:!0,modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=s=>t.value.name=s)},null,8,["label","modelValue"])]),l("div",Be,[i(n,{type:"text",name:"name_ar",label:r.value.name_ar,modelValue:t.value.name_ar,"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.name_ar=s),required:""},null,8,["label","modelValue"])]),l("div",We,[i(k,{name:"subscription_category",label:r.value.subscription_category,required:"",options:d(j),modelValue:t.value.subscription_category,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.subscription_category=s),tooltip:"Plan: POS Package, Service: Wosul Pay "},null,8,["label","options","modelValue"])]),l("div",Ge,[i(k,{name:"device_type",label:r.value.device_type,required:"",options:d(W),modelValue:t.value.device_type,"onUpdate:modelValue":e[3]||(e[3]=s=>t.value.device_type=s)},null,8,["label","options","modelValue"])]),l("div",Re,[i(k,{name:"subscription_for",label:r.value.subscription_for,required:"",options:d(G),modelValue:t.value.subscription_for,"onUpdate:modelValue":e[4]||(e[4]=s=>t.value.subscription_for=s)},null,8,["label","options","modelValue"])]),l("div",je,[i(k,{name:"country_id",label:r.value.select_country,required:"",options:O.value,modelValue:t.value.country_id,"onUpdate:modelValue":e[5]||(e[5]=s=>t.value.country_id=s)},null,8,["label","options","modelValue"])]),l("div",Je,[l("div",ze,[l("div",He,[i(k,{modelValue:t.value.is_trial,"onUpdate:modelValue":e[6]||(e[6]=s=>t.value.is_trial=s),name:"is_trial",label:r.value.is_trial,required:"",options:J.value},null,8,["modelValue","label","options"])]),t.value.is_trial?(c(),m("div",Ke,[i(n,{type:"number",name:"trial_days",label:r.value.trial_days,modelValue:t.value.trial_days,"onUpdate:modelValue":e[7]||(e[7]=s=>t.value.trial_days=s)},null,8,["label","modelValue"])])):V("",!0),y(l("div",Qe,[i(n,{type:"number",name:"subscription_tenure",label:r.value.subscription_tenure,modelValue:t.value.subscription_tenure,"onUpdate:modelValue":e[8]||(e[8]=s=>t.value.subscription_tenure=s)},null,8,["label","modelValue"])],512),[[g,!t.value.is_trial]]),y(l("div",Xe,[i(n,{type:"text",name:"offer_name",label:r.value.offer_name,modelValue:t.value.offer_name,"onUpdate:modelValue":e[9]||(e[9]=s=>t.value.offer_name=s)},null,8,["label","modelValue"])],512),[[g,!t.value.is_trial]]),y(l("div",Ze,[i(n,{type:"number",name:"strike_through_price",label:r.value.strike_through_price,modelValue:t.value.strike_through_price,"onUpdate:modelValue":e[10]||(e[10]=s=>t.value.strike_through_price=s)},null,8,["label","modelValue"])],512),[[g,!t.value.is_trial]]),y(l("div",ea,[i(k,{modelValue:t.value.price_type,"onUpdate:modelValue":e[11]||(e[11]=s=>t.value.price_type=s),name:"price_type",label:r.value.price_type,required:"",options:d(R),onChange:q,disabled:!0},null,8,["modelValue","label","options"])],512),[[g,!t.value.is_trial]]),y(l("div",aa,[i(n,{type:"number",name:"price",label:r.value.price,modelValue:t.value.price,"onUpdate:modelValue":e[12]||(e[12]=s=>t.value.price=s),readonly:""},null,8,["label","modelValue"])],512),[[g,!t.value.is_trial]]),y(l("div",ta,[i(n,{type:"text",name:"tax_name",label:r.value.tax_name,modelValue:t.value.tax_name,"onUpdate:modelValue":e[13]||(e[13]=s=>t.value.tax_name=s),readonly:""},null,8,["label","modelValue"])],512),[[g,!t.value.is_trial]]),y(l("div",sa,[i(n,{type:"number",name:"tax_percentage",label:r.value.tax_percentage,modelValue:t.value.tax_percentage,"onUpdate:modelValue":e[14]||(e[14]=s=>t.value.tax_percentage=s),onInput:q,readonly:""},null,8,["label","modelValue"])],512),[[g,!t.value.is_trial]]),y(l("div",la,[i(n,{type:"number",name:"tax_amount",label:r.value.tax_amount,modelValue:t.value.tax_amount,"onUpdate:modelValue":e[15]||(e[15]=s=>t.value.tax_amount=s),readonly:""},null,8,["label","modelValue"])],512),[[g,!t.value.is_trial]]),y(l("div",oa,[i(n,{type:"number",name:"payable_amount",label:r.value.payable_amount,modelValue:t.value.payable_amount,"onUpdate:modelValue":e[16]||(e[16]=s=>t.value.payable_amount=s),onInput:q,required:""},null,8,["label","modelValue"])],512),[[g,!t.value.is_trial]])])]),l("div",na,[l("div",ia,[l("div",ra,[i(d(P),{class:"form-check-input me-2",type:"checkbox",role:"switch",name:"status",id:"status","unchecked-value":!1,value:le.status,onChange:s=>se("status",s.target.checked)},null,8,["value","onChange"]),l("label",ua,[U(u(a.$t("Active"))+" ",1),ca])])])])])])]),l("div",da,[l("div",_a,[l("div",pa,[l("h5",ma,u(a.$t("Addons")),1),(c(!0),m(_e,null,pe(x.value,(s,oe)=>y((c(),m("div",{class:"col-md-3 my-2",key:oe},[s.value_type==2?(c(),m("div",va,[l("label",ba,[y(l("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":D=>s.value=D,checked:s.value,value:s.id,id:s.constant_name,onChange:E},null,40,ya),[[me,s.value]]),l("h6",ha,u(s.name),1),l("p",fa,u(s.description),1),l("h6",null,[U(u(s.price)+" "+u(C.value)+" ",1),s.type==1?(c(),m("small",ga,"/Month ")):V("",!0),s.type==2?(c(),m("small",Va,"/Year ")):V("",!0)])])])):V("",!0),s.value_type==1?(c(),m("div",xa,[l("label",ka,[l("h6",Sa,u(s.name),1),l("p",wa,u(s.description),1),i(n,{type:"number",name:s.constant_name,modelValue:s.value,"onUpdate:modelValue":D=>s.value=D,class:"mb-0",input_group_text:s.constant_name=="BRANCH_LIMIT"?"/Branch":"/User"},null,8,["name","modelValue","onUpdate:modelValue","input_group_text"]),l("h6",Aa,[U(u(s.price)+" "+u(C.value)+" ",1),s.type==1?(c(),m("small",Ua,"/Month ")):V("",!0),s.type==2?(c(),m("small",Ta,"/Year ")):V("",!0)])])])):V("",!0)])),[[g,s.value_type==1||s.value_type==2&&s.constant_name!="PAYMENT_GATEWAY"&&s.constant_name!="WOSUL_PAY"||s.constant_name=="PAYMENT_GATEWAY"&&T.value==!0||s.constant_name=="WOSUL_PAY"&&N.value==!0]])),128))])])]),l("div",Na,[l("div",qa,[l("div",Da,[l("h5",Pa,u(a.$t("Optional Details")),1),l("div",Ca,[l("label",null,u(a.$t("Description")),1),i(d(P),{as:"textarea",class:"form-control form-control-solid p-3",name:"description",label:r.value.description,cols:"3",rows:"2",modelValue:t.value.description,"onUpdate:modelValue":e[17]||(e[17]=s=>t.value.description=s)},null,8,["label","modelValue"])]),l("div",$a,[l("label",null,u(a.$t("Description (Arabic)")),1),i(d(P),{as:"textarea",class:"form-control form-control-solid p-3",name:"description_ar",label:r.value.description_ar,cols:"3",rows:"2",modelValue:t.value.description_ar,"onUpdate:modelValue":e[18]||(e[18]=s=>t.value.description_ar=s)},null,8,["label","modelValue"])]),Ea])])])])])]),l("div",Ia,[l("button",{type:"submit",class:"btn btn-primary",disabled:t.value.is_submitting},[t.value.is_submitting?(c(),w(Se,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):V("",!0),t.value.is_submitting?(c(),m("span",Fa,u(a.$t("Saving...")),1)):(c(),m("span",Ma,u(a.$t("Save")),1))],8,Oa)])]),_:1},8,["validation-schema","initial-values"])])):(c(),w(ae,{key:1}))]),_:1})}}};export{Za as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.EFQMOwoZ.js","assets/index.sP6fhsqN.js","assets/index.KTHCd6a8.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
