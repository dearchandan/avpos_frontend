import{_ as H}from"./EditFormSkeleton.hbjdnq7m.js";import{_ as K}from"./VCodeGenerateTextInput.2xWesVom.js";import Q from"./ServerMessage.I5ol-gtz.js";import{u as W,a as X,r as h,e as Y,o as Z,v as ee,g as i,p as b,w as y,f as j,J as ae,i as s,k as d,n as se,t as m,j as c,h as p,l as x,K as w,L as te,F as oe,x as le,Q as M,B as ne,bW as k}from"./index.7OFNPsHl.js";import{_ as ie}from"./DefaultLayout.nvkZ4UhM.js";import{F as de}from"./vee-validate.esm.N3uz7Rsk.js";import{c as N,a as v}from"./index.esm.cd1bITNA.js";import{_ as g}from"./VTextInput.VtSvZjuc.js";import{C as re}from"./ClipLoader.1qNfpKDH.js";import{_ as A}from"./VSelect.UFegTIpk.js";import"./VTooltip.n3SV8A0p.js";/* empty css                                                   *//* empty css                                                                */const me={class:"header-nav-wrap"},ce={class:"row align-items-center"},_e={class:"col-auto"},ue={class:"header-back-link"},pe={class:"col-auto"},ge={key:0,class:"fw-bold"},ve={key:1,class:"fw-bold"},fe={key:0,class:"content"},he={class:"row card-strash"},be={key:0,class:"py-3"},ye={class:"col-md-12"},we={class:"row"},ke={class:"col-md-12 mb-4"},Ve={class:"card"},Ce={class:"row"},Ue={class:"col-md-3"},Se={class:"col-md-3"},qe={class:"form-field"},$e={class:"form-label"},je=["value"],xe={class:"col-md-3"},Me={class:"col-md-3"},Ne={class:"col-md-3"},Ae={class:"col-md-3"},Fe={class:"col-md-3 pt-2"},De={class:"form-field pt-2"},Ee={class:"form-check form-switch pt-4"},Le={class:"form-check-label",for:"multi_session_login"},Pe={class:"col-md-3 pt-2"},Te={class:"form-field pt-2"},Be={class:"form-check form-switch pt-4"},Re={class:"form-check-label",for:"allow_adding_merchants"},Ie={class:"col-md-3"},Oe={class:"form-field"},Je={class:"d-flex flex-column gap-2"},Ge=s("span",{class:"fw-semibold"},"UTM Campaign Code",-1),ze={class:"p-3 bg-light d-flex justify-content-between align-items-center"},He={class:"text-dark"},Ke={class:"col-md-12 mb-4"},Qe={class:"card"},We={class:"row"},Xe={class:"col-md-3"},Ye={class:"col-md-3"},Ze={class:"col-md-3"},ea={class:"col-md-3"},aa={class:"col-md-3"},sa={class:"col-md-3"},ta={class:"label"},oa={class:"input-group input-file-group"},la={class:"btn btn-light-primary min-width-0 mb-0",for:"formFile"},na={class:"text-end"},ia=["disabled"],da={key:1,class:"pt-0"},ra={key:2,class:"pt-0"},Sa={__name:"add_sub_admin_user",setup(ma){const{t}=W(),u=X().params.slack,r=h({name:t("Name"),email:t("Email"),password:t("Password"),phone:t("Phone"),status:t("Status"),multi_session_login:t("Multi-Device Login"),allow_adding_merchants:t("Allow Adding Merchants"),select_status:t("Select Status"),date_of_birth:t("Date Of Birth"),date_of_anniversary:t("Date Of Anniversary"),joining_date:t("Date Of Joining"),login_code:t("Login Code"),role:t("Role"),select_role:t("Select Role")}),e=Y({...{server_messages:{type:"",messages:""},is_submitting:!1,name:"",email:"",password:"",status:"",multi_session_login:"",allow_adding_merchants:"",login_code:"",phone:"",date_of_birth:"",date_of_anniversary:"",joining_date:"",image:"",user_slack:"",password_dummy:"123456789",country:"",role:""}});let V=N({name:v().required(t("name is required",{name:t("Name")})).min(3,t("name must be at least n characters",{name:t("Name"),number:3})),email:v().required(t("name is required",{name:t("Email")})).email(t("must be a valid email",{name:t("Email")})),password:v().required(t("name is required",{name:t("Password")})).min(8,t("name must be at least n characters",{name:t("Password"),number:8}))});const C=h([]),F=[{key:"0",value:t("Inactive")},{key:"1",value:t("Active")},{key:"2",value:t("Hold")},{key:"3",value:t("Left")}],U=h([]),S=h([]);Z(()=>{E(),D(),_.isUndefined(u)||L()}),ee(()=>{U.value&&(V=N({name:v().required(t("name is required",{name:t("Name")})).min(3,t("name must be at least n characters",{name:t("Name"),number:3})),email:v().required(t("name is required",{name:t("Email")})).email(t("must be a valid email",{name:t("Email")})),role:v().required(t("name is required",{name:t("Role")}))}))});async function D(){let a=await axios.get("api/admin/roles/all");a=a.data.data,_.forEach(a,o=>{let n={key:o.slack,value:o.name};C.value.push(n)})}async function E(){await axios.get("/api/countries/all").then(a=>{if(a.data.status_code==200)S.value=a.data.data;else try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(a.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=a.data.msg}}).catch(a=>{e.server_messages.type="error",e.server_messages.messages=a,console.log(a)})}const q=h(!1);async function L(){let a=await axios.get("/api/sub_admin",{params:{slack:u}});U.value=a.data.data,a.data.data&&(e.user_slack=a.data.data.slack,e.name=a.data.data.name,e.email=a.data.data.email,e.role=a.data.data.role?a.data.data.role.slack:"",e.status=a.data.data.status,e.multi_session_login=a.data.data.multi_session_login,e.allow_adding_merchants=a.data.data.allow_adding_merchants,e.login_code=a.data.data.login_code,e.date_of_anniversary=a.data.data.date_of_anniversary,e.date_of_birth=a.data.data.date_of_birth,e.phone=a.data.data.phone,e.joining_date=a.data.data.joining_date,e.password_dummy="123456789",e.country=a.data.data.country_slack,e.utm_campaign_code=a.data.data.utm_campaign_code),q.value=!0}function P(){let a="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$*",n=o.length;for(let f=0;f<10;f++)a+=o.charAt(Math.floor(Math.random()*n));e.password=a}async function T(){let a=await axios.post("api/user/generate_login_code");e.login_code=a.data.data.login_code}async function B(a){e.image=a.target.files[0]}async function R(){e.is_submitting=!0;var a=new FormData;a.append("name",e.name),a.append("email",e.email),a.append("password",e.password),a.append("country",e.country),a.append("role",e.role),a.append("status",e.status),a.append("multi_session_login",e.multi_session_login),a.append("allow_adding_merchants",e.allow_adding_merchants),a.append("login_code",e.login_code),a.append("phone",e.phone),a.append("date_of_birth",e.date_of_birth),a.append("date_of_anniversary",e.date_of_anniversary),a.append("joining_date",e.joining_date),a.append("image",e.image),a.append("user_slack",e.user_slack);var o=e.user_slack!=""&&e.user_slack!=null?"/api/sub_admin/update":"/api/sub_admin/save";await axios.post(o,a,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{if(n.data.status_code==200)k.success(n.data.msg),e.is_submitting=!1,router.push("/admin/users");else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(n.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=n.data.msg}e.is_submitting=!1}}).catch(n=>{e.server_messages.type="error",e.server_messages.messages=n,e.is_submitting=!1,console.log(n)})}function I(a){if(!a){k.warn("No UTM Campaign Code to copy!",{autoClose:2e3});return}navigator.clipboard.writeText(a).then(()=>{k.success("Copied to clipboard!",{autoClose:2e3})}).catch(()=>{k.error("Failed to copy!",{autoClose:2e3})})}return(a,o)=>{const n=j("Icon"),f=j("router-link"),O=Q,$=K,J=H,G=ae("tippy");return i(),b(ie,null,{subheader:y(()=>[s("div",me,[s("div",ce,[s("div",_e,[s("div",ue,[d(f,{class:"text-primary",to:"/admin/users"},{default:y(()=>[d(n,{icon:"fa6-solid:chevron-left"}),se(" "+m(a.$t("Sub Admins")),1)]),_:1})])]),s("div",pe,[c(u)==""||c(u)==null?(i(),p("h5",ge,m(a.$t("Add Sub Admin")),1)):(i(),p("h5",ve,m(a.$t("Edit Sub Admin")),1))])])])]),default:y(()=>[c(u)==""||c(u)==null||c(u)!=""&&q.value?(i(),p("div",fe,[d(c(de),{"validation-schema":c(V),"initial-values":e,onSubmit:R,enctype:"multipart/form-data"},{default:y(()=>[s("div",he,[e.server_messages.messages!=""?(i(),p("div",be,[d(O,{server_messages:e.server_messages},null,8,["server_messages"])])):x("",!0),s("div",ye,[s("div",we,[s("div",ke,[s("div",Ve,[s("div",Ce,[s("div",Ue,[d(g,{type:"text",name:"name",modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=l=>e.name=l),label:r.value.name,required:!0},null,8,["modelValue","label"])]),s("div",Se,[s("div",qe,[s("label",$e,m(a.$t("Country")),1),w(s("select",{class:"form-control form-control-sm form-control-solid",name:"country","onUpdate:modelValue":o[1]||(o[1]=l=>e.country=l)},[(i(!0),p(oe,null,le(S.value,(l,z)=>(i(),p("option",{value:l.slack,key:z},m(l.name),9,je))),128))],512),[[te,e.country]])])]),s("div",xe,[d(g,{type:"email",name:"email",modelValue:e.email,"onUpdate:modelValue":o[2]||(o[2]=l=>e.email=l),label:r.value.email,required:!0},null,8,["modelValue","label"])]),s("div",Me,[c(u)==null||c(u)==""?(i(),b($,{key:0,type:"password",name:"password",modelValue:e.password,"onUpdate:modelValue":o[3]||(o[3]=l=>e.password=l),label:r.value.password,required:!0,onGenerate_code:P},null,8,["modelValue","label"])):(i(),b(g,{key:1,type:"password",name:"password_dummy",modelValue:e.password_dummy,"onUpdate:modelValue":o[4]||(o[4]=l=>e.password_dummy=l),label:c(t)("Password")+" ("+c(t)("Can be updated from Reset Password")+")",readonly:!0,disabled:""},null,8,["modelValue","label"]))]),s("div",Ne,[d(A,{name:"status",label:r.value.status,modelValue:e.status,"onUpdate:modelValue":o[5]||(o[5]=l=>e.status=l),placeholder:r.value.select_status,options:F,required:""},null,8,["label","modelValue","placeholder"])]),s("div",Ae,[d(A,{name:"role",label:r.value.role,modelValue:e.role,"onUpdate:modelValue":o[6]||(o[6]=l=>e.role=l),placeholder:r.value.select_role,options:C.value,required:""},null,8,["label","modelValue","placeholder","options"])]),s("div",Fe,[s("div",De,[s("div",Ee,[w(s("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"multi_session_login",checked:"","onUpdate:modelValue":o[7]||(o[7]=l=>e.multi_session_login=l)},null,512),[[M,e.multi_session_login]]),s("label",Le,m(a.$t("Multi-Device Login")),1)])])]),s("div",Pe,[s("div",Te,[s("div",Be,[w(s("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"allow_adding_merchants",checked:"","onUpdate:modelValue":o[8]||(o[8]=l=>e.allow_adding_merchants=l)},null,512),[[M,e.allow_adding_merchants]]),s("label",Re,m(a.$t("Allow Adding Merchants")),1)])])]),s("div",Ie,[s("div",Oe,[s("div",Je,[Ge,s("div",ze,[s("span",He,m(e.utm_campaign_code||"N/A"),1),w((i(),p("button",{class:"border-0",onClick:o[9]||(o[9]=ne(l=>I(e.utm_campaign_code),["prevent"]))},[d(n,{icon:"fa6-regular:copy",class:"text-primary fs-5"})])),[[G,c(t)("Copy")]])])])])])])])]),s("div",Ke,[s("div",Qe,[s("div",We,[s("div",Xe,[d($,{type:"text",name:"login_code",modelValue:e.login_code,"onUpdate:modelValue":o[10]||(o[10]=l=>e.login_code=l),label:r.value.login_code,onGenerate_code:T,readonly:!0},null,8,["modelValue","label"])]),s("div",Ye,[d(g,{type:"number",name:"phone",modelValue:e.phone,"onUpdate:modelValue":o[11]||(o[11]=l=>e.phone=l),label:r.value.phone},null,8,["modelValue","label"])]),s("div",Ze,[d(g,{type:"date",name:"date_of_birth",modelValue:e.date_of_birth,"onUpdate:modelValue":o[12]||(o[12]=l=>e.date_of_birth=l),label:r.value.date_of_birth},null,8,["modelValue","label"])]),s("div",ea,[d(g,{type:"date",name:"date_of_anniversary",modelValue:e.date_of_anniversary,"onUpdate:modelValue":o[13]||(o[13]=l=>e.date_of_anniversary=l),label:r.value.date_of_anniversary},null,8,["modelValue","label"])]),s("div",aa,[d(g,{type:"date",name:"joining_date",modelValue:e.joining_date,"onUpdate:modelValue":o[14]||(o[14]=l=>e.joining_date=l),label:r.value.joining_date},null,8,["modelValue","label"])]),s("div",sa,[s("label",ta,m(a.$t("Upload Profile Pic")),1),s("div",oa,[s("input",{class:"form-control form-control-solid",name:"image",type:"file",id:"formFile",accept:"image/jpg, image/jpeg, image/png",onChange:B},null,32),s("label",la,m(a.$t("Upload")),1)])])])])])])])]),s("div",na,[s("button",{type:"submit",class:"btn btn-primary",disabled:e.is_submitting},[e.is_submitting?(i(),b(re,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):x("",!0),e.is_submitting?(i(),p("span",da,m(a.$t("Saving...")),1)):(i(),p("span",ra,m(a.$t("Save")),1))],8,ia)])]),_:1},8,["validation-schema","initial-values"])])):(i(),b(J,{key:1}))]),_:1})}}};export{Sa as default};
