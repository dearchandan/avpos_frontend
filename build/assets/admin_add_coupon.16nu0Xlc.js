import{u as T,a as B,r as h,e as H,d as k,o as K,g as i,p as y,w as f,f as V,i as s,k as d,n as _,t as r,j as a,h as u,K as L,Q as j,l as g,A as P,x as R,F as O,q as Q,_ as z}from"./index.7OFNPsHl.js";import{_ as G}from"./DefaultLayout.nvkZ4UhM.js";import{_ as J}from"./VTooltip.n3SV8A0p.js";import{_ as W}from"./VTextInput.VtSvZjuc.js";import{a as w,E as C,F as X}from"./vee-validate.esm.N3uz7Rsk.js";import{c as Z,a as ee,d as q}from"./index.esm.cd1bITNA.js";import{C as ae}from"./ClipLoader.1qNfpKDH.js";import{j as te}from"./vue-datepicker.sD5zgpde.js";import{u as se}from"./global.wK1y07-b.js";/* empty css                                                   */const oe={class:"header-nav-wrap"},ne={class:"row align-items-center"},le={class:"col-auto"},de={class:"header-back-link"},ie={class:"col-auto"},re={key:0,class:"fw-bold"},me={key:1,class:"fw-bold"},ue={class:"content"},ce={class:"row"},pe={class:"col-md-12"},_e={class:"row"},ve={class:"col-md-12 mb-4"},fe={class:"form-field float-end pb-0 mb-0"},ye={class:"form-check form-switch form-switch-2"},ge={for:"status"},be={key:0,class:"fw-bold text-uppercase text-primary"},he={key:1,class:"fw-bold text-uppercase text-muted"},ke=["checked"],Ve={class:"col-md-12"},we={class:"card"},Ce={class:"row"},qe={class:"col-md-3"},$e={class:"col-md-3"},De={class:"col-md-3"},xe={class:"form-field"},Ne={for:"",class:"label pb-2"},Me=s("em",null,"*",-1),Se=s("br",null,null,-1),Ae={class:"label me-3"},Ue={class:"col-md-3"},Ye={class:"col-md-3"},Ie={class:"col-3"},Ee={class:"form-field"},Fe={for:"",class:"form-label"},Te={key:0,class:"col-3"},Be={class:"form-field"},He={class:"col-12"},Ke={class:"text-end"},Le=["disabled"],je={key:1,class:"pt-0"},Pe={key:2,class:"pt-0"},sa={__name:"admin_add_coupon",setup(Re){const{t:l}=T(),c=B().params.slack,{coupon_types:$}=se(),p=h({name:l("Coupon Name"),name_ar:l("Coupon Name (Arabic)"),coupon_percentage:l("Coupon Percentage"),coupon_amount:l("Coupon Amount"),quantity:l("Coupon Quantity"),note:l("Note")}),D={server_messages:{type:"",messages:""},is_submitting:!1,coupon_slack:"",name:"",name_ar:"",type:1,value:"",quantity:"",date_range:"",status:h(!0),note:"",is_listing:!1},e=H({...D}),x=k(()=>e.date_range!=""&&e.date_range[0]!=null?moment(e.date_range[0]).format("YYYY-MM-DD HH:mm"):""),N=k(()=>e.date_range!=""&&e.date_range[1]!=null?moment(e.date_range[1]).format("YYYY-MM-DD HH:mm"):""),M=Z({name:ee().required(l("name is required",{name:l("Coupon Name")})).matches(/^(\S+$)/g,l("should not contain blankspace",{name:l("Coupon Name")})).min(2,l("name must be at least n characters",{name:l("Coupon Name"),number:2})),type:q().required(l("name is required",{name:l("Coupon Type")})),value:q().required(l("name is required",{name:l("Value")}))});K(()=>{c!=""&&c!=null&&A()});async function S(){e.is_submitting=!0;var t=new FormData;t.append("coupon_slack",e.coupon_slack),t.append("name",e.name),t.append("name_ar",e.name_ar),t.append("type",e.type),t.append("value",e.value),t.append("quantity",e.quantity),t.append("start_datetime",x.value),t.append("end_datetime",N.value),t.append("status",e.status),t.append("note",e.note);var o=e.coupon_slack!=""&&e.coupon_slack!=null?"/api/admin/coupon/update":"/api/admin/coupon/save";await axios.post(o,t).then(m=>{if(m.data.status_code==200)toast.success(m.data.msg),e.is_submitting=!1,router.push("/admin/coupons");else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(m.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=m.data.msg}e.is_submitting=!1}}).catch(m=>{e.server_messages.type="error",e.server_messages.messages=m,e.is_submitting=!1,console.log(m)})}async function A(){await axios.get("/api/admin/coupon",{params:{slack:c}}).then(t=>{t.data.data.coupon&&(e.coupon_slack=t.data.data.coupon.slack,e.name=t.data.data.coupon.name,e.name_ar=t.data.data.coupon.name_ar,e.type=parseInt(t.data.data.coupon.type),e.value=t.data.data.coupon.value,e.quantity=t.data.data.coupon.quantity,e.date_range=[new Date(String(t.data.data.coupon.start_datetime)),new Date(String(t.data.data.coupon.end_datetime))],e.status=t.data.data.coupon.status==1)}).catch(t=>{e.server_messages.type="error",e.server_messages.messages=t,console.log(t)})}const U=Q(()=>z(()=>import("./ServerMessage.I5ol-gtz.js"),__vite__mapDeps([0,1,2])));return(t,o)=>{const m=V("Icon"),b=V("router-link"),v=W,Y=J,I=G;return i(),y(I,null,{subheader:f(()=>[s("div",oe,[s("div",ne,[s("div",le,[s("div",de,[d(b,{class:"text-primary",to:"/admin/coupons"},{default:f(()=>[d(m,{icon:"fa6-solid:chevron-left"}),_(" "+r(t.$t("Coupons")),1)]),_:1})])]),s("div",ie,[a(c)==""||a(c)==null?(i(),u("h5",re,r(t.$t("Add Coupon")),1)):(i(),u("h5",me,r(t.$t("Edit Coupon")),1))])])])]),default:f(()=>[s("div",ue,[d(a(X),{"validation-schema":a(M),onSubmit:S,enctype:"multipart/form-data"},{default:f(()=>[s("div",ce,[s("div",pe,[s("div",_e,[s("div",ve,[s("div",fe,[s("div",ye,[s("label",ge,[a(e).status?(i(),u("span",be,r(t.$t("Active")),1)):(i(),u("span",he,r(t.$t("Inactive")),1)),L(s("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"status","onUpdate:modelValue":o[0]||(o[0]=n=>a(e).status=n),checked:a(e).status==1},null,8,ke),[[j,a(e).status]])])])])]),s("div",Ve,[a(e).server_messages.messages!=""?(i(),y(a(U),{key:0,class:"py-3",server_messages:a(e).server_messages},null,8,["server_messages"])):g("",!0),s("div",we,[s("div",Ce,[s("div",qe,[d(v,{type:"text",name:"name",modelValue:a(e).name,"onUpdate:modelValue":o[1]||(o[1]=n=>a(e).name=n),label:a(p).name,required:!0,onKeydown:o[2]||(o[2]=P(n=>n.preventDefault(),["space"]))},null,8,["modelValue","label"])]),s("div",$e,[d(v,{type:"text",name:"name_ar",modelValue:a(e).name_ar,"onUpdate:modelValue":o[3]||(o[3]=n=>a(e).name_ar=n),label:a(p).name_ar},null,8,["modelValue","label"])]),s("div",De,[s("div",xe,[s("label",Ne,[_(r(t.$t("Coupon Type"))+" ",1),Me]),_(),Se,(i(!0),u(O,null,R(a($),(n,E)=>(i(),u("label",Ae,[d(a(w),{class:"form-check-input me-1",name:"type",type:"radio",id:E,value:n.value,modelValue:a(e).type,"onUpdate:modelValue":o[4]||(o[4]=F=>a(e).type=F)},null,8,["id","value","modelValue"]),_(" "+r(n.name),1)]))),256)),d(a(C),{name:"type",as:"div",class:"error"})])]),s("div",Ue,[d(v,{type:"text",name:"value",modelValue:a(e).value,"onUpdate:modelValue":o[5]||(o[5]=n=>a(e).value=n),label:a(e).type==1?a(p).coupon_percentage:a(p).coupon_amount,required:!0},null,8,["modelValue","label"])]),s("div",Ye,[d(v,{type:"text",name:"quantity",modelValue:a(e).quantity,"onUpdate:modelValue":o[6]||(o[6]=n=>a(e).quantity=n),label:a(p).quantity,tooltip:"keeping it blank will be considered unlimited quantity"},null,8,["modelValue","label"])]),s("div",Ie,[s("div",Ee,[s("label",Fe,[_(r(t.$t("Date Range"))+" ",1),d(Y,{message:"Keeping dates unselected will make it applicable always"})]),d(a(te),{range:"",modelValue:a(e).date_range,"onUpdate:modelValue":o[7]||(o[7]=n=>a(e).date_range=n),format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid"},null,8,["modelValue"])])]),a(c)==""||a(c)==null?(i(),u("div",Te,[s("div",Be,[s("label",null,r(t.$t("Note")),1),d(a(w),{as:"textarea",class:"form-control form-control-solid p-3",name:"note",modelValue:a(e).note,"onUpdate:modelValue":o[8]||(o[8]=n=>a(e).note=n),label:a(p).note,cols:"3"},null,8,["modelValue","label"]),d(a(C),{name:"note",as:"div",class:"error"})])])):g("",!0)])])]),s("div",He,[s("div",Ke,[s("button",{type:"submit",class:"btn btn-primary",disabled:a(e).is_submitting},[a(e).is_submitting?(i(),y(ae,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):g("",!0),a(e).is_submitting?(i(),u("span",je,r(t.$t("Saving...")),1)):(i(),u("span",Pe,r(t.$t("Save")),1))],8,Le)])])])])])]),_:1},8,["validation-schema"])])]),_:1})}}};export{sa as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.I5ol-gtz.js","assets/index.7OFNPsHl.js","assets/index.1t-AB2n6.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
