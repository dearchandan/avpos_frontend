import{u as oe,a as ie,r as b,b as re,d as F,e as ue,s as ce,o as de,g as c,p as w,w as A,f as M,i as l,k as i,n as U,t as u,j as d,h as m,l as V,K as y,M as g,F as _e,x as pe,Q as me,q as ve,_ as be}from"./index.7OFNPsHl.js";import{_ as ye}from"./DefaultLayout.nvkZ4UhM.js";import{_ as he}from"./EditFormSkeleton.hbjdnq7m.js";import{_ as fe}from"./VSelectInput.LiAW_8HB.js";import{_ as ge}from"./VTextInput.VtSvZjuc.js";import{a as C,F as Ve}from"./vee-validate.esm.N3uz7Rsk.js";import{c as xe,a as S,e as ke}from"./index.esm.cd1bITNA.js";import{C as Se}from"./ClipLoader.1qNfpKDH.js";import{u as we}from"./global.wK1y07-b.js";import"./VTooltip.n3SV8A0p.js";/* empty css                                                   */const Ae={class:"header-nav-wrap"},Ue={class:"row align-items-center"},Te={class:"col-auto"},Ne={class:"header-back-link"},qe={class:"col-auto"},Pe={key:0,class:"fw-bold"},Ce={key:1,class:"fw-bold"},De={key:0,class:"content"},$e={class:"row card-strash"},Ee={class:"col-md-12"},Ie={class:"row"},Oe={class:"col-md-12 mb-4"},Fe={class:"card"},Me={class:"row"},Ye={class:"section-title pb-3 text-muted"},Le={class:"col-6"},Be={class:"col-6"},We={class:"col-3"},Ge={class:"col-3"},Re={class:"col-3"},je={class:"col-3"},Je={class:"col-12"},ze={class:"row"},He={class:"col-3"},Ke={key:0,class:"col-3"},Qe={class:"col-3"},Xe={class:"col-3"},Ze={class:"col-3"},et={class:"col-2"},tt={class:"col-2"},at={class:"col-2"},st={class:"col-2"},lt={class:"col-2"},nt={class:"col-2"},ot={class:"col-3"},it={class:"form-field mt-2"},rt={class:"form-check form-switch"},ut={class:"form-check-label",for:"status"},ct=l("em",null,"*",-1),dt={class:"col-md-12 mb-4"},_t={class:"card"},pt={class:"row"},mt={class:"section-title pb-3 text-muted"},vt={key:0,class:"card p-5 form-check"},bt={class:"form-check-label mb-0 mt-3"},yt=["onUpdate:modelValue","checked","value","id"],ht={class:"text-primary text-uppercase"},ft={class:"text-muted"},gt={key:0},Vt={key:1},xt={key:1,class:"card p-5 my-2"},kt={class:"form-check-label mb-0 mt-3"},St={class:"text-primary text-uppercase"},wt={class:"text-muted mb-0"},At={class:"mt-3"},Ut={key:0},Tt={key:1},Nt={class:"col-md-12 mb-4"},qt={class:"card"},Pt={class:"row"},Ct={class:"section-title pb-3 text-muted"},Dt={class:"col-md-6"},$t={class:"col-md-6"},Et=l("input",{type:"hidden",name:"slack"},null,-1),It={class:"text-end"},Ot=["disabled"],Ft={key:1,class:"pt-0"},Mt={key:2,class:"pt-0"},Zt={__name:"add_master_subscription",props:["action"],setup(Y){const{t:n}=oe(),h=ie().params.slack;b([]);const r=b({name:n("Subscription Name"),name_ar:n("Subscription Name (Arabic)"),subscription_category:n("Subscription Category"),device_type:n("Device Type"),subscription_for:n("Subscription For"),select_country:n("Select Country"),is_trial:n("Is Trial Subscription"),trial_days:n("Trial Days"),price_type:n("Price Type"),price:n("Price"),tax_name:n("Tax Name"),tax_percentage:n("Tax(%)"),discount_name:n("Discount Name"),discount_type:n("Discount Type"),discount_value:n("Discount Amount"),payable_amount:n("Payable Amount"),description:n("Description"),description_ar:n("Description (Arabic)"),subscription_tenure:n("Subscription Tenure"),tax_amount:n("Tax Amount"),offer_name:n("Offer Name"),strike_through_price:n("Strike Through Price")}),L=ve(()=>be(()=>import("./ServerMessage.I5ol-gtz.js"),__vite__mapDeps([0,1,2]))),B=re(),D=F(()=>B.user.currency.symbol),f=ue({type:"",messages:""}),a=b({is_submitting:!1,name:"",name_ar:"",subscription_category:1,device_type:1,subscription_for:1,country_id:"",is_trial:0,trial_days:7,price_type:1,price:"",tax_name:"VAT",tax_percentage:"15",tax_amount:"",discount_name:"",discount_type:"",discount_value:"",payable_amount:0,status:!0,description:"",description_ar:"",subscription_tenure:"",offer_name:"",strike_through_price:"",slack:""}),x=b([]),{device_types:W,subscription_fors:G,price_types:R,discount_types:Lt,subscription_categories:j}=we(),J=b([{id:0,name:"No"},{id:1,name:"Yes"}]);ce(Multiselect);const z=xe({name:S().required(n("name is required",{name:n("Subscription Name")})).min(3,n("name must be at least n characters",{name:n("Subscription Name"),number:3})),name_ar:S().required(n("name is required",{name:n("Subscription Name Ar")})).min(3,n("name must be at least n characters",{name:n("Subscription Name Ar"),number:3})),country_id:S().required(n("name is required",{name:n("Country")})),payable_amount:S().nullable().when("is_trial",{is:t=>t==!1,then:t=>t.required(n("Payable Amount is required",{name:n("Payable Amount")})),otherwise:t=>t.nullable()}),tax_name:S().nullable().when("price_type",{is:t=>t==2,then:t=>t.required(n("Tax Name is required",{name:n("Tax Name")})),otherwise:t=>t.nullable()}),tax_percentage:S().nullable().when("price_type",{is:t=>t==2,then:t=>t.required(n("Tax Percentage is required",{name:n("Tax Percentage")})),otherwise:t=>t.nullable()}),status:ke().label("status")});de(()=>{K(),X(),_.isUndefined(h)||H()});const $=b(!1);async function H(){let t=await axios.get("/api/subscription_detail/"+h);a.value=t.data.data,a.value.country_id=t.data.data.country.slack,a.value.description=t.data.data.description!=null?t.data.data.description:"",a.value.description_ar=t.data.data.description_ar!=null?t.data.data.description_ar:"",t.data.data.addons!=null&&(x.value=[],_.forEach(I.value,e=>{var v="";_.forEach(t.data.data.addons,o=>{o.addon_master_id==e.id&&(v=e.value_type==1?o.limit_value:!0)});let p={id:e.id,constant_name:e.constant_name,name:e.name,name_ar:e.name_ar,description:e.description,type:e.type,value_type:e.value_type,price:e.price,status:e.status,value:v};x.value.push(p),E()})),$.value=!0}const T=b(!1),N=b(!1);function E(){const t=x.value,e=t.find(o=>o.constant_name==="POS"&&o.value===!0),v=t.find(o=>o.constant_name==="INVOICING"&&o.value===!0),p=t.find(o=>o.constant_name==="WOSUL_EASY"&&o.value===!0);e||v?T.value=!0:T.value=!1,p?N.value=!0:N.value=!1}b([]);const I=b([]);async function K(){await axios.get("/api/subscription_addons").then(t=>{I.value=t.data,_.forEach(t.data,e=>{let v={id:e.id,constant_name:e.constant_name,name:e.name,name_ar:e.name_ar,description:e.description,type:e.type,value_type:e.value_type,price:e.price,status:e.status,value:""};x.value.push(v)})})}const Q=Y;F(()=>!_.isUndefined(Q.action));const O=b([]);async function X(){await axios.get("/api/countries").then(t=>{_.forEach(t.data.data,e=>{O.value.push({id:e.slack,name:e.name})})}).catch(t=>{f.type="error",f.messages=t,a.value.is_submitting=!1})}async function Z(t){a.value.is_submitting=!0;var e=new FormData;e.append("name",t.name),e.append("name_ar",t.name_ar),e.append("subscription_category",t.subscription_category),e.append("device_type",t.device_type),e.append("subscription_for",t.subscription_for),e.append("country_id",t.country_id),e.append("is_trial",t.is_trial),e.append("trial_days",t.trial_days),e.append("price_type",t.price_type),e.append("price",t.price),e.append("tax_name",t.tax_name),e.append("subscription_tenure",t.subscription_tenure),e.append("offer_name",t.offer_name!=null&&t.offer_name!="undefined"?t.offer_name:""),e.append("strike_through_price",t.strike_through_price!=null&&t.strike_through_price!="undefined"?t.strike_through_price:""),e.append("tax_percentage",t.tax_percentage!=null&&t.tax_percentage!="undefined"?t.tax_percentage:0),e.append("discount_name",t.discount_name!=null&&t.discount_name!="undefined"?t.discount_name:""),e.append("discount_type",t.discount_type!=null&&t.discount_type!="undefined"?t.discount_type:0),e.append("discount_value",t.discount_value),e.append("payable_amount",t.payable_amount),e.append("status",t.status),e.append("description",t.description),e.append("description_ar",t.description_ar),e.append("addons",JSON.stringify(x.value)),e.append("slack",h);var v=h!=""&&h!=null?"/api/subscription/update":"/api/subscription/save";await axios.post(v,e,{headers:{"Content-Type":"multipart/form-data"}}).then(p=>{if(p.data.status_code==200)toast.success(p.data.msg),a.value.is_submitting=!1,ee(),router.push("/master_subscriptions");else{try{f.type="error",f.messages=JSON.parse(p.data.msg)}catch{f.type="error",f.messages=p.data.msg}a.value.is_submitting=!1}}).catch(p=>{f.type="error",f.messages=p,a.value.is_submitting=!1})}function ee(){Object.assign(a,a)}function q(){var t=a.value.payable_amount,e=a.value.tax_percentage,v=t/(e/100+1),p=t-parseFloat(v);a.value.tax_amount=p.toFixed(2),a.value.price=v.toFixed(2)}return(t,e)=>{const v=M("Icon"),p=M("router-link"),o=ge,k=fe,te=he,ae=ye;return c(),w(ae,null,{subheader:A(()=>[l("div",Ae,[l("div",Ue,[l("div",Te,[l("div",Ne,[i(p,{class:"text-primary",to:"/master_subscriptions"},{default:A(()=>[i(v,{icon:"fa6-solid:chevron-left"}),U(" "+u(t.$t("Subscriptions")),1)]),_:1})])]),l("div",qe,[d(h)==""||d(h)==null?(c(),m("h5",Pe,u(t.$t("Add Subscription")),1)):(c(),m("h5",Ce,u(t.$t("Edit Subscription")),1))])])])]),default:A(()=>[d(h)==""||d(h)==null||d(h)!=""&&$.value?(c(),m("div",De,[i(d(Ve),{"validation-schema":d(z),onSubmit:Z,enctype:"multipart/form-data","initial-values":a.value},{default:A(({setFieldValue:se,values:le})=>[l("div",$e,[f.messages!=""?(c(),w(d(L),{key:0,class:"py-3",server_messages:f},null,8,["server_messages"])):V("",!0),l("div",Ee,[l("div",Ie,[l("div",Oe,[l("div",Fe,[l("div",Me,[l("h5",Ye,u(t.$t("Basic Details"))+": ",1),l("div",Le,[i(o,{type:"text",name:"name",label:r.value.name,required:!0,modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.name=s)},null,8,["label","modelValue"])]),l("div",Be,[i(o,{type:"text",name:"name_ar",label:r.value.name_ar,modelValue:a.value.name_ar,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.name_ar=s),required:""},null,8,["label","modelValue"])]),l("div",We,[i(k,{name:"subscription_category",label:r.value.subscription_category,required:"",options:d(j),modelValue:a.value.subscription_category,"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.subscription_category=s),tooltip:"Plan: POS Package, Service: AvPOS Pay "},null,8,["label","options","modelValue"])]),l("div",Ge,[i(k,{name:"device_type",label:r.value.device_type,required:"",options:d(W),modelValue:a.value.device_type,"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.device_type=s)},null,8,["label","options","modelValue"])]),l("div",Re,[i(k,{name:"subscription_for",label:r.value.subscription_for,required:"",options:d(G),modelValue:a.value.subscription_for,"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.subscription_for=s)},null,8,["label","options","modelValue"])]),l("div",je,[i(k,{name:"country_id",label:r.value.select_country,required:"",options:O.value,modelValue:a.value.country_id,"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.country_id=s)},null,8,["label","options","modelValue"])]),l("div",Je,[l("div",ze,[l("div",He,[i(k,{modelValue:a.value.is_trial,"onUpdate:modelValue":e[6]||(e[6]=s=>a.value.is_trial=s),name:"is_trial",label:r.value.is_trial,required:"",options:J.value},null,8,["modelValue","label","options"])]),a.value.is_trial?(c(),m("div",Ke,[i(o,{type:"number",name:"trial_days",label:r.value.trial_days,modelValue:a.value.trial_days,"onUpdate:modelValue":e[7]||(e[7]=s=>a.value.trial_days=s)},null,8,["label","modelValue"])])):V("",!0),y(l("div",Qe,[i(o,{type:"number",name:"subscription_tenure",label:r.value.subscription_tenure,modelValue:a.value.subscription_tenure,"onUpdate:modelValue":e[8]||(e[8]=s=>a.value.subscription_tenure=s)},null,8,["label","modelValue"])],512),[[g,!a.value.is_trial]]),y(l("div",Xe,[i(o,{type:"text",name:"offer_name",label:r.value.offer_name,modelValue:a.value.offer_name,"onUpdate:modelValue":e[9]||(e[9]=s=>a.value.offer_name=s)},null,8,["label","modelValue"])],512),[[g,!a.value.is_trial]]),y(l("div",Ze,[i(o,{type:"number",name:"strike_through_price",label:r.value.strike_through_price,modelValue:a.value.strike_through_price,"onUpdate:modelValue":e[10]||(e[10]=s=>a.value.strike_through_price=s)},null,8,["label","modelValue"])],512),[[g,!a.value.is_trial]]),y(l("div",et,[i(k,{modelValue:a.value.price_type,"onUpdate:modelValue":e[11]||(e[11]=s=>a.value.price_type=s),name:"price_type",label:r.value.price_type,required:"",options:d(R),onChange:q,disabled:!0},null,8,["modelValue","label","options"])],512),[[g,!a.value.is_trial]]),y(l("div",tt,[i(o,{type:"number",name:"price",label:r.value.price,modelValue:a.value.price,"onUpdate:modelValue":e[12]||(e[12]=s=>a.value.price=s),readonly:""},null,8,["label","modelValue"])],512),[[g,!a.value.is_trial]]),y(l("div",at,[i(o,{type:"text",name:"tax_name",label:r.value.tax_name,modelValue:a.value.tax_name,"onUpdate:modelValue":e[13]||(e[13]=s=>a.value.tax_name=s),readonly:""},null,8,["label","modelValue"])],512),[[g,!a.value.is_trial]]),y(l("div",st,[i(o,{type:"number",name:"tax_percentage",label:r.value.tax_percentage,modelValue:a.value.tax_percentage,"onUpdate:modelValue":e[14]||(e[14]=s=>a.value.tax_percentage=s),onInput:q,readonly:""},null,8,["label","modelValue"])],512),[[g,!a.value.is_trial]]),y(l("div",lt,[i(o,{type:"number",name:"tax_amount",label:r.value.tax_amount,modelValue:a.value.tax_amount,"onUpdate:modelValue":e[15]||(e[15]=s=>a.value.tax_amount=s),readonly:""},null,8,["label","modelValue"])],512),[[g,!a.value.is_trial]]),y(l("div",nt,[i(o,{type:"number",name:"payable_amount",label:r.value.payable_amount,modelValue:a.value.payable_amount,"onUpdate:modelValue":e[16]||(e[16]=s=>a.value.payable_amount=s),onInput:q,required:""},null,8,["label","modelValue"])],512),[[g,!a.value.is_trial]])])]),l("div",ot,[l("div",it,[l("div",rt,[i(d(C),{class:"form-check-input me-2",type:"checkbox",role:"switch",name:"status",id:"status","unchecked-value":!1,value:le.status,onChange:s=>se("status",s.target.checked)},null,8,["value","onChange"]),l("label",ut,[U(u(t.$t("Active"))+" ",1),ct])])])])])])]),l("div",dt,[l("div",_t,[l("div",pt,[l("h5",mt,u(t.$t("Addons")),1),(c(!0),m(_e,null,pe(x.value,(s,ne)=>y((c(),m("div",{class:"col-md-3 my-2",key:ne},[s.value_type==2?(c(),m("div",vt,[l("label",bt,[y(l("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":P=>s.value=P,checked:s.value,value:s.id,id:s.constant_name,onChange:E},null,40,yt),[[me,s.value]]),l("h6",ht,u(s.name),1),l("p",ft,u(s.description),1),l("h6",null,[U(u(s.price)+" "+u(D.value)+" ",1),s.type==1?(c(),m("small",gt,"/Month ")):V("",!0),s.type==2?(c(),m("small",Vt,"/Year ")):V("",!0)])])])):V("",!0),s.value_type==1?(c(),m("div",xt,[l("label",kt,[l("h6",St,u(s.name),1),l("p",wt,u(s.description),1),i(o,{type:"number",name:s.constant_name,modelValue:s.value,"onUpdate:modelValue":P=>s.value=P,class:"mb-0",input_group_text:s.constant_name=="BRANCH_LIMIT"?"/Branch":"/User"},null,8,["name","modelValue","onUpdate:modelValue","input_group_text"]),l("h6",At,[U(u(s.price)+" "+u(D.value)+" ",1),s.type==1?(c(),m("small",Ut,"/Month ")):V("",!0),s.type==2?(c(),m("small",Tt,"/Year ")):V("",!0)])])])):V("",!0)])),[[g,s.value_type==1||s.value_type==2&&s.constant_name!="PAYMENT_GATEWAY"&&s.constant_name!="WOSUL_PAY"||s.constant_name=="PAYMENT_GATEWAY"&&T.value==!0||s.constant_name=="WOSUL_PAY"&&N.value==!0]])),128))])])]),l("div",Nt,[l("div",qt,[l("div",Pt,[l("h5",Ct,u(t.$t("Optional Details")),1),l("div",Dt,[l("label",null,u(t.$t("Description")),1),i(d(C),{as:"textarea",class:"form-control form-control-solid p-3",name:"description",label:r.value.description,cols:"3",rows:"2",modelValue:a.value.description,"onUpdate:modelValue":e[17]||(e[17]=s=>a.value.description=s)},null,8,["label","modelValue"])]),l("div",$t,[l("label",null,u(t.$t("Description (Arabic)")),1),i(d(C),{as:"textarea",class:"form-control form-control-solid p-3",name:"description_ar",label:r.value.description_ar,cols:"3",rows:"2",modelValue:a.value.description_ar,"onUpdate:modelValue":e[18]||(e[18]=s=>a.value.description_ar=s)},null,8,["label","modelValue"])]),Et])])])])])]),l("div",It,[l("button",{type:"submit",class:"btn btn-primary",disabled:a.value.is_submitting},[a.value.is_submitting?(c(),w(Se,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):V("",!0),a.value.is_submitting?(c(),m("span",Ft,u(t.$t("Saving...")),1)):(c(),m("span",Mt,u(t.$t("Save")),1))],8,Ot)])]),_:1},8,["validation-schema","initial-values"])])):(c(),w(te,{key:1}))]),_:1})}}};export{Zt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.I5ol-gtz.js","assets/index.7OFNPsHl.js","assets/index.1t-AB2n6.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
