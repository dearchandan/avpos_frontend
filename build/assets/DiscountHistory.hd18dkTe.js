import{_ as K}from"./PaginateLimit.H-orl6zP.js";import{_ as U}from"./ListingSkeleton.upY030ro.js";import{_ as F}from"./VTextInput.ZgtOiOMJ.js";import{u as H,b as L,e as y,d as O,r as l,o as T,v as h,f as E,g as c,h as u,i as e,t as s,k as r,w as R,B as V,A as D,j as p,K as z,N as G,p as J,F as Q,x as W,O as X}from"./index.GdMxdeuf.js";import{j as Y}from"./vue-datepicker.iEAbZR0K.js";/* empty css                                                   */import"./VTooltip.Ewb958d6.js";import"./vee-validate.esm.9aElOHQY.js";const Z={class:"pb-2"},ee={class:"page-heading d-none d-md-block"},te={class:"row align-items-center justify-content-between"},se={class:"col-12"},oe={class:"row align-items-center"},ae={class:"col-12"},ne={class:"form-field page-heading-search-field mb-0"},ie={class:""},le={class:"row align-items-center"},ce={class:"col-md-4 form-field"},re={for:""},de=["onClick","onKeyup"],_e={class:"col-2"},ue={class:"col-2"},pe={class:"col-4"},me={class:"row align-items-center"},he={class:"col-12"},ge={class:"form-field page-heading-search-field mb-0 pt-md-3"},ve={class:"field-icon"},fe=["placeholder"],be={class:"icon"},ye={key:1,class:"table-responsive"},we={class:"table table-list-data table-hover"},ke={class:"bg-light"},$e={scope:"col",width:"10%"},Ve={scope:"col",width:"10%"},De={scope:"col",width:"10%"},Pe={scope:"col",width:"10%"},Ae={scope:"col",width:"10%"},Be={scope:"col",width:"10%"},Ce={scope:"col",width:"10%"},Me=["onClick"],je={key:1},qe={class:"text-center py-3",colspan:"7"},xe={class:"data-footer"},Ne={class:"row align-items-center justify-content-between"},Se={class:"col-auto"},Ie={class:"col-auto"},ze={__name:"DiscountHistory",props:["discount_slack"],setup(P){const{t:g}=H(),A=L(),B=y({discount_slack:P.discount_slack}),C=y({...B}),v=O(()=>A.user.currency.symbol),M={server_messages:{type:"",messages:""},is_listing:!1,search_query:l(""),business_dates:l([new Date,new Date]),min_price:l(""),max_price:l("")},j=g("search by order no., product name etc"),t=y({...M});T(()=>{i()}),h(()=>t.business_dates,_.debounce(()=>{i()},500)),h(()=>t.min_price,_.debounce(()=>{i()},500)),h(()=>t.max_price,_.debounce(()=>{i()},500)),h(()=>t.search_query,_.debounce(()=>{i()},500));function q(a){const n=router.resolve("/order/"+a);window.open(n.href,"_blank")}const f=l([]),b=l([]);async function i(a=1){t.is_listing=!0,await axios.get("/api/discount/history",{params:{page:a,paginate_limit:w.value,search_query:t.search_query,min_price:t.min_price,max_price:t.max_price,business_dates:t.business_dates,filter:C}}).then(n=>{f.value=n.data.data,b.value=n.data.pagination,t.is_listing=!1}).catch(n=>{t.server_messages.type="error",t.server_messages.messages=n,t.is_listing=!1,console.log(n)})}const w=l();async function x(a){w.value=a,await i()}return(a,n)=>{const k=F,N=E("Icon"),S=U,I=K;return c(),u("div",null,[e("h5",Z,s(a.$t("Applied History")),1),e("div",ee,[e("div",te,[e("div",se,[e("div",oe,[e("div",ae,[e("div",ne,[e("div",ie,[e("div",le,[e("div",ce,[e("label",re,s(a.$t("Date Range")),1),r(p(Y),{range:"",format:"dd-MM-yyyy",modelValue:t.business_dates,"onUpdate:modelValue":n[0]||(n[0]=o=>t.business_dates=o),"enable-time-picker":!1,"max-range":"90","multi-calendars":"","preset-dates":a.presetDates,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":R(({label:o,value:d,presetDate:m})=>[e("span",{role:"button",tabindex:0,onClick:$=>m(d),onKeyup:[D(V($=>m(d),["prevent"]),["enter"]),D(V($=>m(d),["prevent"]),["space"])]},s(o),41,de)]),_:1},8,["modelValue","preset-dates"])]),e("div",_e,[r(k,{type:"number",modelValue:t.min_price,"onUpdate:modelValue":n[1]||(n[1]=o=>t.min_price=o),name:"order_type",label:p(g)("Min Price")},null,8,["modelValue","label"])]),e("div",ue,[r(k,{type:"number",modelValue:t.max_price,"onUpdate:modelValue":n[2]||(n[2]=o=>t.max_price=o),name:"sale_types",label:p(g)("Max Price")},null,8,["modelValue","label"])]),e("div",pe,[e("div",me,[e("div",he,[e("div",ge,[e("div",ve,[z(e("input",{type:"search",class:"form-control form-control-solid",placeholder:p(j),"onUpdate:modelValue":n[3]||(n[3]=o=>t.search_query=o)},null,8,fe),[[G,t.search_query]]),e("div",be,[r(N,{icon:"fa6-solid:magnifying-glass"})])])])])])])])])])])])])])]),t.is_listing?(c(),J(S,{key:0})):(c(),u("div",ye,[e("table",we,[e("thead",ke,[e("tr",null,[e("th",$e,s(a.$t("Order No.")),1),e("th",Ve,s(a.$t("Product Name")),1),e("th",De,s(a.$t("Price Before Discount")),1),e("th",Pe,s(a.$t("Discount")),1),e("th",Ae,s(a.$t("Price After Discount")),1),e("th",Be,s(a.$t("Applied At")),1),e("th",Ce,s(a.$t("Applied By")),1)])]),e("tbody",null,[f.value!=""?(c(!0),u(Q,{key:0},W(f.value,(o,d)=>(c(),u("tr",{key:d},[e("td",null,[e("a",{onClick:m=>q(o.order.slack),href:"javascript:;"},"# "+s(o.order.order_number),9,Me)]),e("td",null,s(o.product_name),1),e("td",null,s(o.product_price_before_discount)+" "+s(v.value),1),e("td",null,s(o.product_discount)+" "+s(v.value),1),e("td",null,s(o.subtotal_after_product_discount)+" "+s(v.value),1),e("td",null,s(o.created_at_label),1),e("td",null,s(o.created_by.name),1)]))),128)):(c(),u("tr",je,[e("td",qe,s(a.$t("No Data Found")),1)]))])])])),e("div",xe,[e("div",Ne,[e("div",Se,[r(I,{onPaginate_limit_update:x,pagination:b.value},null,8,["pagination"])]),e("div",Ie,[r(p(X),{data:b.value,limit:5,onPaginationChangePage:i},null,8,["data"])])])])])}}};export{ze as default};
