import{_ as f}from"./VTextInput.EPCajChY.js";import{F as v}from"./vee-validate.esm.2kXgdFia.js";import{c as y,b as k}from"./index.esm.DHYHwGJ4.js";import{u as R,P as S,a as x,b as T,bT as V,r as w,e as C,g as I,p as q,i as t,l as c,w as B,j as i,n as F,t as H,af as N}from"./index.sP6fhsqN.js";import"./VTooltip.kcvohVRA.js";const O={class:"modal hide",id:"openRegisterModal",tabindex:"-1","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},D={class:"modal-dialog modal-dialog-centered"},M={class:"modal-content"},j={class:"modal-body mt-5"},z={class:"modal-btns"},A={type:"submit",class:"btn btn-lg btn-primary"},L={__name:"OpenRegister",props:["terminal"],setup(m){const{t:o}=R(),d=S(m,"terminal"),u=x(),p=T(),_=V(),r=w(0),h=o("Cash In Hand"),b=y({cash_in_hand:k().moreThan(-1).typeError(o("must be a number",{name:o("Cash In Hand")})).required(o("name is required",{name:o("Cash In Hand")}))}),s=C({type:"",messages:""});async function g(){if(d.registered_device_id==null){let a=u.query.order_slack;var n=new FormData;n.append("terminal_slack",d.value.slack),n.append("cash_in_hand",r.value),await axios.post("/api/business_register/open",n).then(e=>{if(e.data.status_code==200)$("#openRegisterModal").modal("hide"),p.refresh().then(()=>{_.refreshTerminals().then(()=>{a!=null?location.href="/order/"+a:toast.success(e.data.msg)})});else try{s.type="error",s.messages=JSON.parse(e.data.msg)}catch{s.type="error",s.messages=e.data.msg}}).catch(e=>{s.type="error",s.messages=e,console.log(e)})}else toast.warning("Terminal is already linked to a device "+d.registered_device_id)}return(n,a)=>{const e=f;return I(),q(N,{to:"body"},[t("div",O,[t("div",D,[t("div",M,[t("div",j,[c(i(v),{"validation-schema":i(b),onSubmit:a[1]||(a[1]=l=>g())},{default:B(()=>[c(e,{type:"text",name:"cash_in_hand",modelValue:i(r),"onUpdate:modelValue":a[0]||(a[0]=l=>F(r)?r.value=l:null),label:i(h),placeholder:"",size:"large",required:""},null,8,["modelValue","label"]),t("div",z,[t("button",A,H(n.$t("Open Register")),1)])]),_:1},8,["validation-schema"])])])])])])}}};export{L as default};
