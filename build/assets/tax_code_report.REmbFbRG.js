import{u as q,b as z,d as v,e as D,r as c,g as r,p as w,w as m,f as Y,i as e,l as u,k as M,t as n,j as s,m as $,A as V,B as C,h as i,F as J,x as W,I as H,bW as p,q as Q,_ as X}from"./index.li3fCRRM.js";import{D as Z}from"./DefaultLayout.saUWsTkY.js";import{_ as ee}from"./ListingSkeleton.6NzqF9S5.js";import{_ as te}from"./VMultiSelect.2M-H_LD-.js";import{u as se}from"./global.NAtoPKoY.js";import{s as T,a as ae,e as oe,j as ne}from"./vue-datepicker.a6BsTEHj.js";import{s as S,e as A}from"./index.dFkrF4C6.js";import"./ClipLoader.gDBpDd3b.js";/* empty css                                                   */import"./vee-validate.esm.reM-LHjC.js";const le={class:"header-nav-wrap"},re={class:"row align-items-center"},ce={class:"col-auto"},ie={class:"header-back-link"},de={class:"col-auto"},_e={class:"fw-bold"},ue={class:"content"},me={class:"card"},pe={class:"row field-m-0 align-items-end g-3"},he={class:"col-md-4 col-lg-3"},ge={class:"form-field"},fe={for:"",class:"form-label"},ve=e("span",{class:"text-danger"},"*",-1),be=["onClick","onKeyup"],ye={class:"col-md-4 col-lg-3"},xe={class:"col-auto text-end"},ke={class:"row align-items-center"},De={class:"col-auto"},we=["disabled"],Ye={class:"col-auto"},Me=["disabled"],$e={class:"card"},Ve={class:""},Ce={key:0},Te={key:1,class:"table-responsive"},Se={class:"table table-list-data table-hover"},Ae={class:"bg-light"},Be={scope:"col"},Ee={scope:"col"},Fe={scope:"col"},Ne={scope:"col",class:"text-end"},Le={class:"text-end"},Oe={key:1},Ie={class:"text-center py-3",colspan:"5"},Re={key:0},je=e("th",{colspan:"3"},null,-1),Ke={class:"text-end"},tt={__name:"tax_code_report",setup(Pe){const{t:b}=q(),{isAuthorized:Ge,getRoundedValue:B}=H();se();const y=z(),x=v(()=>y.user.currency.symbol),E=D({server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,dates:c([new Date,new Date]),selected_branch:c(),is_exporting:!1}),t=D({...E}),F=b("Select Branch"),N=b("All Branches"),L=c([{label:"Today",value:[new Date,new Date]},{label:"This month",value:[S(new Date),A(new Date)]},{label:"Last month",value:[S(T(new Date,1)),A(T(new Date,1))]},{label:"This year",value:[ae(new Date),oe(new Date)]}]),O=v(()=>y.user.branches);c();const d=c([]);c([]);async function I(a=1){t.is_listing=!0,t.dates[0]=p(t.dates[0]).format("YYYY-MM-DD"),t.dates[1]=p(t.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/tax_code_report",{params:{page:a,filter:t}}).then(o=>{console.log(o.data.data),d.value=o.data.data,t.is_listing=!1}).catch(o=>{t.server_messages.type="error",t.server_messages.messages=o,t.is_listing=!1,console.log(o)})}const h=v(()=>d.value.length?{net_tax_amount:d.value.reduce(function(o,g){return o+parseFloat(g.net_tax_amount)},0).toFixed(2)}:null);async function R(){t.is_exporting=!0,t.dates[0]=p(t.dates[0]).format("YYYY-MM-DD"),t.dates[1]=p(t.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/tax_code_report/export_excel",{params:{filter:t}}).then(a=>{if(a.data.status_code==200){t.is_exporting=!1;const o=document.createElement("a");o.target="_blank",o.href=a.data.data.file,document.body.appendChild(o),o.click()}else{try{t.server_messages.type="error",t.server_messages.messages=JSON.parse(a.data.msg)}catch{t.server_messages.type="error",t.server_messages.messages=a.data.msg}t.is_exporting=!1}}).catch(a=>{t.server_messages.type="error",t.server_messages.messages=a,t.is_exporting=!1,console.log(a)})}const j=Q(()=>X(()=>import("./ServerMessage.Re9KOdbP.js"),__vite__mapDeps([0,1,2])));return(a,o)=>{const g=Y("Icon"),K=Y("router-link"),P=te,G=ee,U=Z;return r(),w(U,null,{subheader:m(()=>[e("div",le,[e("div",re,[e("div",ce,[e("div",ie,[u(K,{class:"text-primary",to:"/reports"},{default:m(()=>[u(g,{icon:"fa6-solid:chevron-left"}),M(" "+n(a.$t("Reports")),1)]),_:1})])]),e("div",de,[e("h5",_e,n(a.$t("Tax Code Report")),1)])])])]),default:m(()=>[e("div",ue,[s(t).server_messages.messages!=""?(r(),w(s(j),{key:0,class:"py-3",server_messages:s(t).server_messages},null,8,["server_messages"])):$("",!0),e("div",me,[e("div",pe,[e("div",he,[e("div",ge,[e("label",fe,[M(n(a.$t("Select Dates"))+" ",1),ve]),u(s(ne),{range:"","preset-dates":s(L),modelValue:s(t).dates,"onUpdate:modelValue":o[0]||(o[0]=l=>s(t).dates=l),format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":m(({label:l,value:_,presetDate:f})=>[e("span",{role:"button",tabindex:0,onClick:k=>f(_),onKeyup:[V(C(k=>f(_),["prevent"]),["enter"]),V(C(k=>f(_),["prevent"]),["space"])]},n(l),41,be)]),_:1},8,["preset-dates","modelValue"])])]),e("div",ye,[u(P,{name:"branches",label:s(F),placeholder:s(N),text:"name",value:"id",options:s(O),modelValue:s(t).selected_branch,"onUpdate:modelValue":o[1]||(o[1]=l=>s(t).selected_branch=l),mode:"single"},null,8,["label","placeholder","options","modelValue"])]),e("div",xe,[e("div",ke,[e("div",De,[e("button",{class:"btn btn-primary",onClick:I,disabled:s(t).dates==null},n(a.$t("View")),9,we)]),e("div",Ye,[e("button",{class:"btn btn-success",onClick:o[2]||(o[2]=l=>R()),disabled:s(t).dates==null},n(a.$t("Export Excel")),9,Me)])])])])]),e("div",$e,[e("div",Ve,[s(t).is_listing?(r(),i("div",Ce,[u(G)])):(r(),i("div",Te,[e("table",Se,[e("thead",Ae,[e("tr",null,[e("th",Be,n(a.$t("Tax Code")),1),e("th",Ee,n(a.$t("Tax Name")),1),e("th",Fe,n(a.$t("Tax Percentage")),1),e("th",Ne,n(a.$t("Tax Amount")),1)])]),e("tbody",null,[s(d)!=""?(r(!0),i(J,{key:0},W(s(d),(l,_)=>(r(),i("tr",{key:_},[e("td",null,n(l.code),1),e("td",null,n(l.name),1),e("td",null,n(l.total_percentage),1),e("td",Le,n(l.net_tax_amount.toFixed(2))+" "+n(s(x)),1)]))),128)):(r(),i("tr",Oe,[e("td",Ie,n(a.$t("No Data Found")),1)]))]),s(h)!=""&&s(h)!=null?(r(),i("tfoot",Re,[e("tr",null,[je,e("th",Ke,n(s(B)(s(h).net_tax_amount))+" "+n(s(x)),1)])])):$("",!0)])]))])])])]),_:1})}}};export{tt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.Re9KOdbP.js","assets/index.li3fCRRM.js","assets/index.KTHCd6a8.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
