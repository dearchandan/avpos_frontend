import{_ as A}from"./EditFormSmallSkeleton.5z1v6Gtx.js";import B from"./ServerMessage.EFQMOwoZ.js";import{u as E,a as T,r as v,e as U,o as I,g as d,p as g,w as f,f as w,i as s,l as c,k as M,t as m,j as r,h as u,m as S,K as L,Q as j}from"./index.sP6fhsqN.js";import{D as z}from"./DefaultLayout.K5Bh9Jz_.js";import{F as J}from"./vee-validate.esm.2kXgdFia.js";import{c as K,a as C}from"./index.esm.DHYHwGJ4.js";import{_ as D}from"./VTextInput.EPCajChY.js";import{C as O}from"./ClipLoader._89zL49D.js";import{_ as Q}from"./VSelect.twStq9pE.js";import"./VTooltip.kcvohVRA.js";/* empty css                                                   *//* empty css                                                                */const R={class:"header-nav-wrap"},G={class:"row align-items-center"},H={class:"col-auto"},P={class:"header-back-link"},W={class:"col-auto"},X={key:0,class:"fw-bold"},Y={key:1,class:"fw-bold"},Z={key:0,class:"content"},aa={class:"row card-strash"},ea={key:0,class:"py-3"},sa={class:"col-md-12"},ta={class:"row"},oa={class:"col-md-12 mb-4"},ia={class:"card"},la={class:"row"},da={class:"col-md-3"},na={class:"col-md-3"},ca={class:"col-md-3"},ra={class:"col-md-3 pt-md-2"},ma={class:"form-field pt-md-2"},_a={class:"form-check form-switch pt-md-4"},ua={class:"form-check-label",for:"status"},pa={class:"text-end"},va=["disabled"],fa={key:1,class:"pt-0"},ha={key:2,class:"pt-0"},Ba={__name:"add_customer_display",setup(ya){const{t:l}=E(),t=T().params.slack,h=v({name:l("CDS Name"),activation_code:l("Activation Code"),terminal:l("Select Terminal")}),a=U({...{server_messages:{type:"",messages:""},is_submitting:!1,name:"",activation_code:"",terminal:"",status:!0,cds_slack:""}}),V=K({name:C().required(l("name is required",{name:l("CDS Name")})).min(3,l("name must be at least n characters",{name:l("CDS Name"),number:3})),terminal:C().required(l("name is required",{name:l("Terminal")}))}),$=v([]),k=v([]);I(()=>{t!=""&&t!=null&&q(),x()});const b=v(!1);async function x(){var e=new FormData;e.append("slack",t!=null&&t!=""?t:"");let o=await axios.post("api/customer_display/add",e);(t==""||t==null)&&(a.activation_code=o.data.data.activation_code);let i=o.data.data.terminals;_.forEach(i,p=>{let y={key:p.slack,value:p.terminal_name};k.value.push(y)}),b.value=!0}async function N(){a.is_submitting=!0;var e=new FormData;e.append("name",a.name),e.append("activation_code",a.activation_code),e.append("status",a.status),e.append("terminal",a.terminal),e.append("cds_slack",a.cds_slack);var o=a.cds_slack!=""&&a.cds_slack!=null?"/api/customer_display/update":"/api/customer_display/save";await axios.post(o,e).then(i=>{if(i.data.status_code==200)toast.success(i.data.msg),a.is_submitting=!1,router.push("/customer_displays");else{try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(i.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=i.data.msg}a.is_submitting=!1}}).catch(i=>{a.server_messages.type="error",a.server_messages.messages=i,a.is_submitting=!1,console.log(i)})}async function q(){await axios.get("/api/customer_display",{params:{slack:t}}).then(e=>{$.value=e.data.data.customer_display,e.data.data.customer_display&&(a.cds_slack=e.data.data.customer_display.slack,a.name=e.data.data.customer_display.name,a.terminal=e.data.data.customer_display.terminal?e.data.data.customer_display.terminal.slack:"",a.status=e.data.data.customer_display.status==1,a.activation_code=e.data.data.customer_display.activation_code)}).catch(e=>{a.server_messages.type="error",a.server_messages.messages=e,console.log(e)})}return(e,o)=>{const i=w("Icon"),p=w("router-link"),y=B,F=A;return d(),g(z,null,{subheader:f(()=>[s("div",R,[s("div",G,[s("div",H,[s("div",P,[c(p,{class:"text-primary",to:"/customer_displays"},{default:f(()=>[c(i,{icon:"fa6-solid:chevron-left"}),M(" "+m(e.$t("CDSs")),1)]),_:1})])]),s("div",W,[r(t)==""||r(t)==null?(d(),u("h5",X,m(e.$t("Add CDS")),1)):(d(),u("h5",Y,m(e.$t("Edit CDS")),1))])])])]),default:f(()=>[r(t)==""||r(t)==null||r(t)!=""&&b.value?(d(),u("div",Z,[c(r(J),{"validation-schema":r(V),onSubmit:N,enctype:"multipart/form-data","initial-values":a},{default:f(()=>[s("div",aa,[a.server_messages.messages!=""?(d(),u("div",ea,[c(y,{server_messages:a.server_messages},null,8,["server_messages"])])):S("",!0),s("div",sa,[s("div",ta,[s("div",oa,[s("div",ia,[s("div",la,[s("div",da,[c(D,{type:"text",name:"name",modelValue:a.name,"onUpdate:modelValue":o[0]||(o[0]=n=>a.name=n),label:h.value.name,required:!0},null,8,["modelValue","label"])]),s("div",na,[c(D,{type:"text",name:"activation_code",modelValue:a.activation_code,"onUpdate:modelValue":o[1]||(o[1]=n=>a.activation_code=n),label:h.value.activation_code,required:!0,"aria-disabled":!0,readonly:!0},null,8,["modelValue","label"])]),s("div",ca,[c(Q,{modelValue:a.terminal,"onUpdate:modelValue":o[2]||(o[2]=n=>a.terminal=n),name:"terminal",label:h.value.terminal,options:k.value,required:"",placeholder:"Select Terminal"},null,8,["modelValue","label","options"])]),s("div",ra,[s("div",ma,[s("div",_a,[L(s("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"status",checked:"","onUpdate:modelValue":o[3]||(o[3]=n=>a.status=n)},null,512),[[j,a.status]]),s("label",ua,m(e.$t("Active")),1)])])])])])])])])]),s("div",pa,[s("button",{type:"submit",class:"btn btn-primary",disabled:a.is_submitting},[a.is_submitting?(d(),g(O,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):S("",!0),a.is_submitting?(d(),u("span",fa,m(e.$t("Saving...")),1)):(d(),u("span",ha,m(e.$t("Save")),1))],8,va)])]),_:1},8,["validation-schema","initial-values"])])):(d(),g(F,{key:1}))]),_:1})}}};export{Ba as default};
