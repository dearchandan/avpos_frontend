import{u as J,b as W,r as l,e as C,o as Y,v as G,g as i,p as x,w as $,I as K,f as N,l as h,i as e,t as a,K as U,N as H,j as v,k as Q,m as f,h as r,F as X,x as Z,y as ee,O as se,q as te,_ as oe}from"./index.sP6fhsqN.js";import{D as ae}from"./DefaultLayout.K5Bh9Jz_.js";import{_ as ie}from"./PaginateLimit.T5jDCI_N.js";import{_ as ne}from"./ListingSkeleton.0g9v9IYA.js";import{_ as ce}from"./ManageMenu.dfCD4VJP.js";import"./vue-datepicker.S8gODTVm.js";import"./ClipLoader._89zL49D.js";/* empty css                                                   */const le={class:"content"},re={class:"page-heading"},de={class:"row align-items-center justify-content-between"},_e={class:"col-auto"},ue={class:"mb-0"},he={class:"col-auto"},me={class:"row align-items-center"},ge={class:"col-auto"},pe={class:"form-field page-heading-search-field mb-0"},ve={class:"field-icon"},fe=["placeholder"],ye={class:"icon"},ke={class:"col-auto"},be={key:0},we={key:1,class:"table-responsive"},Ce={class:"table table-list-data table-hover"},$e={class:"bg-light"},Ae={scope:"col",width:"15%"},Se={scope:"col",width:"5%"},Te={scope:"col",width:"10%"},xe={scope:"col",width:"10%"},Ne={scope:"col",width:"10%"},Be={scope:"col",width:"10%"},De={scope:"col",width:"10%"},Le={key:0,scope:"col",class:"text-end",width:"5%"},Ee=["onClick"],Ie={class:"highlighted-list-item"},qe=["onClick"],Pe={class:"fs-5 ls-wider text-dark"},Me=["onClick"],Oe=["onClick"],Re=["onClick"],Ve={key:0,class:"mx-2 rounded rounded-3"},Fe={key:0,class:"text-success"},je={key:1},ze={key:1,class:"badge badge-success mx-2 rounded rounded-3"},Je={key:0,class:"form-feild"},We={class:"form-check form-switch form-switch-2"},Ye=["onChange","checked"],Ge={key:0,class:"text-end"},Ke={class:"row flex-nowrap gx-2 text-end"},Ue={class:"col-auto"},He=["onClick"],Qe={key:0,class:"col-auto"},Xe=["onClick"],Ze={key:1},es={class:"text-center py-3",colspan:"11"},ss={class:"data-footer"},ts={class:"row align-items-center justify-content-between"},os={class:"col-auto"},as={class:"col-auto"},ms={__name:"terminals",setup(is){const{t:m}=J(),{isAuthorized:A}=K(),k=W();l(!1),l({branch:m("Branch"),select_branch:m("Select Branch")});const B={server_messages:{type:"",messages:""},is_listing:!1,search_query:l("")},D=m("Search by name, code"),t=C({...B});Y(()=>{O(),p()}),G(()=>t.search_query,_.debounce(()=>{p()},500));const b=l([]),w=l([]);async function p(s=1){t.is_listing=!0,await axios.get("/api/v2/terminals",{params:{page:s,paginate_limit:S.value,search_query:t.search_query,filter:q}}).then(c=>{b.value=c.data.data,w.value=c.data.pagination,t.is_listing=!1}).catch(c=>{t.server_messages.type="error",t.server_messages.messages=c,t.is_listing=!1,console.log(c)})}l([]);const S=l();async function L(s){S.value=s,await p()}async function E(s){var c=new FormData;c.append("slack",s),await axios.post("/api/terminal/update_status",c).then(d=>{if(d.data.status_code==200)toast.success(d.data.msg);else try{t.server_messages.type="error",t.server_messages.messages=JSON.parse(d.data.msg)}catch{t.server_messages.type="error",t.server_messages.messages=d.data.msg}}).catch(d=>{t.server_messages.type="error",t.server_messages.messages=d,console.log(d)})}l(!1);const I=C({branch:l(""),mode:l(""),type:l(""),status:l("")}),q=C({...I});l(!1);function y(s){router.push("/terminal/"+s)}function P(s){router.push("/terminal/edit/"+s)}async function M(s){var c=m("Are you sure you want to close the opened terminal?");s.terminal_mode==2&&(c=m("Warning: Closing an opened terminal from offline device will discard all your unsynchronized data from the device?"));var d=!1;await Swal.fire({title:c,showCancelButton:!0,confirmButtonText:m("Yes, Close"),confirmButtonColor:"#d33",cancelButtonText:m("Cancel")}).then(n=>{n.isConfirmed&&(d=!0)}),d&&await axios.post("/api/terminal/close",{terminal_id:s.id}).then(n=>{if(n.data.status_code==200)Swal.fire(n.data.msg),n.data.data.terminal_user_id==k.user.id,p();else try{t.server_messages.type="error",t.server_messages.messages=JSON.parse(n.data.msg)}catch{t.server_messages.type="error",t.server_messages.messages=n.data.msg}}).catch(n=>{t.server_messages.type="error",t.server_messages.messages=n,console.log(n)})}const u=l({write:!1,delete:!1});function O(){u.value={write:A("A_WRITE_TERMINAL"),delete:A("A_DELETE_TERMINAL")}}const R=te(()=>oe(()=>import("./CloseRegister.KvN2SUSS.js"),__vite__mapDeps([0,1,2,3,4,5,6])));return(s,c)=>{const d=ce,n=N("Icon"),T=N("router-link"),V=ne,F=ie,j=ae;return i(),x(j,null,{subheader:$(()=>[h(d)]),default:$(()=>[e("div",le,[e("div",re,[e("div",de,[e("div",_e,[e("h2",ue,a(s.$t("Terminals")),1)]),e("div",he,[e("div",me,[e("div",ge,[e("div",pe,[e("div",ve,[U(e("input",{type:"search",class:"form-control form-control-sm form-control-solid",placeholder:v(D),"onUpdate:modelValue":c[0]||(c[0]=o=>t.search_query=o)},null,8,fe),[[H,t.search_query]]),e("div",ye,[h(n,{icon:"fa6-solid:magnifying-glass"})])])])]),e("div",ke,[u.value.write?(i(),x(T,{key:0,class:"btn btn-sm btn-light-primary2",to:"/terminal/add"},{default:$(()=>[Q("+ "+a(s.$t("New Terminal")),1)]),_:1})):f("",!0)])])])])]),t.is_listing?(i(),r("div",be,[h(V)])):(i(),r("div",we,[e("table",Ce,[e("thead",$e,[e("tr",null,[e("th",Ae,a(s.$t("Name")),1),e("th",Se,a(s.$t("Series")),1),e("th",Te,a(s.$t("Activation Code")),1),e("th",xe,a(s.$t("Linked Device")),1),e("th",Ne,a(s.$t("Registered At")),1),e("th",Be,a(s.$t("Availability Status")),1),e("th",De,a(s.$t("Is Active")),1),u.value.write||u.value.delete?(i(),r("th",Le,a(s.$t("Action")),1)):f("",!0)])]),e("tbody",null,[b.value!=""?(i(!0),r(X,{key:0},Z(b.value,(o,z)=>(i(),r("tr",{key:z},[e("td",{onClick:g=>y(o.slack),role:"button",class:ee({"border-start border-5 fw-bold":o.logged_user_id==v(k).user.id})},[e("div",null,[e("span",Ie,a(o.terminal_name),1)])],10,Ee),e("td",{onClick:g=>y(o.slack),role:"button"},a(o.code),9,qe),e("td",Pe,a(o.terminal_login_code),1),e("td",{onClick:g=>y(o.slack),role:"button"},a(o.registered_device_id),9,Me),e("td",{onClick:g=>y(o.slack),role:"button"},a(o.registered_at_label),9,Oe),e("td",{onClick:g=>y(o.slack),role:"button"},[o.logged_user_id!=null?(i(),r("span",Ve,[o.logged_user_id==v(k).user.id?(i(),r("span",Fe,"Opened By You")):(i(),r("span",je,"Opened by "+a(v(k).user.name),1))])):(i(),r("span",ze,"Available"))],8,Re),e("td",null,[o.logged_user_id==null?(i(),r("div",Je,[e("div",We,[e("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:g=>E(o.slack),checked:o.status==1},null,40,Ye)])])):f("",!0)]),u.value.write||u.value.delete?(i(),r("td",Ge,[e("div",Ke,[e("div",Ue,[u.value&&u.value.write?(i(),r("a",{key:0,class:"btn btn-icon btn-xs btn-light",href:"#",onClick:g=>P(o.slack)},[h(n,{icon:"fa6-solid:pen"})],8,He)):f("",!0)]),u.value.write&&o.logged_user_id!=null?(i(),r("div",Qe,[e("a",{class:"btn btn-icon btn-xs btn-light-danger",href:"#",onClick:g=>M(o)},[h(n,{icon:"fa6-solid:arrow-right-from-bracket"})],8,Xe)])):f("",!0)])])):f("",!0)]))),128)):(i(),r("tr",Ze,[e("td",es,a(s.$t("No Data Found")),1)]))])])])),e("div",ss,[e("div",ts,[e("div",os,[h(F,{onPaginate_limit_update:L,pagination:w.value},null,8,["pagination"])]),e("div",as,[h(v(se),{data:w.value,limit:5,onPaginationChangePage:p},null,8,["data"])])])])]),h(v(R))]),_:1})}}};export{ms as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/CloseRegister.KvN2SUSS.js","assets/VTextInput.EPCajChY.js","assets/VTooltip.kcvohVRA.js","assets/index.sP6fhsqN.js","assets/index.KTHCd6a8.css","assets/vee-validate.esm.2kXgdFia.js","assets/index.esm.DHYHwGJ4.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
