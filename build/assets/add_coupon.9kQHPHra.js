import{u as O,a as j,s as R,r as v,e as J,d as x,o as Q,g as m,p as b,w as y,f as C,i as a,k as u,n as f,t as i,j as t,h as d,K as w,Q as q,l as g,A as z,x as G,F as W,q as X,_ as Z}from"./index.7OFNPsHl.js";import{_ as ee}from"./DefaultLayout.nvkZ4UhM.js";import{_ as te}from"./VSelect.UFegTIpk.js";import{_ as oe}from"./VTooltip.n3SV8A0p.js";import{_ as ae}from"./VTextInput.VtSvZjuc.js";import{a as $,E as S,F as se}from"./vee-validate.esm.N3uz7Rsk.js";import{c as ne,a as le,d as h}from"./index.esm.cd1bITNA.js";import{C as ue}from"./ClipLoader.1qNfpKDH.js";import{j as me}from"./vue-datepicker.sD5zgpde.js";import{u as ie}from"./global.wK1y07-b.js";/* empty css                                                                *//* empty css                                                   */const ce={class:"header-nav-wrap"},de={class:"row align-items-center"},re={class:"col-auto"},_e={class:"header-back-link"},pe={class:"col-auto"},fe={key:0,class:"fw-bold"},ye={key:1,class:"fw-bold"},ge={class:"content"},ve={class:"row"},be={class:"col-md-12"},he={class:"row"},Ve={class:"col-md-12 mb-4"},ke={class:"form-field float-end pb-0 mb-0"},xe={class:"form-check form-switch form-switch-2"},Ce={for:"status"},we={key:0,class:"fw-bold text-uppercase text-primary"},qe={key:1,class:"fw-bold text-uppercase text-muted"},$e=["checked"],Se={class:"col-md-12"},Ue={class:"card"},De={class:"row"},Me={class:"col-md-3"},Ne={class:"col-md-3"},Te={class:"col-md-3"},Ae={class:"form-field"},Ie={for:"",class:"label pb-2"},Ye=a("em",null,"*",-1),Ee=a("br",null,null,-1),Fe={class:"label me-3"},Le={class:"col-md-3"},Pe={class:"col-md-3"},Be={class:"col-md-3"},He={class:"col-md-3"},Ke={class:"col-3"},Oe={class:"form-field"},je={for:"",class:"form-label"},Re={class:"col-md-3"},Je={class:"col-md-3"},Qe={key:0,class:"col-md-6"},ze={for:"",class:"label text-dark"},Ge=a("em",{class:"text-danger"},"*",-1),We={key:1,class:"col-3"},Xe={class:"form-field"},Ze={class:"col-md-3"},et={class:"form-field"},tt={class:"form-check form-switch form-switch-2 pt-4"},ot=["checked"],at={class:"col-12"},st={class:"text-end"},nt=["disabled"],lt={key:1,class:"pt-0"},ut={key:2,class:"pt-0"},kt={__name:"add_coupon",setup(mt){const{t:l}=O(),_=j().params.slack,U=R(Multiselect),{customer_types:D,coupon_types:M}=ie(),c=v({coupon_name:l("Coupon Name"),coupon_name_ar:l("Coupon Name (Arabic)"),coupon_percentage:l("Coupon Percentage"),coupon_amount:l("Coupon Amount"),minimum_order_amount:l("Minimum Order Amount"),maximum_discount_amount:l("Maximum Discount Amount"),coupon_quantity:l("Coupon Quantity"),usage_limit_per_customer:l("Usage Limit Per Customer"),note:l("Note"),customer_type:l("Customer Type"),select_customer_type:l("Select Customer Type"),select_customer:l("Select Customers")}),N={server_messages:{type:"",messages:""},is_submitting:!1,coupon_slack:"",coupon_name:"",coupon_name_ar:"",coupon_type:1,coupon_value:"",minimum_order_amount:"",maximum_discount_amount:"",coupon_quantity:"",date_range:"",is_taxable:v(!1),status:v(!0),usage_limit_per_customer:1,customer_type:1,note:"",customers:[],customer_list:[],is_listing:!1},e=J({...N}),T=x(()=>e.date_range!=""&&e.date_range[0]!=null?moment(e.date_range[0]).format("YYYY-MM-DD HH:mm"):""),A=x(()=>e.date_range!=""&&e.date_range[1]!=null?moment(e.date_range[1]).format("YYYY-MM-DD HH:mm"):""),I=ne({coupon_name:le().required(l("name is required",{name:l("Coupon Name")})).matches(/^(\S+$)/g,l("should not contain blankspace",{name:l("Coupon Name")})).min(2,l("name must be at least n characters",{name:l("Coupon Name"),number:2})),coupon_type:h().required(l("name is required",{name:l("Coupon Type")})),coupon_value:h().required(l("name is required",{name:l("Value")})),customer_type:h().required(l("name is required",{name:l("Customer Type")}))});Q(()=>{_!=""&&_!=null&&E()});async function V(){e.customer_type==3&&(e.is_listing=!0,await axios.get("/api/customers/all").then(o=>{e.customer_list=o.data.data,e.is_listing=!1}).catch(o=>{e.server_messages.type="error",e.server_messages.messages=o,e.is_listing=!1,console.log(o)}))}async function Y(){e.is_submitting=!0;var o=new FormData;o.append("coupon_slack",e.coupon_slack),o.append("coupon_name",e.coupon_name),o.append("coupon_name_ar",e.coupon_name_ar),o.append("coupon_type",e.coupon_type),o.append("coupon_value",e.coupon_value),o.append("minimum_order_amount",e.minimum_order_amount),o.append("maximum_discount_amount",e.maximum_discount_amount),o.append("coupon_quantity",e.coupon_quantity),o.append("start_datetime",T.value),o.append("end_datetime",A.value),o.append("is_taxable",e.is_taxable),o.append("status",e.status),o.append("usage_limit_per_customer",e.usage_limit_per_customer),o.append("customer_type",e.customer_type),o.append("note",e.note),o.append("customers",JSON.stringify(e.customers));var s=e.coupon_slack!=""&&e.coupon_slack!=null?"/api/coupon/update":"/api/coupon/save";await axios.post(s,o).then(r=>{if(r.data.status_code==200)toast.success(r.data.msg),e.is_submitting=!1,router.push("/coupons");else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(r.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=r.data.msg}e.is_submitting=!1}}).catch(r=>{e.server_messages.type="error",e.server_messages.messages=r,e.is_submitting=!1,console.log(r)})}async function E(){await axios.get("/api/coupon",{params:{slack:_}}).then(o=>{o.data.data.coupon&&(e.coupon_slack=o.data.data.coupon.slack,e.coupon_name=o.data.data.coupon.name,e.coupon_name_ar=o.data.data.coupon.name_ar,e.coupon_type=parseInt(o.data.data.coupon.type),e.coupon_value=o.data.data.coupon.value,e.minimum_order_amount=o.data.data.coupon.minimum_order_amount,e.maximum_discount_amount=o.data.data.coupon.maximum_discount_amount,e.coupon_quantity=o.data.data.coupon.coupon_quantity,e.date_range=[new Date(String(o.data.data.coupon.start_datetime)),new Date(String(o.data.data.coupon.end_datetime))],e.is_taxable=o.data.data.coupon.is_taxable==1,e.status=o.data.data.coupon.status==1,e.usage_limit_per_customer=1,e.customer_type=o.data.data.coupon.customer_type,o.data.data.coupon.customer_type==3&&V(),o.data.data.coupon.customers!=null&&o.data.data.coupon.customer_type==3&&(e.customers=[],o.data.data.coupon.customers.forEach(s=>{e.customers.includes(s.customer_id)||e.customers.push(s.customer_id)})))}).catch(o=>{e.server_messages.type="error",e.server_messages.messages=o,console.log(o)})}const F=X(()=>Z(()=>import("./ServerMessage.I5ol-gtz.js"),__vite__mapDeps([0,1,2])));return(o,s)=>{const r=C("Icon"),k=C("router-link"),p=ae,L=oe,P=te,B=ee;return m(),b(B,null,{subheader:y(()=>[a("div",ce,[a("div",de,[a("div",re,[a("div",_e,[u(k,{class:"text-primary",to:"/coupons"},{default:y(()=>[u(r,{icon:"fa6-solid:chevron-left"}),f(" "+i(o.$t("Coupons")),1)]),_:1})])]),a("div",pe,[t(_)==""||t(_)==null?(m(),d("h5",fe,i(o.$t("Add Coupon")),1)):(m(),d("h5",ye,i(o.$t("Edit Coupon")),1))])])])]),default:y(()=>[a("div",ge,[u(t(se),{"validation-schema":t(I),onSubmit:Y,enctype:"multipart/form-data"},{default:y(()=>[a("div",ve,[a("div",be,[a("div",he,[a("div",Ve,[a("div",ke,[a("div",xe,[a("label",Ce,[t(e).status?(m(),d("span",we,i(o.$t("Active")),1)):(m(),d("span",qe,i(o.$t("Inactive")),1)),w(a("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"status","onUpdate:modelValue":s[0]||(s[0]=n=>t(e).status=n),checked:t(e).status==1},null,8,$e),[[q,t(e).status]])])])])]),a("div",Se,[t(e).server_messages.messages!=""?(m(),b(t(F),{key:0,class:"py-3",server_messages:t(e).server_messages},null,8,["server_messages"])):g("",!0),a("div",Ue,[a("div",De,[a("div",Me,[u(p,{type:"text",name:"coupon_name",modelValue:t(e).coupon_name,"onUpdate:modelValue":s[1]||(s[1]=n=>t(e).coupon_name=n),label:t(c).coupon_name,required:!0,onKeydown:s[2]||(s[2]=z(n=>n.preventDefault(),["space"]))},null,8,["modelValue","label"])]),a("div",Ne,[u(p,{type:"text",name:"coupon_name_ar",modelValue:t(e).coupon_name_ar,"onUpdate:modelValue":s[3]||(s[3]=n=>t(e).coupon_name_ar=n),label:t(c).coupon_name_ar},null,8,["modelValue","label"])]),a("div",Te,[a("div",Ae,[a("label",Ie,[f(i(o.$t("Coupon Type"))+" ",1),Ye]),f(),Ee,(m(!0),d(W,null,G(t(M),(n,H)=>(m(),d("label",Fe,[u(t($),{class:"form-check-input me-1",name:"coupon_type",type:"radio",id:H,value:n.value,modelValue:t(e).coupon_type,"onUpdate:modelValue":s[4]||(s[4]=K=>t(e).coupon_type=K)},null,8,["id","value","modelValue"]),f(" "+i(n.name),1)]))),256)),u(t(S),{name:"coupon_type",as:"div",class:"error"})])]),a("div",Le,[u(p,{type:"text",name:"coupon_value",modelValue:t(e).coupon_value,"onUpdate:modelValue":s[5]||(s[5]=n=>t(e).coupon_value=n),label:t(e).coupon_type==1?t(c).coupon_percentage:t(c).coupon_amount,required:!0},null,8,["modelValue","label"])]),a("div",Pe,[u(p,{type:"text",name:"minimum_order_amount",modelValue:t(e).minimum_order_amount,"onUpdate:modelValue":s[6]||(s[6]=n=>t(e).minimum_order_amount=n),label:t(c).minimum_order_amount,tooltip:"Total order amount should be more than this to avail the coupon"},null,8,["modelValue","label"])]),a("div",Be,[u(p,{type:"text",name:"maximum_discount_amount",modelValue:t(e).maximum_discount_amount,"onUpdate:modelValue":s[7]||(s[7]=n=>t(e).maximum_discount_amount=n),label:t(c).maximum_discount_amount},null,8,["modelValue","label"])]),a("div",He,[u(p,{type:"text",name:"coupon_quantity",modelValue:t(e).coupon_quantity,"onUpdate:modelValue":s[8]||(s[8]=n=>t(e).coupon_quantity=n),label:t(c).coupon_quantity,tooltip:"keeping it blank will be considered unlimited quantity"},null,8,["modelValue","label"])]),a("div",Ke,[a("div",Oe,[a("label",je,[f(i(o.$t("Date Range"))+" ",1),u(L,{message:"Keeping dates unselected will make it applicable always"})]),u(t(me),{range:"",modelValue:t(e).date_range,"onUpdate:modelValue":s[9]||(s[9]=n=>t(e).date_range=n),format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid"},null,8,["modelValue"])])]),a("div",Re,[u(p,{type:"number",name:"usage_limit_per_customer",modelValue:t(e).usage_limit_per_customer,"onUpdate:modelValue":s[10]||(s[10]=n=>t(e).usage_limit_per_customer=n),label:t(c).usage_limit_per_customer},null,8,["modelValue","label"])]),a("div",Je,[u(P,{name:"customer_type",label:t(c).customer_type,modelValue:t(e).customer_type,"onUpdate:modelValue":s[11]||(s[11]=n=>t(e).customer_type=n),placeholder:t(c).select_customer_type,options:t(D),required:"",onChange:V},null,8,["label","modelValue","placeholder","options"])]),t(e).customer_type==3?(m(),d("div",Qe,[a("label",ze,[f(i(o.$t("Select Customers"))+" ",1),Ge]),u(t(U),{modelValue:t(e).customers,"onUpdate:modelValue":s[12]||(s[12]=n=>t(e).customers=n),name:"customers",options:t(e).customer_list,label:"name",mode:"tags",valueProp:"id",searchable:!0,class:"form-control",placeholder:t(c).select_customer},null,8,["modelValue","options","placeholder"])])):g("",!0),t(_)==""||t(_)==null?(m(),d("div",We,[a("div",Xe,[a("label",null,i(o.$t("Note")),1),u(t($),{as:"textarea",class:"form-control form-control-solid p-3",name:"note",modelValue:t(e).note,"onUpdate:modelValue":s[13]||(s[13]=n=>t(e).note=n),label:t(c).note,cols:"3"},null,8,["modelValue","label"]),u(t(S),{name:"note",as:"div",class:"error"})])])):g("",!0),a("div",Ze,[a("div",et,[a("div",tt,[w(a("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"is_taxable","onUpdate:modelValue":s[14]||(s[14]=n=>t(e).is_taxable=n),checked:t(e).is_taxable==1},null,8,ot),[[q,t(e).is_taxable]]),f(" "+i(o.$t("Is Taxable")),1)])])])])])]),a("div",at,[a("div",st,[a("button",{type:"submit",class:"btn btn-primary",disabled:t(e).is_submitting},[t(e).is_submitting?(m(),b(ue,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):g("",!0),t(e).is_submitting?(m(),d("span",lt,i(o.$t("Saving...")),1)):(m(),d("span",ut,i(o.$t("Save")),1))],8,nt)])])])])])]),_:1},8,["validation-schema"])])]),_:1})}}};export{kt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.I5ol-gtz.js","assets/index.7OFNPsHl.js","assets/index.1t-AB2n6.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
