import{D as G}from"./DefaultLayout.saUWsTkY.js";import{_ as Q}from"./PaginateLimit.SmYeFgfo.js";import{_ as Y}from"./ListingSkeleton.6NzqF9S5.js";import{_ as x}from"./VSelect.xfZK6hek.js";import{u as tt,b as et,d as ot,r as l,e as T,o as st,v as V,g as c,p as at,w as k,f as L,i as t,l as d,k as f,t as o,h as r,m as y,j as E,K as A,M as nt,N as lt,L as it,F as ct,x as dt,O as _t}from"./index.li3fCRRM.js";import{j as rt}from"./vue-datepicker.a6BsTEHj.js";import"./ClipLoader.gDBpDd3b.js";/* empty css                                                   */import"./vee-validate.esm.reM-LHjC.js";/* empty css                                                                */const ut={class:"header-nav-wrap"},mt={class:"row align-items-center"},ht={class:"col-auto"},pt={class:"header-back-link"},vt={class:"col-auto"},ft={class:"fw-bold"},yt={class:"content"},gt={class:"page-heading"},bt={class:"row align-items-center justify-content-between mb-3"},Ct={class:"col-auto"},kt={class:"mb-0"},wt={key:0,class:"col-auto"},$t={class:"row align-items-end justify-content-between g-3"},St={class:"col col-lg-auto order-2 order-md-1"},Nt={class:"row g-3 align-items-end"},Mt={class:"col col-md-auto"},Tt={class:"form-field"},Vt={class:"col-auto col-md-auto"},Et={class:"btn btn-sm btn-light-primary font-weight-normal",type:"button","data-bs-toggle":"collapse","data-bs-target":"#subFilter","aria-expanded":"false","aria-controls":"collapseExample"},At=t("svg",{width:"13",height:"14",viewBox:"0 0 13 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M0.464286 2.33333H7.03022C7.23775 3.136 7.95879 3.73333 8.82143 3.73333C9.68407 3.73333 10.4051 3.136 10.6126 2.33333H12.5357C12.792 2.33333 13 2.12427 13 1.86667C13 1.60907 12.792 1.4 12.5357 1.4H10.6126C10.4051 0.597333 9.68407 0 8.82143 0C7.95879 0 7.23775 0.597333 7.03022 1.4H0.464286C0.208 1.4 0 1.60907 0 1.86667C0 2.12427 0.208 2.33333 0.464286 2.33333ZM8.82143 0.933333C9.33354 0.933333 9.75 1.35193 9.75 1.86667C9.75 2.3814 9.33354 2.8 8.82143 2.8C8.30932 2.8 7.89286 2.3814 7.89286 1.86667C7.89286 1.35193 8.30932 0.933333 8.82143 0.933333ZM12.5357 11.6667H10.6126C10.4051 10.864 9.68407 10.2667 8.82143 10.2667C7.95879 10.2667 7.23775 10.864 7.03022 11.6667H0.464286C0.208 11.6667 0 11.8757 0 12.1333C0 12.3909 0.208 12.6 0.464286 12.6H7.03022C7.23775 13.4027 7.95879 14 8.82143 14C9.68407 14 10.4051 13.4027 10.6126 12.6H12.5357C12.792 12.6 13 12.3909 13 12.1333C13 11.8757 12.792 11.6667 12.5357 11.6667ZM8.82143 13.0667C8.30932 13.0667 7.89286 12.6481 7.89286 12.1333C7.89286 11.6186 8.30932 11.2 8.82143 11.2C9.33354 11.2 9.75 11.6186 9.75 12.1333C9.75 12.6481 9.33354 13.0667 8.82143 13.0667ZM12.5357 6.53333H5.5055C5.29797 5.73067 4.57693 5.13333 3.71429 5.13333C2.85164 5.13333 2.13061 5.73067 1.92307 6.53333H0.464286C0.208 6.53333 0 6.7424 0 7C0 7.2576 0.208 7.46667 0.464286 7.46667H1.92307C2.13061 8.26933 2.85164 8.86667 3.71429 8.86667C4.57693 8.86667 5.29797 8.26933 5.5055 7.46667H12.5357C12.792 7.46667 13 7.2576 13 7C13 6.7424 12.792 6.53333 12.5357 6.53333ZM3.71429 7.93333C3.20218 7.93333 2.78571 7.51473 2.78571 7C2.78571 6.48527 3.20218 6.06667 3.71429 6.06667C4.22639 6.06667 4.64286 6.48527 4.64286 7C4.64286 7.51473 4.22639 7.93333 3.71429 7.93333Z",fill:"currentColor"})],-1),Dt={class:"col-auto col-md-auto"},Ht={class:"col-12 col-md-4 col-lg-3 order-1 order-md-2"},Pt={class:"form-field mb-0"},Bt={class:"field-icon"},Lt=["placeholder"],Ot={class:"icon"},Ut={class:"collapse",id:"subFilter"},Ft={class:"sub-filter"},It={class:"row align-items-center g-3"},jt={class:"col-6 col-md-auto"},qt={class:"col-6 col-md-auto d-md-block"},Rt={class:"form-field"},Zt={value:""},Jt={value:"1"},Wt={value:"2"},Kt={value:"3"},Xt={value:"4"},zt={class:"col-6 col-md-auto d-md-block"},Gt={key:0},Qt={key:1,class:"table-responsive"},Yt={class:"table table-list-data table-hover"},xt={class:"bg-light"},te={scope:"col",width:"20%"},ee={scope:"col",width:"15%"},oe={scope:"col",width:"15%"},se={scope:"col",width:"10%"},ae={scope:"col",width:"10%"},ne={scope:"col",width:"15%"},le={scope:"col",width:"10%"},ie=["onClick"],ce=["onClick"],de={key:0,class:"text-success"},_e={key:1,class:"text-danger"},re=["onClick"],ue={key:0,class:"text-muted"},me=t("br",null,null,-1),he=["onClick"],pe=["onClick"],ve=["onClick"],fe=["onClick"],ye={key:1},ge={class:"text-center py-3",colspan:"11"},be={class:"data-footer"},Ce={class:"row align-items-center justify-content-between"},ke={class:"col-auto"},we={class:"col-auto"},Be={__name:"admin_transactions",setup($e){const{t:u}=tt(),O=et(),D=ot(()=>O.user.currency.symbol);l(!1);const g=l({type:u("Type"),account:u("Account"),select_account:u("Select Account"),payment_method:u("Payment Method"),select_payment_method:u("Select Payment Method"),amount:u("Amount"),transaction_date:u("Transaction Date")}),U={server_messages:{type:"",messages:""},is_listing:!1,search_query:l(""),filter_count:0},F=u("Search by amount"),n=T({...U});st(()=>{p(),j(),q()}),V(()=>n.search_query,_.debounce(()=>{p()},500));const w=l([]),$=l([]),S=l([]),H=l([]);async function p(e=1){n.is_listing=!0,await axios.get("/api/admin_transactions",{params:{page:e,paginate_limit:P.value,search_query:n.search_query,filter:i}}).then(a=>{w.value=a.data.data,$.value=a.data.pagination,n.is_listing=!1}).catch(a=>{n.server_messages.type="error",n.server_messages.messages=a,n.is_listing=!1,console.log(a)})}const P=l();async function I(e){P.value=e,await p()}async function j(){let e=new FormData;e.append("account_type",i.transaction_type);let a=await axios.post("api/admin_accounts/all",e);a=a.data.data,S.value=[],_.forEach(a,h=>{let C={key:h.slack,value:h.name};S.value.push(C)})}async function q(){let e=await axios.get("api/payment_methods/all");e=e.data.data,_.forEach(e,a=>{let h={key:a.slack,value:a.name};H.value.push(h)})}const R=l(!1),N=T({transaction_dates:l(),payment_method:l(),transaction_type:l(""),account:l(""),bill_type:l("")}),i=T({...N});V(()=>i.account,e=>{b()}),V(()=>i.payment_method,e=>{b()});const M=l(!1);async function b(){n.filter_count=0,JSON.stringify(i)!=JSON.stringify(N)&&(M.value=!0),_.forEach(i,(e,a)=>{e!=""&&e!=null&&a!="transaction_dates"&&(n.filter_count=n.filter_count+1)}),R.value=!1,await p()}function Z(){Object.assign(i,N),M.value=!1,n.filter_count=0,p()}function m(e){router.push("/admin/transaction/"+e)}const J=l({write:!0,delete:!0});return(e,a)=>{const h=L("Icon"),C=L("router-link"),B=x,W=Y,K=Q,X=G;return c(),at(X,null,{subheader:k(()=>[t("div",ut,[t("div",mt,[t("div",ht,[t("div",pt,[d(C,{class:"text-primary",to:"/settings"},{default:k(()=>[d(h,{icon:"fa6-solid:chevron-left"}),f(" "+o(e.$t("Settings")),1)]),_:1})])]),t("div",vt,[t("h5",ft,o(e.$t("Transactions")),1)])])])]),default:k(()=>[t("div",yt,[t("div",gt,[t("div",bt,[t("div",Ct,[t("h2",kt,o(e.$t("Transactions")),1)]),J.value.write?(c(),r("div",wt,[d(C,{class:"btn btn-sm btn-light-primary2",to:"/admin/transaction/add"},{default:k(()=>[f("+ "+o(e.$t("New Transaction")),1)]),_:1})])):y("",!0)]),t("div",$t,[t("div",St,[t("div",Nt,[t("div",Mt,[t("div",Tt,[t("label",null,o(e.$t("Date")),1),d(E(rt),{range:"",modelValue:i.transaction_dates,"onUpdate:modelValue":[a[0]||(a[0]=s=>i.transaction_dates=s),a[1]||(a[1]=s=>b())],format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid form-control-sm"},null,8,["modelValue"])])]),t("div",Vt,[t("button",Et,[At,f(" "+o(e.$t("Filters"))+" ",1),A(t("span",{class:"badge",id:"filter_count_badge"},o(n.filter_count),513),[[nt,n.filter_count>0]])])]),t("div",Dt,[M.value?(c(),r("button",{key:0,class:"btn btn-sm btn-light-danger",onClick:Z},o(e.$t("Clear")),1)):y("",!0)])])]),t("div",Ht,[t("div",Pt,[t("div",Bt,[A(t("input",{type:"search",class:"form-control form-control-sm form-control-solid",placeholder:E(F),"onUpdate:modelValue":a[2]||(a[2]=s=>n.search_query=s)},null,8,Lt),[[lt,n.search_query]]),t("div",Ot,[d(h,{icon:"fa6-solid:magnifying-glass"})])])])])]),t("div",Ut,[t("div",Ft,[t("div",It,[t("div",jt,[d(B,{name:"payment_method",label:g.value.payment_method,modelValue:i.payment_method,"onUpdate:modelValue":a[3]||(a[3]=s=>i.payment_method=s),placeholder:g.value.select_payment_method,options:H.value,height_sm:!0},null,8,["label","modelValue","placeholder","options"])]),t("div",qt,[t("div",Rt,[t("label",null,o(e.$t("Bill Type")),1),A(t("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":a[4]||(a[4]=s=>i.bill_type=s),onChange:b},[t("option",Zt,o(e.$t("All")),1),t("option",Jt,o(e.$t("SUBSCRIPTION_PURCHASE")),1),t("option",Wt,o(e.$t("ADDON_PURCHASE")),1),t("option",Kt,o(e.$t("SUBSCRIPTION_RENEWAL")),1),t("option",Xt,o(e.$t("ADDON_RENEWAL")),1)],544),[[it,i.bill_type]])])]),t("div",zt,[d(B,{name:"account",label:g.value.account,modelValue:i.account,"onUpdate:modelValue":a[5]||(a[5]=s=>i.account=s),placeholder:g.value.select_account,options:S.value,height_sm:!0},null,8,["label","modelValue","placeholder","options"])])])])])]),n.is_listing?(c(),r("div",Gt,[d(W)])):(c(),r("div",Qt,[t("table",Yt,[t("thead",xt,[t("tr",null,[t("th",te,o(e.$t("Type")),1),t("th",ee,o(e.$t("Amount")),1),t("th",oe,o(e.$t("Account")),1),t("th",se,o(e.$t("Payment Method")),1),t("th",ae,o(e.$t("Bill Type")),1),t("th",ne,o(e.$t("Bill To Name")),1),t("th",le,o(e.$t("Transaction Date")),1)])]),t("tbody",null,[w.value!=""?(c(!0),r(ct,{key:0},dt(w.value,(s,z)=>(c(),r("tr",{key:z},[t("td",{onClick:v=>m(s.slack),role:"button"},o(s.type),9,ie),t("td",{onClick:v=>m(s.slack),role:"button"},[s.type=="INCOME"?(c(),r("span",de,"+"+o(s.amount)+" "+o(D.value),1)):y("",!0),s.type=="EXPENSE"?(c(),r("span",_e,"-"+o(s.amount)+" "+o(D.value),1)):y("",!0)],8,ce),t("td",{onClick:v=>m(s.slack),role:"button"},[f(o(s.account.name)+" ",1),s.notes!=null&&s.notes!=""?(c(),r("small",ue,[me,f("Note: "+o(s.notes),1)])):y("",!0)],8,re),t("td",{onClick:v=>m(s.slack),role:"button"},o(s.payment_method_name),9,he),t("td",{onClick:v=>m(s.slack),role:"button"},o(s.bill_type_text),9,pe),t("td",{onClick:v=>m(s.slack),role:"button"},o(s.bill_to_name),9,ve),t("td",{onClick:v=>m(s.slack),role:"button"},o(s.transaction_date),9,fe)]))),128)):(c(),r("tr",ye,[t("td",ge,o(e.$t("No Data Found")),1)]))])])])),t("div",be,[t("div",Ce,[t("div",ke,[d(K,{onPaginate_limit_update:I,pagination:$.value},null,8,["pagination"])]),t("div",we,[d(E(_t),{data:$.value,limit:5,onPaginationChangePage:p},null,8,["data"])])])])])]),_:1})}}};export{Be as default};
