import{u as ne,b as le,d as C,e as A,r as i,o as de,g as d,p as O,w as f,f as P,i as e,k as u,n as F,t,j as s,l as p,A as N,B,h as c,F as ce,x as re,O as ie,I as _e,bV as k,q as ue,_ as pe}from"./index.ri7Y_V5F.js";import{_ as he}from"./DefaultLayout.EMHfdzn0.js";import{_ as me}from"./PaginateLimit.Qyl6CO-f.js";import{_ as ge}from"./ListingSkeleton.PW5leU6x.js";import{_ as ve}from"./VMultiSelect.3zUL7lik.js";import{_ as be}from"./VSelect.ijXeZp1F.js";import{s as E,a as ye,e as fe,j as ke}from"./vue-datepicker.gRWbN_6J.js";import{s as R,e as T}from"./index.DsgwUBM9.js";import"./ClipLoader.4-rIzqtH.js";/* empty css                                                   */import"./vee-validate.esm.0La7AMjT.js";/* empty css                                                                */const De={class:"header-nav-wrap"},$e={class:"row align-items-center"},xe={class:"col-auto"},we={class:"header-back-link"},Ve={class:"col-auto"},Se={class:"fw-bold"},Ye={class:"content"},Me={class:"card"},Ce={class:"row field-m-0 align-items-end g-3"},Ae={class:"col-md-4 col-lg-3"},Oe={class:"form-field"},Pe={for:"",class:"form-label"},Fe=e("span",{class:"text-danger"},"*",-1),Ne=["onClick","onKeyup"],Be={class:"col-md-4 col-lg-3"},Ee={class:"col-md-4 col-lg-3"},Re={class:"col-md-4 col-lg-3"},Te={class:"col-auto text-end"},je={class:"row align-items-center"},Le={class:"col-auto"},Ue=["disabled"],qe={class:"col-auto"},Ie=["disabled"],Ke={class:"card"},ze={class:""},Ge={key:0},Je={key:1,class:"table-responsive"},He={class:"table table-list-data table-hover"},Qe={class:"bg-light"},We={scope:"col"},Xe={scope:"col"},Ze={scope:"col"},et={scope:"col"},tt={scope:"col"},st={scope:"col"},at={scope:"col"},ot={scope:"col"},nt={scope:"col"},lt={scope:"col",class:"text-end"},dt={scope:"col",class:"text-end"},ct={scope:"col",class:"text-end"},rt={scope:"col",class:"text-end"},it={class:"text-center"},_t={class:"text-center"},ut={class:"text-center"},pt={class:"text-center"},ht={class:"text-center"},mt={class:"text-center"},gt={class:"text-center"},vt={key:0,class:"badge badge-primary"},bt={key:1,class:"badge badge-success"},yt={key:2,class:"badge badge-warning"},ft={key:3,class:"badge badge-danger"},kt={class:"text-center"},Dt={key:0,class:"badge badge-primary"},$t={key:1,class:"badge badge-success"},xt={key:2,class:"badge badge-warning"},wt={class:"text-end"},Vt={class:"text-end"},St={class:"text-end"},Yt={class:"text-end"},Mt={key:1},Ct={class:"text-center py-3",colspan:"15"},At={key:0},Ot=e("th",{colspan:"9"},null,-1),Pt={class:"text-end"},Ft={class:"text-end"},Nt={class:"text-end"},Bt={class:"text-end"},Et={class:"data-footer"},Rt={class:"row align-items-center justify-content-between"},Tt={class:"col-auto"},jt={class:"col-auto"},ts={__name:"purchase_order_report",setup(Lt){const{t:v}=ne(),{isAuthorized:Ut,getRoundedValue:h}=_e(),w=le(),g=C(()=>w.user.currency.symbol),j=A({server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,dates:i([new Date,new Date]),selected_branch:i(),selected_approval_status:i(),selected_delivery_status:i(),is_exporting:!1}),o=A({...j}),L=v("Select Branch"),U=v("All Branches"),q=v("Select Approval Status"),I=v("All Approval Status"),K=v("Select Delivery Status"),z=v("All Delivery Status"),G=i([{label:"Today",value:[new Date,new Date]},{label:"This month",value:[R(new Date),T(new Date)]},{label:"Last month",value:[R(E(new Date,1)),T(E(new Date,1))]},{label:"This year",value:[ye(new Date),fe(new Date)]}]);de(()=>{Q()});const J=[{key:"0",value:"Draft"},{key:"1",value:"Approved"},{key:"2",value:"Rejected"},{key:"3",value:"Cancelled"}],H=[{key:"0",value:"Undelivered"},{key:"1",value:"Partial Delivered"},{key:"2",value:"Delivered/Closed"}],V=i([]);async function Q(){_.forEach(w.user.branches,a=>{let n={key:a.slack,value:a.name,id:a.slack};V.value.push(n)})}const S=i();async function W(a){S.value=a,await $()}const m=i([]),D=i([]);async function $(a=1){o.is_listing=!0,o.dates[0]=k(o.dates[0]).format("YYYY-MM-DD"),o.dates[1]=k(o.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/purchase_order_report",{params:{page:a,paginate_limit:S.value,filter:o}}).then(n=>{m.value=n.data.data.data,D.value=n.data.pagination,o.is_listing=!1}).catch(n=>{o.server_messages.type="error",o.server_messages.messages=n,o.is_listing=!1,console.log(n)})}const b=C(()=>m.value.length?{grand_subtotal_after_product_quantity:m.value.reduce(function(n,r){return n+parseFloat(r.grand_subtotal_after_product_quantity)},0).toFixed(2),grand_product_tax:m.value.reduce(function(n,r){return n+parseFloat(r.grand_product_tax)},0).toFixed(2),grand_product_other_changes:m.value.reduce(function(n,r){return n+parseFloat(r.grand_product_other_changes)},0).toFixed(2),grand_product_amount:m.value.reduce(function(n,r){return n+parseFloat(r.grand_product_amount)},0).toFixed(2)}:null);async function X(){o.is_exporting=!0,o.dates[0]=k(o.dates[0]).format("YYYY-MM-DD"),o.dates[1]=k(o.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/purchase_order_report/export_excel",{params:{filter:o}}).then(a=>{if(a.data.status_code==200){o.is_exporting=!1;const n=document.createElement("a");n.target="_blank",n.href=a.data.data.file,document.body.appendChild(n),n.click()}else{try{o.server_messages.type="error",o.server_messages.messages=JSON.parse(a.data.msg)}catch{o.server_messages.type="error",o.server_messages.messages=a.data.msg}o.is_exporting=!1}}).catch(a=>{o.server_messages.type="error",o.server_messages.messages=a,o.is_exporting=!1,console.log(a)})}const Z=ue(()=>pe(()=>import("./ServerMessage.qNo4NwTp.js"),__vite__mapDeps([0,1,2])));return(a,n)=>{const r=P("Icon"),ee=P("router-link"),te=be,Y=ve,se=ge,ae=me,oe=he;return d(),O(oe,null,{subheader:f(()=>[e("div",De,[e("div",$e,[e("div",xe,[e("div",we,[u(ee,{class:"text-primary",to:"/reports"},{default:f(()=>[u(r,{icon:"fa6-solid:chevron-left"}),F(" "+t(a.$t("Reports")),1)]),_:1})])]),e("div",Ve,[e("h5",Se,t(a.$t("Purchase Order Report")),1)])])])]),default:f(()=>[e("div",Ye,[s(o).server_messages.messages!=""?(d(),O(s(Z),{key:0,class:"py-3",server_messages:s(o).server_messages},null,8,["server_messages"])):p("",!0),e("div",Me,[e("div",Ce,[e("div",Ae,[e("div",Oe,[e("label",Pe,[F(t(a.$t("Select Dates"))+" ",1),Fe]),u(s(ke),{range:"","preset-dates":s(G),modelValue:s(o).dates,"onUpdate:modelValue":n[0]||(n[0]=l=>s(o).dates=l),format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":f(({label:l,value:y,presetDate:x})=>[e("span",{role:"button",tabindex:0,onClick:M=>x(y),onKeyup:[N(B(M=>x(y),["prevent"]),["enter"]),N(B(M=>x(y),["prevent"]),["space"])]},t(l),41,Ne)]),_:1},8,["preset-dates","modelValue"])])]),e("div",Be,[u(te,{name:"branches",label:s(L),placeholder:s(U),text:"name",value:"id",options:s(V),modelValue:s(o).selected_branch,"onUpdate:modelValue":n[1]||(n[1]=l=>s(o).selected_branch=l)},null,8,["label","placeholder","options","modelValue"])]),e("div",Ee,[u(Y,{name:"approval_status",label:s(q),placeholder:s(I),text:"value",value:"key",options:J,modelValue:s(o).selected_approval_status,"onUpdate:modelValue":n[2]||(n[2]=l=>s(o).selected_approval_status=l),mode:"single"},null,8,["label","placeholder","modelValue"])]),e("div",Re,[u(Y,{name:"delivery_status",label:s(K),placeholder:s(z),text:"value",value:"key",options:H,modelValue:s(o).selected_delivery_status,"onUpdate:modelValue":n[3]||(n[3]=l=>s(o).selected_delivery_status=l),mode:"single"},null,8,["label","placeholder","modelValue"])]),e("div",Te,[e("div",je,[e("div",Le,[e("button",{class:"btn btn-primary",onClick:$,disabled:s(o).dates==null},t(a.$t("View")),9,Ue)]),e("div",qe,[e("button",{class:"btn btn-success",onClick:n[4]||(n[4]=l=>X()),disabled:s(o).dates==null},t(a.$t("Export Excel")),9,Ie)])])])])]),e("div",Ke,[e("div",ze,[s(o).is_listing?(d(),c("div",Ge,[u(se)])):(d(),c("div",Je,[e("table",He,[e("thead",Qe,[e("tr",null,[e("th",We,t(a.$t("Branch Name")),1),e("th",Xe,t(a.$t("PO No.")),1),e("th",Ze,t(a.$t("PO Reference No.")),1),e("th",et,t(a.$t("PO Date")),1),e("th",tt,t(a.$t("PO Due Date")),1),e("th",st,t(a.$t("Supplier Code")),1),e("th",at,t(a.$t("Supplier Name")),1),e("th",ot,t(a.$t("Approval Status")),1),e("th",nt,t(a.$t("Delivery Status")),1),e("th",lt,t(a.$t("Sub Total")),1),e("th",dt,t(a.$t("Tax")),1),e("th",ct,t(a.$t("Other Charges")),1),e("th",rt,t(a.$t("Net Amount")),1)])]),e("tbody",null,[s(m)!=""?(d(!0),c(ce,{key:0},re(s(m),(l,y)=>(d(),c("tr",{key:y},[e("td",null,t(l.branch!=null?l.branch.name:"-"),1),e("td",it,t(l.po_number),1),e("td",_t,t(l.reference_number),1),e("td",ut,t(l.po_date),1),e("td",pt,t(l.due_date),1),e("td",ht,t(l.supplier!=null?l.supplier.code:"-"),1),e("td",mt,t(l.supplier!=null?l.supplier.name:"-"),1),e("td",gt,[l.approval_status==0?(d(),c("span",vt,t(a.$t("Draft")),1)):p("",!0),l.approval_status==1?(d(),c("span",bt,t(a.$t("Approved")),1)):p("",!0),l.approval_status==2?(d(),c("span",yt,t(a.$t("Rejected")),1)):p("",!0),l.approval_status==3?(d(),c("span",ft,t(a.$t("Cancelled")),1)):p("",!0)]),e("td",kt,[l.delivery_status==0?(d(),c("span",Dt,t(a.$t("Undelivered")),1)):p("",!0),l.delivery_status==1?(d(),c("span",$t,t(a.$t("Partial Delivered")),1)):p("",!0),l.delivery_status==2?(d(),c("span",xt,t(a.$t("Delivered/Closed")),1)):p("",!0)]),e("td",wt,t(s(h)(l.grand_subtotal_after_product_quantity))+" "+t(s(g)),1),e("td",Vt,t(s(h)(l.grand_product_tax))+" "+t(s(g)),1),e("td",St,t(s(h)(l.grand_product_other_changes))+" "+t(s(g)),1),e("td",Yt,t(s(h)(l.grand_product_amount))+" "+t(s(g)),1)]))),128)):(d(),c("tr",Mt,[e("td",Ct,t(a.$t("No Data Found")),1)]))]),s(b)!=""&&s(b)!=null?(d(),c("tfoot",At,[e("tr",null,[Ot,e("th",Pt,t(s(h)(s(b).grand_subtotal_after_product_quantity))+" "+t(s(g)),1),e("th",Ft,t(s(h)(s(b).grand_product_tax))+" "+t(s(g)),1),e("th",Nt,t(s(h)(s(b).grand_product_other_changes)),1),e("th",Bt,t(s(h)(s(b).grand_product_amount))+" "+t(s(g)),1)])])):p("",!0)])])),e("div",Et,[e("div",Rt,[e("div",Tt,[u(ae,{onPaginate_limit_update:W,pagination:s(D)},null,8,["pagination"])]),e("div",jt,[u(s(ie),{data:s(D),limit:5,onPaginationChangePage:$},null,8,["data"])])])])])])])]),_:1})}}};export{ts as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.qNo4NwTp.js","assets/index.ri7Y_V5F.js","assets/index.1t-AB2n6.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
