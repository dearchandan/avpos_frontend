import{u as Y,b as j,s as J,P as K,e as q,r as y,v as G,j as a,g as c,h as l,l as d,i as t,t as i,F as f,x as w,k as p,n as D,K as Q,L as W,m as V,p as X}from"./index.GdMxdeuf.js";import{a as S,E as F}from"./vee-validate.esm.9aElOHQY.js";import{B as Z}from"./BeatLoader.czpWuXPY.js";/* empty css                                                   */const ee={key:0,class:"row"},se={key:0,class:"col-md-4"},te={class:"col-md-4"},oe={class:"card"},ae={class:"row"},ne={class:"col-12"},ce={class:"row"},le={class:"col-12 pt-3"},re={class:"form-field me-3"},ie={class:"label me-3 mb-2"},de={key:0,class:"row"},ue={class:"col-12"},me={value:""},pe=["value"],_e={class:"col-12 py-3"},he={class:"table table-condensed"},ve={class:"text-end"},ge=["onClick"],ye=t("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"0.88em",height:"1em",viewBox:"0 0 448 512",class:"iconify iconify--fa6-regular"},[t("path",{fill:"currentColor",d:"m170.5 51.6l-19 28.4h145l-19-28.4c-1.5-2.2-4-3.6-6.7-3.6h-93.7c-2.7 0-5.2 1.3-6.7 3.6zm147-26.6l36.7 55H424c13.3 0 24 10.7 24 24s-10.7 24-24 24h-8v304c0 44.2-35.8 80-80 80H112c-44.2 0-80-35.8-80-80V128h-8c-13.3 0-24-10.7-24-24s10.7-24 24-24h69.8l36.7-55.1C140.9 9.4 158.4 0 177.1 0h93.7c18.7 0 36.2 9.4 46.6 24.9zM80 128v304c0 17.7 14.3 32 32 32h224c17.7 0 32-14.3 32-32V128zm80 64v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16m80 0v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16m80 0v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16"})],-1),fe=[ye],we={key:1,class:"col-md-8"},be={class:"card"},ke={class:"row"},xe={class:"col-12"},Ve={class:"row"},Be={class:"col-12 pt-3"},Ce={class:"form-field me-3"},De={class:"label me-3 mb-2"},Se={key:0,class:"row"},Fe={class:"col-md-5"},$e={class:"col-md-7"},Ae={key:1},Ie={key:0},Pe={key:1,class:"pt-2 text-danger"},ze={class:"col-12 py-3"},Ne={class:"table table-condensed table-bordered"},Me={class:"text-muted"},Re={key:0,class:"text-end"},Te={width:"80%"},Ue={class:"text-end"},He=["onClick"],Ee=t("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"0.88em",height:"1em",viewBox:"0 0 448 512",class:"iconify iconify--fa6-regular"},[t("path",{fill:"currentColor",d:"m170.5 51.6l-19 28.4h145l-19-28.4c-1.5-2.2-4-3.6-6.7-3.6h-93.7c-2.7 0-5.2 1.3-6.7 3.6zm147-26.6l36.7 55H424c13.3 0 24 10.7 24 24s-10.7 24-24 24h-8v304c0 44.2-35.8 80-80 80H112c-44.2 0-80-35.8-80-80V128h-8c-13.3 0-24-10.7-24-24s10.7-24 24-24h69.8l36.7-55.1C140.9 9.4 158.4 0 177.1 0h93.7c18.7 0 36.2 9.4 46.6 24.9zM80 128v304c0 17.7 14.3 32 32 32h224c17.7 0 32-14.3 32-32V128zm80 64v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16m80 0v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16m80 0v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16"})],-1),Le=[Ee],qe={__name:"DiscountAppliedOn",props:["form"],emits:["refreshDiscount"],setup($,{emit:A}){const{t:u}=Y();j();const B=J(Multiselect),I=[{name:u("All Branches"),value:1},{name:u("Specific Branches"),value:0}],P=K($,"form"),e=q(P.value),z=A,N=u("Search By Category"),M=u("Select Product");function b(){z("refreshDiscount")}const _=y("");async function R(){if(_.value!=""){var n=new FormData;n.append("discount_slack",e.discount.slack),n.append("branch_slack",_.value),await axios.post("/api/discount/branch/add",n).then(s=>{toast.success(s.data.msg),b()}).catch(s=>{e.server_messages.type="error",e.server_messages.messages=s,console.log(s)})}}async function T(n){var s=!1;await Swal.fire({title:u("Do you want to remove discount from this branch?"),showCancelButton:!0,confirmButtonText:u("Yes, Delete"),confirmButtonColor:"#d33"}).then(o=>{o.isConfirmed&&(s=!0)}),s&&await axios.post("/api/discount/branch/remove",{slack:n}).then(o=>{if(o.data.status_code==200)toast.success(o.data.msg),b();else try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(o.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=o.data.msg}}).catch(o=>{e.server_messages.type="error",e.server_messages.messages=o,console.log(o)})}async function U(){var n=new FormData;n.append("discount_slack",e.discount.slack),n.append("applies_to_all_branch",e.discount.applies_to_all_branch),await axios.post("/api/discount/branch/apply_to_all_branch",n).then(s=>{}).catch(s=>{e.server_messages.type="error",e.server_messages.messages=s,console.log(s)})}const H=[{name:"All Products",value:1},{name:"Specific Product",value:2}],h=y(""),k=y([]),v=y(""),x=y(!1);async function E(){await L(),await m()}async function L(){var n=new FormData;n.append("discount_slack",e.discount.slack),n.append("inventory_type",e.discount.inventory_type),await axios.post("/api/discount/update_inventory_type",n).then(s=>{}).catch(s=>{e.server_messages.type="error",e.server_messages.messages=s,console.log(s)})}G(h,function(n){m(n)});async function m(n=""){x.value=!0,await axios.get("/api/discount/inventory",{params:{discount_slack:e.discount.slack,category_slack:n}}).then(s=>{k.value=s.data.data.products,x.value=!1,b()}).catch(s=>{e.server_messages.type="error",e.server_messages.messages=s,e.is_product_listing=!1,console.log(s)})}async function O(){if(v.value!=""){var n=new FormData;n.append("discount_slack",e.discount.slack),n.append("product_slack",v.value),await axios.post("/api/discount/inventory/add",n).then(s=>{toast.success(s.data.msg),m()}).catch(s=>{e.server_messages.type="error",e.server_messages.messages=s,console.log(s)})}}async function C(n=""){var s=!1;if(await Swal.fire({title:n!=""?"Remove Item From Discount?":"Remove All Items From Discount?",showCancelButton:!0,confirmButtonText:"Yes, Delete",confirmButtonColor:"#d33"}).then(r=>{r.isConfirmed&&(s=!0)}),s){var o=new FormData;o.append("discount_slack",e.discount.slack),o.append("model_id",n),await axios.post("/api/discount/inventory/remove",o).then(r=>{toast.success(r.data.msg),m()}).catch(r=>{e.server_messages.type="error",e.server_messages.messages=r,console.log(r)})}}return m(),(n,s)=>a(e).discount.slack!=""?(c(),l("div",ee,[a(e).discount.applies_to==2?(c(),l("div",se)):d("",!0),t("div",te,[t("div",oe,[t("div",ae,[t("div",ne,[t("h5",null,i(n.$t("Applicable Branches")),1)])]),t("div",ce,[t("div",le,[t("div",re,[(c(),l(f,null,w(I,(o,r)=>t("label",ie,[p(a(S),{class:"form-check-input me-1",name:"applies_to_all_branch",type:"radio",id:r,value:o.value,modelValue:a(e).discount.applies_to_all_branch,"onUpdate:modelValue":s[0]||(s[0]=g=>a(e).discount.applies_to_all_branch=g),onChange:U},null,8,["id","value","modelValue"]),D(" "+i(o.name),1)])),64)),p(a(F),{name:"applies_to_all_branch",as:"div",class:"error"})])])]),a(e).discount.applies_to_all_branch==0?(c(),l("div",de,[t("div",ue,[Q(t("select",{class:"form-control form-control-solid form-control-sm w-100","onUpdate:modelValue":s[1]||(s[1]=o=>V(_)?_.value=o:null),onChange:R},[t("option",me,"--"+i(n.$t("Select Branch"))+"--",1),(c(!0),l(f,null,w(a(e).branches,(o,r)=>(c(),l("option",{value:o.slack},i(o.name),9,pe))),256))],544),[[W,a(_)]])]),t("div",_e,[t("table",he,[t("tbody",null,[a(e).discount!=""&&a(e).discount.branches!=""?(c(!0),l(f,{key:0},w(a(e).discount.branches,(o,r)=>(c(),l("tr",{key:r},[t("td",null,i(o.branch.name),1),t("td",ve,[t("a",{class:"btn btn-icon btn-xs btn-light-danger",href:"#",onClick:g=>T(o.slack)},fe,8,ge)])]))),128)):d("",!0)])])])])):d("",!0)])]),a(e).discount.applies_to==1?(c(),l("div",we,[t("div",be,[t("div",ke,[t("div",xe,[t("h5",null,i(n.$t("Applicable Inventory")),1)])]),t("div",Ve,[t("div",Be,[t("div",Ce,[(c(),l(f,null,w(H,(o,r)=>t("label",De,[p(a(S),{class:"form-check-input me-1",name:"applies_to_all_products",type:"radio",id:r,value:o.value,modelValue:a(e).discount.inventory_type,"onUpdate:modelValue":s[2]||(s[2]=g=>a(e).discount.inventory_type=g),onChange:E},null,8,["id","value","modelValue"]),D(" "+i(o.name),1)])),64)),p(a(F),{name:"applies_to_all_products",as:"div",class:"error"})])])]),a(e).discount.inventory_type==2?(c(),l("div",Se,[t("div",Fe,[p(a(B),{modelValue:a(h),"onUpdate:modelValue":s[3]||(s[3]=o=>V(h)?h.value=o:null),name:"category",options:a(e).categories,label:"name",valueProp:"slack",mode:"single",searchable:!0,class:"form-control form-control-sm form-control-solid",placeholder:a(N),onSelect:s[4]||(s[4]=o=>m(a(h)))},null,8,["modelValue","options","placeholder"])]),t("div",$e,[a(x)?(c(),X(Z,{key:0,color:"black",size:"10px",class:"pt-4 mt-2 text-start"})):(c(),l("div",Ae,[a(k)!=""?(c(),l("div",Ie,[p(a(B),{modelValue:a(v),"onUpdate:modelValue":s[5]||(s[5]=o=>V(v)?v.value=o:null),name:"product",options:a(k),label:"name",valueProp:"slack",mode:"single",searchable:!0,placeholder:a(M),onSelect:O,class:"form-control form-control-sm form-control-solid"},null,8,["modelValue","options","placeholder"])])):(c(),l("div",Pe,i(n.$t("No Products Found!")),1))]))]),t("div",ze,[t("table",Ne,[t("thead",null,[t("tr",null,[t("th",Me,i(n.$t("Applicable Items")),1),a(e).discount.inventory!=""?(c(),l("th",Re,[t("a",{class:"dropdown-item text-danger fw-bold",href:"#",onClick:s[6]||(s[6]=o=>C())},i(n.$t("Remove All")),1)])):d("",!0)])]),t("tbody",null,[a(e).discount.inventory!=""?(c(!0),l(f,{key:0},w(a(e).discount.inventory,(o,r)=>(c(),l("tr",{key:r},[t("td",Te,i(o.product.name),1),t("td",Ue,[t("a",{class:"btn btn-icon btn-xs btn-light-danger",href:"#",onClick:g=>C(o.product.id)},Le,8,He)])]))),128)):d("",!0)])])])])):d("",!0)])])):d("",!0)])):d("",!0)}};export{qe as default};
