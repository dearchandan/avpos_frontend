import{_ as B}from"./EditFormSkeleton.Pn2vxq9j.js";import D from"./ServerMessage.Wf7puwQc.js";import{u as F,a as L,r as p,e as R,o as T,j as c,g as m,p as f,w as j,k as n,h,l as S,i as l,Q as O,K as P,t as g}from"./index.GdMxdeuf.js";import{F as W}from"./vee-validate.esm.9aElOHQY.js";import{c as z,a as b}from"./index.esm.0vhAmrVd.js";import{_ as r}from"./VTextInput.ZgtOiOMJ.js";import{C as G}from"./ClipLoader.UcGuNCxH.js";import{_ as I}from"./VSelect.c4Loo_XL.js";const J={class:"row card-strash"},K={key:0,class:"py-3"},Q={class:"col-md-12"},Z={class:"row"},H={class:"col-md-12 mb-4"},X={class:"card"},Y={class:"row"},ee={class:"col-md-6 col-lg-3"},ae={class:"col-md-6 col-lg-3"},te={class:"col-md-6 col-lg-3"},se={class:"col-md-6 col-lg-3"},le={class:"col-md-6 col-lg-3"},ie={class:"col-md-6 col-lg-3"},oe={class:"col-md-6 col-lg-3"},ne={class:"col-md-6 col-lg-3 pt-2"},de={class:"form-field pt-2"},re={class:"form-check form-switch pt-4"},me={class:"form-check-label",for:"status"},ue={class:"col-md-12 mb-4"},ce={class:"card"},_e={class:"pb-3"},pe={class:"row"},ge={class:"col-md-6 col-lg-3"},be={class:"col-md-6 col-lg-3"},ve={class:"col-md-6 col-lg-3"},ye={class:"col-md-6 col-lg-3"},fe={class:"col-md-6 col-lg-3"},he={class:"text-end"},Ve=["disabled"],xe={key:1,class:"pt-0"},ke={key:2,class:"pt-0"},Me={__name:"AddSupplier",props:{redirection:{type:String,required:!1,default:""},slack:{type:String,required:!1,default:""},popupWindow:{type:Boolean,required:!1,default:""}},emits:["closeAddSupplierModal"],setup(w,{emit:q}){const{t:s}=F();L();const o=p({name:s("Supplier Name"),email:s("Supplier Email"),phone:s("Supplier Phone"),country:s("Country"),tax_registration_number:s("Tax Registration Number"),tax_registration_name:s("Tax Registration Name"),gst_number:s("GST Number"),first_address_line:s("Address Line 1"),second_address_line:s("Address Line 2"),city:s("City"),pincode:s("Pincode/Zipcode"),state:s("State"),select_country:s("Select Country")}),V={server_messages:{type:"",messages:""},is_submitting:!1,name:"",email:"",phone:"",tax_registration_number:"",tax_registration_name:"",gst_number:"",status:!0,first_address_line:"",second_address_line:"",city:"",pincode:"",state:"",country:"",supplier_slack:"",redirection:""},e=R({...V}),v=w;e.redirection=v.redirection;const u=v.slack,U=z({name:b().required(s("name is required",{name:s("Supplier Name")})).min(3,s("name must be at least n characters",{name:s("Supplier Name"),number:3})),country:b().required(s("name is required",{name:s("Country")})),email:b().required(s("name is required",{name:s("Email")})).min(3,s("name must be at least n characters",{name:s("Email"),number:3})).email(s("must be a valid email",{name:s("Email")})),phone:b().matches(/^[0-9]{9,10}$/,s("Mobile number must be 9 or 10 digits")).typeError(s("must be a number",{name:s("Mobile Number")})).required(s("name is required",{name:s("Mobile Number")}))}),y=p([]),N=p([]);T(()=>{C(),u!=null&&$()});async function C(){y.value=[];let a=await axios.get("api/v2/countries/all");a=a.data.data,_.forEach(a,t=>{let d={key:t.slack,value:t.name};y.value.push(d)})}const x=p(!1);async function $(){await axios.get("/api/supplier",{params:{slack:u}}).then(a=>{N.value=a.data.data,a.data.data.slack!=null&&(e.supplier_slack=a.data.data.slack,e.name=a.data.data.name,e.email=a.data.data.email,e.city=a.data.data.city,e.state=a.data.data.state,e.gst_number=a.data.data.gst_number,e.tax_registration_number=a.data.data.tax_registration_number,e.tax_registration_name=a.data.data.tax_registration_name,e.phone=a.data.data.phone,e.first_address_line=a.data.data.first_address_line,e.second_address_line=a.data.data.second_address_line,e.pincode=a.data.data.postal_code,e.status=a.data.data.status==1,e.country=a.data.data.supplier?a.data.data.supplier.country.slack:"",x.value=!0)}).catch(a=>{e.server_messages.type="error",e.server_messages.messages=a,console.log(a)})}async function E(){e.is_submitting=!0;var a=new FormData;a.append("name",e.name),a.append("email",e.email),a.append("phone",e.phone),a.append("tax_registration_number",e.tax_registration_number),a.append("tax_registration_name",e.tax_registration_name),a.append("gst_number",e.gst_number),a.append("first_address_line",e.first_address_line),a.append("second_address_line",e.second_address_line),a.append("city",e.city),a.append("pincode",e.pincode),a.append("state",e.state),a.append("country",e.country),a.append("supplier_slack",e.supplier_slack),a.append("status",e.status);var t=e.supplier_slack!=""&&e.supplier_slack!=null?"/api/supplier/update":"/api/supplier/save";await axios.post(t,a).then(d=>{if(d.data.status_code==200)toast.success(d.data.msg),e.is_submitting=!1,A("closeAddSupplierModal"),M(),v.popupWindow==!1&&router.push("/suppliers");else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(d.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=d.data.msg}e.is_submitting=!1}}).catch(d=>{e.server_messages.type="error",e.server_messages.messages=d,e.is_submitting=!1,console.log(d)})}function M(){Object.assign(e,V)}const A=q;return(a,t)=>{const d=D,k=B;return c(u)==""||c(u)==null||c(u)!=""&&x.value?(m(),f(c(W),{key:0,"validation-schema":c(U),onSubmit:E,enctype:"multipart/form-data","initial-values":e},{default:j(()=>[l("div",J,[e.server_messages.messages!=""?(m(),h("div",K,[n(d,{server_messages:e.server_messages},null,8,["server_messages"])])):S("",!0),l("div",Q,[l("div",Z,[l("div",H,[l("div",X,[l("div",Y,[l("div",ee,[n(r,{type:"text",name:"name",modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=i=>e.name=i),label:o.value.name,required:!0},null,8,["modelValue","label"])]),l("div",ae,[n(I,{name:"country",label:o.value.country,modelValue:e.country,"onUpdate:modelValue":t[1]||(t[1]=i=>e.country=i),placeholder:o.value.select_country,options:y.value,required:!0},null,8,["label","modelValue","placeholder","options"])]),l("div",te,[n(r,{type:"email",name:"email",modelValue:e.email,"onUpdate:modelValue":t[2]||(t[2]=i=>e.email=i),label:o.value.email,required:!0},null,8,["modelValue","label"])]),l("div",se,[n(r,{type:"text",name:"phone",modelValue:e.phone,"onUpdate:modelValue":t[3]||(t[3]=i=>e.phone=i),label:o.value.phone,required:!0},null,8,["modelValue","label"])]),l("div",le,[n(r,{type:"text",name:"tax_registration_name",modelValue:e.tax_registration_name,"onUpdate:modelValue":t[4]||(t[4]=i=>e.tax_registration_name=i),label:o.value.tax_registration_name},null,8,["modelValue","label"])]),l("div",ie,[n(r,{type:"text",name:"tax_registration_number",modelValue:e.tax_registration_number,"onUpdate:modelValue":t[5]||(t[5]=i=>e.tax_registration_number=i),label:o.value.tax_registration_number},null,8,["modelValue","label"])]),l("div",oe,[n(r,{type:"text",name:"gst_number",modelValue:e.gst_number,"onUpdate:modelValue":t[6]||(t[6]=i=>e.gst_number=i),label:o.value.gst_number},null,8,["modelValue","label"])]),l("div",ne,[l("div",de,[l("div",re,[P(l("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"status",checked:"","onUpdate:modelValue":t[7]||(t[7]=i=>e.status=i)},null,512),[[O,e.status]]),l("label",me,g(a.$t("Active")),1)])])])])])]),l("div",ue,[l("div",ce,[l("h5",_e,g(a.$t("Address")),1),l("div",pe,[l("div",ge,[n(r,{type:"text",name:"first_address_line",modelValue:e.first_address_line,"onUpdate:modelValue":t[8]||(t[8]=i=>e.first_address_line=i),label:o.value.first_address_line},null,8,["modelValue","label"])]),l("div",be,[n(r,{type:"text",name:"second_address_line",modelValue:e.second_address_line,"onUpdate:modelValue":t[9]||(t[9]=i=>e.second_address_line=i),label:o.value.second_address_line},null,8,["modelValue","label"])]),l("div",ve,[n(r,{type:"text",name:"city",modelValue:e.city,"onUpdate:modelValue":t[10]||(t[10]=i=>e.city=i),label:o.value.city},null,8,["modelValue","label"])]),l("div",ye,[n(r,{type:"text",name:"pincode",modelValue:e.pincode,"onUpdate:modelValue":t[11]||(t[11]=i=>e.pincode=i),label:o.value.pincode},null,8,["modelValue","label"])]),l("div",fe,[n(r,{type:"text",name:"state",modelValue:e.state,"onUpdate:modelValue":t[12]||(t[12]=i=>e.state=i),label:o.value.state},null,8,["modelValue","label"])])])])])])])]),l("div",he,[l("button",{type:"submit",class:"btn btn-primary",disabled:e.is_submitting},[e.is_submitting?(m(),f(G,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):S("",!0),e.is_submitting?(m(),h("span",xe,g(a.$t("Saving...")),1)):(m(),h("span",ke,g(a.$t("Save")),1))],8,Ve)])]),_:1},8,["validation-schema","initial-values"])):(m(),f(k,{key:1}))}}};export{Me as _};
