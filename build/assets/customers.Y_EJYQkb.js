import{_ as W}from"./ActionButtonGroup.AvqLZ7Zu.js";import{_ as z}from"./ListingSkeleton.0g9v9IYA.js";import{u as K,b as Y,r as l,e as S,o as H,v as Q,g as c,p as X,w as N,I as Z,f as B,l as u,i as e,t as s,h as d,k as x,m as g,j as A,K as D,L as E,N as ee,F as te,x as se,O as oe}from"./index.sP6fhsqN.js";import{D as ae}from"./DefaultLayout.K5Bh9Jz_.js";import{_ as ne}from"./PaginateLimit.T5jDCI_N.js";import{j as ie}from"./vue-datepicker.S8gODTVm.js";import{_ as le}from"./ManageMenu.dfCD4VJP.js";import"./ClipLoader._89zL49D.js";/* empty css                                                   */const ce={class:"content"},re={class:"page-heading"},de={class:"row align-items-center justify-content-between mb-3"},_e={class:"col-auto"},ue={class:"mb-0"},me={key:0,class:"col-auto"},he={class:"row align-items-end justify-content-between mb-3"},fe={class:"col-md-auto"},pe={class:"row align-items-end justify-content-between g-3"},ve={class:"col-12 col-md-auto"},ge={class:"form-field"},ye={class:"col col-md-auto"},ke={class:"form-field"},be={value:""},we={value:"1"},Ce={value:"0"},$e={class:"col col-md-auto"},Se={class:"form-field"},Ne={class:"form-label"},Ae={value:""},De={value:"1"},Te={value:"2"},Ve={class:"col-auto col-md-auto"},Be={class:"col-auto"},Ee={class:"form-field page-heading-search-field mb-0"},je={class:"field-icon"},Oe=["placeholder"],Ie={class:"icon"},Me={key:0},qe={key:1,class:"table-responsive"},Fe={class:"table table-list-data table-hover"},Le={class:"bg-light"},Ue={scope:"col",width:"20%"},Pe={scope:"col",width:"15%"},Je={scope:"col",width:"10%"},Re={scope:"col",width:"10%"},Ge={scope:"col",width:"10%"},We={scope:"col",width:"10%"},ze={scope:"col",width:"10%"},Ke={key:0,scope:"col",class:"text-end",width:"5%"},Ye=["onClick"],He={class:"fw-bold highlighted-list-item"},Qe=e("br",null,null,-1),Xe={class:"text-muted"},Ze=["onClick"],xe=["onClick"],et=["onClick"],tt=["onClick"],st=["onClick"],ot={class:"form-feild"},at={class:"form-check form-switch form-switch-2"},nt=["onChange","checked"],it={key:0,class:"text-end"},lt={key:1},ct={class:"text-center py-3",colspan:"11"},rt={class:"data-footer"},dt={class:"row align-items-center justify-content-between"},_t={class:"col-auto"},ut={class:"col-auto"},Ct={__name:"customers",setup(mt){const{isAuthorized:T}=Z(),{t:v}=K();Y(),l(!1);const j={server_messages:{type:"",messages:""},is_listing:!1,search_query:l("")},O=v("Search by name, email, phone.."),a=S({...j});H(()=>{P(),m()}),Q(()=>a.search_query,_.debounce(()=>{m()},500));const y=l([]),k=l([]);async function m(t=1){a.is_listing=!0,await axios.get("/api/v2/customers/paginate",{params:{page:t,paginate_limit:V.value,search_query:a.search_query,filter:r}}).then(n=>{y.value=n.data.data,k.value=n.data.pagination,a.is_listing=!1}).catch(n=>{a.server_messages.type="error",a.server_messages.messages=n,a.is_listing=!1,console.log(n)})}const V=l();async function I(t){V.value=t,await m()}async function M(t){var n=new FormData;n.append("slack",t),await axios.post("/api/customer/update_status",n).then(i=>{if(i.data.status_code==200)toast.success(i.data.msg);else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(i.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=i.data.msg}}).catch(i=>{a.server_messages.type="error",a.server_messages.messages=i,console.log(i)})}const q=l(!1),b=S({created_date:l(),status:l(""),type:l("")}),r=S({...b}),w=l(!1);async function C(){JSON.stringify(r)!=JSON.stringify(b)&&(w.value=!0),q.value=!1,await m()}function F(){Object.assign(r,b),w.value=!1,m()}function f(t){router.push("/customer/"+t)}function L(t){router.push("/customer/edit/"+t)}async function U(t){var n=!1;await Swal.fire({title:v("Do you want to delete this Customer?"),showCancelButton:!0,confirmButtonText:v("Yes, Delete"),confirmButtonColor:"#d33",cancelButtonText:v("Cancel")}).then(i=>{i.isConfirmed&&(n=!0)}),n&&await axios.post("/api/customer/delete",{slack:t}).then(i=>{if(i.data.status_code==200)Swal.fire(i.data.msg),m();else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(i.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=i.data.msg}}).catch(i=>{a.server_messages.type="error",a.server_messages.messages=i,console.log(i)})}const h=l({write:!1,delete:!1});function P(){h.value={write:T("A_WRITE_CUSTOMER"),delete:T("A_DELETE_CUSTOMER")}}return(t,n)=>{const i=B("router-link"),$=B("Icon"),J=z,R=W;return c(),X(ae,null,{subheader:N(()=>[u(le)]),default:N(()=>[e("div",ce,[e("div",re,[e("div",de,[e("div",_e,[e("h2",ue,s(t.$t("Customers")),1)]),h.value.write?(c(),d("div",me,[u(i,{class:"btn btn-sm btn-light-primary2",to:"/customer/add"},{default:N(()=>[x("+ "+s(t.$t("New Customer")),1)]),_:1})])):g("",!0)]),e("div",he,[e("div",fe,[e("div",pe,[e("div",ve,[e("div",ge,[e("label",null,s(t.$t("Created Date")),1),u(A(ie),{range:"",modelValue:r.created_date,"onUpdate:modelValue":[n[0]||(n[0]=o=>r.created_date=o),n[1]||(n[1]=o=>C())],format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid form-control-sm"},null,8,["modelValue"])])]),e("div",ye,[e("div",ke,[e("label",null,s(t.$t("Status")),1),D(e("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":n[2]||(n[2]=o=>r.status=o),onChange:C},[e("option",be,s(t.$t("All")),1),e("option",we,s(t.$t("Active")),1),e("option",Ce,s(t.$t("Inactive")),1)],544),[[E,r.status]])])]),e("div",$e,[e("div",Se,[e("label",Ne,s(t.$t("Type")),1),D(e("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":n[3]||(n[3]=o=>r.type=o),onChange:C},[e("option",Ae,s(t.$t("All")),1),e("option",De,s(t.$t("Regular")),1),e("option",Te,s(t.$t("Walk-In")),1)],544),[[E,r.type]])])]),e("div",Ve,[w.value?(c(),d("button",{key:0,class:"btn btn-sm btn-light-danger",onClick:F},s(t.$t("Clear")),1)):g("",!0)])])]),e("div",Be,[e("div",Ee,[e("div",je,[D(e("input",{type:"search",class:"form-control form-control-sm form-control-solid",placeholder:A(O),"onUpdate:modelValue":n[4]||(n[4]=o=>a.search_query=o)},null,8,Oe),[[ee,a.search_query]]),e("div",Ie,[u($,{icon:"fa6-solid:magnifying-glass"})])])])])])]),a.is_listing?(c(),d("div",Me,[u(J)])):(c(),d("div",qe,[e("table",Fe,[e("thead",Le,[e("tr",null,[e("th",Ue,s(t.$t("Customer Name")),1),e("th",Pe,s(t.$t("Email")),1),e("th",Je,s(t.$t("Phone")),1),e("th",Re,s(t.$t("VAT")),1),e("th",Ge,s(t.$t("GST Number")),1),e("th",We,s(t.$t("Created At")),1),e("th",ze,s(t.$t("Active")),1),h.value.write||h.value.delete?(c(),d("th",Ke,s(t.$t("Action")),1)):g("",!0)])]),e("tbody",null,[y.value!=""?(c(!0),d(te,{key:0},se(y.value,(o,G)=>(c(),d("tr",{key:G},[e("td",{onClick:p=>f(o.slack),role:"button"},[e("div",null,[e("span",He,s(o.name),1),Qe,e("small",Xe,s(t.$t("Code"))+": "+s(o.code),1)])],8,Ye),e("td",{onClick:p=>f(o.slack),role:"button"},s(o.email),9,Ze),e("td",{onClick:p=>f(o.slack),role:"button"},s(o.phone),9,xe),e("td",{onClick:p=>f(o.slack),role:"button"},s(o.vat_number),9,et),e("td",{onClick:p=>f(o.slack),role:"button"},s(o.gst_number),9,tt),e("td",{onClick:p=>f(o.slack),role:"button"},s(o.created_at_label),9,st),e("td",null,[e("div",ot,[e("div",at,[e("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:p=>M(o.slack),checked:o.status==1},null,40,nt)])])]),h.value.write||h.value.delete?(c(),d("td",it,[u(R,{permissions:h.value,onEdit:L,onDelete:U,slack:o.slack},null,8,["permissions","slack"])])):g("",!0)]))),128)):(c(),d("tr",lt,[e("td",ct,s(t.$t("No Data Found")),1)]))])])])),e("div",rt,[e("div",dt,[e("div",_t,[u(ne,{onPaginate_limit_update:I,pagination:k.value},null,8,["pagination"])]),e("div",ut,[u(A(oe),{data:k.value,limit:5,onPaginationChangePage:m},null,8,["data"])])])])])]),_:1})}}};export{Ct as default};
