import{_ as L}from"./ActionButtonGroup.UoCDvTnh.js";import{_ as J}from"./ListingSkeleton.PW5leU6x.js";import{_ as E}from"./VoucherMenu.2wt_4vQ9.js";import{u as Q,b as T,r as l,e as v,o as G,v as K,g as d,p as z,w as y,f as V,k as c,i as t,t as e,n as H,j as b,K as S,L as R,h as m,l as W,N as X,F as Y,x as Z,O as x}from"./index.ri7Y_V5F.js";import{_ as tt}from"./DefaultLayout.EMHfdzn0.js";import{_ as st}from"./PaginateLimit.Qyl6CO-f.js";import{j as et}from"./vue-datepicker.gRWbN_6J.js";import"./ClipLoader.4-rIzqtH.js";/* empty css                                                   */const ot={class:"content"},at={class:"page-heading"},nt={class:"row align-items-center justify-content-between mb-3"},it={class:"col-auto"},lt={class:"mb-0"},ct={class:"col-auto"},rt={class:"row align-items-end justify-content-between mb-3"},dt={class:"col-md-auto"},_t={class:"row align-items-end justify-content-between g-3"},ut={class:"col-12 col-md-auto"},mt={class:"form-field"},ht={class:"col col-md-auto"},pt={class:"form-field"},ft={value:""},gt={value:"1"},vt={value:"0"},yt={class:"col-auto col-md-auto"},bt={class:"col-auto"},wt={class:"form-field page-heading-search-field mb-0"},kt={class:"field-icon"},$t=["placeholder"],Vt={class:"icon"},St={key:0},Ct={key:1,class:"table-responsive"},Nt={class:"table table-list-data table-hover"},At={class:"bg-light"},jt={scope:"col",width:"10%"},Mt={scope:"col",width:"10%"},qt={scope:"col",width:"20%"},Ut={scope:"col",width:"10%"},Dt={scope:"col",width:"10%"},It={scope:"col",class:"text-end",width:"5%"},Bt={role:"button"},Ft={role:"button"},Ot={role:"button"},Pt={role:"button"},Lt={role:"button"},Jt={class:"form-feild"},Et={class:"form-check form-switch form-switch-2"},Qt=["onChange","checked"],Tt={class:"text-end"},Gt={key:1},Kt={class:"text-center py-3",colspan:"11"},zt={class:"data-footer"},Ht={class:"row align-items-center justify-content-between"},Rt={class:"col-auto"},Wt={class:"col-auto"},ls={__name:"voucher_users",setup(Xt){const{t:C}=Q();T();const N={server_messages:{type:"",messages:""},is_listing:!1,search_query:l("")},A=C("Search by name, country, IQAMA/ Passport"),a=v({...N});G(()=>{u()}),K(()=>a.search_query,_.debounce(()=>{u()},500));const h=l([]),p=l([]);async function u(s=1){a.is_listing=!0,await axios.get("/api/voucher_users",{params:{page:s,paginate_limit:w.value,search_query:a.search_query,filter:r,type:1}}).then(o=>{h.value=o.data.data,p.value=o.data.pagination,a.is_listing=!1}).catch(o=>{a.server_messages.type="error",a.server_messages.messages=o,a.is_listing=!1,console.log(o)})}const w=l();async function j(s){w.value=s,await u()}async function M(s){var o=new FormData;o.append("slack",s),await axios.post("/api/voucher_user/update_status",o).then(i=>{if(i.data.status_code==200)toast.success(i.data.msg);else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(i.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=i.data.msg}}).catch(i=>{a.server_messages.type="error",a.server_messages.messages=i,console.log(i)})}const q=l(!1),f=v({dates:l(),status:l("")}),r=v({...f}),g=l(!1);async function k(){JSON.stringify(r)!=JSON.stringify(f)&&(g.value=!0),q.value=!1,await u()}function U(){Object.assign(r,f),g.value=!1,u()}function D(s){router.push("/voucher_user/edit/"+s)}const I=l({write:!0,delete:!1});return(s,o)=>{const i=E,$=V("router-link"),B=V("Icon"),F=J,O=L;return d(),z(tt,null,{subheader:y(()=>[c(i)]),default:y(()=>[t("div",ot,[t("div",at,[t("div",nt,[t("div",it,[t("h2",lt,e(s.$t("Voucher Users")),1)]),t("div",ct,[c($,{class:"btn btn-sm btn-light-primary2",to:"/voucher_user/add"},{default:y(()=>[H("+ "+e(s.$t("New Voucher User")),1)]),_:1})])]),t("div",rt,[t("div",dt,[t("div",_t,[t("div",ut,[t("div",mt,[t("label",null,e(s.$t("Created Date")),1),c(b(et),{range:"",modelValue:r.dates,"onUpdate:modelValue":[o[0]||(o[0]=n=>r.dates=n),o[1]||(o[1]=n=>k())],format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid form-control-sm"},null,8,["modelValue"])])]),t("div",ht,[t("div",pt,[t("label",null,e(s.$t("Status")),1),S(t("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":o[2]||(o[2]=n=>r.status=n),onChange:k},[t("option",ft,e(s.$t("All")),1),t("option",gt,e(s.$t("Active")),1),t("option",vt,e(s.$t("Inactive")),1)],544),[[R,r.status]])])]),t("div",yt,[g.value?(d(),m("button",{key:0,class:"btn btn-sm btn-light-danger",onClick:U},e(s.$t("Clear")),1)):W("",!0)])])]),t("div",bt,[t("div",wt,[t("div",kt,[S(t("input",{type:"search",class:"form-control form-control-sm form-control-solid",placeholder:b(A),"onUpdate:modelValue":o[3]||(o[3]=n=>a.search_query=n)},null,8,$t),[[X,a.search_query]]),t("div",Vt,[c(B,{icon:"fa6-solid:magnifying-glass"})])])])])])]),a.is_listing?(d(),m("div",St,[c(F)])):(d(),m("div",Ct,[t("table",Nt,[t("thead",At,[t("tr",null,[t("th",jt,e(s.$t("Name")),1),t("th",Mt,e(s.$t("IQAMA/Passport No.")),1),t("th",qt,e(s.$t("Country")),1),t("th",Ut,e(s.$t("Created Date")),1),t("th",Dt,e(s.$t("Status")),1),t("th",It,e(s.$t("Action")),1)])]),t("tbody",null,[h.value!=""?(d(!0),m(Y,{key:0},Z(h.value,(n,P)=>(d(),m("tr",{key:P},[t("td",Bt,e(n.name),1),t("td",Ft,e(n.iqama_or_passport_number),1),t("td",Ot,e(n.country),1),t("td",Pt,e(n.created_at_label),1),t("td",Lt,[t("div",Jt,[t("div",Et,[t("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:Yt=>M(n.slack),checked:n.status==1},null,40,Qt)])])]),t("td",Tt,[c(O,{permissions:I.value,onEdit:D,slack:n.slack},null,8,["permissions","slack"])])]))),128)):(d(),m("tr",Gt,[t("td",Kt,e(s.$t("No Data Found")),1)]))])])])),t("div",zt,[t("div",Ht,[t("div",Rt,[c(st,{onPaginate_limit_update:j,pagination:p.value},null,8,["pagination"])]),t("div",Wt,[c(b(x),{data:p.value,limit:5,onPaginationChangePage:u},null,8,["data"])])])])])]),_:1})}}};export{ls as default};
