import{u as H,b as Q,d as x,e as Y,r as m,g as d,p as $,w as g,f as M,i as e,k as _,n as V,t as l,j as s,l as C,A as O,B as A,h as p,F as W,x as X,O as Z,I as ee,bV as v,q as te,_ as se}from"./index.ri7Y_V5F.js";import{_ as ae}from"./DefaultLayout.EMHfdzn0.js";import{_ as oe}from"./PaginateLimit.Qyl6CO-f.js";import{_ as ne}from"./ListingSkeleton.PW5leU6x.js";import{_ as le}from"./VMultiSelect.3zUL7lik.js";import{s as S,a as re,e as ie,j as de}from"./vue-datepicker.gRWbN_6J.js";import{s as P,e as B}from"./index.DsgwUBM9.js";import"./ClipLoader.4-rIzqtH.js";/* empty css                                                   */import"./vee-validate.esm.0La7AMjT.js";const ce={class:"header-nav-wrap"},_e={class:"row align-items-center"},ue={class:"col-auto"},me={class:"header-back-link"},pe={class:"col-auto"},he={class:"fw-bold"},ge={class:"content"},ve={class:"card"},fe={class:"row field-m-0 align-items-end g-3"},be={class:"col-md-4 col-lg-3"},ye={class:"form-field"},xe={for:"",class:"form-label"},ke=e("span",{class:"text-danger"},"*",-1),we=["onClick","onKeyup"],De={class:"col-md-4 col-lg-3"},Fe={class:"col-auto text-end"},Ye={class:"row align-items-center"},$e={class:"col-auto"},Me=["disabled"],Ve={class:"col-auto"},Ce=["disabled"],Oe={class:"card"},Ae={class:""},Se={key:0},Pe={key:1,class:"table-responsive"},Be={class:"table table-list-data table-hover"},Ee={class:"bg-light"},Ne={scope:"col"},Re={scope:"col",class:"text-end"},Le={scope:"col",class:"text-end"},Ie={scope:"col",class:"text-end"},Te={scope:"col",class:"text-end"},je={scope:"col",class:"text-end"},Ke={class:"text-end"},Ue={class:"text-end"},qe={class:"text-end"},ze={class:"text-end"},Ge={class:"text-end"},Je={key:1},He={class:"text-center py-3",colspan:"13"},Qe={key:0},We=e("th",null,null,-1),Xe={class:"text-end"},Ze={class:"text-end"},et={class:"text-end"},tt={class:"text-end"},st={class:"text-end"},at={class:"data-footer"},ot={class:"row align-items-center justify-content-between"},nt={class:"col-auto"},lt={class:"col-auto"},bt={__name:"payment_report",setup(rt){const{t:k}=H(),{isAuthorized:it,getRoundedValue:u}=ee(),w=Q();x(()=>w.user.currency.symbol);const E=Y({server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,dates:m([new Date,new Date]),selected_branch:m(),is_exporting:!1}),t=Y({...E}),N=k("Select Branch"),R=k("All Branches"),L=m([{label:"Today",value:[new Date,new Date]},{label:"This month",value:[P(new Date),B(new Date)]},{label:"Last month",value:[P(S(new Date,1)),B(S(new Date,1))]},{label:"This year",value:[re(new Date),ie(new Date)]}]),I=x(()=>w.user.branches),D=m();async function T(n){D.value=n,await b()}const i=m([]),f=m([]);async function b(n=1){t.is_listing=!0,t.dates[0]=v(t.dates[0]).format("YYYY-MM-DD"),t.dates[1]=v(t.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/payment_report",{params:{page:n,paginate_limit:D.value,filter:t}}).then(a=>{i.value=a.data.data,f.value=a.data.pagination,t.is_listing=!1}).catch(a=>{t.server_messages.type="error",t.server_messages.messages=a,t.is_listing=!1,console.log(a)})}const c=x(()=>i.value.length?{total_order:i.value.reduce(function(a,o){var o=o.total_order!=null?o.total_order:0;return parseFloat(a)+parseFloat(o)},0).toFixed(2),total_order_amount:i.value.reduce(function(a,o){var o=o.total_order_amount!=null?o.total_order_amount:0;return parseFloat(a)+parseFloat(o)},0).toFixed(2),total_return_order:i.value.reduce(function(a,o){var o=o.total_return_order!=null?o.total_return_order:0;return parseFloat(a)+parseFloat(o)},0).toFixed(2),total_return_order_amount:i.value.reduce(function(a,o){var o=o.total_return_order_amount!=null?o.total_return_order_amount:0;return parseFloat(a)+parseFloat(o)},0).toFixed(2),net_amount:i.value.reduce(function(a,o){var o=o.net_amount!=null?o.net_amount:0;return parseFloat(a)+parseFloat(o)},0).toFixed(2)}:null);async function j(){t.is_exporting=!0,t.dates[0]=v(t.dates[0]).format("YYYY-MM-DD"),t.dates[1]=v(t.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/payment_report/export_excel",{params:{filter:t}}).then(n=>{if(n.data.status_code==200){t.is_exporting=!1;const a=document.createElement("a");a.target="_blank",a.href=n.data.data.file,document.body.appendChild(a),a.click()}else{try{t.server_messages.type="error",t.server_messages.messages=JSON.parse(n.data.msg)}catch{t.server_messages.type="error",t.server_messages.messages=n.data.msg}t.is_exporting=!1}}).catch(n=>{t.server_messages.type="error",t.server_messages.messages=n,t.is_exporting=!1,console.log(n)})}const K=te(()=>se(()=>import("./ServerMessage.qNo4NwTp.js"),__vite__mapDeps([0,1,2])));return(n,a)=>{const U=M("Icon"),o=M("router-link"),q=le,z=ne,G=oe,J=ae;return d(),$(J,null,{subheader:g(()=>[e("div",ce,[e("div",_e,[e("div",ue,[e("div",me,[_(o,{class:"text-primary",to:"/reports"},{default:g(()=>[_(U,{icon:"fa6-solid:chevron-left"}),V(" "+l(n.$t("Reports")),1)]),_:1})])]),e("div",pe,[e("h5",he,l(n.$t("Payment Report")),1)])])])]),default:g(()=>[e("div",ge,[s(t).server_messages.messages!=""?(d(),$(s(K),{key:0,class:"py-3",server_messages:s(t).server_messages},null,8,["server_messages"])):C("",!0),e("div",ve,[e("div",fe,[e("div",be,[e("div",ye,[e("label",xe,[V(l(n.$t("Select Dates"))+" ",1),ke]),_(s(de),{range:"","preset-dates":s(L),modelValue:s(t).dates,"onUpdate:modelValue":a[0]||(a[0]=r=>s(t).dates=r),format:"dd-MM-yyyy","enable-time-picker":!1},{"preset-date-range-button":g(({label:r,value:h,presetDate:y})=>[e("span",{role:"button",tabindex:0,onClick:F=>y(h),onKeyup:[O(A(F=>y(h),["prevent"]),["enter"]),O(A(F=>y(h),["prevent"]),["space"])]},l(r),41,we)]),_:1},8,["preset-dates","modelValue"])])]),e("div",De,[_(q,{name:"branches",label:s(N),placeholder:s(R),text:"name",value:"id",options:s(I),modelValue:s(t).selected_branch,"onUpdate:modelValue":a[1]||(a[1]=r=>s(t).selected_branch=r),mode:"single"},null,8,["label","placeholder","options","modelValue"])]),e("div",Fe,[e("div",Ye,[e("div",$e,[e("button",{class:"btn btn-primary",onClick:b,disabled:s(t).dates==null},l(n.$t("View")),9,Me)]),e("div",Ve,[e("button",{class:"btn btn-success",onClick:a[2]||(a[2]=r=>j()),disabled:s(t).dates==null},l(n.$t("Export Excel")),9,Ce)])])])])]),e("div",Oe,[e("div",Ae,[s(t).is_listing?(d(),p("div",Se,[_(z)])):(d(),p("div",Pe,[e("table",Be,[e("thead",Ee,[e("tr",null,[e("th",Ne,l(n.$t("Payment Method")),1),e("th",Re,l(n.$t("Order Count")),1),e("th",Le,l(n.$t("Order Amount")),1),e("th",Ie,l(n.$t("Return Order Count")),1),e("th",Te,l(n.$t("Return Order Amount")),1),e("th",je,l(n.$t("Net Amount")),1)])]),e("tbody",null,[s(i)!=""?(d(!0),p(W,{key:0},X(s(i),(r,h)=>(d(),p("tr",{key:h},[e("td",null,l(r.name),1),e("td",Ke,l(r.total_order),1),e("td",Ue,l(s(u)(r.total_order_amount)),1),e("td",qe,l(r.total_return_order),1),e("td",ze,l(s(u)(r.total_return_order_amount)),1),e("td",Ge,l(s(u)(r.net_amount)),1)]))),128)):(d(),p("tr",Je,[e("td",He,l(n.$t("No Data Found")),1)]))]),s(c)!=""&&s(c)!=null?(d(),p("tfoot",Qe,[e("tr",null,[We,e("th",Xe,l(s(c).total_order),1),e("th",Ze,l(s(u)(s(c).total_order_amount)),1),e("th",et,l(s(c).total_return_order),1),e("th",tt,l(s(u)(s(c).total_return_order_amount)),1),e("th",st,l(s(u)(s(c).net_amount)),1)])])):C("",!0)])])),e("div",at,[e("div",ot,[e("div",nt,[_(G,{onPaginate_limit_update:T,pagination:s(f)},null,8,["pagination"])]),e("div",lt,[_(s(Z),{data:s(f),limit:5,onPaginationChangePage:b},null,8,["data"])])])])])])])]),_:1})}}};export{bt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.qNo4NwTp.js","assets/index.ri7Y_V5F.js","assets/index.1t-AB2n6.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
