import{s as x,P as V,e as S,r as D,g as c,h as l,i as a,t as r,F as p,x as _,k as h,j as n,n as F,K as N,L as $,m as E,l as v}from"./index.ri7Y_V5F.js";import{a as M,E as R}from"./vee-validate.esm.0La7AMjT.js";/* empty css                                                   */const A={class:"row"},L=a("div",{class:"col-4"},null,-1),T={class:"col-4"},U={class:"card"},j={class:"row"},J={class:"col-12"},K={class:"row"},O={class:"col-12 pt-3"},P={class:"form-field"},Y={class:"label me-3 mb-2"},q={key:0,class:"row"},z={class:"col-12"},G={value:""},H=["value"],I={class:"col-12 py-3"},Q={class:"table table-condensed"},W={class:"text-end"},X=["onClick"],oe={__name:"CouponSetting",props:["form"],emits:["refreshCoupon"],setup(f,{emit:g}){x(Multiselect);const b=[{name:"All Branches",value:1},{name:"Specific Branches",value:0}],y=V(f,"form"),e=S(y.value),k=g;function u(){k("refreshCoupon")}const i=D("");async function w(){if(i.value!=""){var t=new FormData;t.append("coupon_slack",e.coupon.slack),t.append("branch_slack",i.value),await axios.post("/api/coupon/branch/add",t).then(o=>{toast.success(o.data.msg),u()}).catch(o=>{e.server_messages.type="error",e.server_messages.messages=o,console.log(o)})}}async function B(t){var o=!1;await Swal.fire({title:"Do you want to remove coupon from this branch?",showCancelButton:!0,confirmButtonText:"Yes, Delete",confirmButtonColor:"#d33"}).then(s=>{s.isConfirmed&&(o=!0)}),o&&await axios.post("/api/coupon/branch/remove",{slack:t}).then(s=>{if(s.data.status_code==200)toast.success(s.data.msg),u();else try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(s.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=s.data.msg}}).catch(s=>{e.server_messages.type="error",e.server_messages.messages=s,console.log(s)})}async function C(){var t=new FormData;t.append("coupon_slack",e.coupon.slack),t.append("applies_to_all_branch",e.coupon.applies_to_all_branch),await axios.post("/api/coupon/branch/apply_to_all_branch",t).then(o=>{toast.success(o.data.msg)}).catch(o=>{e.server_messages.type="error",e.server_messages.messages=o,console.log(o)})}return(t,o)=>(c(),l("div",A,[L,a("div",T,[a("div",U,[a("div",j,[a("div",J,[a("h4",null,r(t.$t("Applicable Branches")),1)])]),a("div",K,[a("div",O,[a("div",P,[(c(),l(p,null,_(b,(s,d)=>a("label",Y,[h(n(M),{class:"form-check-input mx-2",name:"applies_to_all_branch",type:"radio",id:d,value:s.value,modelValue:n(e).coupon.applies_to_all_branch,"onUpdate:modelValue":o[0]||(o[0]=m=>n(e).coupon.applies_to_all_branch=m),onChange:C},null,8,["id","value","modelValue"]),F(" "+r(s.name),1)])),64)),h(n(R),{name:"applies_to_all_branch",as:"div",class:"error"})])])]),n(e).coupon.applies_to_all_branch==0?(c(),l("div",q,[a("div",z,[N(a("select",{class:"form-control w-100","onUpdate:modelValue":o[1]||(o[1]=s=>E(i)?i.value=s:null),onChange:w},[a("option",G,"--"+r(t.$t("Select Branch"))+"--",1),(c(!0),l(p,null,_(n(e).branches,(s,d)=>(c(),l("option",{value:s.slack},r(s.name),9,H))),256))],544),[[$,n(i)]])]),a("div",I,[a("table",Q,[a("tbody",null,[n(e).coupon!=""&&n(e).coupon.branches!=""?(c(!0),l(p,{key:0},_(n(e).coupon.branches,(s,d)=>(c(),l("tr",{key:d},[a("td",null,r(s.branch.name),1),a("td",W,[a("a",{class:"dropdown-item text-danger",href:"#",onClick:m=>B(s.slack)},r(t.$t("Remove")),9,X)])]))),128)):v("",!0)])])])])):v("",!0)])])]))}};export{oe as default};
