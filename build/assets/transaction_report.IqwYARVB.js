import{u as me,b as pe,d as P,e as N,r as c,o as he,v as ye,g as d,p as O,w as g,f as I,i as e,l as i,k as F,t as l,j as s,m as y,A as L,B as U,h as u,F as ge,x as ve,O as be,I as fe,bW as v,q as ke,_ as we}from"./index.li3fCRRM.js";import{D as Ve}from"./DefaultLayout.saUWsTkY.js";import{_ as De}from"./PaginateLimit.SmYeFgfo.js";import{_ as $e}from"./ListingSkeleton.6NzqF9S5.js";import{_ as xe}from"./VMultiSelect.2M-H_LD-.js";import{_ as Me}from"./VSelect.xfZK6hek.js";import{s as R,a as Ye,e as Ae,j as Ee}from"./vue-datepicker.a6BsTEHj.js";import{s as j,e as K}from"./index.dFkrF4C6.js";import"./ClipLoader.gDBpDd3b.js";/* empty css                                                   */import"./vee-validate.esm.reM-LHjC.js";/* empty css                                                                */const Se={class:"header-nav-wrap"},Te={class:"row align-items-center"},Be={class:"col-auto"},Ce={class:"header-back-link"},Pe={class:"col-auto"},Ne={class:"fw-bold"},Oe={class:"content"},Ie={class:"card"},Fe={class:"row field-m-0 align-items-end g-3"},Le={class:"col-md-4 col-lg-3"},Ue={class:"form-field"},Re={for:"",class:"form-label"},je=e("span",{class:"text-danger"},"*",-1),Ke=["onClick","onKeyup"],We={class:"col-md-4 col-lg-3"},qe={class:"col-md-4 col-lg-3"},ze={class:"col-md-4 col-lg-3"},Ge={class:"col-md-4 col-lg-3"},Je={class:"col-md-4 col-lg-3"},Xe={class:"row mt-3"},He={class:"col-12 text-end"},Qe=["disabled"],Ze=["disabled"],et={class:"card"},tt={class:""},st={key:0},at={key:1,class:"table-responsive"},ot={class:"table table-list-data table-hover"},lt={class:"bg-light"},nt={scope:"col"},ct={scope:"col"},dt={scope:"col"},it={scope:"col"},_t={scope:"col"},rt={scope:"col"},ut={scope:"col"},mt={scope:"col"},pt={scope:"col"},ht={scope:"col",class:"text-end"},yt={class:"text-center"},gt={class:"text-center"},vt={class:"text-center"},bt={class:"text-center"},ft={class:"text-center"},kt={class:"text-center"},wt={class:"text-center"},Vt={key:0,class:"badge badge-primary"},Dt={key:1,class:"badge badge-primary"},$t={key:2,class:"badge badge-primary"},xt={class:"text-center"},Mt={class:"text-end"},Yt={key:1},At={class:"text-center py-3",colspan:"10"},Et={key:0},St=e("th",{colspan:"9"},null,-1),Tt={class:"text-end"},Bt={class:"data-footer"},Ct={class:"row align-items-center justify-content-between"},Pt={class:"col-auto"},Nt={class:"col-auto"},Ht={__name:"transaction_report",setup(Ot){const{t:r}=me(),{isAuthorized:It,getRoundedValue:x}=fe(),M=pe(),Y=P(()=>M.user.currency.symbol),W=N({server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,dates:c([new Date,new Date]),selected_branch:c(),selected_type:c(),selected_account:c(),selected_bill_type:c(),selected_payment_method:c(),is_exporting:!1}),t=N({...W}),q=r("Select Branch"),z=r("All Branches"),G=r("Select Type"),J=r("All Type"),X=r("Select Account"),H=r("All Account"),Q=r("Select Bill Type"),Z=r("All Bill Type"),ee=r("Select Payment Method"),te=r("All Payment Method"),se=c([{label:"Today",value:[new Date,new Date]},{label:"This month",value:[j(new Date),K(new Date)]},{label:"Last month",value:[j(R(new Date,1)),K(R(new Date,1))]},{label:"This year",value:[Ye(new Date),Ae(new Date)]}]);he(()=>{le(),E(),ne()});const ae=[{key:"INCOME",value:"Income"},{key:"EXPENSE",value:"Expense"}],oe=[{key:"1",value:"Order"},{key:"2",value:"Invoice"},{key:"3",value:"Purchase"}],A=c([]);async function le(){_.forEach(M.user.branches,a=>{let o={key:a.slack,value:a.name,id:a.slack};A.value.push(o)})}ye(()=>t.selected_type,a=>{E()});const b=c([]);async function E(){b.value=[];let a=new FormData;a.append("account_type",t.selected_type),await axios.post("/api/accounts/all",a).then(o=>{_.forEach(o.data.data,m=>{let V={key:m.slack,value:m.name};b.value.push(V)})}).catch(o=>{t.server_messages.type="error",t.server_messages.messages=o,t.is_listing=!1,console.log(o)})}const S=c([]);async function ne(){let a=await axios.get("api/payment_methods/all");_.forEach(a.data.data,o=>{let m={key:o.id,value:o.name};S.value.push(m)})}const T=c();async function ce(a){T.value=a,await k()}const p=c([]),f=c([]);async function k(a=1){t.is_listing=!0,t.dates[0]=v(t.dates[0]).format("YYYY-MM-DD"),t.dates[1]=v(t.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/transaction_report",{params:{page:a,paginate_limit:T.value,filter:t}}).then(o=>{p.value=o.data.data.data,f.value=o.data.pagination,console.log(p.value),t.is_listing=!1}).catch(o=>{t.server_messages.type="error",t.server_messages.messages=o,t.is_listing=!1,console.log(o)})}const w=P(()=>p.value.length?{amount:p.value.reduce(function(o,m){return o+parseFloat(m.amount)},0).toFixed(2)}:null);async function de(){t.is_exporting=!0,t.dates[0]=v(t.dates[0]).format("YYYY-MM-DD"),t.dates[1]=v(t.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/transaction_report/export_excel",{params:{filter:t}}).then(a=>{if(a.data.status_code==200){t.is_exporting=!1;const o=document.createElement("a");o.target="_blank",o.href=a.data.data.file,document.body.appendChild(o),o.click()}else{try{t.server_messages.type="error",t.server_messages.messages=JSON.parse(a.data.msg)}catch{t.server_messages.type="error",t.server_messages.messages=a.data.msg}t.is_exporting=!1}}).catch(a=>{t.server_messages.type="error",t.server_messages.messages=a,t.is_exporting=!1,console.log(a)})}const ie=ke(()=>we(()=>import("./ServerMessage.Re9KOdbP.js"),__vite__mapDeps([0,1,2])));return(a,o)=>{const m=I("Icon"),V=I("router-link"),D=Me,B=xe,_e=$e,re=De,ue=Ve;return d(),O(ue,null,{subheader:g(()=>[e("div",Se,[e("div",Te,[e("div",Be,[e("div",Ce,[i(V,{class:"text-primary",to:"/reports"},{default:g(()=>[i(m,{icon:"fa6-solid:chevron-left"}),F(" "+l(a.$t("Reports")),1)]),_:1})])]),e("div",Pe,[e("h5",Ne,l(a.$t("Transaction Report")),1)])])])]),default:g(()=>[e("div",Oe,[s(t).server_messages.messages!=""?(d(),O(s(ie),{key:0,class:"py-3",server_messages:s(t).server_messages},null,8,["server_messages"])):y("",!0),e("div",Ie,[e("div",Fe,[e("div",Le,[e("div",Ue,[e("label",Re,[F(l(a.$t("Select Dates"))+" ",1),je]),i(s(Ee),{range:"","preset-dates":s(se),modelValue:s(t).dates,"onUpdate:modelValue":o[0]||(o[0]=n=>s(t).dates=n),format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":g(({label:n,value:h,presetDate:$})=>[e("span",{role:"button",tabindex:0,onClick:C=>$(h),onKeyup:[L(U(C=>$(h),["prevent"]),["enter"]),L(U(C=>$(h),["prevent"]),["space"])]},l(n),41,Ke)]),_:1},8,["preset-dates","modelValue"])])]),e("div",We,[i(D,{name:"branches",label:s(q),placeholder:s(z),text:"name",value:"id",options:s(A),modelValue:s(t).selected_branch,"onUpdate:modelValue":o[1]||(o[1]=n=>s(t).selected_branch=n)},null,8,["label","placeholder","options","modelValue"])]),e("div",qe,[i(B,{name:"status",label:s(G),placeholder:s(J),text:"value",value:"key",options:ae,modelValue:s(t).selected_type,"onUpdate:modelValue":o[2]||(o[2]=n=>s(t).selected_type=n),mode:"single"},null,8,["label","placeholder","modelValue"])]),e("div",ze,[i(D,{name:"account",label:s(X),placeholder:s(H),text:"name",value:"slack",options:s(b),modelValue:s(t).selected_account,"onUpdate:modelValue":o[3]||(o[3]=n=>s(t).selected_account=n)},null,8,["label","placeholder","options","modelValue"])]),e("div",Ge,[i(B,{name:"bill_type",label:s(Q),placeholder:s(Z),text:"value",value:"key",options:oe,modelValue:s(t).selected_bill_type,"onUpdate:modelValue":o[4]||(o[4]=n=>s(t).selected_bill_type=n),mode:"single"},null,8,["label","placeholder","modelValue"])]),e("div",Je,[i(D,{name:"payment_method",label:s(ee),placeholder:s(te),text:"name",value:"slack",options:s(S),modelValue:s(t).selected_payment_method,"onUpdate:modelValue":o[5]||(o[5]=n=>s(t).selected_payment_method=n)},null,8,["label","placeholder","options","modelValue"])])]),e("div",Xe,[e("div",He,[e("button",{class:"btn btn-primary",onClick:k,disabled:s(t).dates==null},l(a.$t("View")),9,Qe),e("button",{class:"btn btn-success ms-3",onClick:o[6]||(o[6]=n=>de()),disabled:s(t).dates==null},l(a.$t("Export Excel")),9,Ze)])])]),e("div",et,[e("div",tt,[s(t).is_listing?(d(),u("div",st,[i(_e)])):(d(),u("div",at,[e("table",ot,[e("thead",lt,[e("tr",null,[e("th",nt,l(a.$t("Branch Name")),1),e("th",ct,l(a.$t("Transaction Date")),1),e("th",dt,l(a.$t("Transaction Code")),1),e("th",it,l(a.$t("Branch Wise Transaction No.")),1),e("th",_t,l(a.$t("Account Code")),1),e("th",rt,l(a.$t("Account")),1),e("th",ut,l(a.$t("Type")),1),e("th",mt,l(a.$t("Bill Type")),1),e("th",pt,l(a.$t("Payment Method")),1),e("th",ht,l(a.$t("Amount")),1)])]),e("tbody",null,[s(p)!=""?(d(!0),u(ge,{key:0},ve(s(p),(n,h)=>(d(),u("tr",{key:h},[e("td",null,l(n.branch!=null?n.branch.name:"--"),1),e("td",yt,l(n.transaction_date),1),e("td",gt,l(n.code),1),e("td",vt,l(n.branch_transaction_number),1),e("td",bt,l(n.account!=null?n.account.code:"--"),1),e("td",ft,l(n.account!=null?n.account.name:"--"),1),e("td",kt,l(n.type),1),e("td",wt,[n.bill_type==1?(d(),u("span",Vt,l(a.$t("Order")),1)):y("",!0),n.bill_type==2?(d(),u("span",Dt,l(a.$t("Invoice")),1)):y("",!0),n.bill_type==3?(d(),u("span",$t,l(a.$t("Purchase")),1)):y("",!0)]),e("td",xt,l(n.payment_method_name),1),e("td",Mt,l(s(x)(n.amount))+" "+l(s(Y)),1)]))),128)):(d(),u("tr",Yt,[e("td",At,l(a.$t("No Data Found")),1)]))]),s(w)!=""&&s(w)!=null?(d(),u("tfoot",Et,[e("tr",null,[St,e("th",Tt,l(s(x)(s(w).amount))+" "+l(s(Y)),1)])])):y("",!0)])])),e("div",Bt,[e("div",Ct,[e("div",Pt,[i(re,{onPaginate_limit_update:ce,pagination:s(f)},null,8,["pagination"])]),e("div",Nt,[i(s(be),{data:s(f),limit:5,onPaginationChangePage:k},null,8,["data"])])])])])])])]),_:1})}}};export{Ht as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.Re9KOdbP.js","assets/index.li3fCRRM.js","assets/index.KTHCd6a8.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
