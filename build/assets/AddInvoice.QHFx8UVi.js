import{b as be,u as Ge,r as y,a as Ke,d as ne,e as B,o as We,v as Xe,f as Ye,g as p,h as m,j as f,p as K,w as Ze,m as x,t as n,i as e,l as h,F as W,N as E,K as I,x as le,k as R,y as z,Q as et,I as tt,q as fe,_ as ye}from"./index.li3fCRRM.js";import{_ as at}from"./AddCustomer.Bj8_PEWg.js";import{_ as ot}from"./EditFormSkeleton.rDEkHHXB.js";import{_ as st}from"./VSelectInput.v0GOolGM.js";import{_ as nt}from"./VTextInput.pcaNaUkX.js";import{_ as lt}from"./VMultiSelect.2M-H_LD-.js";import{_ as it}from"./VSelect.xfZK6hek.js";import{a as ct,E as dt,F as rt}from"./vee-validate.esm.reM-LHjC.js";import{c as ie,a as T,b as X,h as ge}from"./index.esm.e6McCFlz.js";/* empty css                                                   */import{C as ut}from"./ClipLoader.gDBpDd3b.js";import"./ServerMessage.Re9KOdbP.js";import"./VTooltip.pHzwBjkF.js";/* empty css                                                                *//* empty css                                                   */const _t={class:"row"},pt={class:"col-md-12"},mt={class:"row"},vt={class:"col-md-12"},ht={class:"card"},bt={class:"section-title pb-3 text-muted"},ft={class:"row"},yt={class:"col-6 col-md-3"},gt={class:"col-6 col-md-3"},kt={class:"col-6 col-md-3"},Vt={class:"col-6 col-md-3"},xt={class:"col-6 col-md-3"},wt={class:"col-6 col-md-3"},Ct={class:"col-6 col-md-3"},$t={class:"col-12 col-md-12"},Ut={class:""},qt={class:"section-title"},St={class:"row mb-2"},At={class:"col-md-3"},It={class:"col-md-3"},Tt={class:"col-md-3"},Ft={class:"col-md-3"},Dt={class:"align-text-top"},Et=["onUpdate:modelValue"],Pt={class:"col-md-3"},Nt={class:"d-flex align-items-center"},Mt=["onUpdate:modelValue"],Ot={class:"col-md-3"},Bt={class:"d-flex align-items-center"},Rt=["onUpdate:modelValue"],zt={class:"col-1"},Qt=["onClick"],Jt={class:"col-md-12"},Lt={class:"card"},jt={class:"row"},Ht={class:"section-title text-muted"},Gt={class:"col-md-4"},Kt={class:"table-responsive"},Wt={class:"table table-hover table-bordered mb-3 table-responsive-data"},Xt={class:"bg-light"},Yt={class:"text-center"},Zt=e("br",null,null,-1),ea={key:0},ta={key:1},aa={class:"text-center"},oa={class:"text-center"},sa={class:"text-center"},na={class:"text-center"},la=e("br",null,null,-1),ia={class:"text-center"},ca={class:"text-center"},da={class:"text-center"},ra={class:"text-center"},ua=["onUpdate:modelValue"],_a=["onUpdate:modelValue"],pa={key:0,"data-title":"Search Product",width:"18%"},ma={key:1,"data-title":"Search Product",width:"18%"},va={key:2,"data-title":"Unit Price",width:"13%"},ha={key:3,"data-title":"Unit Price",width:"13%"},ba={"data-title":"Quantity",width:"13%"},fa={"data-title":"Amount",width:"7%",class:"text-end"},ya={"data-title":"Discount",width:"12%"},ga={key:4,"data-title":"Additional Fees",width:"8%",class:"text-end"},ka={key:0},Va={key:1},xa={key:2},wa={key:5,"data-title":"Other Taxes and fee",width:"14%",class:"text-end"},Ca={class:"col-auto col-md-auto col-lg-auto text-start"},$a={key:0,class:"col-auto col-md-auto col-lg-auto text-start"},Ua={"data-title":"SubTotal",width:"10%",class:"text-end"},qa={key:6,"data-title":"Select Tax",width:"10%",class:"text-end"},Sa={key:7,"data-title":"Tax",width:"7%"},Aa={"data-title":"Amount",width:"10%",class:"text-end"},Ia={"data-title":"Action",width:"3%",class:"text-center"},Ta=["onClick"],Fa=e("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"0.88em",height:"1em",viewBox:"0 0 448 512",class:"iconify iconify--fa6-regular"},[e("path",{fill:"currentColor",d:"m170.5 51.6l-19 28.4h145l-19-28.4c-1.5-2.2-4-3.6-6.7-3.6h-93.7c-2.7 0-5.2 1.3-6.7 3.6zm147-26.6l36.7 55H424c13.3 0 24 10.7 24 24s-10.7 24-24 24h-8v304c0 44.2-35.8 80-80 80H112c-44.2 0-80-35.8-80-80V128h-8c-13.3 0-24-10.7-24-24s10.7-24 24-24h69.8l36.7-55.1C140.9 9.4 158.4 0 177.1 0h93.7c18.7 0 36.2 9.4 46.6 24.9zM80 128v304c0 17.7 14.3 32 32 32h224c17.7 0 32-14.3 32-32V128zm80 64v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16m80 0v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16m80 0v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16"})],-1),Da=[Fa],Ea={class:"row justify-content-between mt-1"},Pa={class:"col-auto"},Na={class:"col-auto text-decoration-underline mb-3"},Ma={class:"form-check"},Oa={class:"form-check-label mb-0",for:"Shipping_charge"},Ba={class:"table"},Ra={class:"text-end border-0 field-m-0 field-label-hide"},za={class:"border-0 field-m-0 field-label-hide"},Qa={class:"border-0 px-0"},Ja={class:"d-flex align-items-center pt-0 pb-0"},La=["onClick","disabled"],ja={class:"col-md-4 p-0"},Ha={class:"table"},Ga={width:"60%",class:"text-end border-0"},Ka={class:"p-0"},Wa={width:"40%",class:"border-0 text-end"},Xa={class:"p-0"},Ya=e("th",{class:"border-0 px-0"},null,-1),Za={class:"border-0"},eo={class:"border-0"},to=e("th",{class:"border-0 px-0"},null,-1),ao={key:0},oo={class:"text-end border-0"},so={class:"p-0 text-success"},no={class:"border-0 text-end"},lo={class:"p-0 text-success"},io=e("th",{class:"border-0 px-0"},null,-1),co={key:1},ro={class:"text-end border-0"},uo={class:"p-0"},_o={class:"border-0 text-end"},po={class:"p-0"},mo=e("th",{class:"border-0 px-0"},null,-1),vo={key:2},ho={class:"text-end border-0"},bo={class:"p-0 text-success"},fo={class:"border-0 text-end"},yo={class:"p-0 text-success"},go=e("th",{class:"border-0 px-0"},null,-1),ko={key:3},Vo={class:"text-end border-0"},xo={class:"p-0"},wo={class:"border-0 text-end"},Co={class:"p-0"},$o=e("th",{class:"border-0 px-0"},null,-1),Uo={key:4},qo={class:"text-end border-0"},So={class:"p-0"},Ao={class:"border-0 text-end"},Io={class:"p-0"},To=e("th",{class:"border-0 px-0"},null,-1),Fo={key:5},Do={class:"text-end border-0"},Eo={class:"p-0"},Po={class:"border-0 text-end"},No={class:"p-0"},Mo=e("th",{class:"border-0 px-0"},null,-1),Oo={class:"text-end border-0"},Bo={class:"p-0"},Ro={class:"border-0 text-end"},zo={class:"p-0"},Qo=e("th",{class:"border-0 px-0"},null,-1),Jo={key:6},Lo={class:"text-end border-0"},jo={class:"p-0"},Ho={class:"border-0 text-end"},Go={class:"p-0"},Ko=e("th",{class:"border-0 px-0"},null,-1),Wo={class:"tr-total"},Xo={class:"text-end border-0"},Yo={class:"p-0"},Zo={class:"border-0 text-end text-dark"},es={class:"p-0"},ts=e("th",{class:"border-0 px-0"},null,-1),as={class:"col-md-12"},os={class:"card"},ss={class:"row"},ns={class:"section-title text-muted"},ls={for:"",class:"text-warning h6 ms-auto"},is={class:"col-12"},cs={class:"text-end"},ds=["disabled"],rs={key:1,class:"pt-0"},us={key:2,class:"pt-0"},_s={class:"modal hide",id:"addCustomerModal",tabindex:"-1","aria-labelledby":"Add Customer","aria-modal":"true",role:"dialog","data-bs-backdrop":"static","data-bs-keyboard":"false"},ps={class:"modal-dialog modal-dialog-centered modal-xl"},ms={class:"modal-content"},vs={class:"modal-header"},hs={class:"modal-title fs-5"},bs={class:"modal-body"},Es={__name:"AddInvoice",setup(fs){const{calculateInvoice:P}=tt(),ce=be().user.login_branch.tax_inclusive_pricing,{t:l}=Ge(),k=y({customer_type:l("Bill To"),select_customer_type:l("--Select Bill To--"),customer:l("Customer"),representative:l("Representative"),select_customer:l("Select Customer"),invoice_number:l("Invoice Number"),invoice_reference:l("Invoice Reference"),invoice_date:l("Invoice Date"),invoice_due_date:l("Invoice Due Date"),search_placeholder:l("Search and Add Product"),add_service:l("Add Service"),units:l("Units"),discount_type:l("Discount Type"),value:l("Value"),select_tax:l("Select Tax"),select_discount:l("Select"),charge:l("Charge"),charge_name:l("Charge Name")}),ke=fe(()=>ye(()=>import("./ServerMessage.Re9KOdbP.js"),__vite__mapDeps([0,1,2]))),Ve=fe(()=>ye(()=>import("./InvoiceProductSearch.4LGsFVSp.js"),__vite__mapDeps([3,1,2,4,5,6,7,8]))),N=Ke().params.slack,d=y([]),Q=be(),U=ne(()=>Q.user.currency.symbol);ne(()=>Q.user.tax);const xe={server_messages:{type:"",messages:""},is_submitting:!1,slack:"",customer_type:"",customer:"",invoice_additional_details:[{title:"",description:"",title_ar:""}],representative:"",invoice_number:"",invoice_reference_number:"",invoice_date:new Date().toISOString().split("T")[0],invoice_due_date:"",terms:"",other_charges:!1,invoice_products:[],invoice_discount_type:"",invoice_discount_amount:0,additional_charges:[]},a=B({...xe}),we=ie().shape({customer_type:T().required(l("name is required",{name:l("Customer Type")})),customer:T().required(l("name is required",{name:l("Customer")})),invoice_date:T().required(l("name is required",{name:l("Invoice Date")})),invoice_reference_number:X().typeError(l("must be a number",{name:l("Invoice Reference")})).nullable().moreThan(0,"Invoice Reference cannot be negative").transform((t,o)=>o!==""?Number(o):null),invoice_products:ge(ie({product_name:T().required(l("name is required",{name:l("Service")})),sale_price:X().typeError(l("must be a number",{name:l("Unit Price")})).required(l("name is required",{name:l("Unit Price")})).positive(l("must be a positive number",{name:l("Unit Price")})),quantity:X().typeError(l("must be a number",{name:l("Quantity")})).required(l("name is required",{name:l("Quantity")})).positive(l("must be a positive number",{name:l("Quantity")}))})).required(),additional_charges:ge(ie().shape({charge_name:T().nullable().when("charge_amount",{is:t=>t!=""&&t>0,then:t=>t.required(l("name is required",{name:l("Charge Name")})),otherwise:t=>t.nullable()}),charge_amount:X().typeError(l("must be a number",{name:l("Amount")})).nullable().when("charge_name",{is:t=>t!="",then:t=>t.required(l("name is required",{name:l("Amount")})),otherwise:t=>t.nullable()})},["charge_name","charge_amount"])).required(),invoice_discount_type:T().nullable().when("invoice_discount_amount",{is:t=>t!=""&&t>0,then:t=>t.required(l("name is required",{name:l("Discount Type")})),otherwise:t=>t.nullable()}),invoice_discount_amount:T().typeError(l("must be a number",{name:l("Discount Amount")})).nullable().when("invoice_discount_type",{is:t=>t!="",then:t=>t.required(l("name is required",{name:l("Discount Amount")})),otherwise:t=>t.nullable()})},["invoice_discount_type","invoice_discount_amount"]),Ce=[{key:"1",value:l("Customer")},{key:"2",value:l("Company")}],$e=[{key:"1",value:l("Percentage")},{key:"2",value:l("Amount")}],Ue=[{charge_name:l("Shipping Charges"),charge_amount:0},{charge_name:l("Packing Charges"),charge_amount:0}];We(()=>{a.additional_charges=Ue,de(),N!=null&&Se()});const qe=y([{id:"",name:l("Select Fee Type")},{id:1,name:l("Tobacco Tax")},{id:2,name:l("Additional Fee")}]),Y=y([]),Z=y([]),ee=y([]),C=y([]);async function de(){Z.value=[],Y.value=[];let t=await axios.get("api/invoice/add");a.invoice_number=t.data.data.invoice_number,a.invoice_reference_number=t.data.data.invoice_reference_number;let o=t.data.data.item_additional_fees,c=t.data.data.customers;_.forEach(c,i=>{let b={slack:i.slack,name:i.name!=""?i.phone!=""&&i.phone!="null"?i.name+" - "+i.phone:i.name:i.phone};Z.value.push(b)}),_.forEach(Q.user.country.taxes,i=>{let b={key:i.slack,value:i.name,percentage:i.total_percentage};Y.value.push(b)}),_.forEach(o,i=>{let b={key:i.slack,value:i.name,fee_val:i.value,type:i.type};ee.value.push(b)}),C.value=[];let v=t.data.data.discounts;_.forEach(v,i=>{let b={key:i.slack,value:i.name,disc:i.value,type:i.type};C.value.push(b)})}const re=y(!1);async function Se(){await axios.get("/api/invoice",{params:{slack:N}}).then(t=>{if(re.value=!0,d.value=t.data.data,a.slack=d.value.slack,a.terms=d.value.terms,a.invoice_date=d.value.invoice_date,a.invoice_due_date=d.value.due_date,a.representative=d.value.representative=="null"?"":d.value.representative,a.invoice_additional_details=d.value.invoice_additional_details,(a.invoice_additional_details==null||a.invoice_additional_details=="")&&(a.invoice_additional_details=[{title:"",description:"",title_ar:""}]),a.invoice_reference_number=d.value.reference_no!=null?d.value.reference_no:"",a.invoice_number=d.value.invoice_number,a.customer_type=d.value.customer_type,a.customer=d.value.customer.slack,a.invoice_discount_type=d.value.invoice_discount_type!=null?d.value.invoice_discount_type:"",a.invoice_discount_amount=d.value.invoice_discount_type!=null&&d.value.invoice_discount_type==1?d.value.invoice_discount_percentage:d.value.invoice_discount,d.value.invoice_products.length>0){a.invoice_products=[];for(var o=0;o<d.value.invoice_products.length;o++){var c=d.value.invoice_products[o].type,w=d.value.invoice_products[o].product_price_without_tax,v=[],i=[0];if(parseFloat(w)*parseFloat(d.value.invoice_products[o].product_quantity),c==1){var b=d.value.invoice_products[o].product.discounts;if(b!=null)for(var g in b)v[g]={value:b[g].name,key:b[g].slack,type:b[g].type,disc:b[g].value};i=_e(v,d.value.invoice_products[o].discount_slack)}else{var v=[];if(C.value!=null)for(var g in C.value)v[g]={value:C.value[g].value,key:C.value[g].key,type:C.value[g].type,disc:C.value[g].disc}}var q=!0,w=0;if(c==1){var s=P(d.value.invoice_products[o].product,d.value.invoice_products[o].product_quantity,i[0]);q=d.value.invoice_products[o].product.price_type==1}else{q=!1,w=d.value.invoice_products[o].product_price,d.value.invoice_products[o].sale_price=w;var s=P(d.value.invoice_products[o],d.value.invoice_products[o].product_quantity,i[0])}let r=B({type:c,product_slack:c==1?d.value.invoice_products[o].product.this_branch_inventory.slack:"",product_name:d.value.invoice_products[o].product_name,quantity:d.value.invoice_products[o].product_quantity,is_fixed_price:q,sale_price:w,discounts:v,discount:d.value.invoice_products[o].discount_slack,discount_amount:0,tax_additional_fee_type:d.value.invoice_products[o].tax_additional_fee_type,additional_fee_slack:d.value.invoice_products[o].additional_fee_slack,tax:c==2&&d.value.invoice_products[o].tax!=null?d.value.invoice_products[o].tax.slack:"",product:c==1?d.value.invoice_products[o].product:[],prices:s});a.invoice_products.push(r)}}if(t.data.data.invoice_charges.length>0){a.additional_charges=[];for(var o=0;o<t.data.data.invoice_charges.length;o++){var u={charge_name:t.data.data.invoice_charges[o].title,charge_amount:t.data.data.invoice_charges[o].charges};a.additional_charges.push(u)}}d.value.invoice_additional_charges>0&&(a.other_charges=!0,$("#shipping_table_wrap").addClass("show")),V()}).catch(t=>{a.server_messages.type="error",a.server_messages.messages=t,console.log(t)})}const J=y([]);function Ae(t){var o=P(t);J.value.push(t.slack);var c=[];if(t.discounts!=null)for(var v in t.discounts)c[v]={value:t.discounts[v].name,key:t.discounts[v].slack,type:t.discounts[v].type,disc:t.discounts[v].value};let i=B({type:1,product_slack:t.this_branch_inventory.slack,product_name:t.name,quantity:1,is_fixed_price:t.price_type==1,edit_sale_price:0,discounts:c,discount:"",discount_amount:0,product:t,prices:o});a.invoice_products.push(i),V()}function Ie(){var t=0,o=0,c=0,v=0,i=0,b=0,g=0,q=0,w=0,s=0;a.invoice_products.map(u=>{let r=u.prices.product_amount,A=u.prices.product_discount_amount,O=r-A,D=u.prices.order_discount_amount,pe=O-D,me=u.prices.additional_fee_amount,ve=u.prices.tobacco_tax_amount,he=u.prices.tax_amount,He=pe+me+ve+he;t+=parseFloat(u.prices.product_quantity),o+=r,c+=A,v+=O,i+=D,b+=pe,g+=me,q+=ve,w+=he,s+=He}),te.value=t,L.value=_.round(o,2),F.value=_.round(c,2),j.value=_.round(v,2),S.value=_.round(i,2),ue.value=_.round(b,2),G.value=_.round(g,2),H.value=_.round(q,2),ae.value=_.round(w,2),M.value=_.round(s,2)}function Te(t){a.invoice_products.splice(a.invoice_products.indexOf(t),1),J.value.splice(J.value.indexOf(t.product_slack),1),V()}function Fe(){var t=[];if(C.value!=null)for(var o in C.value)t[o]={value:C.value[o].value,key:C.value[o].key,type:C.value[o].type,disc:C.value[o].disc};let c=B({type:2,product_slack:"",product_name:"",quantity:1,is_fixed_price:!1,sale_price:"",edit_sale_price:"",price_excluding_tax:"",amount:"",discounts:t,discount:"",discount_amount:0,tax:"",tax_amount:0,tobacco_tax_amount:0,tax_additional_fee_type:"",additional_fee_slack:"",prices:[]});a.invoice_products.push(c),V()}function De(){a.other_charges=a.other_charges!=!0,V()}function Ee(){let t=B({charge_name:"",charge_amount:0});a.additional_charges.push(t)}function Pe(t){a.additional_charges.splice(t,1),V()}const te=y(0),L=y(0),F=y(0),j=y(0),S=y(0),ue=y(0),H=y(0),G=y(0),ae=y(0),oe=y(0),M=y(0),se=y(0);Xe(()=>S.value,_.debounce(t=>{V()},100));function _e(t,o){return t.filter(function(c){if(c.key==o)return c})}function Ne(t,o){return t.filter(function(c){if(c.key==o)return c})}function Me(t){var o=Q.user.country.taxes.filter(function(c){if(c.slack==t)return c});return o[0].total_percentage}function Oe(t,o){let c=0;if(o>0)if(t==2){let v=0;a.invoice_products.map(i=>{(i.type==1||i.prices.product_amount_after_product_discount!=null)&&(v+=parseFloat(i.prices.product_amount_after_product_discount))}),v>0&&(c=o/v*100)}else c=o;return c}function V(){if(a.invoice_discount_amount!=""&&a.invoice_discount_type!=""){var t=Oe(a.invoice_discount_type,parseFloat(a.invoice_discount_amount));se.value=t}for(var o in a.invoice_products){var c=a.invoice_products[o].quantity,v=a.invoice_products[o].discount,i=a.invoice_products[o].additional_fee_slack;a.invoice_products[o].discounts;var b=[0],g=[0],q=!1,w=0,s=a.invoice_products[o].tax,u=0;if(s!=""&&a.invoice_products[o].type==2&&(u=s!=null&&s!=""?Me(s):0),v!=null&&v!=""&&(b=_e(a.invoice_products[o].discounts,v)),i!=null&&i!=""?(g=Ne(ee.value,i),a.invoice_products[o].additional_fee=g[0]):a.invoice_products[o].additional_fee="",a.invoice_products[o].is_fixed_price==!1&&(a.invoice_products[o].type==1?w=a.invoice_products[o].prices.product_rate:w=a.invoice_products[o].sale_price,q=!0),a.invoice_products[o].type==1)var r=P(a.invoice_products[o].product,c,b[0],t,q,w);else{a.invoice_products[o].tax_percentage=u;var r=P(a.invoice_products[o],c,b[0],t,q,w)}a.invoice_products[o].prices=r}Ie();var A=0,O=0;if(a.other_charges)for(var o in a.additional_charges){var D=a.additional_charges[o].charge_amount;!isNaN(D)&&D!=null&&D>0&&(A=parseFloat(A)+parseFloat(a.additional_charges[o].charge_amount))}oe.value=A.toFixed(2),O=parseFloat(M.value)+parseFloat(A),M.value=O.toFixed(2)}async function Be(){a.is_submitting=!0;var t=new FormData;t.append("customer_type",a.customer_type),t.append("customer",a.customer),t.append("representative",a.representative),a.invoice_additional_details.length&&t.append("invoice_additional_details",JSON.stringify(a.invoice_additional_details)),t.append("invoice_number",a.invoice_number),t.append("reference_no",a.invoice_reference_number>0?a.invoice_reference_number:""),t.append("invoice_date",a.invoice_date),t.append("invoice_due_date",a.invoice_due_date),t.append("products",JSON.stringify(a.invoice_products)),t.append("grand_total_product_quantity",te.value!=null?te.value:0),t.append("grand_subtotal_after_product_quantity",L.value!=null?L.value:0),t.append("grand_product_discount",F.value!=null?F.value:0),t.append("grand_subtotal_after_product_discount",j.value!=null?j.value:0),t.append("invoice_discount_amount",S.value!=null?S.value:0),t.append("invoice_discount_type",a.invoice_discount_type!=null?a.invoice_discount_type:0),t.append("invoice_discount_percentage",se.value!=null?se.value:0),t.append("is_additional_charges",a.other_charges),t.append("additional_charges",JSON.stringify(a.additional_charges)),t.append("grand_product_additional_fee",G.value),t.append("grand_product_tobacco_tax",H.value),t.append("grand_product_tax",ae.value),t.append("invoice_additional_charges",oe.value),t.append("grand_product_amount",M.value),t.append("terms",a.terms),t.append("invoice_slack",a.slack);var o=a.slack!=""&&a.slack!=null?"/api/invoice/update":"/api/invoice/save";await axios.post(o,t).then(c=>{if(c.data.status_code==200)toast.success(c.data.msg),a.is_submitting=!1,router.push("/invoice/"+c.data.data.invoice.slack);else{try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(c.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=c.data.msg}a.is_submitting=!1}}).catch(c=>{a.server_messages.type="error",a.server_messages.messages=c,a.is_submitting=!1})}const Re=ne(()=>a.terms==""||a.terms==null?"0 / 500 Characters":a.terms.length+" / 500 Characters"),ze=y(!1);async function Qe(){ze.value=!1,document.getElementById("add_customer_form").reset(),de(),document.getElementById("close_btn").click()}async function Je(){document.getElementById("close_btn").click()}function Le(){var t={title:"",description:"",title_ar:""};a.invoice_additional_details.push(t)}function je(t){a.invoice_additional_details.splice(t,1)}return(t,o)=>{const c=it,v=lt,i=nt,b=Ye("Icon"),g=st,q=ot,w=at;return p(),m(W,null,[f(N)==""||f(N)==null||f(N)!=""&&re.value?(p(),K(f(rt),{key:0,"validation-schema":f(we),onSubmit:Be,"initial-values":a,enctype:"multipart/form-data"},{default:Ze(()=>[e("div",_t,[a.server_messages.messages!=""?(p(),K(f(ke),{key:0,class:"py-3",server_messages:a.server_messages},null,8,["server_messages"])):x("",!0),e("div",pt,[e("div",mt,[e("div",vt,[e("div",ht,[e("h5",bt,n(t.$t("Basic Details"))+":",1),e("div",ft,[e("div",yt,[h(c,{name:"customer_type",modelValue:a.customer_type,"onUpdate:modelValue":o[0]||(o[0]=s=>a.customer_type=s),placeholder:k.value.select_customer_type,options:Ce,label:k.value.customer_type,required:""},null,8,["modelValue","placeholder","label"])]),e("div",gt,[h(v,{name:"customer",label:k.value.customer,placeholder:k.value.select_customer,text:"name",value:"slack",options:Z.value,modelValue:a.customer,"onUpdate:modelValue":o[1]||(o[1]=s=>a.customer=s),mode:"single",required:"",addModalShow:!0,addModalId:"#addCustomerModal"},null,8,["label","placeholder","options","modelValue"])]),e("div",kt,[h(i,{type:"text",name:"invoice_number",modelValue:a.invoice_number,"onUpdate:modelValue":o[2]||(o[2]=s=>a.invoice_number=s),label:k.value.invoice_number,required:!0,disabled:!0},null,8,["modelValue","label"])]),e("div",Vt,[h(i,{type:"text",name:"invoice_reference_number",modelValue:a.invoice_reference_number,"onUpdate:modelValue":o[3]||(o[3]=s=>a.invoice_reference_number=s),label:k.value.invoice_reference},null,8,["modelValue","label"])]),e("div",xt,[h(i,{type:"date",name:"invoice_date",modelValue:a.invoice_date,"onUpdate:modelValue":o[4]||(o[4]=s=>a.invoice_date=s),label:k.value.invoice_date,required:!0},null,8,["modelValue","label"])]),e("div",wt,[h(i,{type:"date",name:"invoice_due_date",modelValue:a.invoice_due_date,"onUpdate:modelValue":o[5]||(o[5]=s=>a.invoice_due_date=s),label:k.value.invoice_due_date},null,8,["modelValue","label"])]),e("div",Ct,[h(i,{type:"text",name:"representative",modelValue:a.representative,"onUpdate:modelValue":o[6]||(o[6]=s=>a.representative=s),label:k.value.representative},null,8,["modelValue","label"])]),e("div",$t,[e("div",Ut,[e("h6",qt,n(t.$t("Invoice Additional Details"))+" : ",1)]),e("div",St,[e("div",At,n(t.$t("Title")),1),e("div",It,n(t.$t("Value")),1),e("div",Tt,n(t.$t("Title (Arabic)")),1)]),(p(!0),m(W,null,le(a.invoice_additional_details,(s,u)=>(p(),m("div",{class:"row mb-3",key:u},[e("div",Ft,[e("span",Dt,[I(e("input",{type:"text",name:"title","onUpdate:modelValue":r=>s.title=r,class:"form-control form-control-solid"},null,8,Et),[[E,s.title]])])]),e("div",Pt,[e("div",Nt,[I(e("input",{type:"text",name:"description","onUpdate:modelValue":r=>s.description=r,class:"form-control form-control-solid",autocomplete:"off"},null,8,Mt),[[E,s.description]])])]),e("div",Ot,[e("div",Bt,[I(e("input",{type:"text",name:"description","onUpdate:modelValue":r=>s.title_ar=r,class:"form-control form-control-solid",autocomplete:"off"},null,8,Rt),[[E,s.title_ar]])])]),e("div",zt,[u>0?(p(),m("button",{key:0,class:"btn btn-xs btn-light-danger btn-icon",type:"button",onClick:r=>je(u)},[h(b,{icon:"material-symbols:delete-forever"})],8,Qt)):x("",!0),u==0?(p(),m("button",{key:1,class:"btn btn-sm btn-icon btn-light-primary",type:"button",onClick:o[7]||(o[7]=r=>Le()),title:"Add Charge"},[h(b,{icon:"material-symbols:add"})])):x("",!0)])]))),128))])])])]),e("div",Jt,[e("div",Lt,[e("div",jt,[e("h5",Ht,n(t.$t("Products"))+":",1),e("div",Gt,[h(f(Ve),{onSelectProduct:Ae,placeholder:k.value.search_placeholder,selected_products:J.value,button_placeholder:k.value.add_service,only_available:2},null,8,["placeholder","selected_products","button_placeholder"])]),e("div",Kt,[e("table",Wt,[e("thead",Xt,[e("tr",null,[e("th",null,n(t.$t("Product/Service Name")),1),e("th",Yt,[R(n(t.$t("Unit Rate"))+" ",1),Zt,f(ce)==!0?(p(),m("span",ea,n(t.$t("(Tax Inclusive)")),1)):x("",!0),f(ce)==!1?(p(),m("span",ta,n(t.$t("(Tax Exclusive)")),1)):x("",!0)]),e("th",aa,n(t.$t("Quantity")),1),e("th",oa,n(t.$t("Amount")),1),e("th",sa,n(t.$t("Discount")),1),e("th",na,[R(n(t.$t("Other Taxes"))+" ",1),la,R(" "+n(t.$t("and fee")),1)]),e("th",ia,n(t.$t("Subtotal")),1),e("th",ca,n(t.$t("Tax")),1),e("th",da,n(t.$t("Total")),1),e("th",ra,n(t.$t("Remove")),1)])]),e("tbody",null,[a.invoice_products.length>0?(p(!0),m(W,{key:0},le(a.invoice_products,(s,u)=>(p(),m("tr",{key:u},[I(e("input",{type:"hidden",name:"product_name","onUpdate:modelValue":r=>s.product_name=r},null,8,ua),[[E,s.product_name]]),I(e("input",{type:"hidden",name:"product.sku","onUpdate:modelValue":r=>s.product_slack=r},null,8,_a),[[E,s.product_slack]]),s.type==1?(p(),m("td",pa,[R(n(s.product_name)+" ",1),h(f(ct),{type:"hidden",name:"invoice_products["+u+"].product_name",value:s.product_name},null,8,["name","value"]),h(f(dt),{name:"invoice_products["+u+"].product_name",as:"div",class:"error"},null,8,["name"])])):(p(),m("td",ma,[h(i,{type:"text",name:"invoice_products["+u+"].product_name",label:"",modelValue:s.product_name,"onUpdate:modelValue":r=>s.product_name=r,islabel:!1,class:z("pt-0")},null,8,["name","modelValue","onUpdate:modelValue"])])),s.type==1?(p(),m("td",va,[h(i,{type:"number",name:"invoice_products["+u+"].sale_price",input_group_text:f(U),modelValue:s.prices.product_rate,"onUpdate:modelValue":r=>s.prices.product_rate=r,min:"0.01",step:"0.01",label:"",onInput:V,islabel:!1,class:z("pt-0"),disabled:s.is_fixed_price},null,8,["name","input_group_text","modelValue","onUpdate:modelValue","disabled"])])):(p(),m("td",ha,[h(i,{type:"number",name:"invoice_products["+u+"].sale_price",input_group_text:f(U),modelValue:s.sale_price,"onUpdate:modelValue":r=>s.sale_price=r,min:"0.01",step:"0.01",label:"",onInput:V,islabel:!1,class:z("pt-0")},null,8,["name","input_group_text","modelValue","onUpdate:modelValue"])])),e("td",ba,[h(i,{type:"number",input_group_text:k.value.units,label:"",name:"invoice_products["+u+"].quantity",modelValue:s.quantity,"onUpdate:modelValue":r=>s.quantity=r,min:"0.01",step:"0.01",onInput:V,islabel:!1,class:z("pt-0")},null,8,["input_group_text","name","modelValue","onUpdate:modelValue"])]),e("td",fa,n(s.prices.product_amount.toFixed(2)),1),e("td",ya,[h(c,{name:`discount_${u}`,placeholder:k.value.select_discount,options:s.discounts,class:"mb-0",modelValue:s.discount,"onUpdate:modelValue":r=>s.discount=r,onChange:V,id:u,label:"",islabel:!1},null,8,["name","placeholder","options","modelValue","onUpdate:modelValue","id"])]),s.type==1?(p(),m("td",ga,[s.prices.additional_fee_amount>0?(p(),m("span",ka,n(s.prices.additional_fee_amount.toFixed(2)),1)):s.prices.tobacco_tax_amount>0?(p(),m("span",Va,n(s.prices.tobacco_tax_amount.toFixed(2)),1)):(p(),m("span",xa,"0"))])):(p(),m("td",wa,[e("div",Ca,[h(g,{name:`tax_additional_fee_types_${u}`,label:"",options:qe.value,modelValue:s.tax_additional_fee_type,"onUpdate:modelValue":r=>s.tax_additional_fee_type=r,size:"normal",onChange:V},null,8,["name","options","modelValue","onUpdate:modelValue"])]),s.tax_additional_fee_type==2?(p(),m("div",$a,[h(c,{name:`additional_fee_${u}`,label:"",placeholder:"Select Additional Fee",options:ee.value,class:"mb-0",modelValue:s.additional_fee_slack,"onUpdate:modelValue":r=>s.additional_fee_slack=r,onChange:V},null,8,["name","options","modelValue","onUpdate:modelValue"])])):x("",!0)])),e("td",Ua,n(s.prices.product_amount_after_fee_and_taxes.toFixed(2)),1),s.type==1?(p(),m("td",qa,n(s.prices.tax_amount.toFixed(2)),1)):(p(),m("td",Sa,[h(c,{name:`tax_${u}`,placeholder:k.value.select_tax,options:Y.value,class:"mb-0",modelValue:s.tax,"onUpdate:modelValue":r=>s.tax=r,onChange:V,id:u,label:"",islabel:!1},null,8,["name","placeholder","options","modelValue","onUpdate:modelValue","id"])])),e("td",Aa,n(s.prices.final_product_amount.toFixed(2)),1),e("td",Ia,[e("a",{role:"button",class:"btn btn-icon btn-xs btn-light-danger",onClick:r=>Te(s)},Da,8,Ta)])]))),128)):x("",!0)])])]),e("div",Ea,[e("div",Pa,[e("div",Na,[e("a",{href:"javascript:;",onClick:Fe},"+ "+n(t.$t("Add Service")),1)]),e("div",Ma,[I(e("input",{class:"form-check-input",type:"checkbox",value:"",id:"Shipping_charge","data-bs-toggle":"collapse","data-bs-target":"#shipping_table_wrap","onUpdate:modelValue":o[8]||(o[8]=s=>a.other_charges=s),onClick:De},null,512),[[et,a.other_charges]]),e("label",Oa,n(t.$t("Other Charges")),1)]),e("div",{class:z(a.other_charges?"collapse show":"collapse"),id:"shipping_table_wrap"},[e("table",Ba,[(p(!0),m(W,null,le(a.additional_charges,(s,u)=>(p(),m("tr",{key:u},[e("th",Ra,[h(i,{type:"text",name:"additional_charges["+u+"].charge_name",modelValue:s.charge_name,"onUpdate:modelValue":r=>s.charge_name=r,placeholder:k.value.charge_name},null,8,["name","modelValue","onUpdate:modelValue","placeholder"])]),e("th",za,[h(i,{type:"number",name:"additional_charges["+u+"].charge_amount",modelValue:s.charge_amount,"onUpdate:modelValue":r=>s.charge_amount=r,placeholder:k.value.charge,onInput:V,min:"0"},null,8,["name","modelValue","onUpdate:modelValue","placeholder"])]),e("th",Qa,[e("div",Ja,[e("button",{role:"button",class:"btn btn-sm btn-icon btn-light-danger",onClick:r=>Pe(u),disabled:!(a.additional_charges.length>1),type:"button"},"x",8,La),u==a.additional_charges.length-1?(p(),m("button",{key:0,role:"button",class:"btn btn-sm btn-icon btn-light-primary ms-2",onClick:o[9]||(o[9]=r=>Ee()),type:"button"},"+")):x("",!0)])])]))),128))])],2)]),e("div",ja,[e("table",Ha,[e("tr",null,[e("th",Ga,[e("h6",Ka,n(t.$t("Item Sub Total")),1)]),e("th",Wa,[e("h6",Xa,n(L.value)+" "+n(f(U)),1)]),Ya]),e("tr",null,[e("th",Za,[h(c,{name:"invoice_discount_type",modelValue:a.invoice_discount_type,"onUpdate:modelValue":o[10]||(o[10]=s=>a.invoice_discount_type=s),placeholder:k.value.discount_type,options:$e,class:"mt-0",label:"",onChange:V,islabel:!1},null,8,["modelValue","placeholder"])]),e("th",eo,[h(i,{modelValue:a.invoice_discount_amount,"onUpdate:modelValue":o[11]||(o[11]=s=>a.invoice_discount_amount=s),type:"number",name:"invoice_discount_amount",class:"mt-0 p-0",placeholder:k.value.value,label:"",onInput:V,islabel:!1},null,8,["modelValue","placeholder"])]),to]),F.value>0?(p(),m("tr",ao,[e("th",oo,[e("h6",so,n(t.$t("-Product Discount")),1)]),e("th",no,[e("h6",lo,n(F.value)+" "+n(f(U)),1)]),io])):x("",!0),F.value>0?(p(),m("tr",co,[e("th",ro,[e("h6",uo,n(t.$t("Subtotal after Product Discount")),1)]),e("th",_o,[e("h6",po,n(j.value)+" "+n(f(U)),1)]),mo])):x("",!0),S.value>0?(p(),m("tr",vo,[e("th",ho,[e("h6",bo,n(t.$t("-Invoice Discount")),1)]),e("th",fo,[e("h6",yo,n(S.value)+" "+n(f(U)),1)]),go])):x("",!0),S.value>0?(p(),m("tr",ko,[e("th",Vo,[e("h6",xo,n(t.$t("Sub Total After Discount")),1)]),e("th",wo,[e("h6",Co,n(ue.value)+" "+n(f(U)),1)]),$o])):x("",!0),H.value>0?(p(),m("tr",Uo,[e("th",qo,[e("h6",So,n(t.$t("Tobacco Tax")),1)]),e("th",Ao,[e("h6",Io,n(H.value)+" "+n(f(U)),1)]),To])):x("",!0),G.value>0?(p(),m("tr",Fo,[e("th",Do,[e("h6",Eo,n(t.$t("Additional Fees")),1)]),e("th",Po,[e("h6",No,n(G.value)+" "+n(f(U)),1)]),Mo])):x("",!0),e("tr",null,[e("th",Oo,[e("h6",Bo,n(t.$t("Taxes")),1)]),e("th",Ro,[e("h6",zo,n(ae.value)+" "+n(f(U)),1)]),Qo]),a.other_charges==!0?(p(),m("tr",Jo,[e("th",Lo,[e("h6",jo,n(t.$t("Other Charges")),1)]),e("th",Ho,[e("h6",Go,n(oe.value)+" "+n(f(U)),1)]),Ko])):x("",!0),e("tr",Wo,[e("th",Xo,[e("h5",Yo,n(t.$t("Payable Amount")),1)]),e("th",Zo,[e("h5",es,n(M.value)+" "+n(f(U)),1)]),ts])])])])])])]),e("div",as,[e("div",os,[e("div",ss,[e("h5",ns,[R(n(t.$t("Note/Terms and Conditions"))+": ",1),e("label",ls,n(f(Re)),1)]),e("div",is,[I(e("textarea",{maxlength:"500",class:"form-control form-control-solid text-area",name:"terms","onUpdate:modelValue":o[12]||(o[12]=s=>a.terms=s),rows:"1"},null,512),[[E,a.terms]])])])])])])])]),e("div",cs,[e("button",{type:"submit",class:"btn btn-primary",disabled:a.is_submitting},[a.is_submitting?(p(),K(ut,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):x("",!0),a.is_submitting?(p(),m("span",rs,n(t.$t("Saving...")),1)):(p(),m("span",us,n(t.$t("Save")),1))],8,ds)])]),_:1},8,["validation-schema","initial-values"])):(p(),K(q,{key:1})),e("div",_s,[e("div",ps,[e("div",ms,[e("div",vs,[e("h5",hs,n(t.$t("Add Customer")),1),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:Je,id:"close_btn"})]),e("div",bs,[h(w,{onCloseAddCustomerModal:Qe})])])])])],64)}}};export{Es as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.Re9KOdbP.js","assets/index.li3fCRRM.js","assets/index.KTHCd6a8.css","assets/InvoiceProductSearch.4LGsFVSp.js","assets/vee-validate.esm.reM-LHjC.js","assets/index.esm.e6McCFlz.js","assets/BeatLoader.GtqPXmja.js","assets/BeatLoader.5j6ku4bW.css","assets/ClipLoader.7xz7y6gZ.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
