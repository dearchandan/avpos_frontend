import{u as D,a as O,r as m,b as R,e as $,s as x,o as B,d as H,g as v,p as k,w as y,f as I,i as s,l as o,k as F,t as p,j as V,m as T,h as U,q as G,_ as W}from"./index.li3fCRRM.js";import{D as j}from"./DefaultLayout.saUWsTkY.js";import{_ as Y}from"./VTextInput.pcaNaUkX.js";import{_ as Q}from"./VSelectInput.v0GOolGM.js";import{F as z}from"./vee-validate.esm.reM-LHjC.js";import{c as J,a as c}from"./index.esm.e6McCFlz.js";import{C as K}from"./ClipLoader.gDBpDd3b.js";import{_ as X}from"./VTextArea.S7BcQM-W.js";import"./VTooltip.pHzwBjkF.js";/* empty css                                                   */const Z={class:"header-nav-wrap"},ee={class:"row align-items-center"},te={class:"col-auto"},ae={class:"header-back-link"},se={class:"col-auto"},ie={class:"fw-bold"},le={class:"content"},oe={class:"row card-strash"},ne={class:"col-md-12"},re={class:"row"},de={class:"col-md-12 mb-4"},ue={class:"card"},pe={class:"row"},me={class:"col-3"},ce={class:"col-2"},_e={class:"col-2"},ve={class:"col-2"},fe={class:"col-3"},ge={class:"col-3"},he={class:"col-9"},ye={class:"col-2 pt-4"},be={class:"col-2 pt-4"},ke={class:"col-3 pt-4"},Ve={class:"label"},Ie={class:"input-group input-file-group"},Te={class:"btn btn-light-primary min-width-0 mb-0",for:"formFile"},Ue={class:"form-text text-muted mb-1"},Ee={class:"text-end"},Se=["disabled"],qe={key:1,class:"pt-0"},Ce={key:2,class:"pt-0"},Ge={__name:"add_support_ticket",setup(Ne){const{t:i}=D(),f=O().params.slack,r=m({merchant_name:i("Select Merchant"),ticket_type:i("Ticket Type"),priority:i("Priority"),title:i("Title"),description:i("Description"),reporting_date:i("Reporting Date"),reporting_platform:i("Reporting Platform"),user_name:i("User Name"),email:i("Email"),attachment:i("Attachment (jpeg, jpg, png)")}),E=G(()=>W(()=>import("./ServerMessage.Re9KOdbP.js"),__vite__mapDeps([0,1,2])));R();const d=$({type:"",messages:""}),e=m({is_submitting:!1,title:"",ticket_type:"INQUIRY",priority:"MEDIUM",merchant_id:"",description:"",reporting_date:"",reporting_platform:"",user_name:"",email:"",attachment:""}),S=m([{id:"WEB",name:"Web"},{id:"WOSUL_EASY",name:"Wosul Easy"},{id:"IPAD",name:"IPad"}]),q=m([{id:"INQUIRY",name:"INQUIRY"},{id:"SUGGESTION",name:"SUGGESTION"},{id:"COMPLAINT",name:"COMPLAINT"},{id:"TECHNICAL_PROBLEM",name:"TECHNICAL_PROBLEM"},{id:"TECHNICAL_SUPPORT",name:"TECHNICAL_SUPPORT"}]),C=m([{id:"LOW",name:"LOW"},{id:"MEDIUM",name:"MEDIUM"},{id:"HIGH",name:"HIGH"}]);x(Multiselect),B(()=>{M(),_.isUndefined(f)||P()});let N=J({title:c().required(i("name is required",{name:i("Title")})).min(3,i("name must be at least n characters",{name:i("Title"),number:3})),description:c().required(i("name is required",{name:i("Description")})),ticket_type:c().required(i("name is required",{name:i("Ticket Type")})),priority:c().required(i("name is required",{name:i("Priority")})),reporting_date:c().required(i("name is required",{name:i("Reporting Date")})),reporting_platform:c().required(i("name is required",{name:i("Reporting Platform")}))});const b=m([]);async function M(){let t=await axios.get("/api/merchants/all_merchants_ids");b.value=t.data.data,console.log("merchants_list.value =",b.value)}async function P(){let t=await axios.get("/api/support_ticket/"+f);e.value=t.data.data,console.log(e.value),e.value.country_id=t.data.data.country.slack,e.value.description=t.data.data.description!=null?t.data.data.description:"",e.value.description_ar=t.data.data.description_ar!=null?t.data.data.description_ar:"",e.value.price_type=t.data.data.price_type!=null?t.data.data.price_type:1,t.data.data.features!=null&&_.forEach(t.data.data.features,a=>{feature_selected.value.push(a.feature_name)}),t.data.data.addons!=null&&(addon_selected.value=[],_.forEach(addons.value,a=>{var n="";_.forEach(t.data.data.addons,u=>{u.addon_master_id==a.id&&(n=u.limit_value)});let g={id:a.id,constant_name:a.constant_name,name:a.name,name_ar:a.name_ar,description:a.description,type:a.type,status:a.status,value:n};addon_selected.value.push(g)}))}H(()=>!_.isUndefined(props.action));async function w(t){e.value.attachment=t.target.files[0]}async function A(){e.value.is_submitting=!0;var t=new FormData;t.append("priority",e.value.priority),t.append("ticket_type",e.value.ticket_type),t.append("title",e.value.title),t.append("description",e.value.description),t.append("merchant_id",e.value.merchant_id),t.append("reporting_platform",e.value.reporting_platform),t.append("reporting_date",e.value.reporting_date),t.append("user_name",e.value.user_name),t.append("email",e.value.email),t.append("attachment",e.value.attachment);var a=f!=""&&f!=null?"/api/support_ticket/update":"/api/support_ticket/save";await axios.post(a,t,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{if(n.data.status_code==200)toast.success(n.data.msg),e.value.is_submitting=!1,router.push("/support_tickets");else{try{d.type="error",d.messages=JSON.parse(n.data.msg)}catch{d.type="error",d.messages=n.data.msg}e.value.is_submitting=!1}}).catch(n=>{d.type="error",d.messages=n,e.value.is_submitting=!1})}return(t,a)=>{const n=I("Icon"),g=I("router-link"),u=Q,h=Y,L=j;return v(),k(L,null,{subheader:y(()=>[s("div",Z,[s("div",ee,[s("div",te,[s("div",ae,[o(g,{class:"text-primary",to:"/support_tickets"},{default:y(()=>[o(n,{icon:"fa6-solid:chevron-left"}),F(" "+p(t.$t("Support Ticket")),1)]),_:1})])]),s("div",se,[s("h5",ie,p(t.$t("Support Ticket")),1)])])])]),default:y(()=>[s("div",le,[o(V(z),{"validation-schema":V(N),onSubmit:A,enctype:"multipart/form-data","initial-values":e.value},{default:y(({values:Pe,search:we})=>[s("div",oe,[d.messages!=""?(v(),k(V(E),{key:0,class:"py-3",server_messages:d},null,8,["server_messages"])):T("",!0),s("div",ne,[s("div",re,[s("div",de,[s("div",ue,[s("div",pe,[s("div",me,[o(u,{modelValue:e.value.merchant_id,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.merchant_id=l),name:"merchant_id",label:r.value.merchant_name,options:b.value},null,8,["modelValue","label","options"])]),s("div",ce,[o(u,{modelValue:e.value.ticket_type,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.ticket_type=l),name:"ticket_type",label:r.value.ticket_type,required:"",options:q.value},null,8,["modelValue","label","options"])]),s("div",_e,[o(u,{modelValue:e.value.priority,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.priority=l),name:"priority",label:r.value.priority,required:"",options:C.value},null,8,["modelValue","label","options"])]),s("div",ve,[o(h,{type:"text",name:"user_name",label:r.value.user_name,modelValue:e.value.user_name,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.user_name=l)},null,8,["label","modelValue"])]),s("div",fe,[o(h,{type:"email",name:"email",label:r.value.email,modelValue:e.value.email,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.email=l)},null,8,["label","modelValue"])]),s("div",ge,[o(h,{type:"text",name:"title",label:r.value.title,required:"",modelValue:e.value.title,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.title=l)},null,8,["label","modelValue"])]),s("div",he,[o(X,{name:"description",label:r.value.description,modelValue:e.value.description,"onUpdate:modelValue":a[6]||(a[6]=l=>e.value.description=l),required:""},null,8,["label","modelValue"])]),s("div",ye,[o(h,{type:"date",name:"reporting_date",label:r.value.reporting_date,modelValue:e.value.reporting_date,"onUpdate:modelValue":a[7]||(a[7]=l=>e.value.reporting_date=l),required:""},null,8,["label","modelValue"])]),s("div",be,[o(u,{modelValue:e.value.reporting_platform,"onUpdate:modelValue":a[8]||(a[8]=l=>e.value.reporting_platform=l),name:"reporting_platform",label:r.value.reporting_platform,required:"",options:S.value},null,8,["modelValue","label","options"])]),s("div",ke,[s("label",Ve,p(t.$t("Attachment (jpeg, jpg, png)")),1),s("div",Ie,[s("input",{class:"form-control form-control-solid",name:"attachment",type:"file",id:"formFile",onChange:w},null,32),s("label",Te,p(t.$t("Upload")),1)]),s("small",Ue,p(t.$t("Allowed file size per file is 3 MB")),1)])])])])])])]),s("div",Ee,[s("button",{type:"submit",class:"btn btn-primary",disabled:e.value.is_submitting},[e.value.is_submitting?(v(),k(K,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):T("",!0),e.value.is_submitting?(v(),U("span",qe,p(t.$t("Saving...")),1)):(v(),U("span",Ce,p(t.$t("Save")),1))],8,Se)])]),_:1},8,["validation-schema","initial-values"])])]),_:1})}}};export{Ge as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.Re9KOdbP.js","assets/index.li3fCRRM.js","assets/index.KTHCd6a8.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
