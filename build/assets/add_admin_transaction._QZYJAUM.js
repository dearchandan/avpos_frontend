import{D as U}from"./DefaultLayout.K5Bh9Jz_.js";import{_ as P}from"./VTextInput.EPCajChY.js";import{_ as B}from"./VSelect.twStq9pE.js";import{_ as F}from"./VRadio.uBwIG0IU.js";import O from"./ServerMessage.EFQMOwoZ.js";import{u as L,r as y,e as j,o as k,v as z,g as c,p as q,w as d,f as S,i as a,l,k as J,t as r,h,m as $,K,N as R,j as D}from"./index.sP6fhsqN.js";import{F as X}from"./vee-validate.esm.2kXgdFia.js";import{c as G,a as u,b as H}from"./index.esm.DHYHwGJ4.js";import{C as Q}from"./ClipLoader._89zL49D.js";import"./VTooltip.kcvohVRA.js";/* empty css                                                                *//* empty css                                                   */const W={class:"header-nav-wrap"},Y={class:"row align-items-center"},Z={class:"col-auto"},ee={class:"header-back-link"},te={class:"col-auto"},ae={class:"fw-bold"},se={class:"content"},oe={class:"row card-strash"},ne={key:0,class:"py-3"},le={class:"col-md-12"},ie={class:"row"},me={class:"col-md-12 mb-4"},ce={class:"card"},re={class:"row"},de={class:"col-md-3"},ue={class:"col-md-3"},_e={class:"col-md-3"},pe={class:"col-md-3"},ve={class:"col-md-3"},ye={class:"col-md-9"},he={class:"text-end"},fe=["disabled"],be={key:1,class:"pt-0"},ge={key:2,class:"pt-0"},Ce={__name:"add_admin_transaction",setup(Ve){const{t:s}=L(),f={server_messages:{type:"",messages:""},is_submitting:!1,type:"INCOME",account:"",payment_method:"",amount:"",transaction_date:"",note:""},E=[{name:"Income",value:"INCOME"},{name:"Expense",value:"EXPENSE"}],i=y({type:s("Type"),account:s("Account"),select_account:s("Select Account"),payment_method:s("Payment Method"),select_payment_method:s("Select Payment Method"),amount:s("Amount"),transaction_date:s("Transaction Date")}),e=j({...f}),N=G({type:u().required(s("name is required",{name:s("Type")})),account:u().required(s("name is required",{name:s("Account")})),payment_method:u().required(s("name is required",{name:s("Payment Method")})),amount:H().typeError(s("must be a number",{name:s("Amount")})).required(s("name is required",{name:s("Amount")})).positive(s("must be a positive number",{name:s("Amount")})),transaction_date:u().required(s("name is required",{name:s("Transaction Date")}))}),p=y([]);k(()=>{b()}),z(()=>e.type,o=>{b()});async function b(){let o=new FormData;o.append("account_type",e.type);let t=await axios.post("api/admin_accounts/all",o);t=t.data.data,p.value=[],_.forEach(t,m=>{let v={key:m.slack,value:m.name};p.value.push(v)})}const g=y([]);k(()=>{T()});async function T(){let o=await axios.get("api/payment_methods/all");o=o.data.data,_.forEach(o,t=>{let m={key:t.slack,value:t.name};g.value.push(m)})}async function x(){e.is_submitting=!0;var o=new FormData;o.append("type",e.type),o.append("account",e.account),o.append("payment_method",e.payment_method),o.append("amount",e.amount),o.append("transaction_date",e.transaction_date),o.append("note",e.note),await axios.post("/api/admin_transaction/save",o).then(t=>{if(t.data.status_code==200)toast.success(t.data.msg),e.is_submitting=!1,router.push("/admin/transactions"),A();else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(t.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=t.data.msg}e.is_submitting=!1}}).catch(t=>{e.server_messages.type="error",e.server_messages.messages=t,e.is_submitting=!1,console.log(t)})}function A(){Object.assign(e,f)}return(o,t)=>{const m=S("Icon"),v=S("router-link"),M=O,C=F,V=B,w=P,I=U;return c(),q(I,null,{subheader:d(()=>[a("div",W,[a("div",Y,[a("div",Z,[a("div",ee,[l(v,{class:"text-primary",to:"/admin/transactions"},{default:d(()=>[l(m,{icon:"fa6-solid:chevron-left"}),J(" "+r(o.$t("Transactions")),1)]),_:1})])]),a("div",te,[a("h5",ae,r(o.$t("Add Transaction")),1)])])])]),default:d(()=>[a("div",se,[l(D(X),{"validation-schema":D(N),onSubmit:x,"initial-values":e,enctype:"multipart/form-data"},{default:d(()=>[a("div",oe,[e.server_messages.messages!=""?(c(),h("div",ne,[l(M,{server_messages:e.server_messages},null,8,["server_messages"])])):$("",!0),a("div",le,[a("div",ie,[a("div",me,[a("div",ce,[a("div",re,[a("div",de,[l(C,{type:"radio",name:"type",modelValue:e.type,"onUpdate:modelValue":t[0]||(t[0]=n=>e.type=n),label:i.value.type,required:!0,options:E},null,8,["modelValue","label"])]),a("div",ue,[l(V,{name:"account",label:i.value.account,modelValue:e.account,"onUpdate:modelValue":t[1]||(t[1]=n=>e.account=n),placeholder:i.value.select_account,options:p.value,required:""},null,8,["label","modelValue","placeholder","options"])]),a("div",_e,[l(V,{name:"payment_method",label:i.value.payment_method,modelValue:e.payment_method,"onUpdate:modelValue":t[2]||(t[2]=n=>e.payment_method=n),placeholder:i.value.select_payment_method,options:g.value,required:""},null,8,["label","modelValue","placeholder","options"])]),a("div",pe,[l(w,{type:"number",name:"amount",modelValue:e.amount,"onUpdate:modelValue":t[3]||(t[3]=n=>e.amount=n),label:i.value.amount,required:!0},null,8,["modelValue","label"])]),a("div",ve,[l(w,{type:"date",name:"transaction_date",modelValue:e.transaction_date,"onUpdate:modelValue":t[4]||(t[4]=n=>e.transaction_date=n),label:i.value.transaction_date,required:!0},null,8,["modelValue","label"])]),a("div",ye,[a("label",null,r(o.$t("Note")),1),K(a("textarea",{class:"form-control form-control-solid p-3",name:"note","onUpdate:modelValue":t[5]||(t[5]=n=>e.note=n),cols:"10",rows:"10"},null,512),[[R,e.note]])])])])])])])]),a("div",he,[a("button",{type:"submit",class:"btn btn-primary",disabled:e.is_submitting},[e.is_submitting?(c(),q(Q,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):$("",!0),e.is_submitting?(c(),h("span",be,r(o.$t("Saving...")),1)):(c(),h("span",ge,r(o.$t("Save")),1))],8,fe)])]),_:1},8,["validation-schema","initial-values"])])]),_:1})}}};export{Ce as default};
