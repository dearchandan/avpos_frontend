import{_ as Y}from"./ActionButtonGroup.IGw_8hrL.js";import{_ as H}from"./ListingSkeleton.6NzqF9S5.js";import{_ as Q}from"./VSelect.xfZK6hek.js";import{u as X,b as Z,r as d,e as C,o as x,v as ee,g as l,p as B,w as D,I as te,f as T,i as e,t as s,h as c,l as u,k as se,m as p,K as y,N as oe,j as V,y as ae,L as A,F as ie,x as ne,O as le}from"./index.li3fCRRM.js";import{D as ce}from"./DefaultLayout.saUWsTkY.js";import{_ as re}from"./PaginateLimit.SmYeFgfo.js";import{j as de}from"./vue-datepicker.a6BsTEHj.js";import"./vee-validate.esm.reM-LHjC.js";/* empty css                                                                */import"./ClipLoader.gDBpDd3b.js";/* empty css                                                   */const _e={class:"header-nav-wrap"},ue={class:"row align-items-center"},me={class:"col-auto"},he={class:"fw-bold"},pe={class:"content"},ve={class:"page-heading"},fe={class:"row align-items-center justify-content-between"},ge={class:"col-auto"},ye={class:"row align-items-center"},be={key:0,class:"col-auto"},we={class:"col-auto"},ke={class:"row align-items-center"},$e={class:"col-auto"},Se={class:"form-field page-heading-search-field mb-0"},Ce={class:"field-icon"},De=["placeholder"],Ve={class:"icon"},Ae={class:"col-auto"},Ne={class:"dropdown filter-dropdown"},Fe={class:"row gx-3"},Be={class:"col-12"},Te={class:"form-field"},Ie={class:"form-label"},Oe={class:"row gx-3"},Pe={class:"col-6"},Ue={class:"col-6"},Ee={class:"form-field"},Me={class:"form-label"},je={value:"1"},qe={value:"2"},Le={value:"3"},We={class:"col-6"},Je={class:"form-field"},Re={class:"form-label"},ze={value:""},Ge={value:"1"},Ke={value:"2"},Ye={class:"col-6"},He={class:"form-field"},Qe={class:"form-label"},Xe={value:""},Ze={value:"1"},xe={value:"0"},et={class:"row py-3"},tt={class:"col-12 text-end"},st={key:1,class:"table-responsive"},ot={class:"table table-list-data table-hover"},at={class:"bg-light"},it={scope:"col",width:"20%"},nt={scope:"col",width:"10%"},lt={scope:"col",width:"10%"},ct={scope:"col",width:"10%"},rt={scope:"col",width:"10%"},dt={scope:"col",width:"10%",class:"text-end"},_t={scope:"col",width:"5%"},ut={key:0,scope:"col",class:"text-end",width:"5%"},mt={class:"fw-bold highlighted-list-item"},ht=e("br",null,null,-1),pt={class:"text-muted"},vt={key:0},ft={key:1},gt={key:0},yt={key:1},bt={key:2},wt={key:0},kt={key:1},$t={class:"text-end"},St={key:0,class:"badge badge-info"},Ct={key:1},Dt={class:"form-feild"},Vt={class:"form-check form-switch form-switch-2"},At=["onChange","checked"],Nt={key:0,class:"text-end"},Ft={key:1},Bt={class:"text-center py-3",colspan:"11"},Tt={class:"data-footer"},It={class:"row align-items-center justify-content-between"},Ot={class:"col-auto"},Pt={class:"col-auto"},Ht={__name:"master_subscriptions",setup(Ut){const{t:v}=X(),{isAuthorized:N}=te();Z();const I={server_messages:{type:"",messages:""},is_listing:!1,search_query:d("")},O=v("Search by name, arabic name, price.."),i=C({...I});x(()=>{J(),m(),U()}),ee(()=>i.search_query,_.debounce(()=>{m()},500));const b=d([]),w=d([]);async function m(t=1){i.is_listing=!0,await axios.get("/api/subscriptions",{params:{page:t,paginate_limit:F.value,search_query:i.search_query,filter:r}}).then(o=>{b.value=o.data.data,w.value=o.data.pagination,i.is_listing=!1}).catch(o=>{i.server_messages.type="error",i.server_messages.messages=o,i.is_listing=!1,console.log(o)})}const F=d();async function P(t){F.value=t,await m()}const k=d([]);async function U(){k.value=[];let t=await axios.get("api/countries/all");t=t.data.data,_.forEach(t,o=>{let n={key:o.slack,value:o.name};k.value.push(n)})}async function E(t){var o=new FormData;o.append("slack",t),await axios.post("/api/subscription/update_status",o).then(n=>{if(n.data.status_code==200)toast.success(n.data.msg);else try{i.server_messages.type="error",i.server_messages.messages=JSON.parse(n.data.msg)}catch{i.server_messages.type="error",i.server_messages.messages=n.data.msg}}).catch(n=>{i.server_messages.type="error",i.server_messages.messages=n,console.log(n)})}const f=d(!1),$=C({created_date:d(),status:d(""),country:d(""),device_type:d(""),subscription_for:d("")}),r=C({...$}),S=d(!1);async function M(){JSON.stringify(r)!=JSON.stringify($)&&(S.value=!0),f.value=!1,await m()}async function j(){f.value=!f.value}function q(){Object.assign(r,$),S.value=!1,m()}function L(t){router.push("/master_subscription/edit/"+t)}async function W(t){var o=!1;await Swal.fire({title:v("Do you want to delete this Subscription?"),showCancelButton:!0,confirmButtonText:v("Yes, Delete"),confirmButtonColor:"#d33",cancelButtonText:v("Cancel")}).then(n=>{n.isConfirmed&&(o=!0)}),o&&await axios.post("/api/subscription/delete",{slack:t}).then(n=>{if(n.data.status_code==200)Swal.fire(n.data.msg),m();else try{i.server_messages.type="error",i.server_messages.messages=JSON.parse(n.data.msg)}catch{i.server_messages.type="error",i.server_messages.messages=n.data.msg}}).catch(n=>{i.server_messages.type="error",i.server_messages.messages=n,console.log(n)})}const h=d({write:!1,delete:!1});function J(){h.value={write:N("A_WRITE_SUBSCRIPTION"),delete:N("A_DELETE_SUBSCRIPTION")}}return(t,o)=>{const n=T("router-link"),g=T("Icon"),R=Q,z=H,G=Y;return l(),B(ce,null,{subheader:D(()=>[e("div",_e,[e("div",ue,[e("div",me,[e("h5",he,s(t.$t("Subscriptions")),1)])])])]),default:D(()=>[e("div",pe,[e("div",ve,[e("div",fe,[e("div",ge,[e("div",ye,[h.value.write?(l(),c("div",be,[u(n,{class:"btn btn-sm btn-light-primary",to:"/master_subscription/add"},{default:D(()=>[se("+ "+s(t.$t("New Subscription")),1)]),_:1})])):p("",!0)])]),e("div",we,[e("div",ke,[e("div",$e,[e("div",Se,[e("div",Ce,[y(e("input",{type:"search",class:"form-control form-control-sm form-control-shadow",placeholder:V(O),"onUpdate:modelValue":o[0]||(o[0]=a=>i.search_query=a)},null,8,De),[[oe,i.search_query]]),e("div",Ve,[u(g,{icon:"fa6-solid:magnifying-glass"})])])])]),e("div",Ae,[e("div",Ne,[e("button",{type:"button",class:"btn btn-sm btn-icon btn-light-primary","data-bs-auto-close":"outside",onClick:j},[u(g,{icon:"fa6-solid:filter"})]),e("div",{class:ae([f.value?"show":"","dropdown-menu p-3 w-365"]),id:"filter_box",style:{position:"absolute",inset:"0px auto auto 0px",margin:"0px",transform:"translate3d(-310px, 36px, 0px)"}},[e("form",null,[e("div",Fe,[e("div",Be,[e("div",Te,[e("label",Ie,s(t.$t("Created Date")),1),u(V(de),{range:"",modelValue:r.created_date,"onUpdate:modelValue":o[1]||(o[1]=a=>r.created_date=a),format:"dd-MM-yyyy","enable-time-picker":!1},null,8,["modelValue"])])])]),e("div",Oe,[e("div",Pe,[u(R,{name:"country",label:"Country",modelValue:r.country,"onUpdate:modelValue":o[2]||(o[2]=a=>r.country=a),placeholder:"--Select Country--",options:k.value},null,8,["modelValue","options"])]),e("div",Ue,[e("div",Ee,[e("label",Me,s(t.$t("Device Type")),1),y(e("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":o[3]||(o[3]=a=>r.device_type=a)},[e("option",je,s(t.$t("All")),1),e("option",qe,s(t.$t("Web Devices")),1),e("option",Le,s(t.$t("Mobile Devices")),1)],512),[[A,r.device_type]])])]),e("div",We,[e("div",Je,[e("label",Re,s(t.$t("Subscription For")),1),y(e("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":o[4]||(o[4]=a=>r.subscription_for=a)},[e("option",ze,s(t.$t("All")),1),e("option",Ge,s(t.$t("Wosul")),1),e("option",Ke,s(t.$t("Alhamrani")),1)],512),[[A,r.subscription_for]])])]),e("div",Ye,[e("div",He,[e("label",Qe,s(t.$t("Status")),1),y(e("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":o[5]||(o[5]=a=>r.status=a)},[e("option",Xe,s(t.$t("All")),1),e("option",Ze,s(t.$t("Active")),1),e("option",xe,s(t.$t("Inactive")),1)],512),[[A,r.status]])])])]),e("button",{type:"button",onClick:M,class:"btn btn-sm btn-primary w-100"},s(t.$t("Filter")),1)])],2)])])])])]),e("div",et,[e("div",tt,[S.value?(l(),c("button",{key:0,class:"badge badge-danger btn-sm",onClick:q},s(t.$t("Clear Filters")),1)):p("",!0)])])]),i.is_listing?(l(),B(z,{key:0})):(l(),c("div",st,[e("table",ot,[e("thead",at,[e("tr",null,[e("th",it,s(t.$t("Name")),1),e("th",nt,s(t.$t("Category")),1),e("th",lt,s(t.$t("Device Type")),1),e("th",ct,s(t.$t("Subscription For")),1),e("th",rt,s(t.$t("Country")),1),e("th",dt,s(t.$t("Price")),1),e("th",_t,s(t.$t("Active")),1),h.value.write&&h.value.delete?(l(),c("th",ut,s(t.$t("Action")),1)):p("",!0)])]),e("tbody",null,[b.value!=""?(l(!0),c(ie,{key:0},ne(b.value,(a,K)=>(l(),c("tr",{key:K},[e("td",null,[e("div",null,[e("span",mt,s(a.name),1),ht,e("small",pt,s(a.name_ar),1)])]),e("td",null,[a.subscription_category==1?(l(),c("span",vt,s(t.$t("Plan")),1)):a.subscription_category==2?(l(),c("span",ft,s(t.$t("Service")),1)):p("",!0)]),e("td",null,[a.device_type==1?(l(),c("span",gt,s(t.$t("All")),1)):a.device_type==2?(l(),c("span",yt,s(t.$t("Web Devices")),1)):(l(),c("span",bt,s(t.$t("Mobile Devices")),1))]),e("td",null,[a.subscription_for==1?(l(),c("span",wt,s(t.$t("Wosul")),1)):(l(),c("span",kt,s(t.$t("Alhamrani")),1))]),e("td",null,s(a.country.name),1),e("td",$t,[a.is_trial?(l(),c("span",St,s(a.trial_days)+" "+s(t.$t("Days Fee Trial")),1)):(l(),c("span",Ct,s(a.payable_amount)+" "+s(a.currency.symbol),1))]),e("td",null,[e("div",Dt,[e("div",Vt,[e("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:Et=>E(a.slack),checked:a.status==1},null,40,At)])])]),h.value.write&&h.value.delete?(l(),c("td",Nt,[u(G,{permissions:h.value,onDelete:W,onEdit:L,slack:a.slack},null,8,["permissions","slack"])])):p("",!0)]))),128)):(l(),c("tr",Ft,[e("td",Bt,s(t.$t("No Data Found")),1)]))])])])),e("div",Tt,[e("div",It,[e("div",Ot,[u(re,{onPaginate_limit_update:P,pagination:w.value},null,8,["pagination"])]),e("div",Pt,[u(V(le),{data:w.value,onPaginationChangePage:m},null,8,["data"])])])])])]),_:1})}}};export{Ht as default};
