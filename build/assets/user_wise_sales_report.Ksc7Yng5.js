import{u as se,b as ae,d as S,e as B,r as p,v as oe,g as i,p as b,w as $,f as q,i as t,k as v,n as O,t as s,j as e,l as x,A as R,B as U,h,F as ne,x as le,O as ce,I as ie,bV as D,q as re,_ as de}from"./index.GdMxdeuf.js";import{_ as _e}from"./DefaultLayout.qd3nRBiq.js";import{_ as ue}from"./PaginateLimit.H-orl6zP.js";import{_ as me}from"./ListingSkeleton.upY030ro.js";import{_ as he}from"./VMultiSelect.aFZl8ywf.js";import{s as L,a as pe,e as ge,j as ve}from"./vue-datepicker.iEAbZR0K.js";import{s as P,e as I}from"./index.Fegs7wUo.js";import"./ClipLoader.UcGuNCxH.js";/* empty css                                                   */import"./vee-validate.esm.9aElOHQY.js";const fe={class:"header-nav-wrap"},ye={class:"row align-items-center"},be={class:"col-auto"},xe={class:"header-back-link"},we={class:"col-auto"},ke={class:"fw-bold"},$e={class:"content"},De={class:"card"},Fe={class:"row field-m-0 align-items-end g-3"},Ve={class:"col-md-4 col-lg-3"},Ye={class:"form-field"},Me={for:"",class:"form-label"},Se=t("span",{class:"text-danger"},"*",-1),qe=["onClick","onKeyup"],Ae={class:"col-md-4 col-lg-3"},Ce={class:"col-md-4 col-lg-3"},Ne={class:"col-auto text-end"},Ee={class:"row align-items-center"},Be={class:"col-auto"},Oe=["disabled"],Re={key:1,class:"pt-0"},Ue={key:2,class:"pt-0"},Le={class:"col-auto"},Pe=["disabled"],Ie={key:1,class:"pt-0"},Te={key:2,class:"pt-0"},je={class:"card"},ze={class:""},Ke={key:0},Qe={key:1,class:"table-responsive"},Je={class:"table table-list-data table-hover"},Ge={class:"bg-light"},We={scope:"col"},He={scope:"col"},Xe={scope:"col",class:"text-end"},Ze={scope:"col",class:"text-end"},et={scope:"col",class:"text-end"},tt={scope:"col",class:"text-end"},st={scope:"col",class:"text-end"},at={scope:"col",class:"text-end"},ot={scope:"col",class:"text-end"},nt={scope:"col",class:"text-end"},lt={class:"text-end"},ct={class:"text-end"},it={class:"text-end"},rt={class:"text-end"},dt={class:"text-end"},_t={class:"text-end"},ut={class:"text-end"},mt={class:"text-end"},ht={key:1},pt={class:"text-center py-3",colspan:"10"},gt={key:0},vt=t("th",{colspan:"2"},null,-1),ft={class:"text-end"},yt={class:"text-end"},bt={class:"text-end"},xt={class:"text-end"},wt={class:"text-end"},kt={class:"text-end"},$t={class:"text-end"},Dt={class:"text-end"},Ft={class:"data-footer"},Vt={class:"row align-items-center justify-content-between"},Yt={class:"col-auto"},Mt={class:"col-auto"},It={__name:"user_wise_sales_report",setup(St){const{t:w}=se(),{isAuthorized:qt,getRoundedValue:d}=ie(),A=ae(),u=S(()=>A.user.currency.symbol),g=B({server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,dates:p([new Date,new Date]),users:p([]),selected_branches:p(),selected_users:p([]),is_exporting:!1}),a=B({...g}),T=w("Select Branch"),j=w("All Branches"),z=w("Select User"),K=w("All Users"),Q=p([{label:"Today",value:[new Date,new Date]},{label:"This month",value:[P(new Date),I(new Date)]},{label:"Last month",value:[P(L(new Date,1)),I(L(new Date,1))]},{label:"This year",value:[pe(new Date),ge(new Date)]}]),J=S(()=>A.user.branches);oe(()=>a.selected_branches,n=>{n.length==1?G(n[0]):a.selected_users=[]});const F=p([]);async function G(n){n!=null&&n!=""&&await axios.post("/api/branch/users",{id:n}).then(o=>{if(o.data.status_code==200){F.value=[];let l=o.data.data.branch_users;_.forEach(l,f=>{if(f.user!=null){let k={id:f.user.id,name:f.user.name};F.value.push(k)}})}else try{g.server_messages.type="error",g.server_messages.messages=JSON.parse(o.data.msg)}catch{g.server_messages.type="error",g.server_messages.messages=o.data.msg}}).catch(o=>{g.server_messages.type="error",g.server_messages.messages=o,console.log(o)})}const C=p();async function W(n){C.value=n,await Y()}const r=p([]),V=p([]);async function Y(n=1){a.is_listing=!0,a.dates[0]=D(a.dates[0]).format("YYYY-MM-DD"),a.dates[1]=D(a.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/user_wise_sales_report",{params:{page:n,paginate_limit:C.value,filter:a}}).then(o=>{r.value=o.data.data.data,V.value=o.data.pagination,a.is_listing=!1}).catch(o=>{a.server_messages.type="error",a.server_messages.messages=o,a.is_listing=!1,console.log(o)})}const m=S(()=>r.value.length?{sale_qty:r.value.reduce(function(o,l){return o+parseFloat(l.sale_qty)},0).toFixed(),sale_amount:r.value.reduce(function(o,l){return o+parseFloat(l.sale_amount)},0).toFixed(2),returned_qty:r.value.reduce(function(o,l){return o+parseFloat(l.returned_qty)},0).toFixed(),returned_amount:r.value.reduce(function(o,l){return o+parseFloat(l.returned_amount)},0).toFixed(2),discount_amount:r.value.reduce(function(o,l){return o+parseFloat(l.discount_amount)},0).toFixed(2),returned_discount_amount:r.value.reduce(function(o,l){return o+parseFloat(l.returned_discount_amount)},0).toFixed(2),net_sale_qty:r.value.reduce(function(o,l){return o+parseFloat(l.net_sale_qty)},0).toFixed(2),net_sale_amount:r.value.reduce(function(o,l){return o+parseFloat(l.net_sale_amount)},0).toFixed(2)}:null);async function H(){a.is_exporting=!0,a.dates[0]=D(a.dates[0]).format("YYYY-MM-DD"),a.dates[1]=D(a.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/user_wise_sales_report/export_excel",{params:{filter:a}}).then(n=>{if(n.data.status_code==200){a.is_exporting=!1;const o=document.createElement("a");o.target="_blank",o.href=n.data.data.file,document.body.appendChild(o),o.click()}else{try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(n.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=n.data.msg}a.is_exporting=!1}}).catch(n=>{a.server_messages.type="error",a.server_messages.messages=n,a.is_exporting=!1,console.log(n)})}const X=re(()=>de(()=>import("./ServerMessage.Wf7puwQc.js"),__vite__mapDeps([0,1,2])));return(n,o)=>{const l=q("Icon"),f=q("router-link"),k=he,N=q("clip-loader"),Z=me,ee=ue,te=_e;return i(),b(te,null,{subheader:$(()=>[t("div",fe,[t("div",ye,[t("div",be,[t("div",xe,[v(f,{class:"text-primary",to:"/reports"},{default:$(()=>[v(l,{icon:"fa6-solid:chevron-left"}),O(" "+s(n.$t("Reports")),1)]),_:1})])]),t("div",we,[t("h5",ke,s(n.$t("User Wise Sales Report")),1)])])])]),default:$(()=>[t("div",$e,[e(a).server_messages.messages!=""?(i(),b(e(X),{key:0,class:"py-3",server_messages:e(a).server_messages},null,8,["server_messages"])):x("",!0),t("div",De,[t("div",Fe,[t("div",Ve,[t("div",Ye,[t("label",Me,[O(s(n.$t("Select Dates"))+" ",1),Se]),v(e(ve),{range:"","preset-dates":e(Q),modelValue:e(a).dates,"onUpdate:modelValue":o[0]||(o[0]=c=>e(a).dates=c),format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":$(({label:c,value:y,presetDate:M})=>[t("span",{role:"button",tabindex:0,onClick:E=>M(y),onKeyup:[R(U(E=>M(y),["prevent"]),["enter"]),R(U(E=>M(y),["prevent"]),["space"])]},s(c),41,qe)]),_:1},8,["preset-dates","modelValue"])])]),t("div",Ae,[v(k,{name:"branches",label:e(T),placeholder:e(j),text:"name",value:"id",options:e(J),modelValue:e(a).selected_branches,"onUpdate:modelValue":o[1]||(o[1]=c=>e(a).selected_branches=c)},null,8,["label","placeholder","options","modelValue"])]),t("div",Ce,[e(a).selected_branches!=null&&e(a).selected_branches.length==1?(i(),b(k,{key:0,name:"users",label:e(z),placeholder:e(K),text:"name",value:"id",options:e(F),modelValue:e(a).selected_users,"onUpdate:modelValue":o[2]||(o[2]=c=>e(a).selected_users=c)},null,8,["label","placeholder","options","modelValue"])):x("",!0)]),t("div",Ne,[t("div",Ee,[t("div",Be,[t("button",{type:"button",class:"btn btn-primary",onClick:o[3]||(o[3]=c=>Y()),disabled:e(a).is_listing||e(a).dates==null},[e(a).is_listing?(i(),b(N,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):x("",!0),e(a).is_listing?(i(),h("span",Re,s(n.$t("Viewing...")),1)):(i(),h("span",Ue,s(n.$t("View")),1))],8,Oe)]),t("div",Le,[t("button",{type:"button",class:"btn btn-success",onClick:o[4]||(o[4]=c=>H()),disabled:e(a).is_exporting||e(a).dates==null},[e(a).is_exporting?(i(),b(N,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):x("",!0),e(a).is_exporting?(i(),h("span",Ie,s(n.$t("Exporting...")),1)):(i(),h("span",Te,s(n.$t("Export Excel")),1))],8,Pe)])])])])]),t("div",je,[t("div",ze,[e(a).is_listing?(i(),h("div",Ke,[v(Z)])):(i(),h("div",Qe,[t("table",Je,[t("thead",Ge,[t("tr",null,[t("th",We,s(n.$t("Branch")),1),t("th",He,s(n.$t("User Name")),1),t("th",Xe,s(n.$t("Sold Qty.")),1),t("th",Ze,s(n.$t("Sales Amount")),1),t("th",et,s(n.$t("Returned Qty.")),1),t("th",tt,s(n.$t("Returned Amount")),1),t("th",st,s(n.$t("Discount")),1),t("th",at,s(n.$t("Returned Discount")),1),t("th",ot,s(n.$t("Net Sales Qty.")),1),t("th",nt,s(n.$t("Net Sales Amount")),1)])]),t("tbody",null,[e(r)!=""?(i(!0),h(ne,{key:0},le(e(r),(c,y)=>(i(),h("tr",{key:y},[t("td",null,s(c.branch_name),1),t("td",null,s(c.user_name),1),t("td",lt,s(c.sale_qty),1),t("td",ct,s(e(d)(c.sale_amount))+" "+s(e(u)),1),t("td",it,s(c.returned_qty),1),t("td",rt,s(e(d)(c.returned_amount))+" "+s(e(u)),1),t("td",dt,s(e(d)(c.discount_amount))+" "+s(e(u)),1),t("td",_t,s(e(d)(c.returned_discount_amount))+" "+s(e(u)),1),t("td",ut,s(c.net_sale_qty),1),t("td",mt,s(e(d)(c.net_sale_amount))+" "+s(e(u)),1)]))),128)):(i(),h("tr",ht,[t("td",pt,s(n.$t("No Data Found")),1)]))]),e(m)!=""&&e(m)!=null?(i(),h("tfoot",gt,[t("tr",null,[vt,t("th",ft,s(e(m).sale_qty),1),t("th",yt,s(e(d)(e(m).sale_amount))+" "+s(e(u)),1),t("th",bt,s(e(m).returned_qty),1),t("th",xt,s(e(d)(e(m).returned_amount))+" "+s(e(u)),1),t("th",wt,s(e(d)(e(m).discount_amount))+" "+s(e(u)),1),t("th",kt,s(e(d)(e(m).returned_discount_amount))+" "+s(e(u)),1),t("th",$t,s(e(m).net_sale_qty),1),t("th",Dt,s(e(d)(e(m).net_sale_amount))+" "+s(e(u)),1)])])):x("",!0)])])),t("div",Ft,[t("div",Vt,[t("div",Yt,[v(ee,{onPaginate_limit_update:W,pagination:e(V)},null,8,["pagination"])]),t("div",Mt,[v(e(ce),{data:e(V),limit:5,onPaginationChangePage:Y},null,8,["data"])])])])])])])]),_:1})}}};export{It as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.Wf7puwQc.js","assets/index.GdMxdeuf.js","assets/index.1t-AB2n6.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
