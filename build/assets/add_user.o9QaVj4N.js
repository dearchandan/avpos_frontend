import{_ as D}from"./EditFormSkeleton.Pn2vxq9j.js";import{_ as L}from"./VCodeGenerateTextInput.xspRvdfs.js";import A from"./ServerMessage.Wf7puwQc.js";import{_ as O}from"./DefaultLayout.qd3nRBiq.js";import{F as G}from"./vee-validate.esm.9aElOHQY.js";import{c as P,a as u}from"./index.esm.0vhAmrVd.js";import{_ as p}from"./VTextInput.ZgtOiOMJ.js";import{u as J,a as z,r as b,e as H,o as K,v as Q,g as c,p as f,w as y,f as S,i as t,k as d,n as W,t as v,j as m,h,l as $}from"./index.GdMxdeuf.js";import{C as X}from"./ClipLoader.UcGuNCxH.js";import{_ as j}from"./VSelect.c4Loo_XL.js";import"./VTooltip.Ewb958d6.js";/* empty css                                                   *//* empty css                                                                */const Y={class:"header-nav-wrap"},Z={class:"row align-items-center"},ee={class:"col-auto"},ae={class:"header-back-link"},se={class:"col-auto"},te={key:0,class:"fw-bold"},oe={key:1,class:"fw-bold"},le={key:0,class:"content"},ne={class:"row card-strash"},de={key:0,class:"py-3"},ie={class:"col-md-12"},re={class:"row"},me={class:"col-md-12 mb-4"},ue={class:"card"},_e={class:"row"},ce={class:"col-md-3"},pe={class:"col-md-3"},ve={class:"col-md-3"},he={class:"col-md-3"},ge={class:"col-md-3"},fe={class:"col-md-12"},be={class:"card"},ye={class:"row"},we={class:"col-md-3"},Ve={class:"col-md-3"},ke={class:"col-md-3"},qe={class:"col-md-3"},Ue={class:"col-md-3"},Pe={class:"col-md-3"},Se={class:"label"},$e={class:"input-group input-file-group"},je={class:"btn btn-light-primary min-width-0 mb-0",for:"formFile"},Ce={class:"text-end"},xe=["disabled"],Ie={key:1,class:"pt-0"},Ne={key:2,class:"pt-0"},We={__name:"add_user",setup(Ee){const{t:a}=J(),i=z().params.slack,r=b({name:a("Name"),email:a("Email"),password:a("Password"),phone:a("Phone"),role:a("Role"),select_role:a("Select Role"),status:a("Status"),select_status:a("Select Status"),date_of_birth:a("Date Of Birth"),date_of_anniversary:a("Date Of Anniversary"),joining_date:a("Date Of Joining"),login_code:a("Login Code")}),e=H({...{server_messages:{type:"",messages:""},is_submitting:!1,name:"",email:"",password:"",role:"",status:"",login_code:"",phone:"",date_of_birth:"",date_of_anniversary:"",joining_date:"",image:"",user_slack:"",password_dummy:"123456789",passwordType:"password",switchPasswordIcon:!0}});let w=P({name:u().required(a("name is required",{name:a("Name")})).min(3,a("name must be at least n characters",{name:a("Name"),number:3})),email:u().required(a("name is required",{name:a("Email")})).email(a("must be a valid email",{name:a("Email")})),password:u().required(a("name is required",{name:a("Password")})).min(8,a("name must be at least n characters",{name:a("Password"),number:8})),role:u().required(a("name is required",{name:a("Role")})),status:u().required(a("name is required",{name:a("Status")})),phone:u().matches(/^(?:[0-9]{9,10})?$/,a("Mobile number must be number and should be 9 or 10 digits"))});const V=b([]),C=[{key:"0",value:a("Inactive")},{key:"1",value:a("Active")},{key:"2",value:a("Hold")},{key:"3",value:a("Left")}],k=b([]);K(()=>{I(),_.isUndefined(i)||x()}),Q(()=>{_.isUndefined(i)||(w=P({name:u().required(a("name is required",{name:a("Name")})).min(3,a("name must be at least n characters",{name:a("Name"),number:3})),email:u().required(a("name is required",{name:a("Email")})).email(a("must be a valid email",{name:a("Email")})),role:u().required(a("name is required",{name:a("Role")})),status:u().required(a("name is required",{name:a("Status")})),phone:u().matches(/^(?:[0-9]{9,10})?$/,a("Mobile number must be number and should be 9 or 10 digits"))}))});const q=b(!1);async function x(){let s=await axios.get("/api/user",{params:{slack:i}});k.value=s.data.data,s.data.data&&(e.user_slack=s.data.data.slack,e.name=s.data.data.name,e.email=s.data.data.email,e.role=s.data.data.role?s.data.data.role.slack:"",e.status=s.data.data.status,e.login_code=s.data.data.login_code,e.date_of_anniversary=s.data.data.anniversary_date,e.date_of_birth=s.data.data.birth_date,e.phone=s.data.data.phone>0?s.data.data.phone:"",e.joining_date=s.data.data.joining_date,e.password_dummy="123456789"),q.value=!0}async function I(){let s=await axios.get("api/v2/roles/all");s=s.data.data,_.forEach(s,o=>{let n={key:o.slack,value:o.name};V.value.push(n)})}function N(){let s="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$*",n=o.length;for(let g=0;g<10;g++)s+=o.charAt(Math.floor(Math.random()*n));e.password=s}async function E(){let s=await axios.post("api/user/generate_login_code");e.login_code=s.data.data.login_code}async function F(s){e.image=s.target.files[0]}async function R(){e.is_submitting=!0;var s=new FormData;s.append("name",e.name),s.append("email",e.email),s.append("password",e.password),s.append("role",e.role),s.append("status",e.status),s.append("login_code",e.login_code),s.append("phone",e.phone),s.append("date_of_birth",e.date_of_birth),s.append("date_of_anniversary",e.date_of_anniversary),s.append("joining_date",e.joining_date),s.append("image",e.image),s.append("user_slack",e.user_slack);var o=e.user_slack!=""&&e.user_slack!=null?"/api/user/update":"/api/user/save";await axios.post(o,s,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{if(n.data.status_code==200)toast.success(n.data.msg),e.is_submitting=!1,router.push("/users");else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(n.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=n.data.msg}e.is_submitting=!1}}).catch(n=>{e.server_messages.type="error",e.server_messages.messages=n,e.is_submitting=!1,console.log(n)})}function T(){e.switchPasswordIcon==!0?(e.switchPasswordIcon=!1,e.passwordType="text"):(e.switchPasswordIcon=!0,e.passwordType="password")}return(s,o)=>{const n=S("Icon"),g=S("router-link"),M=A,U=L,B=D;return c(),f(O,null,{subheader:y(()=>[t("div",Y,[t("div",Z,[t("div",ee,[t("div",ae,[d(g,{class:"text-primary",to:"/users"},{default:y(()=>[d(n,{icon:"fa6-solid:chevron-left"}),W(" "+v(s.$t("Users")),1)]),_:1})])]),t("div",se,[m(i)==null||m(i)==""?(c(),h("h5",te,v(s.$t("Add User")),1)):(c(),h("h5",oe,v(s.$t("Edit User")),1))])])])]),default:y(()=>[m(i)==""||m(i)==null||m(i)!=""&&q.value?(c(),h("div",le,[d(m(G),{"validation-schema":m(w),onSubmit:R,enctype:"multipart/form-data","initial-values":e},{default:y(()=>[t("div",ne,[e.server_messages.messages!=""?(c(),h("div",de,[d(M,{server_messages:e.server_messages},null,8,["server_messages"])])):$("",!0),t("div",ie,[t("div",re,[t("div",me,[t("div",ue,[t("div",_e,[t("div",ce,[d(p,{type:"text",name:"name",modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=l=>e.name=l),label:r.value.name,required:!0},null,8,["modelValue","label"])]),t("div",pe,[d(p,{type:"email",name:"email",modelValue:e.email,"onUpdate:modelValue":o[1]||(o[1]=l=>e.email=l),label:r.value.email,required:!0,readonly:m(i)!=null&&m(i)!=""},null,8,["modelValue","label","readonly"])]),t("div",ve,[m(i)==null||m(i)==""?(c(),f(U,{key:0,type:e.passwordType,name:"password",modelValue:e.password,"onUpdate:modelValue":o[2]||(o[2]=l=>e.password=l),label:r.value.password,required:!0,onGenerate_code:N,onShow_password_text:T,is_show_password:!0,showPassword:e.switchPasswordIcon},null,8,["type","modelValue","label","showPassword"])):(c(),f(p,{key:1,type:"password",name:"password_dummy",modelValue:e.password_dummy,"onUpdate:modelValue":o[3]||(o[3]=l=>e.password_dummy=l),label:m(a)("Password (Can be updated from Reset Password)"),readonly:!0},null,8,["modelValue","label"]))]),t("div",he,[d(j,{name:"role",label:r.value.role,modelValue:e.role,"onUpdate:modelValue":o[4]||(o[4]=l=>e.role=l),placeholder:r.value.select_role,options:V.value,required:""},null,8,["label","modelValue","placeholder","options"])]),t("div",ge,[d(j,{name:"status",label:r.value.status,modelValue:e.status,"onUpdate:modelValue":o[5]||(o[5]=l=>e.status=l),placeholder:r.value.select_status,options:C,required:"",disabled:k.value.user_type==2},null,8,["label","modelValue","placeholder","disabled"])])])])]),t("div",fe,[t("div",be,[t("div",ye,[t("div",we,[d(U,{type:"text",name:"login_code",modelValue:e.login_code,"onUpdate:modelValue":o[6]||(o[6]=l=>e.login_code=l),label:r.value.login_code,onGenerate_code:E,readonly:!0},null,8,["modelValue","label"])]),t("div",Ve,[d(p,{type:"text",name:"phone",modelValue:e.phone,"onUpdate:modelValue":o[7]||(o[7]=l=>e.phone=l),label:r.value.phone},null,8,["modelValue","label"])]),t("div",ke,[d(p,{type:"date",name:"date_of_birth",modelValue:e.date_of_birth,"onUpdate:modelValue":o[8]||(o[8]=l=>e.date_of_birth=l),label:r.value.date_of_birth},null,8,["modelValue","label"])]),t("div",qe,[d(p,{type:"date",name:"date_of_anniversary",modelValue:e.date_of_anniversary,"onUpdate:modelValue":o[9]||(o[9]=l=>e.date_of_anniversary=l),label:r.value.date_of_anniversary},null,8,["modelValue","label"])]),t("div",Ue,[d(p,{type:"date",name:"joining_date",modelValue:e.joining_date,"onUpdate:modelValue":o[10]||(o[10]=l=>e.joining_date=l),label:r.value.joining_date},null,8,["modelValue","label"])]),t("div",Pe,[t("label",Se,v(s.$t("Upload Profile Pic")),1),t("div",$e,[t("input",{class:"form-control form-control-solid",name:"image",type:"file",id:"formFile",accept:"image/jpg, image/jpeg, image/png",onChange:F},null,32),t("label",je,v(s.$t("Upload")),1)])])])])])])])]),t("div",Ce,[t("button",{type:"submit",class:"btn btn-primary",disabled:e.is_submitting},[e.is_submitting?(c(),f(X,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):$("",!0),e.is_submitting?(c(),h("span",Ie,v(s.$t("Saving...")),1)):(c(),h("span",Ne,v(s.$t("Save")),1))],8,xe)])]),_:1},8,["validation-schema","initial-values"])])):(c(),f(B,{key:1}))]),_:1})}}};export{We as default};
