import{z as F,u as N,b as j,d as L,r as p,P as R,e as x,o as H,j as r,g as l,h as c,i as e,t as n,k as S,w as J,F as C,x as M,l as y,p as q,q as T,_ as U,C as G,D as K}from"./index.GdMxdeuf.js";import"./index.esm.0vhAmrVd.js";import{C as Q}from"./ClipLoader.UcGuNCxH.js";import{F as W}from"./vee-validate.esm.9aElOHQY.js";/* empty css                                                   */const P=m=>(G("data-v-e217df83"),m=m(),K(),m),X={key:0,class:""},Y={class:"my-2"},Z={class:"tab-content-head"},ee={class:"row align-items-center justify-content-between"},se={class:"col-auto"},te={class:"col-auto"},ie={class:"form-field mb-0"},oe={class:"table-responsive"},ae={class:"table table-hover mb-0"},re={class:"bg-light"},ne={width:"20%"},de={width:"20%"},le={class:"text-end"},ce={class:"valign-top",width:"20%"},_e={class:"mb-0"},me={colspan:"2",class:"px-0"},ue={class:"table normal-table"},fe={width:"25%"},pe={class:"form-field mb-0 field-end-label"},he=["value"],ve=P(()=>e("small",null,"Per Unit",-1)),ge={class:"text-end align-middle"},be=["onClick"],ye=P(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"0.88em",height:"1em",viewBox:"0 0 448 512",class:"iconify iconify--fa6-regular"},[e("path",{fill:"currentColor",d:"m170.5 51.6l-19 28.4h145l-19-28.4c-1.5-2.2-4-3.6-6.7-3.6h-93.7c-2.7 0-5.2 1.3-6.7 3.6zm147-26.6l36.7 55H424c13.3 0 24 10.7 24 24s-10.7 24-24 24h-8v304c0 44.2-35.8 80-80 80H112c-44.2 0-80-35.8-80-80V128h-8c-13.3 0-24-10.7-24-24s10.7-24 24-24h69.8l36.7-55.1C140.9 9.4 158.4 0 177.1 0h93.7c18.7 0 36.2 9.4 46.6 24.9zM80 128v304c0 17.7 14.3 32 32 32h224c17.7 0 32-14.3 32-32V128zm80 64v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16m80 0v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16m80 0v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16"})],-1)),we=[ye],ke={class:"col-12 mt-2 text-end"},xe=["disabled"],Se={key:1,class:"pt-0"},Ce={key:2,class:"pt-0"},Me={__name:"AddProductModifier",props:{product:{type:Object}},setup(m){const V=T(()=>U(()=>import("./ModifierSearch.hLSXYRZR.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])));N();const I=j();L(()=>I.user.currency.symbol);const O=m,u=p([]),w=R(O,"product"),a=p(""),k=w.value.slack,h=p([]),f=p([]),s=x({...{server_messages:{type:"",messages:""},is_submitting:!1,modifier_list:[]}});H(()=>{$()});async function $(){await axios.get("/api/v2/product/modifiers",{params:{slack:k}}).then(t=>{h.value=t.data.data.product_modifiers,_.forEach(h.value,(i,d)=>{let v=[];_.forEach(i.options,(b,Ve)=>{let D={option_name:b.option_name,option_name_ar:b.option_name_ar,sale_price:b.sale_price};v.push(D)});let g={modifier_slack:i.slack,modifier_id:i.modifier_id,modifier_name:i.modifier.name,modifier_name_ar:i.modifier.name_ar,modifier_options:v};s.modifier_list.push(g),u.value.push(i.modifier_id)}),f.value=t.data.data.all_modifiers;let o=h.value.map(i=>i.modifier.id);f.value=f.value.filter(i=>!o.includes(i.id))}).catch(t=>{s.server_messages.type="error",s.server_messages.messages=t,console.log(t)})}function A(t){if(a.value=t,a.value!=""){let o=[];_.forEach(a.value.options,(d,v)=>{let g={option_name:d.option_name,option_name_ar:d.option_name_ar,sale_price:d.sale_price};o.push(g)});let i=x({modifier_slack:a.value.slack,modifier_id:a.value.id,modifier_name:a.value.name,modifier_name_ar:a.value.name_ar,modifier_options:o});s.modifier_list.push(i),u.value.push(a.value.id),a.value=""}}function E(t){s.modifier_list.splice(s.modifier_list.indexOf(t),1);let o=_.find(f.value,i=>i.id==t.modifier_id);u.value.splice(u.value.indexOf(o.id),1)}async function z(){s.is_submitting=!0;var t=new FormData;t.append("product_slack",k),t.append("modifiers",JSON.stringify(s.modifier_list)),await axios.post("/api/product/modifier/update",t).then(o=>{if(s.is_submitting=!1,o.data.status_code==200)toast.success(o.data.msg),B();else{try{s.server_messages.type="error",s.server_messages.messages=JSON.parse(o.data.msg)}catch{s.server_messages.type="error",s.server_messages.messages=o.data.msg}s.is_submitting=!1}}).catch(o=>{s.server_messages.type="error",s.server_messages.messages=o,s.is_submitting=!1,console.log(o)})}function B(){a.value=""}return(t,o)=>r(w)!=""?(l(),c("div",X,[e("div",Y,[e("div",Z,[e("div",ee,[e("div",se,[e("h3",null,n(t.$t("Modifiers")),1)]),e("div",te,[e("div",ie,[S(r(V),{onSelectProduct:A,selected_modifiers:r(u)},null,8,["selected_modifiers"])])])])]),S(r(W),{onSubmit:z,"validation-schema":t.schema,"initial-values":r(s)},{default:J(()=>[e("div",oe,[e("table",ae,[e("thead",re,[e("tr",null,[e("th",ne,n(t.$t("Modifier")),1),e("th",de,n(t.$t("Modifier Options")),1),e("th",null,n(t.$t("Modifier Option Price")),1),e("th",le,n(t.$t("Remove")),1)])]),e("tbody",null,[r(s).modifier_list!=""?(l(!0),c(C,{key:0},M(r(s).modifier_list,i=>(l(),c("tr",null,[e("td",ce,[e("div",_e,[e("b",null,n(i.modifier_name),1)])]),e("td",me,[e("table",ue,[e("tbody",null,[(l(!0),c(C,null,M(i.modifier_options,d=>(l(),c("tr",null,[e("td",fe,n(d.option_name),1),e("td",null,[e("div",pe,[e("input",{class:"form-control form-control-sm form-control-solid",value:d.sale_price,readonly:""},null,8,he),ve])])]))),256))])])]),e("td",ge,[e("a",{role:"button",class:"btn btn-icon btn-xs btn-light-danger",onClick:d=>E(i)},we,8,be)])]))),256)):y("",!0)])])]),e("div",ke,[e("button",{type:"submit",class:"btn btn-primary",disabled:r(s).is_submitting},[r(s).is_submitting?(l(),q(Q,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):y("",!0),r(s).is_submitting?(l(),c("span",Se,n(t.$t("Saving...")),1)):(l(),c("span",Ce,n(t.$t("Save")),1))],8,xe)])]),_:1},8,["validation-schema","initial-values"])])])):y("",!0)}},ze=F(Me,[["__scopeId","data-v-e217df83"]]);export{ze as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ModifierSearch.hLSXYRZR.js","assets/index.GdMxdeuf.js","assets/index.1t-AB2n6.css","assets/vee-validate.esm.9aElOHQY.js","assets/index.esm.0vhAmrVd.js","assets/BeatLoader.czpWuXPY.js","assets/BeatLoader.5j6ku4bW.css","assets/ClipLoader.7xz7y6gZ.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
