import{u as K,b as U,r as l,e as w,o as W,v as Y,g as c,p as H,w as k,I as Q,f as E,i as e,l as d,k as X,t as n,K as Z,N as ee,j as b,h as r,m as g,F as te,x as se,O as ae,q as oe,_ as ie}from"./index.sP6fhsqN.js";import{D as le}from"./DefaultLayout.K5Bh9Jz_.js";import{_ as ne}from"./PaginateLimit.T5jDCI_N.js";import{_ as ce}from"./ActionButtonGroup.AvqLZ7Zu.js";import{_ as re}from"./ListingSkeleton.0g9v9IYA.js";import"./vue-datepicker.S8gODTVm.js";import"./ClipLoader._89zL49D.js";/* empty css                                                   */const de={class:"header-nav-wrap"},_e={class:"row align-items-center"},ue={class:"col-auto"},me={class:"header-back-link"},he={class:"col-auto"},ge={class:"fw-bold"},ve={class:"content"},pe={class:"page-heading"},fe={class:"row align-items-center justify-content-end"},ye={class:"col-auto"},we={class:"form-field page-heading-search-field mb-0"},ke={class:"field-icon"},be=["placeholder"],Ce={class:"icon"},Re={key:0,class:"col-auto"},$e={class:"row"},Ae={class:"col-12 text-end"},De={key:0},Se={key:1,class:"table-responsive"},Ee={class:"table table-list-data table-hover"},Me={class:"bg-light"},Be={scope:"col",width:"60%"},Le={scope:"col",width:"20%"},Ne={scope:"col",width:"10%"},Fe={key:0,scope:"col",class:"text-end",width:"10%"},Te=["onClick"],qe=["onClick"],xe={class:"form-feild"},Ie={class:"form-check form-switch form-switch-2"},Pe=["onChange","checked"],Oe={key:0,class:"text-end"},Ve={key:1},je={class:"text-center py-3",colspan:"8"},Ge={class:"data-footer"},Je={class:"row align-items-center justify-content-between"},ze={class:"col-auto"},Ke={class:"col-auto"},st={__name:"roles",setup(Ue){const{t:h}=K(),{isAuthorized:C}=Q(),M=oe(()=>ie(()=>import("./AddRole.KNeMmqwN.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])));U();const v=l(!1),R=l([]);function $(t=""){R.value=t,v.value=!0}function B(){v.value=!1,m()}const L={server_messages:{type:"",messages:""},is_listing:!1,search_query:l("")},N=h("Search by name..."),s=w({...L});W(()=>{O(),m()}),Y(()=>s.search_query,_.debounce(()=>{m()},500));const p=l([]),f=l([]);l(!1);async function m(t=1){s.is_listing=!0,await axios.get("/api/v2/roles",{params:{page:t,paginate_limit:A.value,search_query:s.search_query,filter:x}}).then(o=>{p.value=o.data.data,f.value=o.data.pagination,s.is_listing=!1}).catch(o=>{s.server_messages.type="error",s.server_messages.messages=o,s.is_listing=!1,console.log(o)})}const A=l();async function F(t){A.value=t,await m()}async function T(t){var o=new FormData;o.append("slack",t),await axios.post("/api/role/update_status",o).then(a=>{if(a.data.status_code==200)toast.success(a.data.msg);else try{s.server_messages.type="error",s.server_messages.messages=JSON.parse(a.data.msg)}catch{s.server_messages.type="error",s.server_messages.messages=a.data.msg}}).catch(a=>{s.server_messages.type="error",s.server_messages.messages=a,console.log(a)})}const q=w({dates:l(),role_type:l(""),status:l(""),created_by:l("")}),x=w({...q}),I=l(!1);function D(t){router.push("/role/"+t)}async function P(t){var o=!1;await Swal.fire({title:h("Do you want to delete this role, It withdraw the permission from all users with this role?"),showCancelButton:!0,confirmButtonText:h("Yes, Delete"),confirmButtonColor:"#d33",cancelButtonText:h("Cancel")}).then(a=>{a.isConfirmed&&(o=!0)}),o&&await axios.post("/api/role/delete",{slack:t}).then(a=>{if(a.data.status_code==200)toast.success(a.data.msg),m();else try{s.server_messages.type="error",s.server_messages.messages=JSON.parse(a.data.msg)}catch{s.server_messages.type="error",s.server_messages.messages=a.data.msg}}).catch(a=>{s.server_messages.type="error",s.server_messages.messages=a,console.log(a)})}const u=l({write:!1,delete:!1});function O(){u.value={write:C("A_WRITE_ROLE"),delete:C("A_DELETE_ROLE")}}return(t,o)=>{const a=E("Icon"),y=E("router-link"),V=re,j=ce,G=ne,J=le;return c(),H(J,null,{subheader:k(()=>[e("div",de,[e("div",_e,[e("div",ue,[e("div",me,[d(y,{class:"text-primary",to:"/settings"},{default:k(()=>[d(a,{icon:"fa6-solid:chevron-left"}),X(" "+n(t.$t("Settings")),1)]),_:1})])]),e("div",he,[e("h5",ge,n(t.$t("Roles")),1)])])])]),default:k(()=>[e("div",ve,[e("div",pe,[e("div",fe,[e("div",ye,[e("div",we,[e("div",ke,[Z(e("input",{type:"search",class:"form-control form-control-sm form-control-solid",placeholder:b(N),"onUpdate:modelValue":o[0]||(o[0]=i=>s.search_query=i)},null,8,be),[[ee,s.search_query]]),e("div",Ce,[d(a,{icon:"fa6-solid:magnifying-glass"})])])])]),u.value.write?(c(),r("div",Re,[e("a",{href:"#",class:"btn btn-sm btn-light-primary2","data-bs-toggle":"modal",onClick:o[1]||(o[1]=i=>$()),"data-bs-target":"#addRoleModal"},"+ "+n(t.$t("New Role")),1)])):g("",!0)]),e("div",$e,[e("div",Ae,[I.value?(c(),r("button",{key:0,class:"badge badge-danger btn-sm",onClick:o[2]||(o[2]=(...i)=>t.clearFilter&&t.clearFilter(...i))},n(t.$t("Clear Filters")),1)):g("",!0)])])]),s.is_listing?(c(),r("div",De,[d(V)])):(c(),r("div",Se,[e("table",Ee,[e("thead",Me,[e("tr",null,[e("th",Be,n(t.$t("Role")),1),e("th",Le,n(t.$t("Role Type")),1),e("th",Ne,n(t.$t("Active")),1),u.value.write&&u.value.delete?(c(),r("th",Fe,n(t.$t("Action")),1)):g("",!0)])]),e("tbody",null,[p.value!=""?(c(!0),r(te,{key:0},se(p.value,(i,z)=>(c(),r("tr",{key:z},[e("td",{role:"button","data-bs-toggle":"modal","data-bs-target":"#viewRoleModal",onClick:S=>D(i.slack)},[e("h6",null,n(i.name),1)],8,Te),e("td",{role:"button","data-bs-toggle":"modal","data-bs-target":"#viewRoleModal",onClick:S=>D(i.slack)},n(i.role_type_text),9,qe),e("td",null,[e("div",xe,[e("div",Ie,[e("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"Status_id",onChange:S=>T(i.slack),checked:i.status==1},null,40,Pe)])])]),u.value.write&&u.value.delete?(c(),r("td",Oe,[d(j,{permissions:u.value,onDelete:P,slack:i.slack,onEditModal:$,edit_modal_data:i,edit_modal_target:"#addRoleModal"},null,8,["permissions","slack","edit_modal_data"])])):g("",!0)]))),128)):(c(),r("tr",Ve,[e("td",je,n(t.$t("No Data Found")),1)]))])])])),e("div",Ge,[e("div",Je,[e("div",ze,[d(G,{onPaginate_limit_update:F,pagination:f.value},null,8,["pagination"])]),e("div",Ke,[d(b(ae),{data:f.value,limit:5,onPaginationChangePage:m},null,8,["data"])])])])]),d(b(M),{show_add_role_modal:v.value,onCloseAddRoleModal:B,edit_data:R.value},null,8,["show_add_role_modal","edit_data"])]),_:1})}}};export{st as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/AddRole.KNeMmqwN.js","assets/ServerMessage.EFQMOwoZ.js","assets/index.sP6fhsqN.js","assets/index.KTHCd6a8.css","assets/VSelect.twStq9pE.js","assets/vee-validate.esm.2kXgdFia.js","assets/VSelect.6khW9yoi.css","assets/index.esm.DHYHwGJ4.js","assets/VTextInput.EPCajChY.js","assets/VTooltip.kcvohVRA.js","assets/ClipLoader._89zL49D.js","assets/ClipLoader.7xz7y6gZ.css","assets/global.AEIEVpKW.js","assets/BeatLoader.5j6ku4bW.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
