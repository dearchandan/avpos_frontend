import{_ as M}from"./DefaultLayout.EMHfdzn0.js";import{z as j,g as o,h as n,G as q,b as G,u as P,a as R,r as d,e as Y,p as $,w,f as E,i as s,k as m,n as u,t,l as N,F as H,x as K}from"./index.ri7Y_V5F.js";import{_ as Q}from"./VMultiSelect.3zUL7lik.js";import W from"./ServerMessage.qNo4NwTp.js";import{B as U}from"./BeatLoader.8E6aB4W4.js";/* empty css                                                   */import"./jquery.OY7Knf1c.js";import"./ClipLoader.4-rIzqtH.js";import"./vee-validate.esm.0La7AMjT.js";/* empty css                                                   */const X={},Z={style:{}},ss=q('<div class="row g-3 mb-3"><div class="col-3"><div class="skl-w" style="height:38px;"></div></div></div><div class="row g-3"><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div><div class="col-md-3"><div class="skl-w" style="height:24px;"></div></div></div>',2),es=[ss];function as(D,B){return o(),n("ul",Z,es)}const ts=j(X,[["render",as]]),ls={class:"header-nav-wrap"},is={class:"row align-items-center"},os={class:"col-auto"},cs={class:"header-back-link"},ds={class:"col-auto"},ns={class:"fw-bold"},vs={class:"col align-self-end"},_s={class:"fw-bold text-end mb-3"},rs={class:"content"},us={class:"page-heading"},hs={key:0,class:"py-3"},ms={class:"row"},ps={class:"col-6 col-md-2 mx-auto"},gs={class:"card"},fs={key:0},ks={key:1,class:"text-center"},ys=["src"],bs={class:"col-md-10"},ws={class:"card"},xs={key:0},$s={key:1},Bs={class:"row"},As={class:"col-md-4"},Cs={class:"data-view-box mb-3"},Ss={class:"item"},Vs={class:"col-md-4"},Es={class:"data-view-box mb-3"},Ns={class:"item"},Us={class:"col-md-4"},Ds={class:"data-view-box mb-3"},Is={class:"item"},zs={key:0,class:"col-md-4"},Ls={class:"data-view-box mb-3"},Os={class:"item"},Ts={class:"col-md-4"},Fs={class:"data-view-box mb-3"},Js={class:"item"},Ms={class:"col-md-4"},js={class:"data-view-box mb-3"},qs={class:"item"},Gs={class:"col-md-4"},Ps={class:"data-view-box mb-3"},Rs={class:"item"},Ys={class:"row"},Hs={class:"col-md-12"},Ks={class:"card shadow-none"},Qs={class:"row align-items-center mb-2"},Ws={class:"col-auto"},Xs={class:"mb-3"},Zs={key:0,style:{}},se={class:"row g-3 mb-3"},ee={class:"col-3"},ae={class:"col-3"},te=["disabled"],le=["disabled"],ie={class:"row g-3"},oe={class:"label me-3"},ce=["onClick","disabled","checked"],de={class:"text-start"},ne=s("br",null,null,-1),ve={class:"text-muted"},$e={__name:"view_user",setup(D){const B=G(),{t:f}=P(),A=R().params.slack,C=d(!1),k=d(!1),l=d([]),p=d([]),g=d(!1),c=Y({...{server_messages:{type:"",messages:""},added_branch_slack:""}});S();async function S(){k.value=!0,await axios.get("/api/user",{params:{slack:A}}).then(e=>{l.value=e.data.data,e.data.data.branches!=null&&(p.value=[],_.forEach(e.data.data.branches,a=>{p.value.push(a.slack)})),k.value=!1}).catch(e=>{c.server_messages.type="error",c.server_messages.messages=e,k.value=!1,console.log(e)})}const v=d([]),y=d([]),V=d([]);I();async function I(){let e=await axios.get("api/v2/branches/dropdown");if(_.forEach(e.data.data,a=>{if(a.status==1){let i={key:a.slack,value:a.name,email:a.email};p.value.indexOf(a.slack)!==-1?y.value.push(i):v.value.push(i),C.value=!0}}),v.value.length>0){let a={key:"All",value:"All Branches",email:""};v.value.unshift(a)}}async function z(){var e=c.added_branch_slack;e!=""&&e!=null&&e!="All"&&(b(e),_.forEach(v.value,a=>{a!=null&&a.key==e&&(y.value.push(a),v.value.splice(v.value.findIndex(i=>i.key===e),1))})),e=="All"&&b(e)}async function L(){var e=!1;await Swal.fire({icon:"warning",title:f("Are sure do you want to unassign all branches?"),text:f("This action will unassign all branches except one branch."),showCancelButton:!0,confirmButtonText:f("Yes, Unassign All"),confirmButtonColor:"#d33",cancelButtonText:f("Cancel")}).then(a=>{a.isConfirmed&&(e=!0)}),e&&b("unassign_all")}async function b(e){if(e!=""&&e!=null){g.value=!0;var a=new FormData;a.append("user_slack",A),a.append("branch_slack",e),await axios.post("/api/user/update_branch",a).then(i=>{if(i.data.status_code==200)toast.success(i.data.msg),B.refresh(),S(),e=="All"&&(_.forEach(v.value,r=>{r!=null&&(r.key!="All"&&y.value.push(r),V.value.push(r.key))}),_.forEach(V.value,r=>{v.value.splice(v.value.findIndex(x=>x.key===r),1)}));else try{c.server_messages.type="error",c.server_messages.messages=JSON.parse(i.data.msg)}catch{c.server_messages.type="error",c.server_messages.messages=i.data.msg}g.value=!1}).catch(i=>{c.server_messages.type="error",c.server_messages.messages=i,console.log(i),g.value=!1})}}return d(!1),d(!1),d([]),(e,a)=>{const i=E("Icon"),r=E("router-link"),x=W,O=Q,T=ts,F=M;return o(),$(F,null,{subheader:w(()=>[s("div",ls,[s("div",is,[s("div",os,[s("div",cs,[m(r,{class:"text-primary",to:"/users"},{default:w(()=>[m(i,{icon:"fa6-solid:chevron-left"}),u(" "+t(e.$t("Users")),1)]),_:1})])]),s("div",ds,[s("h5",ns,t(l.value.name),1)]),s("div",vs,[s("p",_s,[m(r,{class:"text-primary",to:"/user/edit/"+l.value.slack},{default:w(()=>[u(t(e.$t("Edit")),1)]),_:1},8,["to"])])])])])]),default:w(()=>[s("div",rs,[s("div",us,[c.server_messages.messages!=""?(o(),n("div",hs,[m(x,{server_messages:c.server_messages},null,8,["server_messages"])])):N("",!0)]),s("div",ms,[s("div",ps,[s("div",gs,[l.value==""?(o(),n("div",fs,[m(U,{color:"gray",size:"15px",class:"pt-2 pe-2"})])):(o(),n("div",ks,[l.value.profile_pic!=""?(o(),n("img",{key:0,src:l.value.profile_pic,class:"",alt:""},null,8,ys)):(o(),$(i,{key:1,icon:"ic:baseline-person",style:{"font-size":"125px"}}))]))])]),s("div",bs,[s("div",ws,[l.value==""?(o(),n("div",xs,[m(U,{color:"gray",size:"15px",class:"pt-2 pe-2"})])):(o(),n("div",$s,[s("div",Bs,[s("div",As,[s("div",Cs,[s("div",Ss,[s("b",null,t(e.$t("User Name"))+":",1),u(" "+t(l.value.name),1)])])]),s("div",Vs,[s("div",Es,[s("div",Ns,[s("b",null,t(e.$t("Email")),1),u(" "+t(l.value.email),1)])])]),s("div",Us,[s("div",Ds,[s("div",Is,[s("b",null,t(e.$t("Phone")),1),u(" "+t(l.value.phone),1)])])]),l.value.login_code!=""?(o(),n("div",zs,[s("div",Ls,[s("div",Os,[s("b",null,t(e.$t("Login Code")),1),u(" "+t(l.value.login_code),1)])])])):N("",!0),s("div",Ts,[s("div",Fs,[s("div",Js,[s("b",null,t(e.$t("Date of Birth")),1),u(" "+t(l.value.date_of_birth),1)])])]),s("div",Ms,[s("div",js,[s("div",qs,[s("b",null,t(e.$t("Date of Anniversary")),1),u(" "+t(l.value.date_of_anniversary),1)])])]),s("div",Gs,[s("div",Ps,[s("div",Rs,[s("b",null,t(e.$t("Date of Joining")),1),u(" "+t(l.value.joining_date),1)])])])])]))])])]),s("div",Ys,[s("div",Hs,[s("div",Ks,[s("div",Qs,[s("div",Ws,[s("h2",Xs,t(e.$t("Branch Access")),1)])]),s("div",null,[C.value?(o(),n("ul",Zs,[s("div",se,[s("div",ee,[m(O,{name:"account_type",placeholder:"Select branch to assign",text:"value",value:"key",options:v.value,mode:"single",required:"",modelValue:c.added_branch_slack,"onUpdate:modelValue":a[0]||(a[0]=h=>c.added_branch_slack=h)},null,8,["options","modelValue"])]),s("div",ae,[s("button",{type:"button",class:"ms-4 btn btn-success",onClick:z,disabled:g.value},t(e.$t("Assign")),9,te),s("button",{type:"button",class:"ms-4 btn btn-danger",onClick:L,disabled:g.value},t(e.$t("Unassign All")),9,le)])]),s("div",ie,[(o(!0),n(H,null,K(y.value,(h,J)=>(o(),n("div",{class:"col-md-3",key:J},[s("li",null,[s("label",oe,[s("input",{class:"form-check-input me-1",type:"checkbox",onClick:ue=>b(h.key),disabled:p.value.length==1&&p.value.indexOf(h.key)!==-1||g.value==!0&&k.value==!0,checked:p.value.indexOf(h.key)!==-1},null,8,ce),s("span",de,[s("b",null,[u(t(h.value)+" ",1),ne,s("small",ve,t(h.email),1)])])])])]))),128))])])):(o(),$(T,{key:1}))])])])])])]),_:1})}}};export{$e as default};
