import{_ as G}from"./ListingSkeleton.PW5leU6x.js";import{u as j,b as Y,r as u,e as I,o as J,v as K,g as i,p as U,w as P,I as z,f as A,i as t,t as s,h as l,k as f,n as Q,l as r,K as g,N as X,j as E,y as Z,L as y,F as x,x as tt,O as et}from"./index.ri7Y_V5F.js";import{_ as st}from"./DefaultLayout.EMHfdzn0.js";import{_ as ot}from"./PaginateLimit.Qyl6CO-f.js";import{j as at}from"./vue-datepicker.gRWbN_6J.js";import"./ClipLoader.4-rIzqtH.js";/* empty css                                                   */const it={class:"header-nav-wrap"},nt={class:"row align-items-center"},lt={class:"col-auto"},ct={class:"fw-bold"},rt={class:"content"},dt={class:"page-heading"},_t={class:"row align-items-center justify-content-between"},ut={class:"col-auto"},ht={class:"row align-items-center"},mt={key:0,class:"col-auto"},pt={class:"col-auto"},vt={class:"row align-items-center"},ft={class:"col-auto"},gt={class:"form-field page-heading-search-field mb-0"},yt={class:"field-icon"},bt=["placeholder"],wt={class:"icon"},$t={class:"col-auto"},Ct={class:"dropdown filter-dropdown"},Tt={class:"row gx-3"},kt={class:"col-12"},St={class:"form-field"},It={class:"form-label"},Pt={class:"row gx-3"},Et={class:"col-6"},Ot={class:"form-field"},Nt={class:"form-label"},Ut={value:""},At={value:"LOW"},Lt={value:"MEDIUM"},Mt={value:"HIGH"},Dt={class:"col-6"},Vt={class:"form-field"},Bt={class:"form-label"},Ht={value:""},Rt={value:"WEB"},Ft={value:"'WOSUL_EASY"},Wt={value:"IPAD"},qt={class:"col-6"},Gt={class:"form-field"},jt={class:"form-label"},Yt={value:""},Jt={value:"INQUIRY"},Kt={value:"SUGGESTION"},zt={value:"COMPLAINT"},Qt={value:"TECHNICAL_PROBLEM"},Xt={value:"TECHNICAL_SUPPORT"},Zt={class:"col-6"},xt={class:"form-field"},te={class:"form-label"},ee={value:""},se={value:"0"},oe={value:"1"},ae={value:"2"},ie={class:"row py-3"},ne={class:"col-12 text-end"},le={key:1,class:"table-responsive"},ce={class:"table table-list-data table-hover"},re={class:"bg-light"},de={scope:"col",width:"40%"},_e={scope:"col",width:"18%"},ue={scope:"col",width:"12%"},he={scope:"col",width:"10%"},me={scope:"col",width:"10%"},pe={key:0,scope:"col",class:"text-center",width:"10%"},ve=["onClick"],fe=["onClick"],ge=["onClick"],ye={key:0,class:"badge badge-info"},be={key:1,class:"badge badge-primary"},we={key:2,class:"badge badge-warning"},$e={key:3,class:"badge badge-danger"},Ce={key:4,class:"badge badge-danger"},Te={key:0,class:"text-dark"},ke={key:1,class:"text-primary"},Se={key:2,class:"text-danger"},Ie=["onClick"],Pe={key:0,class:"text-end"},Ee=["onUpdate:modelValue","onChange"],Oe=["disabled"],Ne=["disabled"],Ue={value:"2"},Ae={key:1},Le={class:"text-center py-3",colspan:"11"},Me={class:"data-footer"},De={class:"row align-items-center justify-content-between"},Ve={class:"col-auto"},Be={class:"col-auto"},Je={__name:"support_tickets",setup(He){const{t:L}=j(),{isAuthorized:O}=z();Y();const M={server_messages:{type:"",messages:""},is_listing:!1,search_query:u("")},D=L("Search by name, arabic name, price.."),n=I({...M});J(()=>{W(),h()}),K(()=>n.search_query,_.debounce(()=>{h()},500));const C=u([]),T=u([]);async function h(e=1){n.is_listing=!0,await axios.get("/api/support_tickets",{params:{page:e,paginate_limit:N.value,search_query:n.search_query,filter:c}}).then(a=>{C.value=a.data.data,T.value=a.data.pagination,n.is_listing=!1}).catch(a=>{n.server_messages.type="error",n.server_messages.messages=a,n.is_listing=!1,console.log(a)})}const N=u();async function V(e){N.value=e,await h()}function b(e){router.push("/support_ticket/"+e)}async function B(e,a){var $=!1;if(await Swal.fire({title:"Warning!",text:"Are you sure want to update Ticket Status?",icon:"warning",confirmButtonText:"Proceed",cancelButtonText:"Cancel",showCancelButton:!0}).then(d=>{d.isConfirmed&&($=!0)}),$){var p=new FormData;p.append("ticket_id",e),p.append("status",a),await axios.post("/api/support_ticket/update_status",p).then(d=>{if(d.data.status_code==200)toast.success(d.data.msg);else try{n.server_messages.type="error",n.server_messages.messages=JSON.parse(d.data.msg)}catch{n.server_messages.type="error",n.server_messages.messages=d.data.msg}}).catch(d=>{n.server_messages.type="error",n.server_messages.messages=d,console.log(d)})}}const w=u(!1),k=I({reporting_platform:"",ticket_type:"",priority:"",status:""}),c=I({...k}),S=u(!1);async function H(){JSON.stringify(c)!=JSON.stringify(k)&&(S.value=!0),w.value=!1,await h()}async function R(){w.value=!w.value}function F(){Object.assign(c,k),S.value=!1,h()}const m=u({write:!1,delete:!1});function W(){m.value={write:O("A_WRITE_SUPPORT_TICKET"),delete:O("A_DELETE_SUPPORT_TICKET")}}return(e,a)=>{const $=A("router-link"),p=A("Icon"),d=G;return i(),U(st,null,{subheader:P(()=>[t("div",it,[t("div",nt,[t("div",lt,[t("h5",ct,s(e.$t("Support Tickets")),1)])])])]),default:P(()=>[t("div",rt,[t("div",dt,[t("div",_t,[t("div",ut,[t("div",ht,[m.value.write?(i(),l("div",mt,[f($,{class:"btn btn-sm btn-light-primary",to:"/support_ticket/add"},{default:P(()=>[Q("+ "+s(e.$t("New Support Ticket")),1)]),_:1})])):r("",!0)])]),t("div",pt,[t("div",vt,[t("div",ft,[t("div",gt,[t("div",yt,[g(t("input",{type:"search",class:"form-control form-control-sm form-control-shadow",placeholder:E(D),"onUpdate:modelValue":a[0]||(a[0]=o=>n.search_query=o)},null,8,bt),[[X,n.search_query]]),t("div",wt,[f(p,{icon:"fa6-solid:magnifying-glass"})])])])]),t("div",$t,[t("div",Ct,[t("button",{type:"button",class:"btn btn-sm btn-icon btn-light-primary","data-bs-auto-close":"outside",onClick:R},[f(p,{icon:"fa6-solid:filter"})]),t("div",{class:Z([w.value?"show":"","dropdown-menu p-3 w-365"]),id:"filter_box",style:{position:"absolute",inset:"0px auto auto 0px",margin:"0px",transform:"translate3d(-310px, 36px, 0px)"}},[t("form",null,[t("div",Tt,[t("div",kt,[t("div",St,[t("label",It,s(e.$t("Created Date")),1),f(E(at),{range:"",modelValue:c.created_date,"onUpdate:modelValue":a[1]||(a[1]=o=>c.created_date=o),format:"dd-MM-yyyy","enable-time-picker":!1},null,8,["modelValue"])])])]),t("div",Pt,[t("div",Et,[t("div",Ot,[t("label",Nt,s(e.$t("Priority")),1),g(t("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":a[2]||(a[2]=o=>c.priority=o)},[t("option",Ut,s(e.$t("All")),1),t("option",At,s(e.$t("LOW")),1),t("option",Lt,s(e.$t("MEDIUM")),1),t("option",Mt,s(e.$t("HIGH")),1)],512),[[y,c.priority]])])]),t("div",Dt,[t("div",Vt,[t("label",Bt,s(e.$t("Device Type")),1),g(t("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":a[3]||(a[3]=o=>c.reporting_platform=o)},[t("option",Ht,s(e.$t("All")),1),t("option",Rt,s(e.$t("WEB")),1),t("option",Ft,s(e.$t("WOSUL EASY")),1),t("option",Wt,s(e.$t("IPAD")),1)],512),[[y,c.reporting_platform]])])]),t("div",qt,[t("div",Gt,[t("label",jt,s(e.$t("Ticket Type")),1),g(t("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":a[4]||(a[4]=o=>c.ticket_type=o)},[t("option",Yt,s(e.$t("All")),1),t("option",Jt,s(e.$t("Inquiry")),1),t("option",Kt,s(e.$t("Suggestion")),1),t("option",zt,s(e.$t("Complaint")),1),t("option",Qt,s(e.$t("Technical Problem")),1),t("option",Xt,s(e.$t("Technical Support")),1)],512),[[y,c.ticket_type]])])]),t("div",Zt,[t("div",xt,[t("label",te,s(e.$t("Status")),1),g(t("select",{class:"form-control form-control-sm form-control-solid","onUpdate:modelValue":a[5]||(a[5]=o=>c.status=o)},[t("option",ee,s(e.$t("All")),1),t("option",se,s(e.$t("Open")),1),t("option",oe,s(e.$t("Processing")),1),t("option",ae,s(e.$t("Closed")),1)],512),[[y,c.status]])])])]),t("button",{type:"button",onClick:H,class:"btn btn-sm btn-primary w-100"},s(e.$t("Filter")),1)])],2)])])])])]),t("div",ie,[t("div",ne,[S.value?(i(),l("button",{key:0,class:"badge badge-danger btn-sm",onClick:F},s(e.$t("Clear Filters")),1)):r("",!0)])])]),n.is_listing?(i(),U(d,{key:0})):(i(),l("div",le,[t("table",ce,[t("thead",re,[t("tr",null,[t("th",de,s(e.$t("Title")),1),t("th",_e,s(e.$t("Merchant Name")),1),t("th",ue,s(e.$t("Ticket Type")),1),t("th",he,s(e.$t("Priority")),1),t("th",me,s(e.$t("Reporting Date")),1),m.value.write&&m.value.delete?(i(),l("th",pe,s(e.$t("Status")),1)):r("",!0)])]),t("tbody",null,[C.value!=""?(i(!0),l(x,{key:0},tt(C.value,(o,q)=>(i(),l("tr",{key:q},[t("td",{onClick:v=>b(o.id),role:"button"},s(o.title),9,ve),t("td",{onClick:v=>b(o.id),role:"button"},s(o.merchant_name),9,fe),t("td",{onClick:v=>b(o.id),role:"button"},[o.ticket_type=="INQUIRY"?(i(),l("span",ye,s(e.$t("Inquiry")),1)):r("",!0),o.ticket_type=="SUGGESTION"?(i(),l("span",be,s(e.$t("Suggestion")),1)):r("",!0),o.ticket_type=="COMPLAINT"?(i(),l("span",we,s(e.$t("Complaint")),1)):r("",!0),o.ticket_type=="TECHNICAL_PROBLEM"?(i(),l("span",$e,s(e.$t("Technical Problem")),1)):r("",!0),o.ticket_type=="TECHNICAL_SUPPORT"?(i(),l("span",Ce,s(e.$t("Technical Support")),1)):r("",!0)],8,ge),t("td",null,[o.priority=="LOW"?(i(),l("span",Te,s(o.priority),1)):r("",!0),o.priority=="MEDIUM"?(i(),l("span",ke,s(o.priority),1)):r("",!0),o.priority=="HIGH"?(i(),l("span",Se,[t("strong",null,s(o.priority),1)])):r("",!0)]),t("td",{onClick:v=>b(o.id),role:"button"},s(o.reporting_date),9,Ie),m.value.write&&m.value.delete?(i(),l("td",Pe,[g(t("select",{class:"form-select form-select-solid","onUpdate:modelValue":v=>o.status=v,onChange:v=>B(o.id,o.status)},[t("option",{value:"0",disabled:o.status==1||o.status==2},s(e.$t("Open")),9,Oe),t("option",{value:"1",disabled:o.status==2},s(e.$t("Processing")),9,Ne),t("option",Ue,s(e.$t("Closed")),1)],40,Ee),[[y,o.status]])])):r("",!0)]))),128)):(i(),l("tr",Ae,[t("td",Le,s(e.$t("No Data Found")),1)]))])])])),t("div",Me,[t("div",De,[t("div",Ve,[f(ot,{onPaginate_limit_update:V,pagination:T.value},null,8,["pagination"])]),t("div",Be,[f(E(et),{data:T.value,onPaginationChangePage:h},null,8,["data"])])])])])]),_:1})}}};export{Je as default};
