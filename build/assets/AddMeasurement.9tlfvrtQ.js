import A from"./ServerMessage.qNo4NwTp.js";import{u as O,r as U,e as B,b as E,P as F,v as I,f as D,g as i,h as l,i as a,t as m,k as d,w as j,Q as q,K as _,F as J,N as y,l as b,x as K,p as L,j as k}from"./index.ri7Y_V5F.js";import{F as z}from"./vee-validate.esm.0La7AMjT.js";import{c as P,a as Q,e as R}from"./index.esm.wERziE-M.js";import{_ as T}from"./VTextInput.o2P1IcEE.js";import{C as G}from"./ClipLoader.4-rIzqtH.js";import"./VTooltip.a7qKl6DY.js";/* empty css                                                   */const H={class:"modal modal-lg hide",id:"addMeasurementModal",tabindex:"-1","aria-labelledby":"Add Measurement","aria-modal":"true",role:"dialog","data-bs-backdrop":"static","data-bs-keyboard":"false"},W={class:"modal-dialog modal-dialog-centered"},X={class:"modal-content"},Y={class:"modal-header"},Z={key:0,class:"modal-title"},ee={key:1,class:"modal-title"},se={class:"modal-body"},ae={class:"row"},te={class:"col-6"},ne={class:"col-md-6 pt-4"},oe={class:"form-field"},ie={class:"form-check form-switch"},re={class:"form-check-label",for:"status"},le={class:"row pt-3"},me={class:"table table-bordered"},de={width:"25%"},ce={width:""},ue=a("th",null,null,-1),_e=a("th",null,null,-1),be=["onUpdate:modelValue"],pe=["onUpdate:modelValue"],ve=["onClick","disabled"],he={key:0,class:"py-3"},fe={class:"mt-2 text-end"},ge=["disabled"],ye={key:1,class:"pt-0"},ke={key:2,class:"pt-0"},Ae={__name:"AddMeasurement",props:{show_add_measurement_modal:Boolean,edit_data:{type:[Array,Object]}},emits:["closeAddMeasurementModal"],setup(M,{emit:w}){const{t:c}=O(),p={server_messages:{type:"",messages:""},is_saving:!1,is_listing:!1,slack:"",measurement_name:"",measurement_name_ar:"",status:!0},o=U([{id:"",unit_name:"",unit_name_ar:"",abbreviation:"",abbreviation_ar:""}]),e=B({...p});E();const $=P({measurement_name:Q().required(c("name is required",{name:c("Measurement Name")})).min(3,c("name must be at least n characters",{name:c("Measurement Name"),number:3})),status:R().label("status")}),x=w,v=M;F(v,"edit_data");function h(){document.getElementById("frmMeasurement").reset(),V(),document.getElementById("close_btn").click(),x("closeAddMeasurementModal")}I(()=>v.edit_data,s=>{if(s&&(e.slack=s.slack,e.measurement_name=s.name,e.measurement_name_ar=s.name_ar,e.status=s.status==1,s.units)){o.value=[];for(var t=0;t<s.units.length;t++){let n={id:s.units[t].id,unit_name:s.units[t].unit_name,unit_name_ar:s.units[t].unit_name_ar,abbreviation:s.units[t].abbreviation,abbreviation_ar:s.units[t].abbreviation_ar};o.value.push(n)}}});async function C(){e.is_saving=!0;var s=new FormData;s.append("measurement_name",e.measurement_name),s.append("measurement_name_ar",JSON.stringify(e.measurement_name_ar)),s.append("status",e.status),s.append("measurement_units",JSON.stringify(o.value)),s.append("slack",e.slack);var t=e.slack!=""&&e.slack!=null?"/api/measurement/update":"/api/measurement/save";await axios.post(t,s).then(n=>{if(n.data.status_code==200)toast.success(n.data.msg),e.server_messages.type="",e.server_messages.messages="",e.is_saving=!1,h();else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(n.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=n.data.msg}e.is_saving=!1}}).catch(n=>{e.server_messages.type="error",e.server_messages.messages=n,e.is_saving=!1,console.log(n)})}function V(){Object.assign(e,p),o.value=[{id:"",unit_name:"",unit_name_ar:"",abbreviation:"",abbreviation_ar:""}]}function N(){let s={id:"",unit_name:"",unit_name_ar:"",abbreviation:"",abbreviation_ar:""};o.value.push(s)}function S(s){o.value.splice(o.value.indexOf(s),1)}return(s,t)=>{const n=D("Icon"),f=A;return i(),l("div",H,[a("div",W,[a("div",X,[a("div",Y,[e.slack==""||e.slack==null?(i(),l("h5",Z,m(s.$t("Add Measurement")),1)):(i(),l("h5",ee,m(s.$t("Update Measurement")),1)),a("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:h,id:"close_btn"})]),a("div",se,[d(k(z),{"validation-schema":k($),onSubmit:C,enctype:"multipart/form-data","initial-values":e,id:"frmMeasurement"},{default:j(()=>[a("div",ae,[a("div",te,[d(T,{type:"text",name:"measurement_name",modelValue:e.measurement_name,"onUpdate:modelValue":t[0]||(t[0]=r=>e.measurement_name=r),label:"Measurement Name",required:!0},null,8,["modelValue"])]),a("div",ne,[a("div",oe,[a("div",ie,[_(a("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"status",checked:"","onUpdate:modelValue":t[1]||(t[1]=r=>e.status=r)},null,512),[[q,e.status]]),a("label",re,m(s.$t("Active")),1)])])])]),a("div",le,[a("table",me,[a("thead",null,[a("tr",null,[a("th",de,m(s.$t("Measurement Unit")),1),a("th",ce,m(s.$t("Abbreviation")),1),ue,_e])]),a("tbody",null,[(i(!0),l(J,null,K(o.value,(r,g)=>(i(),l("tr",{key:g},[a("td",null,[_(a("input",{type:"text",name:"unit_name","onUpdate:modelValue":u=>r.unit_name=u,placeholder:"Ex. Kilogram",class:"form-control form-control-solid"},null,8,be),[[y,r.unit_name]])]),a("td",null,[_(a("input",{type:"text",name:"abbreviation","onUpdate:modelValue":u=>r.abbreviation=u,placeholder:"Ex. kg",class:"form-control form-control-solid"},null,8,pe),[[y,r.abbreviation]])]),a("td",null,[a("button",{class:"btn btn-icon btn-light btn-sm",onClick:u=>S(r),disabled:!(o.value.length>1)},[d(n,{icon:"material-symbols:cancel-outline-rounded",class:"text-danger"})],8,ve)]),a("td",null,[g==o.value.length-1?(i(),l("a",{key:0,href:"#",class:"btn btn-icon btn-light btn-sm",onClick:N},[d(n,{icon:"fa6-solid:plus",class:"text-primary"})])):b("",!0)])]))),128))])])]),e.server_messages.messages!=""?(i(),l("div",he,[d(f,{server_messages:e.server_messages},null,8,["server_messages"])])):b("",!0),a("div",fe,[a("button",{type:"submit",class:"btn btn-primary",disabled:e.is_saving},[e.is_saving?(i(),L(G,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):b("",!0),e.is_saving?(i(),l("span",ye,m(s.$t("Saving...")),1)):(i(),l("span",ke,m(s.$t("Save")),1))],8,ge)])]),_:1},8,["validation-schema","initial-values"])])])])])}}};export{Ae as default};
