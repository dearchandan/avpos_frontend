import{u as me,b as ue,d as O,e as E,r as u,v as pe,o as he,g as d,p as N,w as V,f as I,i as e,l as h,k as P,t as o,j as t,m as c,A as x,B as M,h as r,F as ge,x as ye,O as be,I as fe,bW as y,q as ve,_ as ke}from"./index.li3fCRRM.js";import{D as De}from"./DefaultLayout.saUWsTkY.js";import{_ as $e}from"./PaginateLimit.SmYeFgfo.js";import{_ as Ye}from"./ListingSkeleton.6NzqF9S5.js";import{_ as we}from"./VMultiSelect.2M-H_LD-.js";import{u as Ve}from"./global.NAtoPKoY.js";import{s as R,a as xe,e as Me,j as K}from"./vue-datepicker.a6BsTEHj.js";import{s as L,e as U}from"./index.dFkrF4C6.js";import"./ClipLoader.gDBpDd3b.js";/* empty css                                                   */import"./vee-validate.esm.reM-LHjC.js";const Se={class:"header-nav-wrap"},Te={class:"row align-items-center"},Ae={class:"col-auto"},Ce={class:"header-back-link"},Oe={class:"col-auto"},Ne={class:"fw-bold"},Pe={class:"content"},He={class:"card"},Fe={class:"row field-m-0 align-items-end g-3"},Be={class:"col-md-4 col-lg-3"},Ee={class:"form-field"},Ie={for:"",class:"form-label"},Re=e("span",{class:"text-danger"},"*",-1),Ke=["onClick","onKeyup"],Le={class:"col-md-4 col-lg-3"},Ue={class:"form-field"},je={for:"",class:"form-label"},Je=e("span",{class:"text-danger"},"*",-1),Ge=["onClick","onKeyup"],qe={class:"col-md-4 col-lg-3"},ze={key:0,class:"col-md-4 col-lg-3"},We={class:"col-md-3 col-lg-3"},Qe={class:"col-md-3 col-lg-3"},Xe={class:"col-md-3 col-lg-3"},Ze={class:"row mt-4"},et={class:"col-12 text-end"},tt=["disabled"],st=["disabled"],at={class:"card"},ot={class:""},lt={key:0},nt={key:1,class:"table-responsive"},dt={class:"table table-list-data table-hover"},rt={class:"bg-light"},ct={scope:"col"},it={scope:"col"},_t={scope:"col"},mt={scope:"col"},ut={scope:"col"},pt={scope:"col"},ht={scope:"col"},gt={scope:"col"},yt={scope:"col"},bt={scope:"col"},ft={scope:"col",class:"text-end"},vt={scope:"col",class:"text-end"},kt={scope:"col",class:"text-end"},Dt={key:0},$t={class:"text-end"},Yt={class:"text-end"},wt={class:"text-end"},Vt={class:"text-end"},xt={class:"text-end"},Mt={class:"text-end"},St={key:0},Tt={key:1},At={key:0,class:"badge badge-primary"},Ct={key:1,class:"badge badge-success"},Ot={key:2,class:"badge badge-warning"},Nt={key:3,class:"badge badge-danger"},Pt={key:4,class:"badge badge-danger"},Ht={key:5,class:"badge badge-info"},Ft={key:6,class:"badge badge-secondary"},Bt={class:"text-end"},Et={class:"text-end"},It={class:"text-end"},Rt={key:1},Kt={class:"text-center py-3",colspan:"13"},Lt={key:0},Ut=e("th",{colspan:"10"},null,-1),jt={class:"text-end"},Jt={class:"text-end"},Gt={class:"text-end"},qt={class:"data-footer"},zt={class:"row align-items-center justify-content-between"},Wt={class:"col-auto"},Qt={class:"col-auto"},_s={__name:"sales_report",setup(Xt){const{t:p}=me(),{isAuthorized:Zt,getRoundedValue:D}=fe(),{order_types:j,sale_types:J}=Ve(),H=ue(),$=O(()=>H.user.currency.symbol),i=E({server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,dates:u([new Date,new Date]),created_dates:u([new Date,new Date]),selected_branch:u(),selected_terminals:u([]),payment_method:u(),selected_order_type:u(),selected_sale_type:u(),is_exporting:!1}),s=E({...i}),G=p("Select Branch"),q=p("All Branches");p("All Products");const z=p("All Terminals"),W=p("Select Terminals"),Q=p("Select Order Type"),X=p("All Order Type"),Z=p("Select Sale Type"),ee=p("All Sale Type"),te=p("Select Payment Type"),se=p("All Payment Type"),F=u([{label:"Today",value:[new Date,new Date]},{label:"This month",value:[L(new Date),U(new Date)]},{label:"Last month",value:[L(R(new Date,1)),U(R(new Date,1))]},{label:"This year",value:[xe(new Date),Me(new Date)]}]);pe(()=>s.selected_branch,a=>{a>0?oe(a):s.selected_terminals=[]}),he(()=>{le()});const ae=O(()=>H.user.branches),S=u([]);async function oe(a){a!=null&&a!=""&&await axios.post("/api/branch/terminals",{id:a}).then(l=>{if(l.data.status_code==200){S.value=[];let m=l.data.data;_.forEach(m,f=>{let v={id:f.id,name:f.code+" - "+f.terminal_name};S.value.push(v)})}else try{i.server_messages.type="error",i.server_messages.messages=JSON.parse(l.data.msg)}catch{i.server_messages.type="error",i.server_messages.messages=l.data.msg}}).catch(l=>{i.server_messages.type="error",i.server_messages.messages=l,console.log(l)})}const T=u([]);async function le(){await axios.get("/api/payment_methods/all").then(a=>{if(a.data.status_code==200){T.value=[];let l=a.data.data;_.forEach(l,m=>{let f={id:m.id,name:m.name};T.value.push(f)})}else try{i.server_messages.type="error",i.server_messages.messages=JSON.parse(a.data.msg)}catch{i.server_messages.type="error",i.server_messages.messages=a.data.msg}}).catch(a=>{i.server_messages.type="error",i.server_messages.messages=a,console.log(a)})}const B=u();async function ne(a){B.value=a,await C()}const b=u([]),A=u([]);async function C(a=1){s.is_listing=!0,s.dates!=null&&(s.dates[0]=y(s.dates[0]).format("YYYY-MM-DD"),s.dates[1]=y(s.dates[1]).format("YYYY-MM-DD")),s.created_dates!=null&&(s.created_dates[0]=y(s.created_dates[0]).format("YYYY-MM-DD HH:mm"),s.created_dates[1]=y(s.created_dates[1]).format("YYYY-MM-DD HH:mm")),await axios.get("/api/sales_report",{params:{page:a,paginate_limit:B.value,filter:s}}).then(l=>{b.value=l.data.data.data,A.value=l.data.pagination,s.is_listing=!1}).catch(l=>{s.server_messages.type="error",s.server_messages.messages=l,s.is_listing=!1,console.log(l)})}const Y=O(()=>b.value.length?{order_discount:b.value.reduce(function(l,m){return l+parseFloat(m.order_discount)},0).toFixed(2),grand_product_tax:b.value.reduce(function(l,m){return l+parseFloat(m.tax)},0).toFixed(2),grand_product_amount:b.value.reduce(function(l,m){return l+parseFloat(m.total)},0).toFixed(2)}:null);async function de(){s.is_exporting=!0,s.dates!=null&&(s.dates[0]=y(s.dates[0]).format("YYYY-MM-DD"),s.dates[1]=y(s.dates[1]).format("YYYY-MM-DD")),s.created_dates!=null&&(s.created_dates[0]=y(s.created_dates[0]).format("YYYY-MM-DD HH:mm"),s.created_dates[1]=y(s.created_dates[1]).format("YYYY-MM-DD HH:mm")),await axios.get("/api/sales_report/export_excel",{params:{filter:s}}).then(a=>{if(a.data.status_code==200){s.is_exporting=!1;const l=document.createElement("a");l.target="_blank",l.href=a.data.data.file,document.body.appendChild(l),l.click()}else{try{s.server_messages.type="error",s.server_messages.messages=JSON.parse(a.data.msg)}catch{s.server_messages.type="error",s.server_messages.messages=a.data.msg}s.is_exporting=!1}}).catch(a=>{s.server_messages.type="error",s.server_messages.messages=a,s.is_exporting=!1,console.log(a)})}const re=ve(()=>ke(()=>import("./ServerMessage.Re9KOdbP.js"),__vite__mapDeps([0,1,2])));return(a,l)=>{const m=I("Icon"),f=I("router-link"),v=we,ce=Ye,ie=$e,_e=De;return d(),N(_e,null,{subheader:V(()=>[e("div",Se,[e("div",Te,[e("div",Ae,[e("div",Ce,[h(f,{class:"text-primary",to:"/reports"},{default:V(()=>[h(m,{icon:"fa6-solid:chevron-left"}),P(" "+o(a.$t("Reports")),1)]),_:1})])]),e("div",Oe,[e("h5",Ne,o(a.$t("Sales Report")),1)])])])]),default:V(()=>[e("div",Pe,[t(s).server_messages.messages!=""?(d(),N(t(re),{key:0,class:"py-3",server_messages:t(s).server_messages},null,8,["server_messages"])):c("",!0),e("div",He,[e("div",Fe,[e("div",Be,[e("div",Ee,[e("label",Ie,[P(o(a.$t("Business Dates"))+" ",1),Re]),h(t(K),{range:"","preset-dates":t(F),modelValue:t(s).dates,"onUpdate:modelValue":l[0]||(l[0]=n=>t(s).dates=n),format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":V(({label:n,value:g,presetDate:k})=>[e("span",{role:"button",tabindex:0,onClick:w=>k(g),onKeyup:[x(M(w=>k(g),["prevent"]),["enter"]),x(M(w=>k(g),["prevent"]),["space"])]},o(n),41,Ke)]),_:1},8,["preset-dates","modelValue"])])]),e("div",Le,[e("div",Ue,[e("label",je,[P(o(a.$t("Created At Dates"))+" ",1),Je]),h(t(K),{range:"","preset-dates":t(F),modelValue:t(s).created_dates,"onUpdate:modelValue":l[1]||(l[1]=n=>t(s).created_dates=n),format:"dd-MM-yyyy HH:mm","enable-time-picker":!0,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":V(({label:n,value:g,presetDate:k})=>[e("span",{role:"button",tabindex:0,onClick:w=>k(g),onKeyup:[x(M(w=>k(g),["prevent"]),["enter"]),x(M(w=>k(g),["prevent"]),["space"])]},o(n),41,Ge)]),_:1},8,["preset-dates","modelValue"])])]),e("div",qe,[h(v,{name:"branches",label:t(G),placeholder:t(q),text:"name",value:"id",options:t(ae),modelValue:t(s).selected_branch,"onUpdate:modelValue":l[2]||(l[2]=n=>t(s).selected_branch=n),mode:"single"},null,8,["label","placeholder","options","modelValue"])]),t(s).selected_branch!=null&&t(s).selected_branch>0?(d(),r("div",ze,[t(s).selected_branch!=null&&t(s).selected_branch>0?(d(),N(v,{key:0,name:"terminals",label:t(z),placeholder:t(W),text:"name",value:"id",options:t(S),modelValue:t(s).selected_terminals,"onUpdate:modelValue":l[3]||(l[3]=n=>t(s).selected_terminals=n)},null,8,["label","placeholder","options","modelValue"])):c("",!0)])):c("",!0),e("div",We,[h(v,{name:"payment_methods",label:t(te),placeholder:t(se),text:"name",value:"id",options:t(T),modelValue:t(s).payment_method,"onUpdate:modelValue":l[4]||(l[4]=n=>t(s).payment_method=n),mode:"single"},null,8,["label","placeholder","options","modelValue"])]),e("div",Qe,[h(v,{name:"order_types",label:t(Q),placeholder:t(X),text:"value",value:"key",options:t(j),modelValue:t(s).selected_order_type,"onUpdate:modelValue":l[5]||(l[5]=n=>t(s).selected_order_type=n),mode:"single"},null,8,["label","placeholder","options","modelValue"])]),e("div",Xe,[h(v,{name:"sale_types",label:t(Z),placeholder:t(ee),text:"value",value:"key",options:t(J),modelValue:t(s).selected_sale_type,"onUpdate:modelValue":l[6]||(l[6]=n=>t(s).selected_sale_type=n),mode:"single"},null,8,["label","placeholder","options","modelValue"])])]),e("div",Ze,[e("div",et,[e("button",{class:"btn btn-primary",onClick:C,disabled:t(s).dates==null&&t(s).created_dates==null},o(a.$t("View")),9,tt),e("button",{class:"btn btn-success ms-3",onClick:l[7]||(l[7]=n=>de()),disabled:t(s).dates==null&&t(s).created_dates==null},o(a.$t("Export Excel")),9,st)])])]),e("div",at,[e("div",ot,[t(s).is_listing?(d(),r("div",lt,[h(ce)])):(d(),r("div",nt,[e("table",dt,[e("thead",rt,[e("tr",null,[e("th",ct,o(a.$t("Branch Name")),1),e("th",it,o(a.$t("Terminal")),1),e("th",_t,o(a.$t("Order No.")),1),e("th",mt,o(a.$t("Reference No.")),1),e("th",ut,o(a.$t("Sale Date")),1),e("th",pt,o(a.$t("Customer Name")),1),e("th",ht,o(a.$t("Customer Phone")),1),e("th",gt,o(a.$t("Payment Type")),1),e("th",yt,o(a.$t("Order Type")),1),e("th",bt,o(a.$t("Sale Type")),1),e("th",ft,o(a.$t("Discount Amount")),1),e("th",vt,o(a.$t("Tax Amount")),1),e("th",kt,o(a.$t("Net Sales Amount")),1)])]),e("tbody",null,[t(b)!=""?(d(!0),r(ge,{key:0},ye(t(b),(n,g)=>(d(),r("tr",{key:g},[e("td",null,o(n.branch.name),1),e("td",null,[n.terminal?(d(),r("span",Dt,o(n.terminal.terminal_name),1)):c("",!0)]),e("td",$t,o(n.order_number),1),e("td",Yt,o(n.reference_number),1),e("td",wt,o(n.business_date),1),e("td",Vt,o(n.customer_name),1),e("td",xt,o(n.customer_phone),1),e("td",Mt,o(n.payment_method_name),1),e("td",null,[n.order_type==1?(d(),r("span",St,o(a.$t("Take Away")),1)):c("",!0),n.order_type==2?(d(),r("span",Tt,o(a.$t("Dine In")),1)):c("",!0)]),e("td",null,[n.order_status==0?(d(),r("span",At,o(a.$t("Open")),1)):c("",!0),n.order_status==1?(d(),r("span",Ct,o(a.$t("Closed")),1)):c("",!0),n.order_status==2?(d(),r("span",Ot,o(a.$t("In Kitchen")),1)):c("",!0),n.order_status==3?(d(),r("span",Nt,o(a.$t("On Hold")),1)):c("",!0),n.order_status==4?(d(),r("span",Pt,o(a.$t("Hold & In Kitchen")),1)):c("",!0),n.order_status==5&&n.returned_status==0?(d(),r("span",Ht,"Partial Returned")):c("",!0),n.order_status==5&&n.returned_status==1?(d(),r("span",Ft,"Returned")):c("",!0)]),e("td",Bt,o(t(D)(n.order_discount))+" "+o(t($)),1),e("td",Et,o(t(D)(n.tax))+" "+o(t($)),1),e("td",It,o(t(D)(n.total))+" "+o(t($)),1)]))),128)):(d(),r("tr",Rt,[e("td",Kt,o(a.$t("No Data Found")),1)]))]),t(Y)!=""&&t(Y)!=null?(d(),r("tfoot",Lt,[e("tr",null,[Ut,e("th",jt,o(t(D)(t(Y).order_discount))+" "+o(t($)),1),e("th",Jt,o(t(D)(t(Y).grand_product_tax)),1),e("th",Gt,o(t(D)(t(Y).grand_product_amount))+" "+o(t($)),1)])])):c("",!0)])])),e("div",qt,[e("div",zt,[e("div",Wt,[h(ie,{onPaginate_limit_update:ne,pagination:t(A)},null,8,["pagination"])]),e("div",Qt,[h(t(be),{data:t(A),limit:5,onPaginationChangePage:C},null,8,["data"])])])])])])])]),_:1})}}};export{_s as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.Re9KOdbP.js","assets/index.li3fCRRM.js","assets/index.KTHCd6a8.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
