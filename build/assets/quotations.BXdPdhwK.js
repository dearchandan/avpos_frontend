import{_ as at}from"./DefaultLayout.nvkZ4UhM.js";import{_ as lt}from"./PaginateLimit.Xv-qfeqj.js";import{_ as nt}from"./ListingSkeleton.iExoV4hO.js";import{_ as it}from"./VSelect.UFegTIpk.js";import{_ as ct}from"./SalesMenu.shs1JWgg.js";import{u as dt,b as rt,r,e as V,o as ut,v as O,g as n,p as _t,w as N,I as mt,f as T,k as m,i as t,t as l,h as i,n as B,l as p,j as k,K as w,M as ht,N as gt,L as F,F as U,x as q,O as ft}from"./index.7OFNPsHl.js";import{j as E}from"./vue-datepicker.sD5zgpde.js";import"./ClipLoader.1qNfpKDH.js";/* empty css                                                   */import"./vee-validate.esm.N3uz7Rsk.js";/* empty css                                                                */const pt={class:"content"},vt={class:"page-heading"},bt={class:"row align-items-center justify-content-between mb-3"},Ct={class:"col-auto"},yt={class:"mb-0"},kt={key:0,class:"col-auto"},wt={class:"row align-items-end justify-content-between g-3"},$t={class:"col col-lg-auto order-2 order-md-1"},Mt={class:"row g-3 align-items-end"},Qt={class:"col col-md-auto"},St={class:"form-field"},Vt={class:"col-auto col-md-auto"},Nt={class:"btn btn-sm btn-light-primary font-weight-normal",type:"button","data-bs-toggle":"collapse","data-bs-target":"#subFilter","aria-expanded":"false","aria-controls":"collapseExample"},Dt=t("svg",{width:"13",height:"14",viewBox:"0 0 13 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M0.464286 2.33333H7.03022C7.23775 3.136 7.95879 3.73333 8.82143 3.73333C9.68407 3.73333 10.4051 3.136 10.6126 2.33333H12.5357C12.792 2.33333 13 2.12427 13 1.86667C13 1.60907 12.792 1.4 12.5357 1.4H10.6126C10.4051 0.597333 9.68407 0 8.82143 0C7.95879 0 7.23775 0.597333 7.03022 1.4H0.464286C0.208 1.4 0 1.60907 0 1.86667C0 2.12427 0.208 2.33333 0.464286 2.33333ZM8.82143 0.933333C9.33354 0.933333 9.75 1.35193 9.75 1.86667C9.75 2.3814 9.33354 2.8 8.82143 2.8C8.30932 2.8 7.89286 2.3814 7.89286 1.86667C7.89286 1.35193 8.30932 0.933333 8.82143 0.933333ZM12.5357 11.6667H10.6126C10.4051 10.864 9.68407 10.2667 8.82143 10.2667C7.95879 10.2667 7.23775 10.864 7.03022 11.6667H0.464286C0.208 11.6667 0 11.8757 0 12.1333C0 12.3909 0.208 12.6 0.464286 12.6H7.03022C7.23775 13.4027 7.95879 14 8.82143 14C9.68407 14 10.4051 13.4027 10.6126 12.6H12.5357C12.792 12.6 13 12.3909 13 12.1333C13 11.8757 12.792 11.6667 12.5357 11.6667ZM8.82143 13.0667C8.30932 13.0667 7.89286 12.6481 7.89286 12.1333C7.89286 11.6186 8.30932 11.2 8.82143 11.2C9.33354 11.2 9.75 11.6186 9.75 12.1333C9.75 12.6481 9.33354 13.0667 8.82143 13.0667ZM12.5357 6.53333H5.5055C5.29797 5.73067 4.57693 5.13333 3.71429 5.13333C2.85164 5.13333 2.13061 5.73067 1.92307 6.53333H0.464286C0.208 6.53333 0 6.7424 0 7C0 7.2576 0.208 7.46667 0.464286 7.46667H1.92307C2.13061 8.26933 2.85164 8.86667 3.71429 8.86667C4.57693 8.86667 5.29797 8.26933 5.5055 7.46667H12.5357C12.792 7.46667 13 7.2576 13 7C13 6.7424 12.792 6.53333 12.5357 6.53333ZM3.71429 7.93333C3.20218 7.93333 2.78571 7.51473 2.78571 7C2.78571 6.48527 3.20218 6.06667 3.71429 6.06667C4.22639 6.06667 4.64286 6.48527 4.64286 7C4.64286 7.51473 4.22639 7.93333 3.71429 7.93333Z",fill:"currentColor"})],-1),At={class:"col-auto col-md-auto"},Ht={class:"col-12 col-md-4 col-lg-3 order-1 order-md-2"},xt={class:"form-field mb-0"},Ot={class:"field-icon"},Tt=["placeholder"],Bt={class:"icon"},Ft={class:"collapse",id:"subFilter"},Ut={class:"sub-filter"},qt={class:"row align-items-end g-3"},Et={class:"col-6 col-md-auto"},jt={class:"form-field"},It={class:"col-6 col-md-auto"},Lt={class:"col-6 col-md-auto d-md-block"},Zt={value:""},Pt={value:"0"},Jt={value:"1"},Rt={key:0},zt={key:1,class:"table-responsive"},Gt={class:"table table-list-data table-hover"},Kt={class:"bg-light"},Wt={scope:"col",width:"10%"},Yt={scope:"col",width:"10%"},Xt={scope:"col",width:"10%"},te={scope:"col",width:"10%"},ee={scope:"col",width:"10%"},se={scope:"col",width:"10%",class:"text-end"},oe={scope:"col",width:"10%",class:"text-center"},ae={key:0,scope:"col",class:"text-end",width:"5%"},le=["onClick"],ne=["onClick"],ie=["onClick"],ce=["onClick"],de=["onClick"],re=["onClick"],ue={key:0,class:"text-center"},_e={class:"form-field mb-0"},me=["onUpdate:modelValue","id","onChange"],he=["value"],ge={key:1,class:"text-center"},fe={key:0,class:"badge badge-success"},pe={key:2,class:"text-end",width:"10%"},ve=["href"],be=["onClick"],Ce=["onClick"],ye={key:3},ke={key:1},we={class:"text-center py-3",colspan:"10"},$e={class:"data-footer"},Me={class:"row align-items-center justify-content-between"},Qe={class:"col-auto"},Se={class:"col-auto"},Ee={__name:"quotations",setup(Ve){const{t:v}=dt(),{isAuthorized:D}=mt();rt();const j={server_messages:{type:"",messages:""},is_listing:!1,search_query:r(""),filter_count:0},I=v("Search by Quotation No., Quotation Ref. No., Amount..."),a=V({...j}),A=r({customer:v("Customer"),select_customer:v("Select Customer")});ut(()=>{W(),g(),Z()}),O(()=>a.search_query,_.debounce(()=>{g()},500));const $=r([]),M=r([]),L=r([{key:"0",value:"Draft"},{key:"1",value:"Approved"}]);async function g(e=1){a.is_listing=!0,await axios.get("/api/v2/quotations",{params:{page:e,paginate_limit:x.value,search_query:a.search_query,filter:u}}).then(o=>{$.value=o.data.data,M.value=o.data.pagination,a.is_listing=!1}).catch(o=>{a.server_messages.type="error",a.server_messages.messages=o,a.is_listing=!1,console.log(o)})}const H=r([]);async function Z(){let e=await axios.get("api/v2/customers/dropdown");e=e.data.data,_.forEach(e,o=>{let c={key:o.slack,value:o==null?void 0:o.name};H.value.push(c)})}const x=r();async function P(e){x.value=e,await g()}async function J(e,o){var c=new FormData;c.append("slack",o),c.append("status",e.target.value),await axios.post("/api/quotation/update_status",c).then(h=>{if(h.data.status_code==200)toast.success(h.data.msg),g();else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(h.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=h.data.msg}}).catch(h=>{a.server_messages.type="error",a.server_messages.messages=h,console.log(h)})}const R=r(!1),Q=V({quotation_dates:r(),quotation_due_dates:r(),customer:r(""),status:r("")}),u=V({...Q}),S=r(!1);O(()=>u.customer,e=>{y()});async function y(){a.filter_count=0,JSON.stringify(u)!=JSON.stringify(Q)&&(S.value=!0),_.forEach(u,(e,o)=>{e!=""&&e!=null&&o!="quotation_dates"&&(a.filter_count=a.filter_count+1)}),R.value=!1,await g()}function z(){Object.assign(u,Q),S.value=!1,a.filter_count=0,g()}function b(e){router.push("/quotation/"+e)}function G(e){router.push("/quotation/edit/"+e)}async function K(e){var o=!1;await Swal.fire({title:v("Do you want to delete this quotation?"),showCancelButton:!0,confirmButtonText:v("Yes, Delete"),confirmButtonColor:"#d33",cancelButtonText:v("Cancel")}).then(c=>{c.isConfirmed&&(o=!0)}),o&&await axios.post("/api/quotation/delete",{slack:e}).then(c=>{if(c.data.status_code==200)toast.success(c.data.msg),g();else try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(c.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=c.data.msg}}).catch(c=>{a.server_messages.type="error",a.server_messages.messages=c,console.log(c)})}const f=r({write:!1,delete:!1});function W(){f.value={write:D("A_WRITE_QUOTATION"),delete:D("A_DELETE_QUOTATION")}}return(e,o)=>{const c=ct,h=T("router-link"),C=T("Icon"),Y=it,X=nt,tt=lt,et=at;return n(),_t(et,null,{subheader:N(()=>[m(c)]),default:N(()=>[t("div",pt,[t("div",vt,[t("div",bt,[t("div",Ct,[t("h2",yt,l(e.$t("Quotations")),1)]),f.value.write?(n(),i("div",kt,[m(h,{class:"btn btn-sm btn-light-primary2",to:"/quotation/add"},{default:N(()=>[B("+ "+l(e.$t("New Quotation")),1)]),_:1})])):p("",!0)]),t("div",wt,[t("div",$t,[t("div",Mt,[t("div",Qt,[t("div",St,[t("label",null,l(e.$t("Quotation Date")),1),m(k(E),{range:"",modelValue:u.quotation_dates,"onUpdate:modelValue":[o[0]||(o[0]=s=>u.quotation_dates=s),o[1]||(o[1]=s=>y())],format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid form-control-sm"},null,8,["modelValue"])])]),t("div",Vt,[t("button",Nt,[Dt,B(" "+l(e.$t("Filters"))+" ",1),w(t("span",{class:"badge",id:"filter_count_badge"},l(a.filter_count),513),[[ht,a.filter_count>0]])])]),t("div",At,[S.value?(n(),i("button",{key:0,class:"btn btn-sm btn-light-danger",onClick:z},l(e.$t("Clear")),1)):p("",!0)])])]),t("div",Ht,[t("div",xt,[t("div",Ot,[w(t("input",{type:"search",class:"form-control form-control-sm form-control-solid",placeholder:k(I),"onUpdate:modelValue":o[2]||(o[2]=s=>a.search_query=s)},null,8,Tt),[[gt,a.search_query]]),t("div",Bt,[m(C,{icon:"fa6-solid:magnifying-glass"})])])])])]),t("div",Ft,[t("div",Ut,[t("div",qt,[t("div",Et,[t("div",jt,[t("label",null,l(e.$t("Quotation Due Date")),1),m(k(E),{range:"",modelValue:u.quotation_due_dates,"onUpdate:modelValue":[o[3]||(o[3]=s=>u.quotation_due_dates=s),o[4]||(o[4]=s=>y())],format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid form-control-sm"},null,8,["modelValue"])])]),t("div",It,[m(Y,{name:"customer",label:A.value.customer,modelValue:u.customer,"onUpdate:modelValue":o[5]||(o[5]=s=>u.customer=s),placeholder:A.value.select_customer,options:H.value,height_sm:!0},null,8,["label","modelValue","placeholder","options"])]),t("div",Lt,[t("label",null,l(e.$t("Status")),1),w(t("select",{class:"form-select form-select-solid form-select-sm","onUpdate:modelValue":o[6]||(o[6]=s=>u.status=s),onChange:y},[t("option",Zt,l(e.$t("All")),1),t("option",Pt,l(e.$t("Draft")),1),t("option",Jt,l(e.$t("Approved")),1)],544),[[F,u.status]])])])])])]),a.is_listing?(n(),i("div",Rt,[m(X)])):(n(),i("div",zt,[t("table",Gt,[t("thead",Kt,[t("tr",null,[t("th",Wt,l(e.$t("Quotation Number")),1),t("th",Yt,l(e.$t("Ref. Number")),1),t("th",Xt,l(e.$t("Customer")),1),t("th",te,l(e.$t("Quotation Date")),1),t("th",ee,l(e.$t("Quotation Due Date")),1),t("th",se,l(e.$t("Amount")),1),t("th",oe,l(e.$t("Status")),1),f.value.write||f.value.delete?(n(),i("th",ae,l(e.$t("Action")),1)):p("",!0)])]),t("tbody",null,[$.value!=""?(n(!0),i(U,{key:0},q($.value,(s,st)=>(n(),i("tr",{key:st},[t("td",{quotation:"button","data-bs-toggle":"modal","data-bs-target":"#viewQuotationModal",onClick:d=>b(s.slack)},l(s.quotation_number),9,le),t("td",{quotation:"button","data-bs-toggle":"modal","data-bs-target":"#viewQuotationModal",onClick:d=>b(s.slack)},l(s.reference_no),9,ne),t("td",{quotation:"button","data-bs-toggle":"modal","data-bs-target":"#viewQuotationModal",onClick:d=>b(s.slack)},l(s.customer_name),9,ie),t("td",{quotation:"button","data-bs-toggle":"modal","data-bs-target":"#viewQuotationModal",onClick:d=>b(s.slack)},l(s.quotation_date_label),9,ce),t("td",{quotation:"button","data-bs-toggle":"modal","data-bs-target":"#viewQuotationModal",onClick:d=>b(s.slack)},l(s.quotation_due_date_label),9,de),t("td",{class:"text-end",quotation:"button","data-bs-toggle":"modal","data-bs-target":"#viewQuotationModal",onClick:d=>b(s.slack)},l(s.grand_product_amount),9,re),s.status==0?(n(),i("td",ue,[t("div",_e,[w(t("select",{class:"form-control form-control-solid","onUpdate:modelValue":d=>s.status=d,name:"status",id:s.slack,onChange:d=>J(d,s.slack)},[(n(!0),i(U,null,q(L.value,(d,ot)=>(n(),i("option",{value:d.key,key:ot},l(d.value),9,he))),128))],40,me),[[F,s.status]])])])):(n(),i("td",ge,[s.status==1?(n(),i("span",fe,l(e.$t("Approved")),1)):p("",!0)])),f.value.write||f.value.delete?(n(),i("td",pe,[s.receipt_link!=null?(n(),i("a",{key:0,href:s.receipt_link,target:"_blank",type:"button",class:"mx-2"},[m(C,{icon:"ph:printer-light",class:"fs-3 text-info"})],8,ve)):p("",!0),f.value.write&&s.status==0?(n(),i("a",{key:1,class:"mx-2",href:"#",onClick:d=>G(s.slack)},[m(C,{icon:"fa6-solid:pen",class:"fs-5 text-default"})],8,be)):p("",!0),f.value.delete&&s.status==0?(n(),i("a",{key:2,class:"mx-2",href:"#",onClick:d=>K(s.slack)},[m(C,{icon:"fa6-solid:trash-can",class:"fs-5 text-default"})],8,Ce)):(n(),i("a",ye,"--"))])):p("",!0)]))),128)):(n(),i("tr",ke,[t("td",we,l(e.$t("No Data Found")),1)]))])])])),t("div",$e,[t("div",Me,[t("div",Qe,[m(tt,{onPaginate_limit_update:P,pagination:M.value},null,8,["pagination"])]),t("div",Se,[m(k(ft),{data:M.value,limit:5,onPaginationChangePage:g},null,8,["data"])])])])])]),_:1})}}};export{Ee as default};
