import{u as H,b as Q,d as w,e as M,r as u,g as r,p as V,w as f,f as C,i as e,l as d,k as S,t as s,j as t,m as A,A as F,B as N,h as m,F as X,x as Z,O as ee,I as te,bW as v,q as se,_ as ae}from"./index.li3fCRRM.js";import{D as oe}from"./DefaultLayout.saUWsTkY.js";import{_ as ne}from"./PaginateLimit.SmYeFgfo.js";import{_ as le}from"./ListingSkeleton.6NzqF9S5.js";import{_ as re}from"./VMultiSelect.2M-H_LD-.js";import{u as ie}from"./global.NAtoPKoY.js";import{s as R,a as ce,e as de,j as _e}from"./vue-datepicker.a6BsTEHj.js";import{s as P,e as B}from"./index.dFkrF4C6.js";import"./ClipLoader.gDBpDd3b.js";/* empty css                                                   */import"./vee-validate.esm.reM-LHjC.js";const ue={class:"header-nav-wrap"},me={class:"row align-items-center"},he={class:"col-auto"},pe={class:"header-back-link"},ge={class:"col-auto"},fe={class:"fw-bold"},ve={class:"content"},be={class:"card"},ye={class:"row field-m-0 align-items-end g-3"},De={class:"col-md-4 col-lg-3"},ke={class:"form-field"},we={for:"",class:"form-label"},xe=e("span",{class:"text-danger"},"*",-1),$e=["onClick","onKeyup"],Ye={class:"col-md-4 col-lg-3"},Me={class:"col-auto text-end"},Ve={class:"row align-items-center"},Ce={class:"col-auto"},Se=["disabled"],Ae={class:"col-auto"},Fe=["disabled"],Ne={class:"card"},Re={class:""},Pe={key:0},Be={key:1,class:"table-responsive"},Oe={class:"table table-list-data table-hover"},Ee={class:"bg-light"},Le={scope:"col"},Te={scope:"col"},Ie={scope:"col"},je={scope:"col"},Ke={scope:"col"},Ge={scope:"col"},Ue={scope:"col"},qe={scope:"col",class:"text-end"},ze={scope:"col",class:"text-end"},Je={scope:"col",class:"text-end"},We={class:"text-end"},He={class:"text-end"},Qe={class:"text-end"},Xe={key:1},Ze={class:"text-center py-3",colspan:"13"},et={key:0},tt=e("th",{colspan:"7"},null,-1),st={class:"text-end"},at={class:"text-end"},ot={class:"text-end"},nt={class:"data-footer"},lt={class:"row align-items-center justify-content-between"},rt={class:"col-auto"},it={class:"col-auto"},kt={__name:"sales_returned_report",setup(ct){const{t:b}=H(),{isAuthorized:dt,getRoundedValue:_}=te();ie();const x=Q(),h=w(()=>x.user.currency.symbol),O=M({server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,dates:u([new Date,new Date]),selected_branch:u(),is_exporting:!1}),a=M({...O}),E=b("Select Branch"),L=b("All Branches");b("All Products");const T=u([{label:"Today",value:[new Date,new Date]},{label:"This month",value:[P(new Date),B(new Date)]},{label:"Last month",value:[P(R(new Date,1)),B(R(new Date,1))]},{label:"This year",value:[ce(new Date),de(new Date)]}]),I=w(()=>x.user.branches),$=u();async function j(o){$.value=o,await D()}const i=u([]),y=u([]);async function D(o=1){a.is_listing=!0,a.dates[0]=v(a.dates[0]).format("YYYY-MM-DD"),a.dates[1]=v(a.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/sales_returned_report",{params:{page:o,paginate_limit:$.value,filter:a}}).then(n=>{i.value=n.data.data.data,y.value=n.data.pagination,a.is_listing=!1}).catch(n=>{a.server_messages.type="error",a.server_messages.messages=n,a.is_listing=!1,console.log(n)})}const p=w(()=>i.value.length?{returned_discount_amount:i.value.reduce(function(n,c){return n+parseFloat(c.order_discount)},0).toFixed(2),returned_tax_amount:i.value.reduce(function(n,c){return n+parseFloat(c.tax)},0).toFixed(2),returned_amount:i.value.reduce(function(n,c){return n+parseFloat(c.total)},0).toFixed(2)}:null);async function K(){a.is_exporting=!0,a.dates[0]=v(a.dates[0]).format("YYYY-MM-DD"),a.dates[1]=v(a.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/sales_returned_report/export_excel",{params:{filter:a}}).then(o=>{if(o.data.status_code==200){a.is_exporting=!1;const n=document.createElement("a");n.target="_blank",n.href=o.data.data.file,document.body.appendChild(n),n.click()}else{try{a.server_messages.type="error",a.server_messages.messages=JSON.parse(o.data.msg)}catch{a.server_messages.type="error",a.server_messages.messages=o.data.msg}a.is_exporting=!1}}).catch(o=>{a.server_messages.type="error",a.server_messages.messages=o,a.is_exporting=!1,console.log(o)})}const G=se(()=>ae(()=>import("./ServerMessage.Re9KOdbP.js"),__vite__mapDeps([0,1,2])));return(o,n)=>{const c=C("Icon"),U=C("router-link"),q=re,z=le,J=ne,W=oe;return r(),V(W,null,{subheader:f(()=>[e("div",ue,[e("div",me,[e("div",he,[e("div",pe,[d(U,{class:"text-primary",to:"/reports"},{default:f(()=>[d(c,{icon:"fa6-solid:chevron-left"}),S(" "+s(o.$t("Reports")),1)]),_:1})])]),e("div",ge,[e("h5",fe,s(o.$t("Sales Returned Report")),1)])])])]),default:f(()=>[e("div",ve,[t(a).server_messages.messages!=""?(r(),V(t(G),{key:0,class:"py-3",server_messages:t(a).server_messages},null,8,["server_messages"])):A("",!0),e("div",be,[e("div",ye,[e("div",De,[e("div",ke,[e("label",we,[S(s(o.$t("Select Dates"))+" ",1),xe]),d(t(_e),{range:"","preset-dates":t(T),modelValue:t(a).dates,"onUpdate:modelValue":n[0]||(n[0]=l=>t(a).dates=l),format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":f(({label:l,value:g,presetDate:k})=>[e("span",{role:"button",tabindex:0,onClick:Y=>k(g),onKeyup:[F(N(Y=>k(g),["prevent"]),["enter"]),F(N(Y=>k(g),["prevent"]),["space"])]},s(l),41,$e)]),_:1},8,["preset-dates","modelValue"])])]),e("div",Ye,[d(q,{name:"branches",label:t(E),placeholder:t(L),text:"name",value:"id",options:t(I),modelValue:t(a).selected_branch,"onUpdate:modelValue":n[1]||(n[1]=l=>t(a).selected_branch=l),mode:"single"},null,8,["label","placeholder","options","modelValue"])]),e("div",Me,[e("div",Ve,[e("div",Ce,[e("button",{class:"btn btn-primary",onClick:D,disabled:t(a).dates==null},s(o.$t("View")),9,Se)]),e("div",Ae,[e("button",{class:"btn btn-success",onClick:n[2]||(n[2]=l=>K()),disabled:t(a).dates==null},s(o.$t("Export Excel")),9,Fe)])])])])]),e("div",Ne,[e("div",Re,[t(a).is_listing?(r(),m("div",Pe,[d(z)])):(r(),m("div",Be,[e("table",Oe,[e("thead",Ee,[e("tr",null,[e("th",Le,s(o.$t("Branch Name")),1),e("th",Te,s(o.$t("Return Order No.")),1),e("th",Ie,s(o.$t("Sale Return Date")),1),e("th",je,s(o.$t("Customer Name")),1),e("th",Ke,s(o.$t("Customer Phone")),1),e("th",Ge,s(o.$t("Payment Type")),1),e("th",Ue,s(o.$t("Return Reason")),1),e("th",qe,s(o.$t("Discount Amount")),1),e("th",ze,s(o.$t("Tax Amount")),1),e("th",Je,s(o.$t("Net Sales Amount")),1)])]),e("tbody",null,[t(i)!=""?(r(!0),m(X,{key:0},Z(t(i),(l,g)=>(r(),m("tr",{key:g},[e("td",null,s(l.branch_name),1),e("td",null,s(l.return_order_number),1),e("td",null,s(l.return_date),1),e("td",null,s(l.customer_name),1),e("td",null,s(l.customer_phone),1),e("td",null,s(l.payment_method_name),1),e("td",null,s(l.reason),1),e("td",We,s(t(_)(l.order_discount))+" "+s(t(h)),1),e("td",He,s(t(_)(l.tax))+" "+s(t(h)),1),e("td",Qe,s(t(_)(l.total))+" "+s(t(h)),1)]))),128)):(r(),m("tr",Xe,[e("td",Ze,s(o.$t("No Data Found")),1)]))]),t(p)!=""&&t(p)!=null?(r(),m("tfoot",et,[e("tr",null,[tt,e("th",st,s(t(_)(t(p).returned_discount_amount))+" "+s(t(h)),1),e("th",at,s(t(_)(t(p).returned_tax_amount)),1),e("th",ot,s(t(_)(t(p).returned_amount))+" "+s(t(h)),1)])])):A("",!0)])])),e("div",nt,[e("div",lt,[e("div",rt,[d(J,{onPaginate_limit_update:j,pagination:t(y)},null,8,["pagination"])]),e("div",it,[d(t(ee),{data:t(y),limit:5,onPaginationChangePage:D},null,8,["data"])])])])])])])]),_:1})}}};export{kt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.Re9KOdbP.js","assets/index.li3fCRRM.js","assets/index.KTHCd6a8.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
