import{_ as E}from"./EditFormSkeleton.Ez20ofO9.js";import{_ as M}from"./VMultiSelect.pXBL2AV1.js";import B from"./ServerMessage.EFQMOwoZ.js";import{D as W}from"./DefaultLayout.K5Bh9Jz_.js";import{F}from"./vee-validate.esm.2kXgdFia.js";import{c as I,a as g,g as O,b as T}from"./index.esm.DHYHwGJ4.js";import{_ as p}from"./VTextInput.EPCajChY.js";import{u as P,a as J,r as h,e as L,o as j,g as m,p as y,w as b,f as R,i as o,l,k as z,t as v,j as u,h as c,m as q}from"./index.sP6fhsqN.js";import{C as G}from"./ClipLoader._89zL49D.js";/* empty css                                                                */import"./VTooltip.kcvohVRA.js";/* empty css                                                   */const H={class:"header-nav-wrap"},K={class:"row align-items-center"},Q={class:"col-auto"},X={class:"header-back-link"},Y={class:"col-auto"},Z={key:0,class:"fw-bold"},ee={key:1,class:"fw-bold"},ae={key:0,class:"content"},te={class:"row card-strash"},se={key:0,class:"py-3"},oe={class:"col-md-12"},re={class:"row"},ne={class:"col-md-12"},le={class:"card"},de={class:"row"},ie={class:"col-md-2"},me={class:"col-md-2"},ue={class:"col-md-2"},_e={class:"col-md-2"},ce={class:"col-md-2"},pe={class:"col-md-2"},ve={class:"col-md-12"},he={class:"text-end"},be=["disabled"],ge={key:1,class:"pt-0"},ye={key:2,class:"pt-0"},Me={__name:"add_receipt",setup(fe){const{t}=P(),d=J().params.slack,i=h({receipt_number:t("Receipt Number"),receipt_date:t("Receipt Date"),balance_amount:t("Balance Amount"),withdrawal_amount:t("Withdrawal Amount"),note:t("Note"),rent_receipt_user:t("Rent Receipt User"),select_rent_receipt_user:t("Select User"),payment_mode:t("Payment Mode"),select_payment_mode:t("Select Payment Mode")}),e=L({...{server_messages:{type:"",messages:""},is_submitting:!1,voucher_number:"",voucher_date:"",balance_amount:"",withdrawal_amount:"",closing_voucher_user_id:"",payment_mode:"",note:""}});let S=I({voucher_number:g().required(t("name is required",{name:t("Receipt Number")})),voucher_date:O().required(t("name is required",{name:t("Receipt Date")})),closing_voucher_user_id:g().required(t("name is required",{name:t("Rent Receipt User")})),payment_mode:g().required(t("name is required",{name:t("Payment Mode")})),withdrawal_amount:T().required(t("name is required",{name:t("Withdrawal Amount")})).typeError(t("must be a number",{name:t("Withdrawal Amount")})).min(1,t("Withdrawal Amount must be more than 1")).test({test:function(a,s){var r=$('[name="withdrawal_amount"]').attr("max");return a<=parseInt(r)?!0:s.createError({path:`${s.path}`,message:t("must be less than or equal to n",{name:t("Withdrawal Amount"),number:r})})}})});j(()=>{U(),d!=""&&d!=null&&N()});const x=h([{id:"Cash",name:"Cash"},{id:"Online Transfer",name:"Online Transfer"}]),f=h([]);async function U(){await axios.get("/api/voucher/add",{params:{type:2}}).then(a=>{if(a.data.status_code==200)d==null&&(e.voucher_number=a.data.data.voucher_number,e.voucher_date=a.data.data.date,e.balance_amount=a.data.data.balance_amount),_.forEach(a.data.data.voucher_users,s=>{if(s.status==1){let r={id:s.id,name:s.name};f.value.push(r)}});else try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(a.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=a.data.msg}}).catch(a=>{e.server_messages.type="error",e.server_messages.messages=a,console.log(a)})}const w=h(!1);async function N(){let a=await axios.get("/api/voucher",{params:{slack:d,type:2}});a.data.data&&(a.data.data.status>0&&router.push("/rent_receipts"),e.rent_receipt_slack=a.data.data.slack,e.voucher_number=a.data.data.voucher_number,e.voucher_date=a.data.data.voucher_date,e.balance_amount=a.data.data.balance_amount,e.withdrawal_amount=a.data.data.withdrawal_amount,e.closing_voucher_user_id=a.data.data.closing_voucher_user_id,e.payment_mode=a.data.data.payment_mode,e.note=a.data.data.note),w.value=!0}async function A(){e.is_submitting=!0;var a=new FormData;a.append("voucher_number",e.voucher_number),a.append("voucher_date",e.voucher_date),a.append("balance_amount",e.balance_amount),a.append("withdrawal_amount",e.withdrawal_amount),a.append("closing_voucher_user_id",e.closing_voucher_user_id),a.append("payment_mode",e.payment_mode),a.append("note",e.note),a.append("slack",e.rent_receipt_slack),a.append("type",2);var s=e.rent_receipt_slack!=""&&e.rent_receipt_slack!=null?"/api/voucher/update":"/api/voucher/save";await axios.post(s,a,{headers:{"Content-Type":"multipart/form-data"}}).then(r=>{if(r.data.status_code==200)toast.success(r.data.msg),e.is_submitting=!1,router.push("/rent_receipts");else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(r.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=r.data.msg}e.is_submitting=!1}}).catch(r=>{e.server_messages.type="error",e.server_messages.messages=r,e.is_submitting=!1,console.log(r)})}return(a,s)=>{const r=R("Icon"),k=R("router-link"),C=B,V=M,D=E;return m(),y(W,null,{subheader:b(()=>[o("div",H,[o("div",K,[o("div",Q,[o("div",X,[l(k,{class:"text-primary",to:"/rent_receipts"},{default:b(()=>[l(r,{icon:"fa6-solid:chevron-left"}),z(" "+v(a.$t("Rent Receipts")),1)]),_:1})])]),o("div",Y,[u(d)==null||u(d)==""?(m(),c("h5",Z,v(a.$t("Add Rent Receipt")),1)):(m(),c("h5",ee,v(a.$t("Edit Rent Receipt")),1))])])])]),default:b(()=>[u(d)==""||u(d)==null||u(d)!=""&&w.value?(m(),c("div",ae,[l(u(F),{"validation-schema":u(S),onSubmit:A,enctype:"multipart/form-data","initial-values":e},{default:b(()=>[o("div",te,[e.server_messages.messages!=""?(m(),c("div",se,[l(C,{server_messages:e.server_messages},null,8,["server_messages"])])):q("",!0),o("div",oe,[o("div",re,[o("div",ne,[o("div",le,[o("div",de,[o("div",ie,[l(p,{type:"text",name:"voucher_number",modelValue:e.voucher_number,"onUpdate:modelValue":s[0]||(s[0]=n=>e.voucher_number=n),label:i.value.receipt_number,disabled:!0,required:!0},null,8,["modelValue","label"])]),o("div",me,[l(p,{type:"date",name:"voucher_date",modelValue:e.voucher_date,"onUpdate:modelValue":s[1]||(s[1]=n=>e.voucher_date=n),label:i.value.receipt_date,required:!0},null,8,["modelValue","label"])]),o("div",ue,[l(p,{type:"number",name:"balance_amount",modelValue:e.balance_amount,"onUpdate:modelValue":s[2]||(s[2]=n=>e.balance_amount=n),label:i.value.balance_amount,disabled:!0,required:!0},null,8,["modelValue","label"])]),o("div",_e,[l(p,{type:"number",name:"withdrawal_amount",modelValue:e.withdrawal_amount,"onUpdate:modelValue":s[3]||(s[3]=n=>e.withdrawal_amount=n),label:i.value.withdrawal_amount,max:e.balance_amount,required:!0},null,8,["modelValue","label","max"])]),o("div",ce,[l(V,{label:i.value.rent_receipt_user,name:"closing_voucher_user_id",text:"name",value:"id",options:f.value,mode:"single",modelValue:e.closing_voucher_user_id,"onUpdate:modelValue":s[4]||(s[4]=n=>e.closing_voucher_user_id=n),placeholder:i.value.select_rent_receipt_user,required:!0},null,8,["label","options","modelValue","placeholder"])]),o("div",pe,[l(V,{label:i.value.payment_mode,name:"payment_mode",text:"name",value:"id",options:x.value,mode:"single",modelValue:e.payment_mode,"onUpdate:modelValue":s[5]||(s[5]=n=>e.payment_mode=n),placeholder:i.value.select_payment_mode,required:!0},null,8,["label","options","modelValue","placeholder"])]),o("div",ve,[l(p,{type:"text",name:"note",modelValue:e.note,"onUpdate:modelValue":s[6]||(s[6]=n=>e.note=n),label:i.value.note},null,8,["modelValue","label"])])])])])])])]),o("div",he,[o("button",{type:"submit",class:"btn btn-primary",disabled:e.is_submitting},[e.is_submitting?(m(),y(G,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):q("",!0),e.is_submitting?(m(),c("span",ge,v(a.$t("Saving...")),1)):(m(),c("span",ye,v(a.$t("Save")),1))],8,be)])]),_:1},8,["validation-schema","initial-values"])])):(m(),y(D,{key:1}))]),_:1})}}};export{Me as default};
