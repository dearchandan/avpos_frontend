import{_ as B}from"./EditFormSkeleton.hbjdnq7m.js";import D from"./ServerMessage.I5ol-gtz.js";import{u as T,a as O,r as g,e as E,o as I,j as p,g as u,p as y,w as Z,k as l,h as c,l as f,i as a,t as r,F as J,x as L,L as P,K as v,bG as N,n as h,Q as z}from"./index.7OFNPsHl.js";import{F as G}from"./vee-validate.esm.N3uz7Rsk.js";import{c as K,a as b}from"./index.esm.cd1bITNA.js";import{_ as d}from"./VTextInput.VtSvZjuc.js";import{C as Q}from"./ClipLoader.1qNfpKDH.js";const W={class:"row card-strash"},H={key:0,class:"py-3"},X={class:"col-md-12"},Y={class:"row"},ee={class:"col-md-12 mb-4"},te={class:"card"},ae={class:"row"},se={class:"col-6 col-md-4 col-lg-3"},ie={class:"col-6 col-md-4 col-lg-3"},oe={class:"col-6 col-md-4 col-lg-3"},le={class:"form-field"},ne={class:"form-label"},de={value:""},re=["value"],me={class:"col-6 col-md-4 col-lg-3"},ue={key:0,class:"col-6 col-md-4 col-lg-3"},_e={class:"form-field"},ce={class:"d-flex align-items-center"},pe={class:"me-3 mt-3"},be=["checked"],ge={class:"mt-3"},ve=["checked"],ye={class:"col-6 col-md-4 col-lg-3"},fe={class:"col-6 col-md-4 col-lg-3"},he={class:"col-6 col-md-4 col-lg-3"},Ve={class:"col-6 col-md-4 col-lg-3"},xe={class:"col-6 col-md-4 col-lg-3"},ke={class:"col-6 col-md-4 col-lg-3"},Ce={class:"col-6 col-md-4 col-lg-3"},Ne={class:"col-6 col-md-4 col-lg-3"},Ue={class:"form-field pt-2"},$e={class:"form-check form-switch pt-4"},Se={class:"form-check-label",for:"status"},we={class:"col-md-12 mb-4"},qe={class:"card"},je={class:"pb-3"},Me={class:"text-muted"},Ae={class:"row"},Fe={class:"col-6 col-md-4 col-lg-3"},Re={class:"col-6 col-md-4 col-lg-3"},Be={class:"col-6 col-md-4 col-lg-3"},De={class:"col-6 col-md-4 col-lg-3"},Te={class:"col-6 col-md-4 col-lg-3"},Oe={class:"col-6 col-md-4 col-lg-3"},Ee={class:"col-6 col-md-4 col-lg-3"},Ie={class:"col-6 col-md-4 col-lg-3"},Ze={class:"text-end"},Je=["disabled"],Le={key:1,class:"pt-0"},Pe={key:2,class:"pt-0"},et={__name:"AddCustomer",props:{redirection:{type:String,required:!1,default:""}},emits:["closeAddCustomerModal"],setup(U,{emit:$}){const{t:o}=T(),V=O(),_=V.params.slack,n=g({name:o("Customer Name"),email:o("Customer Email"),phone:o("Customer Phone"),tax_registration_number:o("Tax Registration Number"),tax_registration_name:o("Tax Registration Name"),commercial_registration_number:o("Commercial Registration Number"),gst_number:o("GST Number"),date_of_birth:o("Date Of Birth"),date_of_anniversary:o("Date Of Anniversary"),joining_date:o("Date Of Joining"),first_address_line:o("Street Name"),second_address_line:o("Additional Street Name"),city:o("City Name"),pincode:o("Postal Zone"),building_number:o("Building Number"),city_subdivision_name:o("City Subdivision Name"),identification_code:o("Identification Code"),state:o("State")}),e=E({...{server_messages:{type:"",messages:""},is_submitting:!1,name:"",email:"",phone:"",customer_type:"",tax_registration_number:"",tax_registration_name:"",commercial_registration_number:"",gst_number:"",date_of_birth:"",date_of_anniversary:"",joining_date:"",status:!0,first_address_line:"",second_address_line:"",city:"",pincode:"",building_number:"",city_subdivision_name:"",identification_code:"",state:"",country:"",customer_slack:"",redirection:"",invoice_path:!1,quotation_path:!1}}),S=U;e.redirection=S.redirection;const w=K({name:b().required(o("name is required",{name:o("Customer Name")})).min(3,o("name must be at least n characters",{name:o("Customer Name"),number:3})).matches(/^[a-zA-Z\u0600-\u06FF\s]+$/,o("Name must be in alphabets")),phone:b().matches(/^[0-9]{9,10}$/,o("Mobile number must be 9 or 10 digits")).typeError(o("must be a number",{name:o("Mobile Number")})).required(o("name is required",{name:o("Mobile Number")})),tax_registration_number:b().nullable().test("is-valid-tax-number",o("Tax Registration Number must be a 15-digit number starting with 3 and ending with 3"),t=>!t||/^[3]\d{13}[3]$/.test(t)),building_number:b().nullable().test("is-valid-tax-number",o("Building Number must be a 4-digit number"),t=>!t||/^\d{4}$/.test(t)),pincode:b().nullable().test("is-valid-tax-number",o("Postal Zone must be a 5-digit number"),t=>!t||/^\d{5}$/.test(t))}),x=g([]),q=g([]);I(()=>{j(),_!=""&&_!=null&&M();let t=V.path;e.invoice_path=t.includes("invoice"),e.quotation_path=t.includes("quotation"),(e.invoice_path==!0||e.quotation_path==!0)&&(e.customer_type=1)});async function j(){await axios.get("/api/v2/countries/all").then(t=>{if(t.data.status_code==200)x.value=t.data.data;else try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(t.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=t.data.msg}}).catch(t=>{e.server_messages.type="error",e.server_messages.messages=t,console.log(t)})}const k=g(!1);async function M(){await axios.get("/api/customer",{params:{slack:_}}).then(t=>{q.value=t.data.data,t.data.data&&(e.customer_slack=t.data.data.slack,e.name=t.data.data.name,e.email=t.data.data.email,e.city=t.data.data.city,e.state=t.data.data.state,e.gst_number=t.data.data.gst_number,e.tax_registration_number=t.data.data.tax_registration_number,e.tax_registration_name=t.data.data.tax_registration_name,e.commercial_registration_number=t.data.data.commercial_registration_number,e.phone=t.data.data.phone,e.first_address_line=t.data.data.first_address_line,e.second_address_line=t.data.data.second_address_line,e.pincode=t.data.data.postal_code,e.building_number=t.data.data.building_number,e.city_subdivision_name=t.data.data.city_subdivision_name,e.identification_code=t.data.data.identification_code,e.country=t.data.data.country?t.data.data.country.slack:"",e.date_of_anniversary=t.data.data.date_of_anniversary,e.date_of_birth=t.data.data.date_of_birth,e.joining_date=t.data.data.joining_date,e.customer_type=t.data.data.type,e.status=t.data.data.status==1,k.value=!0)}).catch(t=>{e.server_messages.type="error",e.server_messages.messages=t,console.log(t)})}async function A(){e.is_submitting=!0;var t=new FormData;t.append("name",e.name),t.append("email",e.email!=""?e.email:""),t.append("phone",e.phone),t.append("customer_type",e.invoice_path==!0||e.quotation_path==!0?1:e.customer_type),t.append("tax_registration_number",e.tax_registration_number),t.append("tax_registration_name",e.tax_registration_name),t.append("commercial_registration_number",e.commercial_registration_number),t.append("gst_number",e.gst_number),t.append("date_of_birth",e.date_of_birth),t.append("date_of_anniversary",e.date_of_anniversary),t.append("joining_date",e.joining_date),t.append("status",e.status),t.append("first_address_line",e.first_address_line),t.append("second_address_line",e.second_address_line),t.append("city",e.city),t.append("pincode",e.pincode),t.append("building_number",e.building_number),t.append("city_subdivision_name",e.city_subdivision_name),t.append("identification_code",e.identification_code),t.append("state",e.state),t.append("country",e.country),t.append("customer_slack",e.customer_slack);var s=e.customer_slack!=""&&e.customer_slack!=null?"/api/customer/update":"/api/customer/save";await axios.post(s,t).then(m=>{if(m.data.status_code==200)e.redirection!=""&&router.push(e.redirection),toast.success(m.data.msg),e.is_submitting=!1,(e.invoice_path==!0||e.quotation_path==!0)&&(e.customer_type=1),F("closeAddCustomerModal");else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(m.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=m.data.msg}e.is_submitting=!1}}).catch(m=>{e.server_messages.type="error",e.server_messages.messages=m,e.is_submitting=!1,console.log(m)})}const F=$;return(t,s)=>{const m=D,C=B;return p(_)==""||p(_)==null||p(_)!=""&&k.value?(u(),y(p(G),{key:0,"validation-schema":p(w),"initial-values":e,onSubmit:A,enctype:"multipart/form-data",id:"add_customer_form"},{default:Z(()=>[a("div",W,[e.server_messages.messages!=""?(u(),c("div",H,[l(m,{server_messages:e.server_messages},null,8,["server_messages"])])):f("",!0),a("div",X,[a("div",Y,[a("div",ee,[a("div",te,[a("div",ae,[a("div",se,[l(d,{type:"text",name:"name",modelValue:e.name,"onUpdate:modelValue":s[0]||(s[0]=i=>e.name=i),label:n.value.name,required:!0},null,8,["modelValue","label"])]),a("div",ie,[l(d,{type:"text",name:"phone",modelValue:e.phone,"onUpdate:modelValue":s[1]||(s[1]=i=>e.phone=i),label:n.value.phone,required:""},null,8,["modelValue","label"])]),a("div",oe,[a("div",le,[a("label",ne,r(t.$t("Country")),1),v(a("select",{class:"form-control form-control-solid","onUpdate:modelValue":s[2]||(s[2]=i=>e.country=i)},[a("option",de,r(t.$t("Select Country")),1),(u(!0),c(J,null,L(x.value,(i,R)=>(u(),c("option",{value:i.slack,key:R},r(i.name),9,re))),128))],512),[[P,e.country]])])]),a("div",me,[l(d,{type:"email",name:"email",modelValue:e.email,"onUpdate:modelValue":s[3]||(s[3]=i=>e.email=i),label:n.value.email},null,8,["modelValue","label"])]),e.invoice_path==!1&&e.quotation_path==!1?(u(),c("div",ue,[a("div",_e,[a("label",null,r(t.$t("Customer Type")),1),a("div",ce,[a("label",pe,[v(a("input",{class:"form-check-input me-1",type:"radio",name:"customer_type","onUpdate:modelValue":s[4]||(s[4]=i=>e.customer_type=i),value:2,checked:e.customer_type==2||e.customer_type==""||e.customer_type==null},null,8,be),[[N,e.customer_type]]),h(r(t.$t("Walk-In")),1)]),a("label",ge,[v(a("input",{class:"form-check-input me-1",type:"radio",name:"customer_type","onUpdate:modelValue":s[5]||(s[5]=i=>e.customer_type=i),value:1,checked:e.customer_type==1},null,8,ve),[[N,e.customer_type]]),h(r(t.$t("Regular")),1)])])])])):f("",!0),a("div",ye,[l(d,{type:"text",name:"tax_registration_name",modelValue:e.tax_registration_name,"onUpdate:modelValue":s[6]||(s[6]=i=>e.tax_registration_name=i),label:n.value.tax_registration_name},null,8,["modelValue","label"])]),a("div",fe,[l(d,{type:"text",name:"tax_registration_number",modelValue:e.tax_registration_number,"onUpdate:modelValue":s[7]||(s[7]=i=>e.tax_registration_number=i),label:n.value.tax_registration_number},null,8,["modelValue","label"])]),a("div",he,[l(d,{type:"text",name:"commercial_registration_number",modelValue:e.commercial_registration_number,"onUpdate:modelValue":s[8]||(s[8]=i=>e.commercial_registration_number=i),label:n.value.commercial_registration_number},null,8,["modelValue","label"])]),a("div",Ve,[l(d,{type:"text",name:"gst_number",modelValue:e.gst_number,"onUpdate:modelValue":s[9]||(s[9]=i=>e.gst_number=i),label:n.value.gst_number},null,8,["modelValue","label"])]),a("div",xe,[l(d,{type:"date",name:"date_of_birth",modelValue:e.date_of_birth,"onUpdate:modelValue":s[10]||(s[10]=i=>e.date_of_birth=i),label:n.value.date_of_birth},null,8,["modelValue","label"])]),a("div",ke,[l(d,{type:"date",name:"date_of_anniversary",modelValue:e.date_of_anniversary,"onUpdate:modelValue":s[11]||(s[11]=i=>e.date_of_anniversary=i),label:n.value.date_of_anniversary},null,8,["modelValue","label"])]),a("div",Ce,[l(d,{type:"date",name:"joining_date",modelValue:e.joining_date,"onUpdate:modelValue":s[12]||(s[12]=i=>e.joining_date=i),label:n.value.joining_date},null,8,["modelValue","label"])]),a("div",Ne,[a("div",Ue,[a("div",$e,[v(a("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"status",checked:"","onUpdate:modelValue":s[13]||(s[13]=i=>e.status=i)},null,512),[[z,e.status]]),a("label",Se,r(t.$t("Active")),1)])])])])])]),a("div",we,[a("div",qe,[a("h5",je,[h(r(t.$t("Address"))+" ",1),a("small",Me,r(t.$t("(Required for Zatca Invoicing)")),1)]),a("div",Ae,[a("div",Fe,[l(d,{type:"text",name:"first_address_line",modelValue:e.first_address_line,"onUpdate:modelValue":s[14]||(s[14]=i=>e.first_address_line=i),label:n.value.first_address_line},null,8,["modelValue","label"])]),a("div",Re,[l(d,{type:"text",name:"second_address_line",modelValue:e.second_address_line,"onUpdate:modelValue":s[15]||(s[15]=i=>e.second_address_line=i),label:n.value.second_address_line},null,8,["modelValue","label"])]),a("div",Be,[l(d,{type:"text",name:"building_number",modelValue:e.building_number,"onUpdate:modelValue":s[16]||(s[16]=i=>e.building_number=i),label:n.value.building_number},null,8,["modelValue","label"])]),a("div",De,[l(d,{type:"text",name:"city",modelValue:e.city,"onUpdate:modelValue":s[17]||(s[17]=i=>e.city=i),label:n.value.city},null,8,["modelValue","label"])]),a("div",Te,[l(d,{type:"text",name:"pincode",modelValue:e.pincode,"onUpdate:modelValue":s[18]||(s[18]=i=>e.pincode=i),label:n.value.pincode},null,8,["modelValue","label"])]),a("div",Oe,[l(d,{type:"text",name:"city_subdivision_name",modelValue:e.city_subdivision_name,"onUpdate:modelValue":s[19]||(s[19]=i=>e.city_subdivision_name=i),label:n.value.city_subdivision_name},null,8,["modelValue","label"])]),a("div",Ee,[l(d,{type:"text",name:"identification_code",modelValue:e.identification_code,"onUpdate:modelValue":s[20]||(s[20]=i=>e.identification_code=i),label:n.value.identification_code},null,8,["modelValue","label"])]),a("div",Ie,[l(d,{type:"text",name:"state",modelValue:e.state,"onUpdate:modelValue":s[21]||(s[21]=i=>e.state=i),label:n.value.state},null,8,["modelValue","label"])])])])])])])]),a("div",Ze,[a("button",{type:"submit",class:"btn btn-primary",disabled:e.is_submitting},[e.is_submitting?(u(),y(Q,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):f("",!0),e.is_submitting?(u(),c("span",Le,r(t.$t("Saving...")),1)):(u(),c("span",Pe,r(t.$t("Save")),1))],8,Je)])]),_:1},8,["validation-schema","initial-values"])):(u(),y(C,{key:1}))}}};export{et as _};
