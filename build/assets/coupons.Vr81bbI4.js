import{_ as L}from"./ActionButtonGroup.AvqLZ7Zu.js";import{_ as j}from"./CouponStage.iy6iJQYn.js";import{z as U,u as G,b as J,r as p,e as M,o as K,v as Q,g as c,p as R,w as b,I as W,f as A,l as m,i as e,h as l,k as E,t as a,m as k,K as Y,N as H,j as B,F as X,x as Z,y as d,O as ee,C as te,D as se}from"./index.sP6fhsqN.js";import{D as ae}from"./DefaultLayout.K5Bh9Jz_.js";import{_ as oe}from"./PaginateLimit.T5jDCI_N.js";import"./vue-datepicker.S8gODTVm.js";import{B as ie}from"./BeatLoader.GLQikMEo.js";import{_ as ne}from"./ManageMenu.dfCD4VJP.js";import"./ClipLoader._89zL49D.js";/* empty css                                                   *//* empty css                                                   */const S=v=>(te("data-v-7924fc07"),v=v(),se(),v),ce={class:"content"},le={class:"page-heading"},de={class:"row align-items-center justify-content-between"},re={class:"col-auto"},_e={class:"row align-items-center"},he={key:0,class:"col-auto"},me={class:"col-auto"},ue={class:"row align-items-center"},pe=S(()=>e("div",{class:"col-auto"},[e("div",{class:"dropdown filter-dropdown"},[e("div",{class:"dropdown-menu p-0",style:{"min-width":"150px"}},[e("div",{class:"dropdown-item"},"An item"),e("div",{class:"dropdown-item"},"A second item"),e("div",{class:"dropdown-item"},"A third item"),e("div",{class:"dropdown-item"},"A fourth item"),e("div",{class:"dropdown-item"},"And a fifth one")])])],-1)),ge={class:"col-auto"},ve={class:"form-field page-heading-search-field mb-0"},fe={class:"field-icon"},ke=["placeholder"],ye={class:"icon"},we={key:0},Ce={key:1,class:"table-responsive"},be={class:"table table-list-data table-hover"},$e={class:"bg-light"},xe={scope:"col",width:"10%"},Ae={scope:"col",width:"10%"},Ee={scope:"col",width:"10%"},Be={scope:"col",width:"10%"},Se={scope:"col",width:"10%"},De={scope:"col",width:"10%"},Ne={scope:"col",width:"10%"},Ie={scope:"col",width:"10%"},qe={scope:"col",width:"10%"},Oe={key:0,scope:"col",class:"text-end",width:"5%"},Pe=["onClick"],Te={class:"fw-bold highlighted-list-item"},Fe={key:0},Ve=S(()=>e("br",null,null,-1)),ze={class:"text-muted"},Le=["onClick"],je=["onClick"],Ue={key:0},Ge={key:1,href:"#"},Je={key:0},Me={key:1},Ke=["onClick"],Qe=["onClick"],Re=["onClick"],We=["onClick"],Ye=["onClick"],He={class:"form-feild"},Xe={class:"form-check form-switch form-switch-2"},Ze=["onChange","checked"],et={key:0,class:"text-end"},tt={key:1},st={class:"text-center py-3",colspan:"11"},at={class:"data-footer"},ot={class:"row align-items-center justify-content-between"},it={class:"col-auto"},nt={class:"col-auto"},ct={__name:"coupons",setup(v){const{t:f}=G(),{isAuthorized:$}=W();J(),p(!1);const D={server_messages:{type:"",messages:""},is_listing:!1,search_query:p("")},N=f("Search by name, email, code.."),o=M({...D});K(()=>{T(),g()}),Q(()=>o.search_query,_.debounce(()=>{g()},500));const y=p([]),w=p([]);async function g(s=1){o.is_listing=!0,await axios.get("/api/coupons",{params:{page:s,paginate_limit:x.value,search_query:o.search_query}}).then(n=>{y.value=n.data.data,w.value=n.data.pagination,o.is_listing=!1}).catch(n=>{o.server_messages.type="error",o.server_messages.messages=n,o.is_listing=!1,console.log(n)})}const x=p();async function I(s){x.value=s,await g()}async function q(s){var n=new FormData;n.append("slack",s),await axios.post("/api/coupon/update_status",n).then(i=>{if(i.data.status_code==200)toast.success(i.data.msg);else try{o.server_messages.type="error",o.server_messages.messages=JSON.parse(i.data.msg)}catch{o.server_messages.type="error",o.server_messages.messages=i.data.msg}}).catch(i=>{o.server_messages.type="error",o.server_messages.messages=i,console.log(i)})}function r(s){router.push("/coupon/"+s)}function O(s){router.push("/coupon/edit/"+s)}async function P(s){var n=!1;await Swal.fire({title:f("Do you want to delete this item?"),showCancelButton:!0,confirmButtonText:f("Yes, Delete"),confirmButtonColor:"#d33",cancelButtonText:f("Cancel")}).then(i=>{i.isConfirmed&&(n=!0)}),n&&await axios.post("/api/coupon/delete",{slack:s}).then(i=>{if(i.data.status_code==200)toast.success(i.data.msg),g();else try{o.server_messages.type="error",o.server_messages.messages=JSON.parse(i.data.msg)}catch{o.server_messages.type="error",o.server_messages.messages=i.data.msg}}).catch(i=>{o.server_messages.type="error",o.server_messages.messages=i,console.log(i)})}const u=p({write:!1,delete:!1});function T(){u.value={write:$("A_WRITE_COUPON"),delete:$("A_DELETE_COUPON")}}return(s,n)=>{const i=A("router-link"),C=A("Icon"),F=j,V=L;return c(),R(ae,null,{subheader:b(()=>[m(ne)]),default:b(()=>[e("div",ce,[e("div",le,[e("div",de,[e("div",re,[e("div",_e,[u.value.write?(c(),l("div",he,[m(i,{class:"btn btn-sm btn-light-primary",to:"/coupon/add"},{default:b(()=>[E("+ "+a(s.$t("New Coupon")),1)]),_:1})])):k("",!0)])]),e("div",me,[e("div",ue,[pe,e("div",ge,[e("div",ve,[e("div",fe,[Y(e("input",{type:"text",class:"form-control form-control-sm form-control-shadow",placeholder:B(N),"onUpdate:modelValue":n[0]||(n[0]=t=>o.search_query=t)},null,8,ke),[[H,o.search_query]]),e("div",ye,[m(C,{icon:"fa6-solid:magnifying-glass"})])])])])])])])]),o.is_listing?(c(),l("div",we,[m(ie,{color:"gray",size:"15px",class:"pt-2 pe-2"})])):(c(),l("div",Ce,[e("table",be,[e("thead",$e,[e("tr",null,[e("th",xe,a(s.$t("Coupon")),1),e("th",Ae,a(s.$t("Amount/Percentage")),1),e("th",Ee,a(s.$t("Branches")),1),e("th",Be,a(s.$t("Available Qty.")),1),e("th",Se,a(s.$t("Customer Type")),1),e("th",De,a(s.$t("Ends At")),1),e("th",Ne,a(s.$t("Status")),1),e("th",Ie,a(s.$t("Created At")),1),e("th",qe,a(s.$t("Active")),1),u.value.write||u.value.delete?(c(),l("th",Oe,a(s.$t("Action")),1)):k("",!0)])]),e("tbody",null,[y.value!=""?(c(!0),l(X,{key:0},Z(y.value,(t,z)=>(c(),l("tr",{key:z},[e("td",{onClick:h=>r(t.slack),role:"button",class:d({"text-muted":t.stage=="Expired"})},[e("div",null,[e("span",Te,a(t.name),1),t.name_ar!=""?(c(),l("span",Fe,[Ve,e("small",ze,a(t.name_ar),1)])):k("",!0)])],10,Pe),e("td",{onClick:h=>r(t.slack),role:"button",class:d({"text-muted":t.stage=="Expired"})},a(t.value)+" "+a(t.type_text),11,Le),e("td",{onClick:h=>r(t.slack),role:"button",class:d({"text-muted":t.stage=="Expired"})},[t.branches_count==0?(c(),l("span",Ue,a(s.$t("All Branches")),1)):(c(),l("span",Ge,[E(a(t.branches_count)+" ",1),t.branches_count>1?(c(),l("span",Je,a(s.$t("Branches")),1)):(c(),l("span",Me,a(s.$t("Branch")),1))]))],10,je),e("td",{onClick:h=>r(t.slack),role:"button",class:d({"text-muted":t.stage=="Expired"})},a(t.available_quantity),11,Ke),e("td",{onClick:h=>r(t.slack),role:"button",class:d({"text-muted":t.stage=="Expired"})},a(t.customer_type_text),11,Qe),e("td",{onClick:h=>r(t.slack),role:"button",class:d({"text-muted":t.stage=="Expired"})},a(t.end_datetime_label),11,Re),e("td",{onClick:h=>r(t.slack),role:"button",class:d({"text-muted":t.stage=="Expired"})},[m(F,{stage:t.stage},null,8,["stage"])],10,We),e("td",{onClick:h=>r(t.slack),role:"button",class:d({"text-muted":t.stage=="Expired"})},a(t.created_at_label),11,Ye),e("td",null,[e("div",He,[e("div",Xe,[e("input",{class:d(["form-check-input",{"disabled-switch":t.stage=="Expired"}]),type:"checkbox",role:"switch",id:"Status_id",onChange:h=>q(t.slack),checked:t.status==1},null,42,Ze)])])]),u.value.write||u.value.delete?(c(),l("td",et,[m(V,{permissions:u.value,onEdit:O,onDelete:P,slack:t.slack},null,8,["permissions","slack"])])):k("",!0)]))),128)):(c(),l("tr",tt,[e("td",st,a(s.$t("No Data Found")),1)]))])])])),e("div",at,[e("div",ot,[e("div",it,[m(oe,{onPaginate_limit_update:I,pagination:w.value},null,8,["pagination"])]),e("div",nt,[m(B(ee),{data:w.value,limit:5,onPaginationChangePage:g},null,8,["data"])])])])])]),_:1})}}},kt=U(ct,[["__scopeId","data-v-7924fc07"]]);export{kt as default};
