import{u as te,r as v,b as ae,d as ne,a as se,e as ie,o as oe,g as l,h as m,j as a,p as f,w as P,l as k,t as r,n as q,k as u,i as n,F as V,x as S,Q as le,K as re,q as F,_ as Q,I as _e}from"./index.ri7Y_V5F.js";import{_ as ce}from"./EditFormSkeleton.MxB2Xqx6.js";import{_ as ue}from"./VMultiSelect.3zUL7lik.js";import{_ as de}from"./VTextInput.o2P1IcEE.js";import{_ as me}from"./VTooltip.a7qKl6DY.js";import{a as x,F as pe}from"./vee-validate.esm.0La7AMjT.js";import{c as ye,a as B,d as R,e as he,h as ge}from"./index.esm.wERziE-M.js";import{C as ve}from"./ClipLoader.4-rIzqtH.js";/* empty css                                                   */const be={class:"row"},fe={class:"col-md-12"},ke={class:"row"},qe={class:"col-md-12"},Ve={class:"card"},we={class:"row mb-5"},Se={class:"section-title pb-2"},xe={class:"section-title pb-2 text-muted"},Ie={class:"col-12 col-md-4 col-lg-3"},Ue={class:"col-12 col-md-4 col-lg-3"},Ce={class:"col-12 col-md-4 col-lg-3"},$e={class:"col-auto pt-md-3"},Ae={class:"form-field pt-3"},Ee={class:"form-check form-switch"},Pe={class:"form-check-label",for:"status"},De=n("em",null,"*",-1),Te={class:"col-auto pt-md-3"},Ne={class:"form-field pt-3"},Oe={class:"form-check form-switch"},Me={class:"form-check-label",for:"is_stockable"},Fe=n("em",null,"*",-1),Qe={key:0,class:"col-6 col-md-4 col-lg-3"},Be={class:"form-field"},Re={for:""},je=n("em",{class:"text-danger"},"*",-1),Le={value:""},Ge=["label"],ze=["value"],He={key:1,class:"col-6 col-md-4 col-lg-3"},Je={class:"form-field"},Ke={for:""},Ye=n("em",{class:"text-danger"},"*",-1),We={value:""},Xe=["label"],Ze=["value"],et={class:"row"},tt={class:"section-title pb-2 text-muted"},at={class:"col-12 col-md-4 col-lg-3"},nt={class:"form-field"},st={class:"input-group input-file-group"},it={class:"btn btn-light-primary min-width-0 mb-0",for:"formFile"},ot={class:"col-6 col-md-4 col-lg-3"},lt={class:"col-6 col-md-4 col-lg-3"},rt={class:"col-6 col-md-4 col-lg-3"},_t={class:"col-6 col-md-4 col-lg-3"},ct={class:"col-md-12"},ut={class:"card"},dt={class:"row"},mt={class:"section-title pb-2 text-muted"},pt={key:0,class:"col-6 col-md-3 col-lg-3"},yt={class:"col-6 col-md-3 col-lg-3"},ht={key:1,class:"col-6 col-md-3 col-lg-3"},gt={class:"col-auto col-lg-auto"},vt={class:"form-field",type:"radio"},bt={class:"label"},ft={class:"form-check form-switch mt-md-3"},kt=["onUpdate:modelValue","checked","onChange"],qt={class:"text-end"},Vt=["disabled"],wt={key:1,class:"pt-0"},St={key:2,class:"pt-0"},Ot={__name:"AddIngredient",setup(xt){const j=F(()=>Q(()=>import("./AddCategory.YYpFIiy8.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),{t:o}=te(),{isAuthorized:D}=_e();localStorage.getItem("language"),v([{name:o("Everywhere"),value:""},{name:"POS",value:"POS"},{name:"INVOICE",value:"INVOICE"}]);const p=v({name:o("Ingredient Name"),sale_price:o("Sale Price"),name_ar:o("Ingredient Name (Arabic)"),short_description:o("Short Description"),short_description_ar:o("Short Description (Arabic)"),description:o("Description"),description_ar:o("Description (Arabic)"),select_categories:o("Select Categories"),purchase_price:o("Purchase Price"),alert_quantity:o("Alert Quantity"),upc:o("UPC (Barcode)"),master_ingredient_tooltip:o("This master ingredient will be visible on all branches."),branch_ingredient_tooltip:o("Stock only for this branch."),sales_price_inc_tax:o("Sale Price (Incl. Tax)"),sales_price_exc_tax:o("Sale Price (Excl. Tax)"),quantity:o("Quantity In Hand"),sku:o("SKU"),show_in:o("Show In"),unit:o("Unit")}),L=F(()=>Q(()=>import("./ServerMessage.qNo4NwTp.js"),__vite__mapDeps([1,2,3]))),T=ae(),w=ne(()=>T.user.currency.symbol),g=se().params.slack,h=ie({type:"",messages:""});function G(){O()}const e=v({is_submitting:!1,slack:"",name:"",sale_price:"",stock_measurement_unit_id:"",sale_measurement_unit_id:"",categories:[],is_stockable:!0,status:!0,image:"",name_ar:"",short_description:"",short_description_ar:"",description:"",description_ar:"",upc:"",purchase_price:"",alert_quantity:"",inventory_slack:"",inventory_quantity:0,inventory_sku:"",inventory_alert_quantity:"",inventory_show_in:"",inventory_is_favorite:!1,inventory_status:!0,is_quantity_readonly:!1,stock_measurement_unit_name:"Units"}),z=ye({name:B().required(o("name is required",{name:o("Ingredient Name")})).min(3,o("name must be at least n characters",{name:o("Ingredient Name"),number:3})).max(20,o("Must be less than 20 characters",{name:o("Ingredient Name"),number:20})),sale_price:R().typeError(o("must be a number",{name:o("Sale Price")})).required(o("name is required",{name:o("Sale Price")})).positive(o("must be a positive number",{name:o("Sale Price")})),status:he().label("status"),categories:ge().min(1,o("select at least n options",{number:1})),inventory_quantity:R().typeError(o("must be a number",{name:o("Quantity")})).when({is:()=>e.value.is_stockable,then:t=>t.required(o("name is required",{name:o("Quantity")})).moreThan(0,"Quantity cannot be negative"),otherwise:t=>t.nullable()}),inventory_alert_quantity:B().matches(/^([.0-9]{0,9999999999999})$/,o("Alert Quantity must be a positive number or 0"))});async function H(t){e.value.image=t.target.files[0]}async function J(t){e.value.stock_measurement_unit_name=t.target.options[t.target.options.selectedIndex].text}oe(()=>{_.isUndefined(g)||Z(),O(),K()});const N=v({write:!1,delete:!1});function K(){N.value={write:D("A_WRITE_CATEGORY"),delete:D("A_DELETE_CATEGORY")}}const I=v([]),U=v([]),Y=v([]);async function O(){await axios.get("/api/ingredient/add").then(t=>{U.value=t.data.data.categories,Y.value=t.data.data.taxes,I.value=t.data.data.measurements}).catch(t=>{h.type="error",h.messages=t,e.value.is_submitting=!1,console.log(t)})}async function W(t){e.is_submitting=!0;var s=new FormData;s.append("name",t.name),s.append("sale_price",t.sale_price),s.append("categories",JSON.stringify(t.categories)),s.append("is_stockable",t.is_stockable),s.append("status",t.status),s.append("image",e.value.image),s.append("name_ar",t.name_ar),s.append("short_description",t.short_description),s.append("short_description_ar",t.short_description_ar),s.append("description",t.description),s.append("description_ar",t.description_ar),s.append("upc",t.upc),s.append("purchase_price",t.purchase_price),s.append("alert_quantity",t.alert_quantity),s.append("ingredient_slack",g),s.append("inventory_slack",t.inventory_slack),s.append("inventory_sale_price",t.inventory_sale_price),s.append("inventory_quantity",t.inventory_quantity!=null?t.inventory_quantity:0),s.append("inventory_sku",t.inventory_sku!=null?t.inventory_sku:""),s.append("inventory_alert_quantity",t.inventory_alert_quantity),s.append("inventory_show_in",t.inventory_show_in!=null?t.inventory_show_in:""),s.append("inventory_is_favorite",t.inventory_is_favorite=="1"),s.append("inventory_status",t.inventory_status=="1"),t.is_stockable&&(t.stock_measurement_unit_id!=""&&s.append("stock_measurement_unit_id",t.stock_measurement_unit_id?t.stock_measurement_unit_id:""),t.sale_measurement_unit_id!=""&&s.append("sale_measurement_unit_id",t.sale_measurement_unit_id?t.sale_measurement_unit_id:""));var b=g!=""&&g!=null?"/api/ingredient/update":"/api/ingredient/save";await axios.post(b,s,{headers:{"Content-Type":"multipart/form-data"}}).then(d=>{if(d.data.status_code==200)toast.success(d.data.msg),e.value.is_submitting=!1,X(),router.push("/ingredients");else{try{h.type="error",h.messages=JSON.parse(d.data.msg)}catch{h.type="error",h.messages=d.data.msg}e.value.is_submitting=!1}}).catch(d=>{h.type="error",h.messages=d,e.value.is_submitting=!1,console.log(d)})}function X(){Object.assign(e,e)}const M=v(!1);async function Z(){let t=await axios.get("/api/ingredient",{params:{slack:g}});e.value=t.data.data.ingredient,M.value=!0,e.value.image="",e.value.categories=[],Object.keys(e.value.product_categories).forEach(s=>{e.value.categories.push(e.value.product_categories[s].category.slack)}),e.value.this_branch_inventory!=null?(e.value.inventory_slack=e.value.this_branch_inventory.slack,e.value.sale_price=e.value.this_branch_inventory.sale_price,e.value.inventory_quantity=e.value.this_branch_inventory.quantity,e.value.inventory_sku=e.value.this_branch_inventory.sku,e.value.inventory_alert_quantity=e.value.this_branch_inventory.alert_quantity,e.value.inventory_show_in=e.value.this_branch_inventory.show_in,e.value.inventory_is_favorite=e.value.this_branch_inventory.is_favorite==1,e.value.inventory_status=e.value.this_branch_inventory.status==1,e.value.is_quantity_readonly=!0):(e.value.inventory_show_in="",e.value.inventory_is_favorite=!1,e.value.inventory_status=!0,e.value.is_quantity_readonly=!1),e.value.is_stockable==!0&&e.value.stock_measurement_unit_id>0?e.value.stock_measurement_unit_name=e.value.stock_measurement_unit.unit_name+" "+e.value.stock_measurement_unit.unit_name_ar:e.value.stock_measurement_unit_name="Units"}return(t,s)=>{const b=me,d=de,C=ue,ee=ce;return l(),m(V,null,[a(g)==""||a(g)==null||a(g)!=""&&a(M)?(l(),f(a(pe),{key:0,"validation-schema":a(z),onSubmit:W,enctype:"multipart/form-data","initial-values":a(e)},{default:P(({values:c,setFieldValue:$})=>[n("div",be,[n("div",fe,[a(h).messages!=""?(l(),f(a(L),{key:0,class:"py-3",server_messages:a(h)},null,8,["server_messages"])):k("",!0),n("div",ke,[n("div",qe,[n("div",Ve,[n("div",we,[n("h4",Se,[q(r(t.$t("Master Ingredient Details"))+":",1),u(b,{message:a(p).master_ingredient_tooltip},null,8,["message"])]),n("h5",xe,r(t.$t("Basic Details"))+":",1),n("div",Ie,[u(d,{type:"text",name:"name",label:a(p).name,required:!0,modelValue:a(e).name,"onUpdate:modelValue":s[0]||(s[0]=i=>a(e).name=i)},null,8,["label","modelValue"])]),n("div",Ue,[a(N).write?(l(),f(C,{key:0,name:"categories",label:a(p).select_categories,text:"name",value:"slack",options:a(U),required:"",selected:a(e).categories,addModalShow:!0,addModalId:"#addCategoryModal"},null,8,["label","options","selected"])):(l(),f(C,{key:1,name:"categories",label:a(p).select_categories,text:"name",value:"slack",options:a(U),required:"",selected:a(e).categories},null,8,["label","options","selected"]))]),n("div",Ce,[u(d,{type:"text",name:"sale_price",label:a(p).sale_price,required:!0,input_group_text:c.is_stockable&&c.sale_measurement_unit?a(w)+"/ Per "+a(e).sale_measurement_unit.abbreviation:a(w)+"/ Per Unit",modelValue:a(e).sale_price,"onUpdate:modelValue":s[1]||(s[1]=i=>a(e).sale_price=i)},null,8,["label","input_group_text","modelValue"])]),n("div",$e,[n("div",Ae,[n("div",Ee,[u(a(x),{class:"form-check-input me-2",type:"checkbox",role:"switch",name:"status",id:"status","unchecked-value":!1,value:c.status,onChange:i=>$("status",i.target.checked)},null,8,["value","onChange"]),n("label",Pe,[q(r(t.$t("Active"))+" ",1),De])])])]),n("div",Te,[n("div",Ne,[n("div",Oe,[u(a(x),{class:"form-check-input me-2",type:"checkbox",role:"switch",name:"is_stockable",id:"is_stockable","unchecked-value":!1,value:c.is_stockable,onChange:i=>$("is_stockable",i.target.checked)},null,8,["value","onChange"]),n("label",Me,[q(r(t.$t("Is Stockable"))+" ",1),Fe])])])]),c.is_stockable?(l(),m("div",Qe,[n("div",Be,[n("label",Re,[q(r(t.$t("Stock Unit"))+" ",1),je,u(b,{message:"Stock unit is your storage unit, i.e sugar can be stored in kilograms "})]),u(a(x),{as:"select",name:"stock_measurement_unit_id",class:"form-control form-control-solid",modelValue:a(e).stock_measurement_unit_id,"onUpdate:modelValue":s[2]||(s[2]=i=>a(e).stock_measurement_unit_id=i),onChange:s[3]||(s[3]=i=>J(i)),disabled:a(e).is_quantity_readonly},{default:P(()=>[n("option",Le,r(t.$t("Units")),1),(l(!0),m(V,null,S(a(I),(i,A)=>(l(),m("optgroup",{key:A,label:i.name+" "+(i.name_ar!=""&&i.name_ar!=null&&i.name_ar!="null"?i.name_ar:"")},[(l(!0),m(V,null,S(i.units,(y,E)=>(l(),m("option",{key:E,value:y.id},r(y.unit_name)+" "+r(y.unit_name_ar!=""&&y.unit_name_ar!=null&&y.unit_name_ar!="null"?y.unit_name_ar:""),9,ze))),128))],8,Ge))),128))]),_:1},8,["modelValue","disabled"])])])):k("",!0),c.is_stockable?(l(),m("div",He,[n("div",Je,[n("label",Ke,[q(r(t.$t("Sales Unit"))+" ",1),Ye,u(b,{message:"Sales unit is your selling unit i.e sugar can be sold in grams  "})]),u(a(x),{as:"select",name:"sale_measurement_unit_id",id:"sale_measurement_unit_id",class:"form-control form-control-solid",modelValue:a(e).sale_measurement_unit_id,"onUpdate:modelValue":s[4]||(s[4]=i=>a(e).sale_measurement_unit_id=i)},{default:P(()=>[n("option",We,r(t.$t("Units")),1),(l(!0),m(V,null,S(a(I),(i,A)=>(l(),m("optgroup",{key:A,label:i.name+" "+(i.name_ar!=""&&i.name_ar!=null&&i.name_ar!="null"?i.name_ar:"")},[(l(!0),m(V,null,S(i.units,(y,E)=>(l(),m("option",{key:E,value:y.id},r(y.unit_name)+" "+r(y.unit_name_ar!=""&&y.unit_name_ar!=null&&y.unit_name_ar!="null"?y.unit_name_ar:""),9,Ze))),128))],8,Xe))),128))]),_:1},8,["modelValue"])])])):k("",!0)]),n("div",et,[n("h5",tt,r(t.$t("Optional Details"))+": ",1),n("div",at,[n("div",nt,[n("label",null,r(t.$t("Ingredient Image")),1),n("div",st,[n("input",{class:"form-control form-control-solid",name:"image",type:"file",id:"formFile",accept:"image/jpg, image/jpeg, image/png",onChange:H},null,32),n("label",it,r(t.$t("Upload")),1)])])]),n("div",ot,[u(d,{type:"number",name:"purchase_price",label:a(p).purchase_price,input_group_text:c.sale_measurement_unit?a(w)+"/ Per "+c.sale_measurement_unit.abbreviation:a(w)+"/ Per Unit",modelValue:a(e).purchase_price,"onUpdate:modelValue":s[5]||(s[5]=i=>a(e).purchase_price=i)},null,8,["label","input_group_text","modelValue"])]),n("div",lt,[u(d,{type:"number",name:"alert_quantity",label:a(p).alert_quantity,modelValue:a(e).alert_quantity,"onUpdate:modelValue":s[6]||(s[6]=i=>a(e).alert_quantity=i)},null,8,["label","modelValue"])]),n("div",rt,[u(d,{type:"text",name:"upc",label:a(p).upc,modelValue:a(e).upc,"onUpdate:modelValue":s[7]||(s[7]=i=>a(e).upc=i)},null,8,["label","modelValue"])]),n("div",_t,[u(d,{type:"text",name:"short_description",label:a(p).short_description,modelValue:a(e).short_description,"onUpdate:modelValue":s[8]||(s[8]=i=>a(e).short_description=i)},null,8,["label","modelValue"])])])])]),n("div",ct,[n("div",ut,[n("div",dt,[n("h5",mt,[q(r(a(T).user.login_branch.name)+"'s "+r(t.$t("In Hand Inventory Details"))+":",1),u(b,{message:a(p).branch_ingredient_tooltip},null,8,["message"])]),c.is_stockable==!0?(l(),m("div",pt,[u(d,{type:"number",name:"inventory_quantity",label:a(p).quantity,modelValue:c.inventory_quantity,"onUpdate:modelValue":i=>c.inventory_quantity=i,input_group_text:a(e).stock_measurement_unit_name,required:"",readonly:a(e).is_quantity_readonly},null,8,["label","modelValue","onUpdate:modelValue","input_group_text","readonly"])])):k("",!0),n("div",yt,[u(d,{type:"text",name:"inventory_sku",label:a(p).sku,modelValue:c.inventory_sku,"onUpdate:modelValue":i=>c.inventory_sku=i},null,8,["label","modelValue","onUpdate:modelValue"])]),c.is_stockable==!0?(l(),m("div",ht,[u(d,{type:"number",name:"inventory_alert_quantity",label:a(p).alert_quantity,modelValue:c.inventory_alert_quantity,"onUpdate:modelValue":i=>c.inventory_alert_quantity=i},null,8,["label","modelValue","onUpdate:modelValue"])])):k("",!0),n("div",gt,[n("div",vt,[n("label",bt,r(t.$t("Status")),1),n("div",ft,[re(n("input",{class:"form-check-input",name:"inventory_status",type:"checkbox",role:"switch",id:"inventory_status","onUpdate:modelValue":i=>c.inventory_status=i,checked:a(e).inventory_status,onChange:i=>$("inventory_status",i.target.checked)},null,40,kt),[[le,c.inventory_status]])])])])])])])])])]),n("div",qt,[n("button",{type:"submit",class:"btn btn-primary",disabled:a(e).is_submitting},[a(e).is_submitting?(l(),f(ve,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):k("",!0),a(e).is_submitting?(l(),m("span",wt,r(t.$t("Saving...")),1)):(l(),m("span",St,r(t.$t("Save")),1))],8,Vt)])]),_:1},8,["validation-schema","initial-values"])):(l(),f(ee,{key:1})),u(a(j),{onCloseAddCategoryModal:G})],64)}}};export{Ot as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/AddCategory.YYpFIiy8.js","assets/ServerMessage.qNo4NwTp.js","assets/index.ri7Y_V5F.js","assets/index.1t-AB2n6.css","assets/VSelectInput.ncg8IJ_w.js","assets/VTooltip.a7qKl6DY.js","assets/vee-validate.esm.0La7AMjT.js","assets/index.esm.wERziE-M.js","assets/VTextInput.o2P1IcEE.js","assets/ClipLoader.4-rIzqtH.js","assets/ClipLoader.7xz7y6gZ.css","assets/BeatLoader.5j6ku4bW.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
