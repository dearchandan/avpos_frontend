import q from"./ServerMessage.Re9KOdbP.js";import{_ as x}from"./VSelect.xfZK6hek.js";import{u as B,r as d,b as C,d as E,e as T,v as D,o as U,g as r,h as n,i as t,t as m,l as c,w as j,Q as F,K as f,N as I,m as h,p as O,j as g}from"./index.li3fCRRM.js";import{F as z}from"./vee-validate.esm.reM-LHjC.js";import{c as G,a as J,b as K,e as L}from"./index.esm.e6McCFlz.js";import{_ as Q}from"./VTextInput.pcaNaUkX.js";/* empty css                                                   */import{C as H}from"./ClipLoader.gDBpDd3b.js";import{u as P}from"./global.NAtoPKoY.js";/* empty css                                                                */import"./VTooltip.pHzwBjkF.js";/* empty css                                                   */const W={class:"modal hide",id:"addRoleModal",tabindex:"-1","aria-labelledby":"Add Role","aria-modal":"true",role:"dialog","data-bs-backdrop":"static","data-bs-keyboard":"false"},X={class:"modal-dialog modal-dialog-centered"},Y={class:"modal-content"},Z={class:"modal-header"},ee={class:"modal-title"},se={class:"modal-body"},te={class:"row"},ae={class:"col-md-12"},oe={class:"col-md-12"},le={class:"form-field pt-3"},ie={class:"form-check form-switch"},re={class:"form-check-label",for:"status"},de={key:0,class:"py-3"},ne={class:"row pt-4"},me={class:"col-12"},ce=["disabled"],_e={key:1,class:"pt-0"},ue={key:2,class:"pt-0"},$e={__name:"AddRole",props:{show_add_role_modal:Boolean,edit_data:{type:[Array,Object]}},emits:["closeAddRoleModal"],setup(k,{emit:R}){const{t:a}=B(),_=d({name:a("Role Name"),role_type:a("Role Type"),select_role_type:a("Select Role Type")}),w=C(),{role_types:p}=P(),S=E(()=>w.user.merchant.layout);d(!1);const y={server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,role_id:"",name:"",role_type:"",status:!0},e=T({...y}),u=d([]),V=G({name:J().required(a("name is required",{name:a("Role Name")})).min(3,a("name must be at least n characters",{name:a("Role Name"),number:3})),role_type:K().typeError(a("name is required",{name:a("Role Type")})).required(a("name is required",{name:a("Role Type")})),status:L().label("status")}),$=R,A=k;function b(){document.getElementById("add_role_form").reset(),N(),$("closeAddRoleModal"),document.getElementById("close_btn").click()}d(null),D(()=>A.edit_data,s=>{s&&(e.role_id=s.slack,e.name=s.name,e.status=s.status==1,e.role_type=s.role_type)}),U(()=>{S.value==2?p.forEach((s,o)=>{if(s.value=="Admin"||s.value=="Staff"){let l={key:s.key,value:s.value};u.value.push(l)}}):u.value=p});async function M(){e.is_submitting=!0;var s=new FormData;s.append("name",e.name),s.append("role_type",e.role_type),s.append("status",e.status),s.append("role_id",e.role_id);var o=e.role_id!=""&&e.role_id!=null?"/api/role/update":"/api/role/save";await axios.post(o,s).then(l=>{if(l.data.status_code==200)toast.success(l.data.msg),e.is_submitting=!1,b();else{try{e.server_messages.type="error",e.server_messages.messages=JSON.parse(l.data.msg)}catch{e.server_messages.type="error",e.server_messages.messages=l.data.msg}e.is_submitting=!1}}).catch(l=>{e.server_messages.type="error",e.server_messages.messages=l,e.is_submitting=!1,console.log(l)})}function N(){Object.assign(e,y)}return(s,o)=>{const l=x,v=q;return r(),n("div",W,[t("div",X,[t("div",Y,[t("div",Z,[t("h5",ee,m(s.$t("Add Role")),1),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:b,id:"close_btn"})]),t("div",se,[c(g(z),{"validation-schema":g(V),onSubmit:M,"initial-values":e,id:"add_role_form"},{default:j(()=>[t("div",te,[t("div",ae,[c(Q,{type:"text",name:"name",modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=i=>e.name=i),label:_.value.name,required:!0},null,8,["modelValue","label"]),c(l,{name:"role_type",label:_.value.role_type,modelValue:e.role_type,"onUpdate:modelValue":o[1]||(o[1]=i=>e.role_type=i),placeholder:_.value.select_role_type,options:u.value,required:""},null,8,["label","modelValue","placeholder","options"])]),t("div",oe,[t("div",le,[t("div",ie,[f(t("input",{class:"form-check-input me-2",type:"checkbox",role:"switch",id:"status","onUpdate:modelValue":o[2]||(o[2]=i=>e.status=i)},null,512),[[F,e.status]]),t("label",re,m(s.$t("Active")),1)])])]),f(t("input",{type:"hidden","onUpdate:modelValue":o[3]||(o[3]=i=>e.role_id=i)},null,512),[[I,e.role_id]])]),e.server_messages.messages!=""?(r(),n("div",de,[c(v,{server_messages:e.server_messages},null,8,["server_messages"])])):h("",!0),t("div",ne,[t("div",me,[t("button",{type:"submit",class:"btn btn-primary w-100",disabled:e.is_submitting},[e.is_submitting?(r(),O(H,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):h("",!0),e.is_submitting?(r(),n("span",_e,m(s.$t("Saving...")),1)):(r(),n("span",ue,m(s.$t("Save")),1))],8,ce)])])]),_:1},8,["validation-schema","initial-values"])])])])])}}};export{$e as default};
