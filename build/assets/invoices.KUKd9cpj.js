import{u as it,e as S,b as ct,r as i,o as rt,v as Z,g as n,p as B,w as R,I as dt,f as x,k as u,i as t,t as o,h as l,n as T,l as c,j as k,K as q,M as ut,N as _t,L as mt,F as ht,x as gt,O as vt,q as z,_ as U}from"./index.ri7Y_V5F.js";import{_ as pt}from"./DefaultLayout.EMHfdzn0.js";import{_ as ft}from"./PaginateLimit.Qyl6CO-f.js";import{_ as bt}from"./ListingSkeleton.PW5leU6x.js";import{_ as yt}from"./SalesMenu.F66Kl-Kr.js";import{j as J}from"./vue-datepicker.gRWbN_6J.js";import"./ClipLoader.4-rIzqtH.js";/* empty css                                                   */const kt={class:"content"},Ct={class:"page-heading"},wt={class:"row align-items-center justify-content-between mb-3"},$t={class:"col-auto"},It={class:"mb-0"},Mt={key:0,class:"col-auto"},Vt={class:"row align-items-end justify-content-between g-3"},St={class:"col col-lg-auto order-2 order-md-1"},Ht={class:"row g-3 align-items-end"},Dt={class:"col col-md-auto"},Nt={class:"form-field"},Et={class:"col-auto col-md-auto"},Pt={class:"btn btn-sm btn-light-primary font-weight-normal",type:"button","data-bs-toggle":"collapse","data-bs-target":"#subFilter","aria-expanded":"false","aria-controls":"collapseExample"},Rt=t("svg",{width:"13",height:"14",viewBox:"0 0 13 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M0.464286 2.33333H7.03022C7.23775 3.136 7.95879 3.73333 8.82143 3.73333C9.68407 3.73333 10.4051 3.136 10.6126 2.33333H12.5357C12.792 2.33333 13 2.12427 13 1.86667C13 1.60907 12.792 1.4 12.5357 1.4H10.6126C10.4051 0.597333 9.68407 0 8.82143 0C7.95879 0 7.23775 0.597333 7.03022 1.4H0.464286C0.208 1.4 0 1.60907 0 1.86667C0 2.12427 0.208 2.33333 0.464286 2.33333ZM8.82143 0.933333C9.33354 0.933333 9.75 1.35193 9.75 1.86667C9.75 2.3814 9.33354 2.8 8.82143 2.8C8.30932 2.8 7.89286 2.3814 7.89286 1.86667C7.89286 1.35193 8.30932 0.933333 8.82143 0.933333ZM12.5357 11.6667H10.6126C10.4051 10.864 9.68407 10.2667 8.82143 10.2667C7.95879 10.2667 7.23775 10.864 7.03022 11.6667H0.464286C0.208 11.6667 0 11.8757 0 12.1333C0 12.3909 0.208 12.6 0.464286 12.6H7.03022C7.23775 13.4027 7.95879 14 8.82143 14C9.68407 14 10.4051 13.4027 10.6126 12.6H12.5357C12.792 12.6 13 12.3909 13 12.1333C13 11.8757 12.792 11.6667 12.5357 11.6667ZM8.82143 13.0667C8.30932 13.0667 7.89286 12.6481 7.89286 12.1333C7.89286 11.6186 8.30932 11.2 8.82143 11.2C9.33354 11.2 9.75 11.6186 9.75 12.1333C9.75 12.6481 9.33354 13.0667 8.82143 13.0667ZM12.5357 6.53333H5.5055C5.29797 5.73067 4.57693 5.13333 3.71429 5.13333C2.85164 5.13333 2.13061 5.73067 1.92307 6.53333H0.464286C0.208 6.53333 0 6.7424 0 7C0 7.2576 0.208 7.46667 0.464286 7.46667H1.92307C2.13061 8.26933 2.85164 8.86667 3.71429 8.86667C4.57693 8.86667 5.29797 8.26933 5.5055 7.46667H12.5357C12.792 7.46667 13 7.2576 13 7C13 6.7424 12.792 6.53333 12.5357 6.53333ZM3.71429 7.93333C3.20218 7.93333 2.78571 7.51473 2.78571 7C2.78571 6.48527 3.20218 6.06667 3.71429 6.06667C4.22639 6.06667 4.64286 6.48527 4.64286 7C4.64286 7.51473 4.22639 7.93333 3.71429 7.93333Z",fill:"currentColor"})],-1),qt={class:"col-auto col-md-auto"},At={class:"col-12 col-md-4 col-lg-3 order-1 order-md-2"},jt={class:"form-field mb-0"},Ot={class:"field-icon"},Ft=["placeholder"],Lt={class:"icon"},Zt={class:"collapse",id:"subFilter"},Bt={class:"sub-filter"},xt={class:"row align-items-end g-3"},Tt={class:"col-6 col-md-auto"},zt={class:"form-field"},Ut={class:"col-6 col-md-auto d-md-block"},Jt={value:""},Gt={value:"0"},Kt={value:"1"},Wt={value:"2"},Qt={value:"3"},Xt={key:0},Yt={key:1,class:"table-responsive"},te={class:"table table-list-data table-hover"},ee={class:"bg-light"},se={scope:"col",width:"10%"},oe={scope:"col",width:"10%"},ae={scope:"col",width:"10%"},ne={scope:"col",width:"10%"},le={scope:"col",width:"10%"},ie={scope:"col",width:"10%",class:"text-end"},ce={scope:"col",width:"10%",class:"text-center"},re={key:0,scope:"col",class:"text-end",width:"10%"},de=["onClick"],ue=["onClick"],_e=["onClick"],me=["onClick"],he=["onClick"],ge={key:0},ve={key:1},pe=["onClick"],fe={key:0},be={key:1,class:"text-muted"},ye={class:"text-center"},ke={key:0,class:"badge badge-primary"},Ce={key:1,class:"badge badge-success"},we={key:2,class:"badge badge-warning"},$e={key:3},Ie={key:0,class:"badge badge-info"},Me={key:1,class:"badge badge-secondary"},Ve={class:"text-end",width:"10%"},Se={key:0},He={class:"row flex-nowrap gx-2 text-end"},De={class:"col-auto"},Ne=["onClick","disabled"],Ee={class:"col-auto"},Pe=["onClick"],Re={key:0,class:"col-auto"},qe=["title","onClick"],Ae={class:"col-auto"},je=["href"],Oe=t("svg",{width:"22",height:"22",viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M5 8V1H17V8",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),t("path",{d:"M5 17H3C2.46957 17 1.96086 16.7893 1.58579 16.4142C1.21071 16.0391 1 15.5304 1 15V10C1 9.46957 1.21071 8.96086 1.58579 8.58579C1.96086 8.21071 2.46957 8 3 8H19C19.5304 8 20.0391 8.21071 20.4142 8.58579C20.7893 8.96086 21 9.46957 21 10V15C21 15.5304 20.7893 16.0391 20.4142 16.4142C20.0391 16.7893 19.5304 17 19 17H17",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),t("path",{d:"M17 13H5V21H17V13Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),Fe=[Oe],Le={key:1},Ze={class:"text-center py-3",colspan:"10"},Be={class:"data-footer"},xe={class:"row align-items-center justify-content-between"},Te={class:"col-auto"},ze={class:"col-auto"},es={__name:"invoices",setup(Ue){const G=z(()=>U(()=>import("./ServerMessage.qNo4NwTp.js"),__vite__mapDeps([0,1,2]))),{t:H}=it(),{isAuthorized:A}=dt(),m=S({type:"",messages:""});ct(),i({customer:H("Customer"),select_customer:H("Select Customer")});const K={is_listing:!1,search_query:i(""),filter_count:0},W=H("Search by Invoice No., Invoice Ref. No., Amount..."),r=S({...K});rt(()=>{et(),g(),at()}),Z(()=>r.search_query,_.debounce(()=>{g()},500));const D=i([]),N=i([]);async function g(s=1){r.is_listing=!0,await axios.get("/api/invoices",{params:{page:s,paginate_limit:j.value,search_query:r.search_query,filter:d}}).then(a=>{D.value=a.data.data,N.value=a.data.pagination,r.is_listing=!1}).catch(a=>{m.type="error",m.messages=a,r.is_listing=!1,console.log(a)})}i([]);const j=i();async function Q(s){j.value=s,await g()}const X=i(!1),E=S({invoice_dates:i(),invoice_due_dates:i(),customer:i(""),status:i("")}),d=S({...E}),P=i(!1);Z(()=>d.customer,s=>{C()});async function C(){r.filter_count=0,JSON.stringify(d)!=JSON.stringify(E)&&(P.value=!0),_.forEach(d,(s,a)=>{s!=""&&s!=null&&a!="invoice_dates"&&(r.filter_count=r.filter_count+1)}),X.value=!1,await g()}function Y(){Object.assign(d,E),d.customer=i(""),P.value=!1,r.filter_count=0,document.getElementsByClassName("multiselect-clear")[0].click(),g()}function p(s){router.push("/invoice/"+s)}function tt(s){router.push("/invoice/edit/"+s)}const f=i({write:!1,delete:!1});function et(){f.value={write:A("A_WRITE_INVOICE"),delete:A("A_DELETE_INVOICE")}}const O=i(null);function st(s){O.value.getInvoiceDetail(s),$("#returnInvoiceModal").modal("show")}const ot=z(()=>U(()=>import("./ReturnInvoiceModal.tldUBAQs.js"),__vite__mapDeps([3,4,1,2,5,6,7,8,9,10,11,12,13,14,15]))),F=i("");async function at(){const s=await axios.get("/api/v2/zatca/merchant");(s.data.status_code==200||s.data.status_code==201)&&(F.value=s.data.data)}const w=i(!1);async function nt(s){var a,I,M,b,V;w.value=!0;try{const y=await axios.post("/api/v2/zatca/signStandardInvoice",{slack:s});w.value=!1;const v=y.data;v.status_code===200&&((a=v.data)!=null&&a.res)?(toast.success("Invoice signed successfully!"),getOrders()):(m.type="error",(I=v.data)!=null&&I.errors?m.messages=Object.values(v.data.errors).flat().join(", "):m.messages=((M=v.data)==null?void 0:M.message)||"An unknown error occurred.")}catch(y){w.value=!1,m.type="error",m.messages=((V=(b=y.response)==null?void 0:b.data)==null?void 0:V.message)||"Something went wrong.",console.error(y)}}return(s,a)=>{const I=yt,M=x("router-link"),b=x("Icon"),V=bt,y=ft,v=pt;return n(),B(v,null,{subheader:R(()=>[u(I)]),default:R(()=>[t("div",kt,[t("div",Ct,[t("div",wt,[t("div",$t,[t("h2",It,o(s.$t("Invoices")),1)]),f.value.write?(n(),l("div",Mt,[u(M,{class:"btn btn-sm btn-light-primary2",to:"/invoice/add"},{default:R(()=>[T("+ "+o(s.$t("New Invoice")),1)]),_:1})])):c("",!0)]),t("div",Vt,[t("div",St,[t("div",Ht,[t("div",Dt,[t("div",Nt,[t("label",null,o(s.$t("Invoice Date")),1),u(k(J),{range:"",modelValue:d.invoice_dates,"onUpdate:modelValue":[a[0]||(a[0]=e=>d.invoice_dates=e),a[1]||(a[1]=e=>C())],format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid form-control-sm"},null,8,["modelValue"])])]),t("div",Et,[t("button",Pt,[Rt,T(" "+o(s.$t("Filters"))+" ",1),q(t("span",{class:"badge",id:"filter_count_badge"},o(r.filter_count),513),[[ut,r.filter_count>0]])])]),t("div",qt,[P.value?(n(),l("button",{key:0,class:"btn btn-sm btn-light-danger",onClick:Y},o(s.$t("Clear")),1)):c("",!0)])])]),t("div",At,[t("div",jt,[t("div",Ot,[q(t("input",{type:"search",class:"form-control form-control-sm form-control-solid",placeholder:k(W),"onUpdate:modelValue":a[2]||(a[2]=e=>r.search_query=e)},null,8,Ft),[[_t,r.search_query]]),t("div",Lt,[u(b,{icon:"fa6-solid:magnifying-glass"})])])])])]),t("div",Zt,[t("div",Bt,[t("div",xt,[t("div",Tt,[t("div",zt,[t("label",null,o(s.$t("Invoice Due Date")),1),u(k(J),{range:"",modelValue:d.invoice_due_dates,"onUpdate:modelValue":[a[3]||(a[3]=e=>d.invoice_due_dates=e),a[4]||(a[4]=e=>C())],format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid form-control-sm"},null,8,["modelValue"])])]),t("div",Ut,[t("label",null,o(s.$t("Status")),1),q(t("select",{class:"form-select form-select-solid form-select-sm","onUpdate:modelValue":a[5]||(a[5]=e=>d.status=e),onChange:C},[t("option",Jt,o(s.$t("All")),1),t("option",Gt,o(s.$t("Draft")),1),t("option",Kt,o(s.$t("Paid")),1),t("option",Wt,o(s.$t("Partial Paid")),1),t("option",Qt,o(s.$t("Returned")),1)],544),[[mt,d.status]])])])])])]),r.is_listing?(n(),l("div",Xt,[u(V)])):(n(),l("div",Yt,[m.messages!=""?(n(),B(k(G),{key:0,server_messages:m},null,8,["server_messages"])):c("",!0),t("table",te,[t("thead",ee,[t("tr",null,[t("th",se,o(s.$t("Invoice Number")),1),t("th",oe,o(s.$t("Ref. Number")),1),t("th",ae,o(s.$t("Customer")),1),t("th",ne,o(s.$t("Invoice Date")),1),t("th",le,o(s.$t("Invoice Due Date")),1),t("th",ie,o(s.$t("Amount")),1),t("th",ce,o(s.$t("Status")),1),f.value.write?(n(),l("th",re,o(s.$t("Action")),1)):c("",!0)])]),t("tbody",null,[D.value!=""?(n(!0),l(ht,{key:0},gt(D.value,(e,lt)=>{var L;return n(),l("tr",{key:lt},[t("td",{invoice:"button","data-bs-toggle":"modal","data-bs-target":"#viewInvoiceModal",onClick:h=>p(e.slack)},o(e.invoice_number),9,de),t("td",{invoice:"button","data-bs-toggle":"modal","data-bs-target":"#viewInvoiceModal",onClick:h=>p(e.slack)},o(e.reference_no>0?e.reference_no:"--"),9,ue),t("td",{invoice:"button","data-bs-toggle":"modal","data-bs-target":"#viewInvoiceModal",onClick:h=>p(e.slack)},o((L=e.customer)==null?void 0:L.name),9,_e),t("td",{invoice:"button","data-bs-toggle":"modal","data-bs-target":"#viewInvoiceModal",onClick:h=>p(e.slack)},o(e.invoice_date_label),9,me),t("td",{invoice:"button","data-bs-toggle":"modal","data-bs-target":"#viewInvoiceModal",onClick:h=>p(e.slack)},[e.invoice_due_date_label!=null?(n(),l("span",ge,o(e.invoice_due_date_label),1)):(n(),l("span",ve,"--"))],8,he),t("td",{class:"text-end",invoice:"button","data-bs-toggle":"modal","data-bs-target":"#viewInvoiceModal",onClick:h=>p(e.slack)},[e.returned_status==0?(n(),l("span",fe,o(e.grand_amount_after_returned.toFixed(2))+" "+o(s.currency_symbol),1)):c("",!0),e.grand_amount_after_returned!=e.grand_product_amount?(n(),l("s",be,o(e.grand_product_amount)+" "+o(s.currency_symbol),1)):c("",!0)],8,pe),t("td",ye,[e.status==0?(n(),l("span",ke,o(s.$t("Draft")),1)):c("",!0),e.status==1?(n(),l("span",Ce,o(s.$t("Paid")),1)):c("",!0),e.status==2?(n(),l("span",we,o(s.$t("Partial Paid")),1)):c("",!0),e.status==3?(n(),l("div",$e,[e.returned_status==0?(n(),l("span",Ie,o(s.$t("Partial Returned")),1)):c("",!0),e.returned_status==1?(n(),l("span",Me,o(s.$t("Returned")),1)):c("",!0)])):c("",!0)]),t("td",Ve,[f.value.write&&f.value.delete?(n(),l("div",Se,[t("div",He,[t("div",De,[e.status==1&&F.value&&!e.zatcaResponse?(n(),l("button",{key:0,onClick:h=>nt(e.slack),disabled:w.value,target:"_blank",type:"button",class:"btn btn-xs btn-warning ms-2"}," E-Sign ",8,Ne)):c("",!0)]),t("div",Ee,[f.value.write&&e.status==0?(n(),l("a",{key:0,class:"btn btn-icon btn-xs btn-light",href:"#",onClick:h=>tt(e.slack)},[u(b,{icon:"fa6-solid:pen",class:"fs-5 text-default"})],8,Pe)):c("",!0)]),e.returned_status!=1&&e.status!=0?(n(),l("div",Re,[e.returned_status!=1&&e.status!=0?(n(),l("a",{key:0,href:"#",type:"button",class:"mx-2",title:e.invoice_service_products_qty_with_return_qty==e.grand_product_quantity?"Return completed except Service Items":"",onClick:h=>e.invoice_service_products_qty_with_return_qty!=e.grand_product_quantity?st(e.slack):null},[u(b,{icon:"tabler:receipt-refund",class:"fs-3 text-warning"})],8,qe)):c("",!0)])):c("",!0),t("div",Ae,[t("a",{href:e.receipt_link,target:"_blank",type:"button",class:"btn btn-icon btn-xs btn-light"},Fe,8,je)])])])):c("",!0)])])}),128)):(n(),l("tr",Le,[t("td",Ze,o(s.$t("No Data Found")),1)]))])])])),t("div",Be,[t("div",xe,[t("div",Te,[u(y,{onPaginate_limit_update:Q,pagination:N.value},null,8,["pagination"])]),t("div",ze,[u(k(vt),{data:N.value,limit:5,onPaginationChangePage:g},null,8,["data"])])])])]),u(k(ot),{onRefreshInvoices:a[6]||(a[6]=e=>g()),ref_key:"returnInvoiceRef",ref:O},null,512)]),_:1})}}};export{es as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.qNo4NwTp.js","assets/index.ri7Y_V5F.js","assets/index.1t-AB2n6.css","assets/ReturnInvoiceModal.tldUBAQs.js","assets/VMultiSelect.3zUL7lik.js","assets/vee-validate.esm.0La7AMjT.js","assets/VMultiSelect.xrLheaKB.css","assets/index.esm.wERziE-M.js","assets/VTextInput.o2P1IcEE.js","assets/VTooltip.a7qKl6DY.js","assets/BeatLoader.8E6aB4W4.js","assets/BeatLoader.5j6ku4bW.css","assets/global.f8Ro4KP-.js","assets/ClipLoader.4-rIzqtH.js","assets/ClipLoader.7xz7y6gZ.css","assets/ReturnInvoiceModal.LEkAunOU.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
