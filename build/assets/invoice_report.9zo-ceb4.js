import{u as se,b as ae,d as F,e as S,r as m,o as oe,g as i,p as P,w as y,f as C,i as e,k as p,n as N,t,j as s,l as v,A,B,h as d,F as ne,x as ce,O as le,I as ie,bV as k,q as de,_ as _e}from"./index.ri7Y_V5F.js";import{_ as re}from"./DefaultLayout.EMHfdzn0.js";import{_ as ue}from"./PaginateLimit.Qyl6CO-f.js";import{_ as he}from"./ListingSkeleton.PW5leU6x.js";import{_ as me}from"./VMultiSelect.3zUL7lik.js";import{_ as pe}from"./VSelect.ijXeZp1F.js";import{s as I,a as ge,e as ve,j as fe}from"./vue-datepicker.gRWbN_6J.js";import{s as R,e as E}from"./index.DsgwUBM9.js";import"./ClipLoader.4-rIzqtH.js";/* empty css                                                   */import"./vee-validate.esm.0La7AMjT.js";/* empty css                                                                */const be={class:"header-nav-wrap"},ye={class:"row align-items-center"},ke={class:"col-auto"},xe={class:"header-back-link"},$e={class:"col-auto"},De={class:"fw-bold"},we={class:"content"},Ve={class:"card"},Ye={class:"row field-m-0 align-items-end g-3"},Me={class:"col-md-4 col-lg-3"},Fe={class:"form-field"},Se={for:"",class:"form-label"},Pe=e("span",{class:"text-danger"},"*",-1),Ce=["onClick","onKeyup"],Ne={class:"col-md-4 col-lg-3"},Ae={class:"col-md-4 col-lg-3"},Be={class:"col-auto text-end"},Ie={class:"row align-items-center"},Re={class:"col-auto"},Ee=["disabled"],Oe={class:"col-auto"},Te=["disabled"],Le={class:"card"},qe={class:""},je={key:0},Ke={key:1,class:"table-responsive"},Ue={class:"table table-list-data table-hover"},ze={class:"bg-light"},Ge={scope:"col"},Je={scope:"col"},He={scope:"col"},Qe={scope:"col"},We={scope:"col"},Xe={scope:"col"},Ze={scope:"col"},et={scope:"col"},tt={scope:"col",class:"text-end"},st={scope:"col",class:"text-end"},at={scope:"col",class:"text-end"},ot={scope:"col",class:"text-end"},nt={scope:"col",class:"text-end"},ct={class:"text-center"},lt={class:"text-center"},it={class:"text-center"},dt={class:"text-center"},_t={class:"text-center"},rt={class:"text-center"},ut={class:"text-center"},ht={key:0,class:"badge badge-primary"},mt={key:1,class:"badge badge-success"},pt={key:2,class:"badge badge-warning"},gt={key:3,class:"badge badge-warning"},vt={key:4,class:"badge badge-danger"},ft={class:"text-end"},bt={class:"text-end"},yt={class:"text-end"},kt={class:"text-end"},xt={class:"text-end"},$t={key:1},Dt={class:"text-center py-3",colspan:"14"},wt={key:0},Vt=e("th",{colspan:"8"},null,-1),Yt={class:"text-end"},Mt={class:"text-end"},Ft={class:"text-end"},St={class:"text-end"},Pt={class:"text-end"},Ct={class:"data-footer"},Nt={class:"row align-items-center justify-content-between"},At={class:"col-auto"},Bt={class:"col-auto"},Qt={__name:"invoice_report",setup(It){const{t:b}=se(),{isAuthorized:Rt,getRoundedValue:u}=ie(),w=ae(),h=F(()=>w.user.currency.symbol),O=S({server_messages:{type:"",messages:""},is_submitting:!1,is_listing:!1,dates:m([new Date,new Date]),selected_branch:m(),selected_status:m(),is_exporting:!1}),o=S({...O}),T=b("Select Branch"),L=b("All Branches"),q=b("Select Status"),j=b("All Status"),K=m([{label:"Today",value:[new Date,new Date]},{label:"This month",value:[R(new Date),E(new Date)]},{label:"Last month",value:[R(I(new Date,1)),E(I(new Date,1))]},{label:"This year",value:[ge(new Date),ve(new Date)]}]);oe(()=>{z()});const U=[{key:"0",value:"Draft"},{key:"1",value:"Paid"},{key:"2",value:"Partial Paid"},{key:"3",value:"Returned"}],V=m([]);async function z(){_.forEach(w.user.branches,a=>{let n={key:a.slack,value:a.name,id:a.slack};V.value.push(n)})}const Y=m();async function G(a){Y.value=a,await $()}const r=m([]),x=m([]);async function $(a=1){o.is_listing=!0,o.dates[0]=k(o.dates[0]).format("YYYY-MM-DD"),o.dates[1]=k(o.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/invoice_report",{params:{page:a,paginate_limit:Y.value,filter:o}}).then(n=>{r.value=n.data.data.data,x.value=n.data.pagination,o.is_listing=!1}).catch(n=>{o.server_messages.type="error",o.server_messages.messages=n,o.is_listing=!1,console.log(n)})}const g=F(()=>r.value.length?{grand_subtotal_after_product_quantity:r.value.reduce(function(n,l){return n+parseFloat(l.grand_subtotal_after_product_quantity)},0).toFixed(2),invoice_discount:r.value.reduce(function(n,l){return n+parseFloat(l.invoice_discount)},0).toFixed(2),grand_subtotal_after_product_discount:r.value.reduce(function(n,l){return n+parseFloat(l.grand_subtotal_after_product_discount)},0).toFixed(2),grand_product_tax:r.value.reduce(function(n,l){return n+parseFloat(l.grand_product_tax)},0).toFixed(2),invoice_additional_charges:r.value.reduce(function(n,l){return n+parseFloat(l.invoice_additional_charges)},0).toFixed(2),grand_product_amount:r.value.reduce(function(n,l){return n+parseFloat(l.grand_product_amount)},0).toFixed(2)}:null);async function J(){o.is_exporting=!0,o.dates[0]=k(o.dates[0]).format("YYYY-MM-DD"),o.dates[1]=k(o.dates[1]).format("YYYY-MM-DD"),await axios.get("/api/invoice_report/export_excel",{params:{filter:o}}).then(a=>{if(a.data.status_code==200){o.is_exporting=!1;const n=document.createElement("a");n.target="_blank",n.href=a.data.data.file,document.body.appendChild(n),n.click()}else{try{o.server_messages.type="error",o.server_messages.messages=JSON.parse(a.data.msg)}catch{o.server_messages.type="error",o.server_messages.messages=a.data.msg}o.is_exporting=!1}}).catch(a=>{o.server_messages.type="error",o.server_messages.messages=a,o.is_exporting=!1,console.log(a)})}const H=de(()=>_e(()=>import("./ServerMessage.qNo4NwTp.js"),__vite__mapDeps([0,1,2])));return(a,n)=>{const l=C("Icon"),Q=C("router-link"),W=pe,X=me,Z=he,ee=ue,te=re;return i(),P(te,null,{subheader:y(()=>[e("div",be,[e("div",ye,[e("div",ke,[e("div",xe,[p(Q,{class:"text-primary",to:"/reports"},{default:y(()=>[p(l,{icon:"fa6-solid:chevron-left"}),N(" "+t(a.$t("Reports")),1)]),_:1})])]),e("div",$e,[e("h5",De,t(a.$t("Invoice Report")),1)])])])]),default:y(()=>[e("div",we,[s(o).server_messages.messages!=""?(i(),P(s(H),{key:0,class:"py-3",server_messages:s(o).server_messages},null,8,["server_messages"])):v("",!0),e("div",Ve,[e("div",Ye,[e("div",Me,[e("div",Fe,[e("label",Se,[N(t(a.$t("Select Dates"))+" ",1),Pe]),p(s(fe),{range:"","preset-dates":s(K),modelValue:s(o).dates,"onUpdate:modelValue":n[0]||(n[0]=c=>s(o).dates=c),format:"dd-MM-yyyy","enable-time-picker":!1,"input-class-name":"form-control form-control-solid"},{"preset-date-range-button":y(({label:c,value:f,presetDate:D})=>[e("span",{role:"button",tabindex:0,onClick:M=>D(f),onKeyup:[A(B(M=>D(f),["prevent"]),["enter"]),A(B(M=>D(f),["prevent"]),["space"])]},t(c),41,Ce)]),_:1},8,["preset-dates","modelValue"])])]),e("div",Ne,[p(W,{name:"branches",label:s(T),placeholder:s(L),text:"name",value:"id",options:s(V),modelValue:s(o).selected_branch,"onUpdate:modelValue":n[1]||(n[1]=c=>s(o).selected_branch=c)},null,8,["label","placeholder","options","modelValue"])]),e("div",Ae,[p(X,{name:"status",label:s(q),placeholder:s(j),text:"value",value:"key",options:U,modelValue:s(o).selected_status,"onUpdate:modelValue":n[2]||(n[2]=c=>s(o).selected_status=c),mode:"single"},null,8,["label","placeholder","modelValue"])]),e("div",Be,[e("div",Ie,[e("div",Re,[e("button",{class:"btn btn-primary",onClick:$,disabled:s(o).dates==null},t(a.$t("View")),9,Ee)]),e("div",Oe,[e("button",{class:"btn btn-success",onClick:n[3]||(n[3]=c=>J()),disabled:s(o).dates==null},t(a.$t("Export Excel")),9,Te)])])])])]),e("div",Le,[e("div",qe,[s(o).is_listing?(i(),d("div",je,[p(Z)])):(i(),d("div",Ke,[e("table",Ue,[e("thead",ze,[e("tr",null,[e("th",Ge,t(a.$t("Branch Name")),1),e("th",Je,t(a.$t("Invoice No.")),1),e("th",He,t(a.$t("Reference No.")),1),e("th",Qe,t(a.$t("Invoice Date")),1),e("th",We,t(a.$t("Invoice Due Date")),1),e("th",Xe,t(a.$t("Customer Name")),1),e("th",Ze,t(a.$t("Customer Phone")),1),e("th",et,t(a.$t("Status")),1),e("th",tt,t(a.$t("Sub Total")),1),e("th",st,t(a.$t("Discount")),1),e("th",at,t(a.$t("Tax")),1),e("th",ot,t(a.$t("Other Charges")),1),e("th",nt,t(a.$t("Net Amount")),1)])]),e("tbody",null,[s(r)!=""?(i(!0),d(ne,{key:0},ce(s(r),(c,f)=>(i(),d("tr",{key:f},[e("td",null,t(c.branch_name),1),e("td",ct,t(c.invoice_number),1),e("td",lt,t(c.reference_no),1),e("td",it,t(c.invoice_date),1),e("td",dt,t(c.due_date),1),e("td",_t,t(c.customer_name),1),e("td",rt,t(c.customer_phone),1),e("td",ut,[c.status==0?(i(),d("span",ht,t(a.$t("Draft")),1)):v("",!0),c.status==1?(i(),d("span",mt,t(a.$t("Paid")),1)):v("",!0),c.status==2?(i(),d("span",pt,t(a.$t("Partial Paid")),1)):v("",!0),c.status==3&&c.returned_status==0?(i(),d("span",gt,t(a.$t("Partial Returned")),1)):v("",!0),c.status==3&&c.returned_status==1?(i(),d("span",vt,t(a.$t("Returned")),1)):v("",!0)]),e("td",ft,t(s(u)(c.grand_subtotal_after_product_quantity))+" "+t(s(h)),1),e("td",bt,t(s(u)(c.invoice_discount))+" "+t(s(h)),1),e("td",yt,t(s(u)(c.grand_product_tax))+" "+t(s(h)),1),e("td",kt,t(s(u)(c.invoice_additional_charges))+" "+t(s(h)),1),e("td",xt,t(s(u)(c.grand_product_amount))+" "+t(s(h)),1)]))),128)):(i(),d("tr",$t,[e("td",Dt,t(a.$t("No Data Found")),1)]))]),s(g)!=""&&s(g)!=null?(i(),d("tfoot",wt,[e("tr",null,[Vt,e("th",Yt,t(s(u)(s(g).grand_subtotal_after_product_quantity))+" "+t(s(h)),1),e("th",Mt,t(s(u)(s(g).invoice_discount))+" "+t(s(h)),1),e("th",Ft,t(s(u)(s(g).grand_product_tax))+" "+t(s(h)),1),e("th",St,t(s(g).invoice_additional_charges),1),e("th",Pt,t(s(u)(s(g).grand_product_amount))+" "+t(s(h)),1)])])):v("",!0)])])),e("div",Ct,[e("div",Nt,[e("div",At,[p(ee,{onPaginate_limit_update:G,pagination:s(x)},null,8,["pagination"])]),e("div",Bt,[p(s(le),{data:s(x),limit:5,onPaginationChangePage:$},null,8,["data"])])])])])])])]),_:1})}}};export{Qt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ServerMessage.qNo4NwTp.js","assets/index.ri7Y_V5F.js","assets/index.1t-AB2n6.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
