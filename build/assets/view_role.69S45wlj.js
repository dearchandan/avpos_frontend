import{_ as z}from"./RoleSkeleton.gLhzPMg9.js";import J from"./ServerMessage.Wf7puwQc.js";import{b as K,a as P,r as b,e as Q,g as n,p as N,w as y,f as E,i as s,k as w,n as F,t as i,h as r,l as h,F as U,x as $,K as A,Q as B,j as q}from"./index.GdMxdeuf.js";import{_ as G}from"./DefaultLayout.qd3nRBiq.js";import{F as H}from"./vee-validate.esm.9aElOHQY.js";import"./index.esm.0vhAmrVd.js";/* empty css                                                   */import{C as W}from"./ClipLoader.UcGuNCxH.js";/* empty css                                                   */const X={class:"header-nav-wrap"},Y={class:"row align-items-center"},Z={class:"col-auto"},ee={class:"header-back-link"},se={class:"col-auto"},te={class:"fw-bold"},ae={key:0,class:"content role-checkbox-content"},le={class:"page-heading"},ne={key:0,class:"py-3"},re={class:"row"},oe={key:0,class:"col-lg-3 col-md-3"},ce={class:"card","data-select2-id":"select2-data-14-jv1y"},ie={class:"row"},ue={class:"col-12 pb-3"},de={key:0,class:"badge badge-success"},_e={key:1,class:"badge badge-danger"},ve={class:"col-md-12 clearfix"},he={class:"data-view-box mb-3"},pe={class:"item"},me={class:"item"},ge={key:0,class:"col-md-12 clearfix"},fe={class:"data-view-box mb-3"},ke={key:0,class:"item"},be={key:1,class:"item"},ye={class:"col-lg-9 col-md-9"},we={class:"row"},Ce={class:"form-check mt-2 mb-2"},Se={class:"form-check-label mb-0"},xe=["value","id","onClick"],Ne={class:"text-primary text-uppercase"},Ue={class:"table-responsive"},$e={class:"table"},Ae={class:"td-head-data pt-0 pb-0 mb-0",width:"40%"},Be={class:"form-check mb-0"},Me={class:"form-check-label mb-0"},Ie=["value","id","onClick"],Ve={class:"fw-bold text-dark"},Ee={width:"60%",class:""},Fe={key:0,class:"userrole_sub_table"},Oe={class:"row g-3"},Re={class:"form-check mb-0"},je={class:"form-check-label mb-0"},De=["value","id","onClick"],Te={key:0,class:"col-6 col-md-4"},Le={class:"text-end"},ze=["disabled"],Je={key:1,class:"pt-0"},Ke={key:2,class:"pt-0"},as={__name:"view_role",setup(Pe){const O=K(),M=P().params.slack,C=b(!1),u=b([]),m=b([]),t=b([]),o=Q({...{server_messages:{type:"",messages:""}}});R();async function R(){await axios.get("/api/v2/role",{params:{slack:M}}).then(e=>{u.value=e.data.data.role,m.value=e.data.data.access_menus,t.value=e.data.data.role.role_menus,C.value=!0}).catch(e=>{o.server_messages.type="error",o.server_messages.messages=e,C.value=!0,console.log(e)})}function v(e,l){return e.filter(function(a){return a!=l})}function S(e){if(e.event.target.checked==!0)e.type=="ACTIONS"&&(t.value.push(e.current),t.value=v(t.value,e.parent),t.value.push(e.parent),t.value=v(t.value,e.grand_parent),t.value.push(e.grand_parent)),e.type=="SUB_MENU"&&(t.value.push(e.current),t.value=v(t.value,e.parent),t.value.push(e.parent),t.value=t.value.concat(e.children)),e.type=="MAIN_MENU"&&(t.value.push(e.current),t.value=t.value.concat(e.children));else{if(e.type=="ACTIONS"){t.value=v(t.value,e.current);for(var l=0,a=0;a<e.siblings.length;a++)t.value.includes(e.siblings[a])&&l++;l==0&&(t.value=v(t.value,e.parent));var g="_"+e.grand_parent;if(typeof m.value[g]<"u"){for(var f=0,k=m.value[g].childs,a=0;a<k.length;a++)t.value.includes(k[a])&&f++;f==0&&(t.value=v(t.value,e==null?void 0:e.grand_parent))}}if(e.type=="SUB_MENU"){t.value=v(t.value,e.current);for(var a=0;a<e.children.length;a++)t.value=v(t.value,e.children[a]);for(var l=0,a=0;a<e.siblings.length;a++)t.value.includes(e.siblings[a])&&l++;l==0&&(t.value=v(t.value,e.parent))}if(e.type=="MAIN_MENU"){t.value=v(t.value,e.current);for(var a=0;a<e.children.length;a++)t.value=v(t.value,e.children[a])}}}async function j(){o.is_submitting=!0;var e=new FormData;e.append("role_slack",M),e.append("role_menus",t.value),await axios.post("/api/role/update_permission",e).then(l=>{if(l.data.status_code==200)toast.success(l.data.msg),o.is_submitting=!1,O.refresh(),router.push("/roles");else{try{o.server_messages.type="error",o.server_messages.messages=JSON.parse(l.data.msg)}catch{o.server_messages.type="error",o.server_messages.messages=l.data.msg}o.is_submitting=!1}}).catch(l=>{o.server_messages.type="error",o.server_messages.messages=l,o.is_submitting=!1,console.log(l)})}return(e,l)=>{const a=E("Icon"),g=E("router-link"),f=J,k=z;return n(),N(G,null,{subheader:y(()=>{var p;return[s("div",X,[s("div",Y,[s("div",Z,[s("div",ee,[w(g,{class:"text-primary",to:"/roles"},{default:y(()=>[w(a,{icon:"fa6-solid:chevron-left"}),F(" "+i(e.$t("Roles")),1)]),_:1})])]),s("div",se,[s("h5",te,i((p=u.value)==null?void 0:p.name),1)])])])]}),default:y(()=>[C.value?(n(),r("div",ae,[s("div",le,[o.server_messages.messages!=""?(n(),r("div",ne,[w(f,{server_messages:o.server_messages},null,8,["server_messages"])])):h("",!0)]),w(q(H),{onSubmit:j},{default:y(()=>{var p,I,V;return[s("div",re,[((p=u.value)==null?void 0:p.name)!=null?(n(),r("div",oe,[s("div",ce,[s("div",ie,[s("div",ue,[u.value.status==1?(n(),r("span",de,i(e.$t("Active")),1)):(n(),r("span",_e,i(e.$t("Inactive")),1))]),s("div",ve,[s("div",he,[s("div",pe,[s("span",null,i(e.$t("Created At")),1),s("strong",null,i(u.value.created_at_label),1)]),s("div",me,[s("span",null,i(e.$t("Updated At")),1),s("strong",null,i(u.value.updated_at_label),1)])])]),u.value.created_by!=null||u.value.updated_by!=null?(n(),r("div",ge,[s("div",fe,[u.value.created_by?(n(),r("div",ke,[s("span",null,i(e.$t("Created By")),1),s("strong",null,i((I=u.value.created_by)==null?void 0:I.name),1)])):h("",!0),u.value.updated_by?(n(),r("div",be,[s("span",null,i(e.$t("Updated By")),1),s("strong",null,i((V=u.value.updated_by)==null?void 0:V.name),1)])):h("",!0)])])):h("",!0)])])])):h("",!0),s("div",ye,[s("div",we,[(n(!0),r(U,null,$(m.value,(d,D)=>(n(),r("div",{key:D,class:"card"},[s("div",Ce,[s("label",Se,[A(s("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":l[0]||(l[0]=c=>t.value=c),value:d.menu_key,id:d.menu_key,onClick:c=>S({type:d.type,current:d.menu_key,parent:"",grand_parent:"",children:d.childs,siblings:d.siblings,event:c})},null,8,xe),[[B,t.value]]),s("h5",Ne,i(d==null?void 0:d.name),1)])]),s("div",Ue,[s("table",$e,[s("tbody",null,[(n(!0),r(U,null,$(d.sub_menu,(c,T)=>(n(),r("tr",{key:T},[s("td",Ae,[s("div",Be,[s("label",Me,[A(s("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":l[1]||(l[1]=_=>t.value=_),value:c.menu_key,id:c.menu_key,onClick:_=>S({type:c.type,current:c.menu_key,parent:d.menu_key,grand_parent:"",children:c.childs,siblings:c.siblings,event:_})},null,8,Ie),[[B,t.value]]),s("span",Ve,i(c==null?void 0:c.name),1)])])]),s("td",Ee,[c.actions?(n(),r("div",Fe,[s("div",Oe,[(n(!0),r(U,null,$(c.actions,(_,L)=>(n(),r("div",{class:"col-6 col-md-4",key:L},[s("div",Re,[s("label",je,[A(s("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":l[2]||(l[2]=x=>t.value=x),value:_.menu_key,id:_.menu_key,onClick:x=>S({type:_.type,current:_.menu_key,parent:c.menu_key,grand_parent:d.menu_key,children:"",siblings:_.siblings,event:x})},null,8,De),[[B,t.value]]),F(" "+i(_==null?void 0:_.name),1)])])]))),128)),Object(c.actions).length==2?(n(),r("div",Te)):h("",!0)])])):h("",!0)])]))),128))])])])]))),128))])])]),s("div",Le,[s("button",{type:"submit",class:"btn btn-primary",disabled:o.is_submitting},[o.is_submitting?(n(),N(W,{key:0,color:"white",size:"20px",class:"pt-2 pe-2"})):h("",!0),o.is_submitting?(n(),r("span",Je,i(e.$t("Saving...")),1)):(n(),r("span",Ke,i(e.$t("Save")),1))],8,ze)])]}),_:1})])):(n(),N(k,{key:1}))]),_:1})}}};export{as as default};
